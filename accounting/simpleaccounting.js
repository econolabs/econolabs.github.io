var simpleaccounting=function(){"use strict";!function(){const e={NODE_ENV:"development"};try{if(process)return process.env=Object.assign({},process.env),void Object.assign(process.env,e)}catch(e){}globalThis.process={env:e}}();const e=!1,t="${JSCORE_VERSION}",n=function(e,t){if(!e)throw r(t)},r=function(e){return new Error("Firebase Database ("+t+") INTERNAL ASSERT FAILED: "+e)},i=function(e){const t=[];let n=0;for(let r=0;r<e.length;r++){let i=e.charCodeAt(r);i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):55296==(64512&i)&&r+1<e.length&&56320==(64512&e.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&e.charCodeAt(++r)),t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t},s={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let t=0;t<e.length;t+=3){const i=e[t],s=t+1<e.length,o=s?e[t+1]:0,a=t+2<e.length,c=a?e[t+2]:0,l=i>>2,u=(3&i)<<4|o>>4;let d=(15&o)<<2|c>>6,h=63&c;a||(h=64,s||(d=64)),r.push(n[l],n[u],n[d],n[h])}return r.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(i(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){const t=[];let n=0,r=0;for(;n<e.length;){const i=e[n++];if(i<128)t[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=e[n++];t[r++]=String.fromCharCode((31&i)<<6|63&s)}else if(i>239&&i<365){const s=((7&i)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536;t[r++]=String.fromCharCode(55296+(s>>10)),t[r++]=String.fromCharCode(56320+(1023&s))}else{const s=e[n++],o=e[n++];t[r++]=String.fromCharCode((15&i)<<12|(63&s)<<6|63&o)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let t=0;t<e.length;){const i=n[e.charAt(t++)],s=t<e.length?n[e.charAt(t)]:0;++t;const a=t<e.length?n[e.charAt(t)]:64;++t;const c=t<e.length?n[e.charAt(t)]:64;if(++t,null==i||null==s||null==a||null==c)throw new o;const l=i<<2|s>>4;if(r.push(l),64!==a){const e=s<<4&240|a>>2;if(r.push(e),64!==c){const e=a<<6&192|c;r.push(e)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class o extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const a=function(e){const t=i(e);return s.encodeByteArray(t,!0)},c=function(e){return a(e).replace(/\./g,"")},l=function(e){try{return s.decodeString(e,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function u(e){return d(void 0,e)}function d(e,t){if(!(t instanceof Object))return t;switch(t.constructor){case Date:return new Date(t.getTime());case Object:void 0===e&&(e={});break;case Array:e=[];break;default:return t}for(const n in t)t.hasOwnProperty(n)&&"__proto__"!==n&&(e[n]=d(e[n],t[n]));return e}const h=()=>function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if("undefined"!=typeof global)return global;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__,p=()=>{try{return h()||(()=>{if("undefined"==typeof process||void 0===process.env)return;const e=process.env.__FIREBASE_DEFAULTS__;return e?JSON.parse(e):void 0})()||(()=>{if("undefined"==typeof document)return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(e){return}const t=e&&l(e[1]);return t&&JSON.parse(t)})()}catch(e){return void console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${e}`)}},f=e=>{const t=(e=>{var t,n;return null===(n=null===(t=p())||void 0===t?void 0:t.emulatorHosts)||void 0===n?void 0:n[e]})(e);if(!t)return;const n=t.lastIndexOf(":");if(n<=0||n+1===t.length)throw new Error(`Invalid host ${t} with no separate hostname and port!`);const r=parseInt(t.substring(n+1),10);return"["===t[0]?[t.substring(1,n-1),r]:[t.substring(0,n),r]},_=()=>{var e;return null===(e=p())||void 0===e?void 0:e.config};class m{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),"function"==typeof e&&(this.promise.catch((()=>{})),1===e.length?e(t):e(t,n))}}}function g(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test("undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:"")}function y(){return!0===e}class v extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,v.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,b.prototype.create)}}class b{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e,...t){const n=t[0]||{},r=`${this.service}/${e}`,i=this.errors[e],s=i?function(e,t){return e.replace(w,((e,n)=>{const r=t[n];return null!=r?String(r):`<${n}?>`}))}(i,n):"Error",o=`${this.serviceName}: ${s} (${r}).`;return new v(r,o,n)}}const w=/\{\$([^}]+)}/g;function C(e){return JSON.parse(e)}function E(e){return JSON.stringify(e)}const I=function(e){let t={},n={},r={},i="";try{const s=e.split(".");t=C(l(s[0])||""),n=C(l(s[1])||""),i=s[2],r=n.d||{},delete n.d}catch(e){}return{header:t,claims:n,data:r,signature:i}};function S(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function T(e,t){return Object.prototype.hasOwnProperty.call(e,t)?e[t]:void 0}function N(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}function k(e,t,n){const r={};for(const i in e)Object.prototype.hasOwnProperty.call(e,i)&&(r[i]=t.call(n,e[i],i,e));return r}function D(e,t){if(e===t)return!0;const n=Object.keys(e),r=Object.keys(t);for(const i of n){if(!r.includes(i))return!1;const n=e[i],s=t[i];if(P(n)&&P(s)){if(!D(n,s))return!1}else if(n!==s)return!1}for(const e of r)if(!n.includes(e))return!1;return!0}function P(e){return null!==e&&"object"==typeof e}class R{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,t){t||(t=0);const n=this.W_;if("string"==typeof e)for(let r=0;r<16;r++)n[r]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3),t+=4;else for(let r=0;r<16;r++)n[r]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],t+=4;for(let e=16;e<80;e++){const t=n[e-3]^n[e-8]^n[e-14]^n[e-16];n[e]=4294967295&(t<<1|t>>>31)}let r,i,s=this.chain_[0],o=this.chain_[1],a=this.chain_[2],c=this.chain_[3],l=this.chain_[4];for(let e=0;e<80;e++){e<40?e<20?(r=c^o&(a^c),i=1518500249):(r=o^a^c,i=1859775393):e<60?(r=o&a|c&(o|a),i=2400959708):(r=o^a^c,i=3395469782);const t=(s<<5|s>>>27)+r+l+i+n[e]&4294967295;l=c,c=a,a=4294967295&(o<<30|o>>>2),o=s,s=t}this.chain_[0]=this.chain_[0]+s&4294967295,this.chain_[1]=this.chain_[1]+o&4294967295,this.chain_[2]=this.chain_[2]+a&4294967295,this.chain_[3]=this.chain_[3]+c&4294967295,this.chain_[4]=this.chain_[4]+l&4294967295}update(e,t){if(null==e)return;void 0===t&&(t=e.length);const n=t-this.blockSize;let r=0;const i=this.buf_;let s=this.inbuf_;for(;r<t;){if(0===s)for(;r<=n;)this.compress_(e,r),r+=this.blockSize;if("string"==typeof e){for(;r<t;)if(i[s]=e.charCodeAt(r),++s,++r,s===this.blockSize){this.compress_(i),s=0;break}}else for(;r<t;)if(i[s]=e[r],++s,++r,s===this.blockSize){this.compress_(i),s=0;break}}this.inbuf_=s,this.total_+=t}digest(){const e=[];let t=8*this.total_;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let e=this.blockSize-1;e>=56;e--)this.buf_[e]=255&t,t/=256;this.compress_(this.buf_);let n=0;for(let t=0;t<5;t++)for(let r=24;r>=0;r-=8)e[n]=this.chain_[t]>>r&255,++n;return e}}function O(e,t){return`${e} failed: ${t} argument `}const x=function(e){let t=0;for(let n=0;n<e.length;n++){const r=e.charCodeAt(n);r<128?t++:r<2048?t+=2:r>=55296&&r<=56319?(t+=4,n++):t+=3}return t};function A(e){return e&&e._delegate?e._delegate:e}class M{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const q="[DEFAULT]";class j{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const e=new m;if(this.instancesDeferred.set(t,e),this.isInitialized(t)||this.shouldAutoInitialize())try{const n=this.getOrInitializeService({instanceIdentifier:t});n&&e.resolve(n)}catch(e){}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const n=this.normalizeInstanceIdentifier(null==e?void 0:e.identifier),r=null!==(t=null==e?void 0:e.optional)&&void 0!==t&&t;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(r)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(e){if(r)return null;throw e}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,this.shouldAutoInitialize()){if(function(e){return"EAGER"===e.instantiationMode}(e))try{this.getOrInitializeService({instanceIdentifier:q})}catch(e){}for(const[e,t]of this.instancesDeferred.entries()){const n=this.normalizeInstanceIdentifier(e);try{const e=this.getOrInitializeService({instanceIdentifier:n});t.resolve(e)}catch(e){}}}}clearInstance(e=q){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter((e=>"INTERNAL"in e)).map((e=>e.INTERNAL.delete())),...e.filter((e=>"_delete"in e)).map((e=>e._delete()))])}isComponentSet(){return null!=this.component}isInitialized(e=q){return this.instances.has(e)}getOptions(e=q){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[e,t]of this.instancesDeferred.entries()){n===this.normalizeInstanceIdentifier(e)&&t.resolve(r)}return r}onInit(e,t){var n;const r=this.normalizeInstanceIdentifier(t),i=null!==(n=this.onInitCallbacks.get(r))&&void 0!==n?n:new Set;i.add(e),this.onInitCallbacks.set(r,i);const s=this.instances.get(r);return s&&e(s,r),()=>{i.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const r of n)try{r(e,t)}catch(e){}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:(r=e,r===q?void 0:r),options:t}),this.instances.set(e,n),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch(e){}var r;return n||null}normalizeInstanceIdentifier(e=q){return this.component?this.component.multipleInstances?e:q:e}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class F{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new j(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}var L;!function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"}(L||(L={}));const $={debug:L.DEBUG,verbose:L.VERBOSE,info:L.INFO,warn:L.WARN,error:L.ERROR,silent:L.SILENT},V=L.INFO,U={[L.DEBUG]:"log",[L.VERBOSE]:"log",[L.INFO]:"info",[L.WARN]:"warn",[L.ERROR]:"error"},z=(e,t,...n)=>{if(t<e.logLevel)return;const r=(new Date).toISOString(),i=U[t];if(!i)throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`);console[i](`[${r}]  ${e.name}:`,...n)};class W{constructor(e){this.name=e,this._logLevel=V,this._logHandler=z,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in L))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel="string"==typeof e?$[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!=typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,L.DEBUG,...e),this._logHandler(this,L.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,L.VERBOSE,...e),this._logHandler(this,L.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,L.INFO,...e),this._logHandler(this,L.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,L.WARN,...e),this._logHandler(this,L.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,L.ERROR,...e),this._logHandler(this,L.ERROR,...e)}}let B,H;const Q=new WeakMap,K=new WeakMap,Y=new WeakMap,G=new WeakMap,J=new WeakMap;let X={get(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return K.get(e);if("objectStoreNames"===t)return e.objectStoreNames||Y.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return te(e[t])},set:(e,t,n)=>(e[t]=n,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function Z(e){return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(H||(H=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(...t){return e.apply(ne(this),t),te(Q.get(this))}:function(...t){return te(e.apply(ne(this),t))}:function(t,...n){const r=e.call(ne(this),t,...n);return Y.set(r,t.sort?t.sort():[t]),te(r)}}function ee(e){return"function"==typeof e?Z(e):(e instanceof IDBTransaction&&function(e){if(K.has(e))return;const t=new Promise(((t,n)=>{const r=()=>{e.removeEventListener("complete",i),e.removeEventListener("error",s),e.removeEventListener("abort",s)},i=()=>{t(),r()},s=()=>{n(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",i),e.addEventListener("error",s),e.addEventListener("abort",s)}));K.set(e,t)}(e),t=e,(B||(B=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])).some((e=>t instanceof e))?new Proxy(e,X):e);var t}function te(e){if(e instanceof IDBRequest)return function(e){const t=new Promise(((t,n)=>{const r=()=>{e.removeEventListener("success",i),e.removeEventListener("error",s)},i=()=>{t(te(e.result)),r()},s=()=>{n(e.error),r()};e.addEventListener("success",i),e.addEventListener("error",s)}));return t.then((t=>{t instanceof IDBCursor&&Q.set(t,e)})).catch((()=>{})),J.set(t,e),t}(e);if(G.has(e))return G.get(e);const t=ee(e);return t!==e&&(G.set(e,t),J.set(t,e)),t}const ne=e=>J.get(e);const re=["get","getKey","getAll","getAllKeys","count"],ie=["put","add","delete","clear"],se=new Map;function oe(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!=typeof t)return;if(se.get(t))return se.get(t);const n=t.replace(/FromIndex$/,""),r=t!==n,i=ie.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!i&&!re.includes(n))return;const s=async function(e,...t){const s=this.transaction(e,i?"readwrite":"readonly");let o=s.store;return r&&(o=o.index(t.shift())),(await Promise.all([o[n](...t),i&&s.done]))[0]};return se.set(t,s),s}X=(e=>({...e,get:(t,n,r)=>oe(t,n)||e.get(t,n,r),has:(t,n)=>!!oe(t,n)||e.has(t,n)}))(X);class ae{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map((e=>{if(function(e){const t=e.getComponent();return"VERSION"===(null==t?void 0:t.type)}(e)){const t=e.getImmediate();return`${t.library}/${t.version}`}return null})).filter((e=>e)).join(" ")}}const ce="@firebase/app",le="0.10.13",ue=new W("@firebase/app"),de="@firebase/app-compat",he="@firebase/analytics-compat",pe="@firebase/analytics",fe="@firebase/app-check-compat",_e="@firebase/app-check",me="@firebase/auth",ge="@firebase/auth-compat",ye="@firebase/database",ve="@firebase/data-connect",be="@firebase/database-compat",we="@firebase/functions",Ce="@firebase/functions-compat",Ee="@firebase/installations",Ie="@firebase/installations-compat",Se="@firebase/messaging",Te="@firebase/messaging-compat",Ne="@firebase/performance",ke="@firebase/performance-compat",De="@firebase/remote-config",Pe="@firebase/remote-config-compat",Re="@firebase/storage",Oe="@firebase/storage-compat",xe="@firebase/firestore",Ae="@firebase/vertexai-preview",Me="@firebase/firestore-compat",qe="firebase",je="[DEFAULT]",Fe={[ce]:"fire-core",[de]:"fire-core-compat",[pe]:"fire-analytics",[he]:"fire-analytics-compat",[_e]:"fire-app-check",[fe]:"fire-app-check-compat",[me]:"fire-auth",[ge]:"fire-auth-compat",[ye]:"fire-rtdb",[ve]:"fire-data-connect",[be]:"fire-rtdb-compat",[we]:"fire-fn",[Ce]:"fire-fn-compat",[Ee]:"fire-iid",[Ie]:"fire-iid-compat",[Se]:"fire-fcm",[Te]:"fire-fcm-compat",[Ne]:"fire-perf",[ke]:"fire-perf-compat",[De]:"fire-rc",[Pe]:"fire-rc-compat",[Re]:"fire-gcs",[Oe]:"fire-gcs-compat",[xe]:"fire-fst",[Me]:"fire-fst-compat",[Ae]:"fire-vertex","fire-js":"fire-js",[qe]:"fire-js-all"},Le=new Map,$e=new Map,Ve=new Map;function Ue(e,t){try{e.container.addComponent(t)}catch(n){ue.debug(`Component ${t.name} failed to register with FirebaseApp ${e.name}`,n)}}function ze(e){const t=e.name;if(Ve.has(t))return ue.debug(`There were multiple attempts to register component ${t}.`),!1;Ve.set(t,e);for(const t of Le.values())Ue(t,e);for(const t of $e.values())Ue(t,e);return!0}const We=new b("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."});class Be{constructor(e,t,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new M("app",(()=>this),"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw We.create("app-deleted",{appName:this._name})}}function He(e,t={}){let n=e;if("object"!=typeof t){t={name:t}}const r=Object.assign({name:je,automaticDataCollectionEnabled:!1},t),i=r.name;if("string"!=typeof i||!i)throw We.create("bad-app-name",{appName:String(i)});if(n||(n=_()),!n)throw We.create("no-options");const s=Le.get(i);if(s){if(D(n,s.options)&&D(r,s.config))return s;throw We.create("duplicate-app",{appName:i})}const o=new F(i);for(const e of Ve.values())o.addComponent(e);const a=new Be(n,r,o);return Le.set(i,a),a}function Qe(){return Array.from(Le.values())}function Ke(e,t,n){var r;let i=null!==(r=Fe[e])&&void 0!==r?r:e;n&&(i+=`-${n}`);const s=i.match(/\s|\//),o=t.match(/\s|\//);if(s||o){const e=[`Unable to register library "${i}" with version "${t}":`];return s&&e.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&o&&e.push("and"),o&&e.push(`version name "${t}" contains illegal characters (whitespace or "/")`),void ue.warn(e.join(" "))}ze(new M(`${i}-version`,(()=>({library:i,version:t})),"VERSION"))}const Ye="firebase-heartbeat-store";let Ge=null;function Je(){return Ge||(Ge=function(e,t,{blocked:n,upgrade:r,blocking:i,terminated:s}={}){const o=indexedDB.open(e,t),a=te(o);return r&&o.addEventListener("upgradeneeded",(e=>{r(te(o.result),e.oldVersion,e.newVersion,te(o.transaction),e)})),n&&o.addEventListener("blocked",(e=>n(e.oldVersion,e.newVersion,e))),a.then((e=>{s&&e.addEventListener("close",(()=>s())),i&&e.addEventListener("versionchange",(e=>i(e.oldVersion,e.newVersion,e)))})).catch((()=>{})),a}("firebase-heartbeat-database",1,{upgrade:(e,t)=>{if(0===t)try{e.createObjectStore(Ye)}catch(e){console.warn(e)}}}).catch((e=>{throw We.create("idb-open",{originalErrorMessage:e.message})}))),Ge}async function Xe(e,t){try{const n=(await Je()).transaction(Ye,"readwrite"),r=n.objectStore(Ye);await r.put(t,Ze(e)),await n.done}catch(e){if(e instanceof v)ue.warn(e.message);else{const t=We.create("idb-set",{originalErrorMessage:null==e?void 0:e.message});ue.warn(t.message)}}}function Ze(e){return`${e.name}!${e.options.appId}`}class et{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new nt(t),this._heartbeatsCachePromise=this._storage.read().then((e=>(this._heartbeatsCache=e,e)))}async triggerHeartbeat(){var e,t;try{const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=tt();if(null==(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)&&(this._heartbeatsCache=await this._heartbeatsCachePromise,null==(null===(t=this._heartbeatsCache)||void 0===t?void 0:t.heartbeats)))return;if(this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some((e=>e.date===r)))return;return this._heartbeatsCache.heartbeats.push({date:r,agent:n}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter((e=>{const t=new Date(e.date).valueOf();return Date.now()-t<=2592e6})),this._storage.overwrite(this._heartbeatsCache)}catch(e){ue.warn(e)}}async getHeartbeatsHeader(){var e;try{if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,null==(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)||0===this._heartbeatsCache.heartbeats.length)return"";const t=tt(),{heartbeatsToSend:n,unsentEntries:r}=function(e,t=1024){const n=[];let r=e.slice();for(const i of e){const e=n.find((e=>e.agent===i.agent));if(e){if(e.dates.push(i.date),rt(n)>t){e.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),rt(n)>t){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}(this._heartbeatsCache.heartbeats),i=c(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=t,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(e){return ue.warn(e),""}}}function tt(){return(new Date).toISOString().substring(0,10)}class nt{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!function(){try{return"object"==typeof indexedDB}catch(e){return!1}}()&&new Promise(((e,t)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),e(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var e;t((null===(e=i.error)||void 0===e?void 0:e.message)||"")}}catch(e){t(e)}})).then((()=>!0)).catch((()=>!1))}async read(){if(await this._canUseIndexedDBPromise){const e=await async function(e){try{const t=(await Je()).transaction(Ye),n=await t.objectStore(Ye).get(Ze(e));return await t.done,n}catch(e){if(e instanceof v)ue.warn(e.message);else{const t=We.create("idb-get",{originalErrorMessage:null==e?void 0:e.message});ue.warn(t.message)}}}(this.app);return(null==e?void 0:e.heartbeats)?e:{heartbeats:[]}}return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const n=await this.read();return Xe(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}}async add(e){var t;if(await this._canUseIndexedDBPromise){const n=await this.read();return Xe(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}}}function rt(e){return c(JSON.stringify({version:2,heartbeats:e})).length}var it;it="",ze(new M("platform-logger",(e=>new ae(e)),"PRIVATE")),ze(new M("heartbeat",(e=>new et(e)),"PRIVATE")),Ke(ce,le,it),Ke(ce,le,"esm2017"),Ke("fire-js","");Ke("firebase","10.14.1","app");const st="@firebase/database",ot="1.0.8";let at="";class ct{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,t){null==t?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),E(t))}get(e){const t=this.domStorage_.getItem(this.prefixedName_(e));return null==t?null:C(t)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}class lt{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,t){null==t?delete this.cache_[e]:this.cache_[e]=t}get(e){return S(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}const ut=function(e){try{if("undefined"!=typeof window&&void 0!==window[e]){const t=window[e];return t.setItem("firebase:sentinel","cache"),t.removeItem("firebase:sentinel"),new ct(t)}}catch(e){}return new lt},dt=ut("localStorage"),ht=ut("sessionStorage"),pt=new W("@firebase/database"),ft=function(){let e=1;return function(){return e++}}(),_t=function(e){const t=function(e){const t=[];let r=0;for(let i=0;i<e.length;i++){let s=e.charCodeAt(i);if(s>=55296&&s<=56319){const t=s-55296;i++,n(i<e.length,"Surrogate pair missing trail surrogate."),s=65536+(t<<10)+(e.charCodeAt(i)-56320)}s<128?t[r++]=s:s<2048?(t[r++]=s>>6|192,t[r++]=63&s|128):s<65536?(t[r++]=s>>12|224,t[r++]=s>>6&63|128,t[r++]=63&s|128):(t[r++]=s>>18|240,t[r++]=s>>12&63|128,t[r++]=s>>6&63|128,t[r++]=63&s|128)}return t}(e),r=new R;r.update(t);const i=r.digest();return s.encodeByteArray(i)},mt=function(...e){let t="";for(let n=0;n<e.length;n++){const r=e[n];Array.isArray(r)||r&&"object"==typeof r&&"number"==typeof r.length?t+=mt.apply(null,r):t+="object"==typeof r?E(r):r,t+=" "}return t};let gt=null,yt=!0;const vt=function(...e){var t;if(!0===yt&&(yt=!1,null===gt&&!0===ht.get("logging_enabled")&&(n(!t,"Can't turn on custom loggers persistently."),pt.logLevel=L.VERBOSE,gt=pt.log.bind(pt))),gt){const t=mt.apply(null,e);gt(t)}},bt=function(e){return function(...t){vt(e,...t)}},wt=function(...e){const t="FIREBASE INTERNAL ERROR: "+mt(...e);pt.error(t)},Ct=function(...e){const t=`FIREBASE FATAL ERROR: ${mt(...e)}`;throw pt.error(t),new Error(t)},Et=function(...e){const t="FIREBASE WARNING: "+mt(...e);pt.warn(t)},It=function(e){return"number"==typeof e&&(e!=e||e===Number.POSITIVE_INFINITY||e===Number.NEGATIVE_INFINITY)},St="[MIN_NAME]",Tt="[MAX_NAME]",Nt=function(e,t){if(e===t)return 0;if(e===St||t===Tt)return-1;if(t===St||e===Tt)return 1;{const n=Mt(e),r=Mt(t);return null!==n?null!==r?n-r==0?e.length-t.length:n-r:-1:null!==r?1:e<t?-1:1}},kt=function(e,t){return e===t?0:e<t?-1:1},Dt=function(e,t){if(t&&e in t)return t[e];throw new Error("Missing required key ("+e+") in object: "+E(t))},Pt=function(e){if("object"!=typeof e||null===e)return E(e);const t=[];for(const n in e)t.push(n);t.sort();let n="{";for(let r=0;r<t.length;r++)0!==r&&(n+=","),n+=E(t[r]),n+=":",n+=Pt(e[t[r]]);return n+="}",n},Rt=function(e,t){const n=e.length;if(n<=t)return[e];const r=[];for(let i=0;i<n;i+=t)i+t>n?r.push(e.substring(i,n)):r.push(e.substring(i,i+t));return r};function Ot(e,t){for(const n in e)e.hasOwnProperty(n)&&t(n,e[n])}const xt=function(e){n(!It(e),"Invalid JSON number");const t=1023;let r,i,s,o,a;0===e?(i=0,s=0,r=1/e==-1/0?1:0):(r=e<0,(e=Math.abs(e))>=Math.pow(2,-1022)?(o=Math.min(Math.floor(Math.log(e)/Math.LN2),t),i=o+t,s=Math.round(e*Math.pow(2,52-o)-Math.pow(2,52))):(i=0,s=Math.round(e/Math.pow(2,-1074))));const c=[];for(a=52;a;a-=1)c.push(s%2?1:0),s=Math.floor(s/2);for(a=11;a;a-=1)c.push(i%2?1:0),i=Math.floor(i/2);c.push(r?1:0),c.reverse();const l=c.join("");let u="";for(a=0;a<64;a+=8){let e=parseInt(l.substr(a,8),2).toString(16);1===e.length&&(e="0"+e),u+=e}return u.toLowerCase()};const At=new RegExp("^-?(0*)\\d{1,10}$"),Mt=function(e){if(At.test(e)){const t=Number(e);if(t>=-2147483648&&t<=2147483647)return t}return null},qt=function(e){try{e()}catch(e){setTimeout((()=>{const t=e.stack||"";throw Et("Exception was thrown by user callback.",t),e}),Math.floor(0))}},jt=function(e,t){const n=setTimeout(e,t);return"number"==typeof n&&"undefined"!=typeof Deno&&Deno.unrefTimer?Deno.unrefTimer(n):"object"==typeof n&&n.unref&&n.unref(),n};class Ft{constructor(e,t){this.appName_=e,this.appCheckProvider=t,this.appCheck=null==t?void 0:t.getImmediate({optional:!0}),this.appCheck||null==t||t.get().then((e=>this.appCheck=e))}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise(((t,n)=>{setTimeout((()=>{this.appCheck?this.getToken(e).then(t,n):t(null)}),0)}))}addTokenChangeListener(e){var t;null===(t=this.appCheckProvider)||void 0===t||t.get().then((t=>t.addTokenListener(e)))}notifyForInvalidToken(){Et(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}}class Lt{constructor(e,t,n){this.appName_=e,this.firebaseOptions_=t,this.authProvider_=n,this.auth_=null,this.auth_=n.getImmediate({optional:!0}),this.auth_||n.onInit((e=>this.auth_=e))}getToken(e){return this.auth_?this.auth_.getToken(e).catch((e=>e&&"auth/token-not-initialized"===e.code?(vt("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(e))):new Promise(((t,n)=>{setTimeout((()=>{this.auth_?this.getToken(e).then(t,n):t(null)}),0)}))}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then((t=>t.addAuthTokenListener(e)))}removeTokenChangeListener(e){this.authProvider_.get().then((t=>t.removeAuthTokenListener(e)))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',Et(e)}}class $t{constructor(e){this.accessToken=e}getToken(e){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(e){e(this.accessToken)}removeTokenChangeListener(e){}notifyForInvalidToken(){}}$t.OWNER="owner";const Vt=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,Ut="ac",zt="websocket",Wt="long_polling";class Bt{constructor(e,t,n,r,i=!1,s="",o=!1,a=!1){this.secure=t,this.namespace=n,this.webSocketOnly=r,this.nodeAdmin=i,this.persistenceKey=s,this.includeNamespaceInQueryParams=o,this.isUsingEmulator=a,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=dt.get("host:"+e)||this._host}isCacheableHost(){return"s-"===this.internalHost.substr(0,2)}isCustomHost(){return"firebaseio.com"!==this._domain&&"firebaseio-demo.com"!==this._domain}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&dt.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){const e=this.secure?"https://":"http://",t=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${t}`}}function Ht(e,t,r){let i;if(n("string"==typeof t,"typeof type must == string"),n("object"==typeof r,"typeof params must == object"),t===zt)i=(e.secure?"wss://":"ws://")+e.internalHost+"/.ws?";else{if(t!==Wt)throw new Error("Unknown connection type: "+t);i=(e.secure?"https://":"http://")+e.internalHost+"/.lp?"}(function(e){return e.host!==e.internalHost||e.isCustomHost()||e.includeNamespaceInQueryParams})(e)&&(r.ns=e.namespace);const s=[];return Ot(r,((e,t)=>{s.push(e+"="+t)})),i+s.join("&")}class Qt{constructor(){this.counters_={}}incrementCounter(e,t=1){S(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t}get(){return u(this.counters_)}}const Kt={},Yt={};function Gt(e){const t=e.toString();return Kt[t]||(Kt[t]=new Qt),Kt[t]}class Jt{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,t){for(this.pendingResponses[e]=t;this.pendingResponses[this.currentResponseNum];){const e=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let t=0;t<e.length;++t)e[t]&&qt((()=>{this.onMessage_(e[t])}));if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}const Xt="start";class Zt{constructor(e,t,n,r,i,s,o){this.connId=e,this.repoInfo=t,this.applicationId=n,this.appCheckToken=r,this.authToken=i,this.transportSessionId=s,this.lastSessionId=o,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=bt(e),this.stats_=Gt(t),this.urlFn=e=>(this.appCheckToken&&(e[Ut]=this.appCheckToken),Ht(t,Wt,e))}open(e,t){this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new Jt(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout((()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null}),Math.floor(3e4)),function(e){if("complete"===document.readyState)e();else{let t=!1;const n=function(){document.body?t||(t=!0,e()):setTimeout(n,Math.floor(10))};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",(()=>{"complete"===document.readyState&&n()})),window.attachEvent("onload",n))}}((()=>{if(this.isClosed_)return;this.scriptTagHolder=new en(((...e)=>{const[t,n,r,i,s]=e;if(this.incrementIncomingBytes_(e),this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,t===Xt)this.id=n,this.password=r;else{if("close"!==t)throw new Error("Unrecognized command received: "+t);n?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(n,(()=>{this.onClosed_()}))):this.onClosed_()}}),((...e)=>{const[t,n]=e;this.incrementIncomingBytes_(e),this.myPacketOrderer.handleResponse(t,n)}),(()=>{this.onClosed_()}),this.urlFn);const e={};e[Xt]="t",e.ser=Math.floor(1e8*Math.random()),this.scriptTagHolder.uniqueCallbackIdentifier&&(e.cb=this.scriptTagHolder.uniqueCallbackIdentifier),e.v="5",this.transportSessionId&&(e.s=this.transportSessionId),this.lastSessionId&&(e.ls=this.lastSessionId),this.applicationId&&(e.p=this.applicationId),this.appCheckToken&&(e[Ut]=this.appCheckToken),"undefined"!=typeof location&&location.hostname&&Vt.test(location.hostname)&&(e.r="f");const t=this.urlFn(e);this.log_("Connecting via long-poll to "+t),this.scriptTagHolder.addTag(t,(()=>{}))}))}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){Zt.forceAllow_=!0}static forceDisallow(){Zt.forceDisallow_=!0}static isAvailable(){return!!Zt.forceAllow_||!(Zt.forceDisallow_||"undefined"==typeof document||null==document.createElement||"object"==typeof window&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href)||"object"==typeof Windows&&"object"==typeof Windows.UI)}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const t=E(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const n=a(t),r=Rt(n,1840);for(let e=0;e<r.length;e++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,r.length,r[e]),this.curSegmentNum++}addDisconnectPingFrame(e,t){this.myDisconnFrame=document.createElement("iframe");const n={dframe:"t"};n.id=e,n.pw=t,this.myDisconnFrame.src=this.urlFn(n),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const t=E(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}}class en{constructor(e,t,n,r){this.onDisconnect=n,this.urlFn=r,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0;{this.uniqueCallbackIdentifier=ft(),window["pLPCommand"+this.uniqueCallbackIdentifier]=e,window["pRTLPCB"+this.uniqueCallbackIdentifier]=t,this.myIFrame=en.createIFrame_();let n="";if(this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,11)){n='<script>document.domain="'+document.domain+'";<\/script>'}const r="<html><body>"+n+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(r),this.myIFrame.doc.close()}catch(e){vt("frame writing exception"),e.stack&&vt(e.stack),vt(e)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(e);try{e.contentWindow.document||vt("No IE domain setting required")}catch(t){const n=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+n+"';document.close();})())"}return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout((()=>{null!==this.myIFrame&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)}),Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e.id=this.myID,e.pw=this.myPW,e.ser=this.currentSerial;let t=this.urlFn(e),n="",r=0;for(;this.pendingSegs.length>0;){if(!(this.pendingSegs[0].d.length+30+n.length<=1870))break;{const e=this.pendingSegs.shift();n=n+"&seg"+r+"="+e.seg+"&ts"+r+"="+e.ts+"&d"+r+"="+e.d,r++}}return t+=n,this.addLongPollTag_(t,this.currentSerial),!0}return!1}enqueueSegment(e,t,n){this.pendingSegs.push({seg:e,ts:t,d:n}),this.alive&&this.newRequest_()}addLongPollTag_(e,t){this.outstandingRequests.add(t);const n=()=>{this.outstandingRequests.delete(t),this.newRequest_()},r=setTimeout(n,Math.floor(25e3));this.addTag(e,(()=>{clearTimeout(r),n()}))}addTag(e,t){setTimeout((()=>{try{if(!this.sendNewPolls)return;const n=this.myIFrame.doc.createElement("script");n.type="text/javascript",n.async=!0,n.src=e,n.onload=n.onreadystatechange=function(){const e=n.readyState;e&&"loaded"!==e&&"complete"!==e||(n.onload=n.onreadystatechange=null,n.parentNode&&n.parentNode.removeChild(n),t())},n.onerror=()=>{vt("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(n)}catch(e){}}),Math.floor(1))}}let tn=null;"undefined"!=typeof MozWebSocket?tn=MozWebSocket:"undefined"!=typeof WebSocket&&(tn=WebSocket);class nn{constructor(e,t,n,r,i,s,o){this.connId=e,this.applicationId=n,this.appCheckToken=r,this.authToken=i,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=bt(this.connId),this.stats_=Gt(t),this.connURL=nn.connectionURL_(t,s,o,r,n),this.nodeAdmin=t.nodeAdmin}static connectionURL_(e,t,n,r,i){const s={v:"5"};return"undefined"!=typeof location&&location.hostname&&Vt.test(location.hostname)&&(s.r="f"),t&&(s.s=t),n&&(s.ls=n),r&&(s[Ut]=r),i&&(s.p=i),Ht(e,zt,s)}open(e,t){this.onDisconnect=t,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,dt.set("previous_websocket_failure",!0);try{let e;y(),this.mySock=new tn(this.connURL,[],e)}catch(e){this.log_("Error instantiating WebSocket.");const t=e.message||e.data;return t&&this.log_(t),void this.onClosed_()}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=e=>{this.handleIncomingFrame(e)},this.mySock.onerror=e=>{this.log_("WebSocket error.  Closing connection.");const t=e.message||e.data;t&&this.log_(t),this.onClosed_()}}start(){}static forceDisallow(){nn.forceDisallow_=!0}static isAvailable(){let e=!1;if("undefined"!=typeof navigator&&navigator.userAgent){const t=/Android ([0-9]{0,}\.[0-9]{0,})/,n=navigator.userAgent.match(t);n&&n.length>1&&parseFloat(n[1])<4.4&&(e=!0)}return!e&&null!==tn&&!nn.forceDisallow_}static previouslyFailed(){return dt.isInMemoryStorage||!0===dt.get("previous_websocket_failure")}markConnectionHealthy(){dt.remove("previous_websocket_failure")}appendFrame_(e){if(this.frames.push(e),this.frames.length===this.totalFrames){const e=this.frames.join("");this.frames=null;const t=C(e);this.onMessage(t)}}handleNewFrameCount_(e){this.totalFrames=e,this.frames=[]}extractFrameCount_(e){if(n(null===this.frames,"We already have a frame buffer"),e.length<=6){const t=Number(e);if(!isNaN(t))return this.handleNewFrameCount_(t),null}return this.handleNewFrameCount_(1),e}handleIncomingFrame(e){if(null===this.mySock)return;const t=e.data;if(this.bytesReceived+=t.length,this.stats_.incrementCounter("bytes_received",t.length),this.resetKeepAlive(),null!==this.frames)this.appendFrame_(t);else{const e=this.extractFrameCount_(t);null!==e&&this.appendFrame_(e)}}send(e){this.resetKeepAlive();const t=E(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const n=Rt(t,16384);n.length>1&&this.sendString_(String(n.length));for(let e=0;e<n.length;e++)this.sendString_(n[e])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval((()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()}),Math.floor(45e3))}sendString_(e){try{this.mySock.send(e)}catch(e){this.log_("Exception thrown from WebSocket.send():",e.message||e.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}nn.responsesRequiredToBeHealthy=2,nn.healthyTimeout=3e4;class rn{constructor(e){this.initTransports_(e)}static get ALL_TRANSPORTS(){return[Zt,nn]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(e){const t=nn&&nn.isAvailable();let n=t&&!nn.previouslyFailed();if(e.webSocketOnly&&(t||Et("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),n=!0),n)this.transports_=[nn];else{const e=this.transports_=[];for(const t of rn.ALL_TRANSPORTS)t&&t.isAvailable()&&e.push(t);rn.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}rn.globalTransportInitialized_=!1;class sn{constructor(e,t,n,r,i,s,o,a,c,l){this.id=e,this.repoInfo_=t,this.applicationId_=n,this.appCheckToken_=r,this.authToken_=i,this.onMessage_=s,this.onReady_=o,this.onDisconnect_=a,this.onKill_=c,this.lastSessionId=l,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=bt("c:"+this.id+":"),this.transportManager_=new rn(t),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.conn_),n=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout((()=>{this.conn_&&this.conn_.open(t,n)}),Math.floor(0));const r=e.healthyTimeout||0;r>0&&(this.healthyTimeout_=jt((()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>102400?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>10240?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))}),Math.floor(r)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return t=>{e===this.conn_?this.onConnectionLost_(t):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return t=>{2!==this.state_&&(e===this.rx_?this.onPrimaryMessageReceived_(t):e===this.secondaryConn_?this.onSecondaryMessageReceived_(t):this.log_("message on old connection"))}}sendRequest(e){const t={t:"d",d:e};this.sendData_(t)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if("t"in e){const t=e.t;"a"===t?this.upgradeIfSecondaryHealthy_():"r"===t?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),this.tx_!==this.secondaryConn_&&this.rx_!==this.secondaryConn_||this.close()):"o"===t&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const t=Dt("t",e),n=Dt("d",e);if("c"===t)this.onSecondaryControl_(n);else{if("d"!==t)throw new Error("Unknown protocol layer: "+t);this.pendingDataMessages.push(n)}}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:"p",d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:"a",d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:"n",d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const t=Dt("t",e),n=Dt("d",e);"c"===t?this.onControl_(n):"d"===t&&this.onDataMessage_(n)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const t=Dt("t",e);if("d"in e){const n=e.d;if("h"===t){const e=Object.assign({},n);this.repoInfo_.isUsingEmulator&&(e.h=this.repoInfo_.host),this.onHandshake_(e)}else if("n"===t){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let e=0;e<this.pendingDataMessages.length;++e)this.onDataMessage_(this.pendingDataMessages[e]);this.pendingDataMessages=[],this.tryCleanupConnection()}else"s"===t?this.onConnectionShutdown_(n):"r"===t?this.onReset_(n):"e"===t?wt("Server Error: "+n):"o"===t?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):wt("Unknown control packet command: "+t)}}onHandshake_(e){const t=e.ts,n=e.v,r=e.h;this.sessionId=e.s,this.repoInfo_.host=r,0===this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),"5"!==n&&Et("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.secondaryConn_),n=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(t,n),jt((()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())}),Math.floor(6e4))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,1===this.state_?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,t){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):jt((()=>{this.sendPingOnPrimaryIfNecessary_()}),Math.floor(5e3))}sendPingOnPrimaryIfNecessary_(){this.isHealthy_||1!==this.state_||(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:"p",d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,this.tx_!==e&&this.rx_!==e||this.close()}onConnectionLost_(e){this.conn_=null,e||0!==this.state_?1===this.state_&&this.log_("Realtime connection lost."):(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(dt.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(1!==this.state_)throw"Connection is not connected";this.tx_.send(e)}close(){2!==this.state_&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}class on{put(e,t,n,r){}merge(e,t,n,r){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,t,n){}onDisconnectMerge(e,t,n){}onDisconnectCancel(e,t){}reportStats(e){}}class an{constructor(e){this.allowedEvents_=e,this.listeners_={},n(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...t){if(Array.isArray(this.listeners_[e])){const n=[...this.listeners_[e]];for(let e=0;e<n.length;e++)n[e].callback.apply(n[e].context,t)}}on(e,t,n){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:n});const r=this.getInitialEvent(e);r&&t.apply(n,r)}off(e,t,n){this.validateEventType_(e);const r=this.listeners_[e]||[];for(let e=0;e<r.length;e++)if(r[e].callback===t&&(!n||n===r[e].context))return void r.splice(e,1)}validateEventType_(e){n(this.allowedEvents_.find((t=>t===e)),"Unknown event: "+e)}}class cn extends an{constructor(){super(["online"]),this.online_=!0,"undefined"==typeof window||void 0===window.addEventListener||g()||(window.addEventListener("online",(()=>{this.online_||(this.online_=!0,this.trigger("online",!0))}),!1),window.addEventListener("offline",(()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))}),!1))}static getInstance(){return new cn}getInitialEvent(e){return n("online"===e,"Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}class ln{constructor(e,t){if(void 0===t){this.pieces_=e.split("/");let t=0;for(let e=0;e<this.pieces_.length;e++)this.pieces_[e].length>0&&(this.pieces_[t]=this.pieces_[e],t++);this.pieces_.length=t,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}toString(){let e="";for(let t=this.pieceNum_;t<this.pieces_.length;t++)""!==this.pieces_[t]&&(e+="/"+this.pieces_[t]);return e||"/"}}function un(){return new ln("")}function dn(e){return e.pieceNum_>=e.pieces_.length?null:e.pieces_[e.pieceNum_]}function hn(e){return e.pieces_.length-e.pieceNum_}function pn(e){let t=e.pieceNum_;return t<e.pieces_.length&&t++,new ln(e.pieces_,t)}function fn(e){return e.pieceNum_<e.pieces_.length?e.pieces_[e.pieces_.length-1]:null}function _n(e,t=0){return e.pieces_.slice(e.pieceNum_+t)}function mn(e){if(e.pieceNum_>=e.pieces_.length)return null;const t=[];for(let n=e.pieceNum_;n<e.pieces_.length-1;n++)t.push(e.pieces_[n]);return new ln(t,0)}function gn(e,t){const n=[];for(let t=e.pieceNum_;t<e.pieces_.length;t++)n.push(e.pieces_[t]);if(t instanceof ln)for(let e=t.pieceNum_;e<t.pieces_.length;e++)n.push(t.pieces_[e]);else{const e=t.split("/");for(let t=0;t<e.length;t++)e[t].length>0&&n.push(e[t])}return new ln(n,0)}function yn(e){return e.pieceNum_>=e.pieces_.length}function vn(e,t){const n=dn(e),r=dn(t);if(null===n)return t;if(n===r)return vn(pn(e),pn(t));throw new Error("INTERNAL ERROR: innerPath ("+t+") is not within outerPath ("+e+")")}function bn(e,t){const n=_n(e,0),r=_n(t,0);for(let e=0;e<n.length&&e<r.length;e++){const t=Nt(n[e],r[e]);if(0!==t)return t}return n.length===r.length?0:n.length<r.length?-1:1}function wn(e,t){if(hn(e)!==hn(t))return!1;for(let n=e.pieceNum_,r=t.pieceNum_;n<=e.pieces_.length;n++,r++)if(e.pieces_[n]!==t.pieces_[r])return!1;return!0}function Cn(e,t){let n=e.pieceNum_,r=t.pieceNum_;if(hn(e)>hn(t))return!1;for(;n<e.pieces_.length;){if(e.pieces_[n]!==t.pieces_[r])return!1;++n,++r}return!0}class En{constructor(e,t){this.errorPrefix_=t,this.parts_=_n(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let e=0;e<this.parts_.length;e++)this.byteLength_+=x(this.parts_[e]);In(this)}}function In(e){if(e.byteLength_>768)throw new Error(e.errorPrefix_+"has a key path longer than 768 bytes ("+e.byteLength_+").");if(e.parts_.length>32)throw new Error(e.errorPrefix_+"path specified exceeds the maximum depth that can be written (32) or object contains a cycle "+Sn(e))}function Sn(e){return 0===e.parts_.length?"":"in property '"+e.parts_.join(".")+"'"}class Tn extends an{constructor(){let e,t;super(["visible"]),"undefined"!=typeof document&&void 0!==document.addEventListener&&(void 0!==document.hidden?(t="visibilitychange",e="hidden"):void 0!==document.mozHidden?(t="mozvisibilitychange",e="mozHidden"):void 0!==document.msHidden?(t="msvisibilitychange",e="msHidden"):void 0!==document.webkitHidden&&(t="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,t&&document.addEventListener(t,(()=>{const t=!document[e];t!==this.visible_&&(this.visible_=t,this.trigger("visible",t))}),!1)}static getInstance(){return new Tn}getInitialEvent(e){return n("visible"===e,"Unknown event type: "+e),[this.visible_]}}const Nn=1e3;class kn extends on{constructor(e,t,n,r,i,s,o,a){if(super(),this.repoInfo_=e,this.applicationId_=t,this.onDataUpdate_=n,this.onConnectStatus_=r,this.onServerInfoUpdate_=i,this.authTokenProvider_=s,this.appCheckTokenProvider_=o,this.authOverride_=a,this.id=kn.nextPersistentConnectionId_++,this.log_=bt("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=Nn,this.maxReconnectDelay_=3e5,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,a&&!y())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");Tn.getInstance().on("visible",this.onVisible_,this),-1===e.host.indexOf("fblocal")&&cn.getInstance().on("online",this.onOnline_,this)}sendRequest(e,t,r){const i=++this.requestNumber_,s={r:i,a:e,b:t};this.log_(E(s)),n(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(s),r&&(this.requestCBHash_[i]=r)}get(e){this.initConnection_();const t=new m,n={action:"g",request:{p:e._path.toString(),q:e._queryObject},onComplete:e=>{const n=e.d;"ok"===e.s?t.resolve(n):t.reject(n)}};this.outstandingGets_.push(n),this.outstandingGetCount_++;const r=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(r),t.promise}listen(e,t,r,i){this.initConnection_();const s=e._queryIdentifier,o=e._path.toString();this.log_("Listen called for "+o+" "+s),this.listens.has(o)||this.listens.set(o,new Map),n(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),n(!this.listens.get(o).has(s),"listen() called twice for same path/queryId.");const a={onComplete:i,hashFn:t,query:e,tag:r};this.listens.get(o).set(s,a),this.connected_&&this.sendListen_(a)}sendGet_(e){const t=this.outstandingGets_[e];this.sendRequest("g",t.request,(n=>{delete this.outstandingGets_[e],this.outstandingGetCount_--,0===this.outstandingGetCount_&&(this.outstandingGets_=[]),t.onComplete&&t.onComplete(n)}))}sendListen_(e){const t=e.query,n=t._path.toString(),r=t._queryIdentifier;this.log_("Listen on "+n+" for "+r);const i={p:n};e.tag&&(i.q=t._queryObject,i.t=e.tag),i.h=e.hashFn(),this.sendRequest("q",i,(i=>{const s=i.d,o=i.s;kn.warnOnListenWarnings_(s,t);(this.listens.get(n)&&this.listens.get(n).get(r))===e&&(this.log_("listen response",i),"ok"!==o&&this.removeListen_(n,r),e.onComplete&&e.onComplete(o,s))}))}static warnOnListenWarnings_(e,t){if(e&&"object"==typeof e&&S(e,"w")){const n=T(e,"w");if(Array.isArray(n)&&~n.indexOf("no_index")){const e='".indexOn": "'+t._queryParams.getIndex().toString()+'"',n=t._path.toString();Et(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${e} at ${n} to your security rules for better performance.`)}}}refreshAuthToken(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},(()=>{})),this.reduceReconnectDelayIfAdminCredential_(e)}reduceReconnectDelayIfAdminCredential_(e){(e&&40===e.length||function(e){const t=I(e).claims;return"object"==typeof t&&!0===t.admin}(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=3e4)}refreshAppCheckToken(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},(()=>{}))}tryAuth(){if(this.connected_&&this.authToken_){const e=this.authToken_,t=function(e){const t=I(e).claims;return!!t&&"object"==typeof t&&t.hasOwnProperty("iat")}(e)?"auth":"gauth",n={cred:e};null===this.authOverride_?n.noauth=!0:"object"==typeof this.authOverride_&&(n.authvar=this.authOverride_),this.sendRequest(t,n,(t=>{const n=t.s,r=t.d||"error";this.authToken_===e&&("ok"===n?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(n,r))}))}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},(e=>{const t=e.s,n=e.d||"error";"ok"===t?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(t,n)}))}unlisten(e,t){const r=e._path.toString(),i=e._queryIdentifier;this.log_("Unlisten called for "+r+" "+i),n(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query");this.removeListen_(r,i)&&this.connected_&&this.sendUnlisten_(r,i,e._queryObject,t)}sendUnlisten_(e,t,n,r){this.log_("Unlisten on "+e+" for "+t);const i={p:e};r&&(i.q=n,i.t=r),this.sendRequest("n",i)}onDisconnectPut(e,t,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,t,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:t,onComplete:n})}onDisconnectMerge(e,t,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,t,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:t,onComplete:n})}onDisconnectCancel(e,t){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,t):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:t})}sendOnDisconnect_(e,t,n,r){const i={p:t,d:n};this.log_("onDisconnect "+e,i),this.sendRequest(e,i,(e=>{r&&setTimeout((()=>{r(e.s,e.d)}),Math.floor(0))}))}put(e,t,n,r){this.putInternal("p",e,t,n,r)}merge(e,t,n,r){this.putInternal("m",e,t,n,r)}putInternal(e,t,n,r,i){this.initConnection_();const s={p:t,d:n};void 0!==i&&(s.h=i),this.outstandingPuts_.push({action:e,request:s,onComplete:r}),this.outstandingPutCount_++;const o=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(o):this.log_("Buffering put: "+t)}sendPut_(e){const t=this.outstandingPuts_[e].action,n=this.outstandingPuts_[e].request,r=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(t,n,(n=>{this.log_(t+" response",n),delete this.outstandingPuts_[e],this.outstandingPutCount_--,0===this.outstandingPutCount_&&(this.outstandingPuts_=[]),r&&r(n.s,n.d)}))}reportStats(e){if(this.connected_){const t={c:e};this.log_("reportStats",t),this.sendRequest("s",t,(e=>{if("ok"!==e.s){const t=e.d;this.log_("reportStats","Error sending stats: "+t)}}))}}onDataMessage_(e){if("r"in e){this.log_("from server: "+E(e));const t=e.r,n=this.requestCBHash_[t];n&&(delete this.requestCBHash_[t],n(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}onDataPush_(e,t){this.log_("handleServerMessage",e,t),"d"===e?this.onDataUpdate_(t.p,t.d,!1,t.t):"m"===e?this.onDataUpdate_(t.p,t.d,!0,t.t):"c"===e?this.onListenRevoked_(t.p,t.q):"ac"===e?this.onAuthRevoked_(t.s,t.d):"apc"===e?this.onAppCheckRevoked_(t.s,t.d):"sd"===e?this.onSecurityDebugPacket_(t):wt("Unrecognized action received from server: "+E(e)+"\nAre you using the latest client?")}onReady_(e,t){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=(new Date).getTime(),this.handleTimestamp_(e),this.lastSessionId=t,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(e){n(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout((()=>{this.establishConnectionTimer_=null,this.establishConnection_()}),Math.floor(e))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=Nn,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}onOnline_(e){e?(this.log_("Browser went online."),this.reconnectDelay_=Nn,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){if(this.visible_){if(this.lastConnectionEstablishedTime_){(new Date).getTime()-this.lastConnectionEstablishedTime_>3e4&&(this.reconnectDelay_=Nn),this.lastConnectionEstablishedTime_=null}}else this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=(new Date).getTime();const e=(new Date).getTime()-this.lastConnectionAttemptTime_;let t=Math.max(0,this.reconnectDelay_-e);t=Math.random()*t,this.log_("Trying to reconnect in "+t+"ms"),this.scheduleConnect_(t),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,1.3*this.reconnectDelay_)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=(new Date).getTime(),this.lastConnectionEstablishedTime_=null;const e=this.onDataMessage_.bind(this),t=this.onReady_.bind(this),r=this.onRealtimeDisconnect_.bind(this),i=this.id+":"+kn.nextConnectionId_++,s=this.lastSessionId;let o=!1,a=null;const c=function(){a?a.close():(o=!0,r())},l=function(e){n(a,"sendRequest call when we're not connected not allowed."),a.sendRequest(e)};this.realtime_={close:c,sendRequest:l};const u=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[n,c]=await Promise.all([this.authTokenProvider_.getToken(u),this.appCheckTokenProvider_.getToken(u)]);o?vt("getToken() completed but was canceled"):(vt("getToken() completed. Creating connection."),this.authToken_=n&&n.accessToken,this.appCheckToken_=c&&c.token,a=new sn(i,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,e,t,r,(e=>{Et(e+" ("+this.repoInfo_.toString()+")"),this.interrupt("server_kill")}),s))}catch(e){this.log_("Failed to get token: "+e),o||(this.repoInfo_.nodeAdmin&&Et(e),c())}}}interrupt(e){vt("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(e){vt("Resuming connection for reason: "+e),delete this.interruptReasons_[e],N(this.interruptReasons_)&&(this.reconnectDelay_=Nn,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(e){const t=e-(new Date).getTime();this.onServerInfoUpdate_({serverTimeOffset:t})}cancelSentTransactions_(){for(let e=0;e<this.outstandingPuts_.length;e++){const t=this.outstandingPuts_[e];t&&"h"in t.request&&t.queued&&(t.onComplete&&t.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])}onListenRevoked_(e,t){let n;n=t?t.map((e=>Pt(e))).join("$"):"default";const r=this.removeListen_(e,n);r&&r.onComplete&&r.onComplete("permission_denied")}removeListen_(e,t){const n=new ln(e).toString();let r;if(this.listens.has(n)){const e=this.listens.get(n);r=e.get(t),e.delete(t),0===e.size&&this.listens.delete(n)}else r=void 0;return r}onAuthRevoked_(e,t){vt("Auth token revoked: "+e+"/"+t),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),"invalid_token"!==e&&"permission_denied"!==e||(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=3&&(this.reconnectDelay_=3e4,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(e,t){vt("App check token revoked: "+e+"/"+t),this.appCheckToken_=null,this.forceTokenRefresh_=!0,"invalid_token"!==e&&"permission_denied"!==e||(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=3&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace("\n","\nFIREBASE: "))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const e of this.listens.values())for(const t of e.values())this.sendListen_(t);for(let e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);for(;this.onDisconnectRequestQueue_.length;){const e=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(e.action,e.pathString,e.data,e.onComplete)}for(let e=0;e<this.outstandingGets_.length;e++)this.outstandingGets_[e]&&this.sendGet_(e)}sendConnectStats_(){const e={};e["sdk.js."+at.replace(/\./g,"-")]=1,g()?e["framework.cordova"]=1:"object"==typeof navigator&&"ReactNative"===navigator.product&&(e["framework.reactnative"]=1),this.reportStats(e)}shouldReconnect_(){const e=cn.getInstance().currentlyOnline();return N(this.interruptReasons_)&&e}}kn.nextPersistentConnectionId_=0,kn.nextConnectionId_=0;class Dn{constructor(e,t){this.name=e,this.node=t}static Wrap(e,t){return new Dn(e,t)}}class Pn{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,t){const n=new Dn(St,e),r=new Dn(St,t);return 0!==this.compare(n,r)}minPost(){return Dn.MIN}}let Rn;class On extends Pn{static get __EMPTY_NODE(){return Rn}static set __EMPTY_NODE(e){Rn=e}compare(e,t){return Nt(e.name,t.name)}isDefinedOn(e){throw r("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,t){return!1}minPost(){return Dn.MIN}maxPost(){return new Dn(Tt,Rn)}makePost(e,t){return n("string"==typeof e,"KeyIndex indexValue must always be a string."),new Dn(e,Rn)}toString(){return".key"}}const xn=new On;class An{constructor(e,t,n,r,i=null){this.isReverse_=r,this.resultGenerator_=i,this.nodeStack_=[];let s=1;for(;!e.isEmpty();)if(s=t?n(e.key,t):1,r&&(s*=-1),s<0)e=this.isReverse_?e.left:e.right;else{if(0===s){this.nodeStack_.push(e);break}this.nodeStack_.push(e),e=this.isReverse_?e.right:e.left}}getNext(){if(0===this.nodeStack_.length)return null;let e,t=this.nodeStack_.pop();if(e=this.resultGenerator_?this.resultGenerator_(t.key,t.value):{key:t.key,value:t.value},this.isReverse_)for(t=t.left;!t.isEmpty();)this.nodeStack_.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack_.push(t),t=t.left;return e}hasNext(){return this.nodeStack_.length>0}peek(){if(0===this.nodeStack_.length)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}class Mn{constructor(e,t,n,r,i){this.key=e,this.value=t,this.color=null!=n?n:Mn.RED,this.left=null!=r?r:qn.EMPTY_NODE,this.right=null!=i?i:qn.EMPTY_NODE}copy(e,t,n,r,i){return new Mn(null!=e?e:this.key,null!=t?t:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let r=this;const i=n(e,r.key);return r=i<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===i?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n)),r.fixUp_()}removeMin_(){if(this.left.isEmpty())return qn.EMPTY_NODE;let e=this;return e.left.isRed_()||e.left.left.isRed_()||(e=e.moveRedLeft_()),e=e.copy(null,null,null,e.left.removeMin_(),null),e.fixUp_()}remove(e,t){let n,r;if(n=this,t(e,n.key)<0)n.left.isEmpty()||n.left.isRed_()||n.left.left.isRed_()||(n=n.moveRedLeft_()),n=n.copy(null,null,null,n.left.remove(e,t),null);else{if(n.left.isRed_()&&(n=n.rotateRight_()),n.right.isEmpty()||n.right.isRed_()||n.right.left.isRed_()||(n=n.moveRedRight_()),0===t(e,n.key)){if(n.right.isEmpty())return qn.EMPTY_NODE;r=n.right.min_(),n=n.copy(r.key,r.value,null,null,n.right.removeMin_())}n=n.copy(null,null,null,null,n.right.remove(e,t))}return n.fixUp_()}isRed_(){return this.color}fixUp_(){let e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}moveRedLeft_(){let e=this.colorFlip_();return e.right.left.isRed_()&&(e=e.copy(null,null,null,null,e.right.rotateRight_()),e=e.rotateLeft_(),e=e.colorFlip_()),e}moveRedRight_(){let e=this.colorFlip_();return e.left.left.isRed_()&&(e=e.rotateRight_(),e=e.colorFlip_()),e}rotateLeft_(){const e=this.copy(null,null,Mn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight_(){const e=this.copy(null,null,Mn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip_(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth_(){const e=this.check_();return Math.pow(2,e)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}}Mn.RED=!0,Mn.BLACK=!1;class qn{constructor(e,t=qn.EMPTY_NODE){this.comparator_=e,this.root_=t}insert(e,t){return new qn(this.comparator_,this.root_.insert(e,t,this.comparator_).copy(null,null,Mn.BLACK,null,null))}remove(e){return new qn(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,Mn.BLACK,null,null))}get(e){let t,n=this.root_;for(;!n.isEmpty();){if(t=this.comparator_(e,n.key),0===t)return n.value;t<0?n=n.left:t>0&&(n=n.right)}return null}getPredecessorKey(e){let t,n=this.root_,r=null;for(;!n.isEmpty();){if(t=this.comparator_(e,n.key),0===t){if(n.left.isEmpty())return r?r.key:null;for(n=n.left;!n.right.isEmpty();)n=n.right;return n.key}t<0?n=n.left:t>0&&(r=n,n=n.right)}throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new An(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,t){return new An(this.root_,e,this.comparator_,!1,t)}getReverseIteratorFrom(e,t){return new An(this.root_,e,this.comparator_,!0,t)}getReverseIterator(e){return new An(this.root_,null,this.comparator_,!0,e)}}function jn(e,t){return Nt(e.name,t.name)}function Fn(e,t){return Nt(e,t)}let Ln;qn.EMPTY_NODE=new class{copy(e,t,n,r,i){return this}insert(e,t,n){return new Mn(e,t,null)}remove(e,t){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}};const $n=function(e){return"number"==typeof e?"number:"+xt(e):"string:"+e},Vn=function(e){if(e.isLeafNode()){const t=e.val();n("string"==typeof t||"number"==typeof t||"object"==typeof t&&S(t,".sv"),"Priority must be a string or number.")}else n(e===Ln||e.isEmpty(),"priority of unexpected type.");n(e===Ln||e.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};let Un,zn,Wn;class Bn{constructor(e,t=Bn.__childrenNodeConstructor.EMPTY_NODE){this.value_=e,this.priorityNode_=t,this.lazyHash_=null,n(void 0!==this.value_&&null!==this.value_,"LeafNode shouldn't be created with null/undefined value."),Vn(this.priorityNode_)}static set __childrenNodeConstructor(e){Un=e}static get __childrenNodeConstructor(){return Un}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(e){return new Bn(this.value_,e)}getImmediateChild(e){return".priority"===e?this.priorityNode_:Bn.__childrenNodeConstructor.EMPTY_NODE}getChild(e){return yn(e)?this:".priority"===dn(e)?this.priorityNode_:Bn.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(e,t){return null}updateImmediateChild(e,t){return".priority"===e?this.updatePriority(t):t.isEmpty()&&".priority"!==e?this:Bn.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,t).updatePriority(this.priorityNode_)}updateChild(e,t){const r=dn(e);return null===r?t:t.isEmpty()&&".priority"!==r?this:(n(".priority"!==r||1===hn(e),".priority must be the last token in a path"),this.updateImmediateChild(r,Bn.__childrenNodeConstructor.EMPTY_NODE.updateChild(pn(e),t)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(e,t){return!1}val(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(null===this.lazyHash_){let e="";this.priorityNode_.isEmpty()||(e+="priority:"+$n(this.priorityNode_.val())+":");const t=typeof this.value_;e+=t+":",e+="number"===t?xt(this.value_):this.value_,this.lazyHash_=_t(e)}return this.lazyHash_}getValue(){return this.value_}compareTo(e){return e===Bn.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof Bn.__childrenNodeConstructor?-1:(n(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))}compareToLeafNode_(e){const t=typeof e.value_,r=typeof this.value_,i=Bn.VALUE_TYPE_ORDER.indexOf(t),s=Bn.VALUE_TYPE_ORDER.indexOf(r);return n(i>=0,"Unknown leaf type: "+t),n(s>=0,"Unknown leaf type: "+r),i===s?"object"===r?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:s-i}withIndex(){return this}isIndexed(){return!0}equals(e){if(e===this)return!0;if(e.isLeafNode()){const t=e;return this.value_===t.value_&&this.priorityNode_.equals(t.priorityNode_)}return!1}}Bn.VALUE_TYPE_ORDER=["object","boolean","number","string"];const Hn=new class extends Pn{compare(e,t){const n=e.node.getPriority(),r=t.node.getPriority(),i=n.compareTo(r);return 0===i?Nt(e.name,t.name):i}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,t){return!e.getPriority().equals(t.getPriority())}minPost(){return Dn.MIN}maxPost(){return new Dn(Tt,new Bn("[PRIORITY-POST]",Wn))}makePost(e,t){const n=zn(e);return new Dn(t,new Bn("[PRIORITY-POST]",n))}toString(){return".priority"}},Qn=Math.log(2);class Kn{constructor(e){var t;this.count=(t=e+1,parseInt(Math.log(t)/Qn,10)),this.current_=this.count-1;const n=(r=this.count,parseInt(Array(r+1).join("1"),2));var r;this.bits_=e+1&n}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const Yn=function(e,t,n,r){e.sort(t);const i=function(t,r){const s=r-t;let o,a;if(0===s)return null;if(1===s)return o=e[t],a=n?n(o):o,new Mn(a,o.node,Mn.BLACK,null,null);{const c=parseInt(s/2,10)+t,l=i(t,c),u=i(c+1,r);return o=e[c],a=n?n(o):o,new Mn(a,o.node,Mn.BLACK,l,u)}},s=function(t){let r=null,s=null,o=e.length;const a=function(t,r){const s=o-t,a=o;o-=t;const l=i(s+1,a),u=e[s],d=n?n(u):u;c(new Mn(d,u.node,r,null,l))},c=function(e){r?(r.left=e,r=e):(s=e,r=e)};for(let e=0;e<t.count;++e){const n=t.nextBitIsOne(),r=Math.pow(2,t.count-(e+1));n?a(r,Mn.BLACK):(a(r,Mn.BLACK),a(r,Mn.RED))}return s}(new Kn(e.length));return new qn(r||t,s)};let Gn;const Jn={};class Xn{constructor(e,t){this.indexes_=e,this.indexSet_=t}static get Default(){return n(Jn&&Hn,"ChildrenNode.ts has not been loaded"),Gn=Gn||new Xn({".priority":Jn},{".priority":Hn}),Gn}get(e){const t=T(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof qn?t:null}hasIndex(e){return S(this.indexSet_,e.toString())}addIndex(e,t){n(e!==xn,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const r=[];let i=!1;const s=t.getIterator(Dn.Wrap);let o,a=s.getNext();for(;a;)i=i||e.isDefinedOn(a.node),r.push(a),a=s.getNext();o=i?Yn(r,e.getCompare()):Jn;const c=e.toString(),l=Object.assign({},this.indexSet_);l[c]=e;const u=Object.assign({},this.indexes_);return u[c]=o,new Xn(u,l)}addToIndexes(e,t){const r=k(this.indexes_,((r,i)=>{const s=T(this.indexSet_,i);if(n(s,"Missing index implementation for "+i),r===Jn){if(s.isDefinedOn(e.node)){const n=[],r=t.getIterator(Dn.Wrap);let i=r.getNext();for(;i;)i.name!==e.name&&n.push(i),i=r.getNext();return n.push(e),Yn(n,s.getCompare())}return Jn}{const n=t.get(e.name);let i=r;return n&&(i=i.remove(new Dn(e.name,n))),i.insert(e,e.node)}}));return new Xn(r,this.indexSet_)}removeFromIndexes(e,t){const n=k(this.indexes_,(n=>{if(n===Jn)return n;{const r=t.get(e.name);return r?n.remove(new Dn(e.name,r)):n}}));return new Xn(n,this.indexSet_)}}let Zn;class er{constructor(e,t,r){this.children_=e,this.priorityNode_=t,this.indexMap_=r,this.lazyHash_=null,this.priorityNode_&&Vn(this.priorityNode_),this.children_.isEmpty()&&n(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return Zn||(Zn=new er(new qn(Fn),null,Xn.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||Zn}updatePriority(e){return this.children_.isEmpty()?this:new er(this.children_,e,this.indexMap_)}getImmediateChild(e){if(".priority"===e)return this.getPriority();{const t=this.children_.get(e);return null===t?Zn:t}}getChild(e){const t=dn(e);return null===t?this:this.getImmediateChild(t).getChild(pn(e))}hasChild(e){return null!==this.children_.get(e)}updateImmediateChild(e,t){if(n(t,"We should always be passing snapshot nodes"),".priority"===e)return this.updatePriority(t);{const n=new Dn(e,t);let r,i;t.isEmpty()?(r=this.children_.remove(e),i=this.indexMap_.removeFromIndexes(n,this.children_)):(r=this.children_.insert(e,t),i=this.indexMap_.addToIndexes(n,this.children_));const s=r.isEmpty()?Zn:this.priorityNode_;return new er(r,s,i)}}updateChild(e,t){const r=dn(e);if(null===r)return t;{n(".priority"!==dn(e)||1===hn(e),".priority must be the last token in a path");const i=this.getImmediateChild(r).updateChild(pn(e),t);return this.updateImmediateChild(r,i)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(e){if(this.isEmpty())return null;const t={};let n=0,r=0,i=!0;if(this.forEachChild(Hn,((s,o)=>{t[s]=o.val(e),n++,i&&er.INTEGER_REGEXP_.test(s)?r=Math.max(r,Number(s)):i=!1})),!e&&i&&r<2*n){const e=[];for(const n in t)e[n]=t[n];return e}return e&&!this.getPriority().isEmpty()&&(t[".priority"]=this.getPriority().val()),t}hash(){if(null===this.lazyHash_){let e="";this.getPriority().isEmpty()||(e+="priority:"+$n(this.getPriority().val())+":"),this.forEachChild(Hn,((t,n)=>{const r=n.hash();""!==r&&(e+=":"+t+":"+r)})),this.lazyHash_=""===e?"":_t(e)}return this.lazyHash_}getPredecessorChildName(e,t,n){const r=this.resolveIndex_(n);if(r){const n=r.getPredecessorKey(new Dn(e,t));return n?n.name:null}return this.children_.getPredecessorKey(e)}getFirstChildName(e){const t=this.resolveIndex_(e);if(t){const e=t.minKey();return e&&e.name}return this.children_.minKey()}getFirstChild(e){const t=this.getFirstChildName(e);return t?new Dn(t,this.children_.get(t)):null}getLastChildName(e){const t=this.resolveIndex_(e);if(t){const e=t.maxKey();return e&&e.name}return this.children_.maxKey()}getLastChild(e){const t=this.getLastChildName(e);return t?new Dn(t,this.children_.get(t)):null}forEachChild(e,t){const n=this.resolveIndex_(e);return n?n.inorderTraversal((e=>t(e.name,e.node))):this.children_.inorderTraversal(t)}getIterator(e){return this.getIteratorFrom(e.minPost(),e)}getIteratorFrom(e,t){const n=this.resolveIndex_(t);if(n)return n.getIteratorFrom(e,(e=>e));{const n=this.children_.getIteratorFrom(e.name,Dn.Wrap);let r=n.peek();for(;null!=r&&t.compare(r,e)<0;)n.getNext(),r=n.peek();return n}}getReverseIterator(e){return this.getReverseIteratorFrom(e.maxPost(),e)}getReverseIteratorFrom(e,t){const n=this.resolveIndex_(t);if(n)return n.getReverseIteratorFrom(e,(e=>e));{const n=this.children_.getReverseIteratorFrom(e.name,Dn.Wrap);let r=n.peek();for(;null!=r&&t.compare(r,e)>0;)n.getNext(),r=n.peek();return n}}compareTo(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===tr?-1:0}withIndex(e){if(e===xn||this.indexMap_.hasIndex(e))return this;{const t=this.indexMap_.addIndex(e,this.children_);return new er(this.children_,this.priorityNode_,t)}}isIndexed(e){return e===xn||this.indexMap_.hasIndex(e)}equals(e){if(e===this)return!0;if(e.isLeafNode())return!1;{const t=e;if(this.getPriority().equals(t.getPriority())){if(this.children_.count()===t.children_.count()){const e=this.getIterator(Hn),n=t.getIterator(Hn);let r=e.getNext(),i=n.getNext();for(;r&&i;){if(r.name!==i.name||!r.node.equals(i.node))return!1;r=e.getNext(),i=n.getNext()}return null===r&&null===i}return!1}return!1}}resolveIndex_(e){return e===xn?null:this.indexMap_.get(e.toString())}}er.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;const tr=new class extends er{constructor(){super(new qn(Fn),er.EMPTY_NODE,Xn.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return er.EMPTY_NODE}isEmpty(){return!1}};Object.defineProperties(Dn,{MIN:{value:new Dn(St,er.EMPTY_NODE)},MAX:{value:new Dn(Tt,tr)}}),On.__EMPTY_NODE=er.EMPTY_NODE,Bn.__childrenNodeConstructor=er,Ln=tr,function(e){Wn=e}(tr);function nr(e,t=null){if(null===e)return er.EMPTY_NODE;if("object"==typeof e&&".priority"in e&&(t=e[".priority"]),n(null===t||"string"==typeof t||"number"==typeof t||"object"==typeof t&&".sv"in t,"Invalid priority type found: "+typeof t),"object"==typeof e&&".value"in e&&null!==e[".value"]&&(e=e[".value"]),"object"!=typeof e||".sv"in e){return new Bn(e,nr(t))}if(e instanceof Array){let n=er.EMPTY_NODE;return Ot(e,((t,r)=>{if(S(e,t)&&"."!==t.substring(0,1)){const e=nr(r);!e.isLeafNode()&&e.isEmpty()||(n=n.updateImmediateChild(t,e))}})),n.updatePriority(nr(t))}{const n=[];let r=!1;if(Ot(e,((e,t)=>{if("."!==e.substring(0,1)){const i=nr(t);i.isEmpty()||(r=r||!i.getPriority().isEmpty(),n.push(new Dn(e,i)))}})),0===n.length)return er.EMPTY_NODE;const i=Yn(n,jn,(e=>e.name),Fn);if(r){const e=Yn(n,Hn.getCompare());return new er(i,nr(t),new Xn({".priority":e},{".priority":Hn}))}return new er(i,nr(t),Xn.Default)}}!function(e){zn=e}(nr);class rr extends Pn{constructor(e){super(),this.indexPath_=e,n(!yn(e)&&".priority"!==dn(e),"Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,t){const n=this.extractChild(e.node),r=this.extractChild(t.node),i=n.compareTo(r);return 0===i?Nt(e.name,t.name):i}makePost(e,t){const n=nr(e),r=er.EMPTY_NODE.updateChild(this.indexPath_,n);return new Dn(t,r)}maxPost(){const e=er.EMPTY_NODE.updateChild(this.indexPath_,tr);return new Dn(Tt,e)}toString(){return _n(this.indexPath_,0).join("/")}}const ir=new class extends Pn{compare(e,t){const n=e.node.compareTo(t.node);return 0===n?Nt(e.name,t.name):n}isDefinedOn(e){return!0}indexedValueChanged(e,t){return!e.equals(t)}minPost(){return Dn.MIN}maxPost(){return Dn.MAX}makePost(e,t){const n=nr(e);return new Dn(t,n)}toString(){return".value"}};function sr(e){return{type:"value",snapshotNode:e}}function or(e,t){return{type:"child_added",snapshotNode:t,childName:e}}function ar(e,t){return{type:"child_removed",snapshotNode:t,childName:e}}function cr(e,t,n){return{type:"child_changed",snapshotNode:t,childName:e,oldSnap:n}}class lr{constructor(e){this.index_=e}updateChild(e,t,r,i,s,o){n(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");const a=e.getImmediateChild(t);return a.getChild(i).equals(r.getChild(i))&&a.isEmpty()===r.isEmpty()?e:(null!=o&&(r.isEmpty()?e.hasChild(t)?o.trackChildChange(ar(t,a)):n(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):a.isEmpty()?o.trackChildChange(or(t,r)):o.trackChildChange(cr(t,r,a))),e.isLeafNode()&&r.isEmpty()?e:e.updateImmediateChild(t,r).withIndex(this.index_))}updateFullNode(e,t,n){return null!=n&&(e.isLeafNode()||e.forEachChild(Hn,((e,r)=>{t.hasChild(e)||n.trackChildChange(ar(e,r))})),t.isLeafNode()||t.forEachChild(Hn,((t,r)=>{if(e.hasChild(t)){const i=e.getImmediateChild(t);i.equals(r)||n.trackChildChange(cr(t,r,i))}else n.trackChildChange(or(t,r))}))),t.withIndex(this.index_)}updatePriority(e,t){return e.isEmpty()?er.EMPTY_NODE:e.updatePriority(t)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}class ur{constructor(e){this.indexedFilter_=new lr(e.getIndex()),this.index_=e.getIndex(),this.startPost_=ur.getStartPost_(e),this.endPost_=ur.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){const t=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,n=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return t&&n}updateChild(e,t,n,r,i,s){return this.matches(new Dn(t,n))||(n=er.EMPTY_NODE),this.indexedFilter_.updateChild(e,t,n,r,i,s)}updateFullNode(e,t,n){t.isLeafNode()&&(t=er.EMPTY_NODE);let r=t.withIndex(this.index_);r=r.updatePriority(er.EMPTY_NODE);const i=this;return t.forEachChild(Hn,((e,t)=>{i.matches(new Dn(e,t))||(r=r.updateImmediateChild(e,er.EMPTY_NODE))})),this.indexedFilter_.updateFullNode(e,r,n)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){const t=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),t)}return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){const t=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),t)}return e.getIndex().maxPost()}}class dr{constructor(e){this.withinDirectionalStart=e=>this.reverse_?this.withinEndPost(e):this.withinStartPost(e),this.withinDirectionalEnd=e=>this.reverse_?this.withinStartPost(e):this.withinEndPost(e),this.withinStartPost=e=>{const t=this.index_.compare(this.rangedFilter_.getStartPost(),e);return this.startIsInclusive_?t<=0:t<0},this.withinEndPost=e=>{const t=this.index_.compare(e,this.rangedFilter_.getEndPost());return this.endIsInclusive_?t<=0:t<0},this.rangedFilter_=new ur(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,t,n,r,i,s){return this.rangedFilter_.matches(new Dn(t,n))||(n=er.EMPTY_NODE),e.getImmediateChild(t).equals(n)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,t,n,r,i,s):this.fullLimitUpdateChild_(e,t,n,i,s)}updateFullNode(e,t,n){let r;if(t.isLeafNode()||t.isEmpty())r=er.EMPTY_NODE.withIndex(this.index_);else if(2*this.limit_<t.numChildren()&&t.isIndexed(this.index_)){let e;r=er.EMPTY_NODE.withIndex(this.index_),e=this.reverse_?t.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):t.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let n=0;for(;e.hasNext()&&n<this.limit_;){const t=e.getNext();if(this.withinDirectionalStart(t)){if(!this.withinDirectionalEnd(t))break;r=r.updateImmediateChild(t.name,t.node),n++}}}else{let e;r=t.withIndex(this.index_),r=r.updatePriority(er.EMPTY_NODE),e=this.reverse_?r.getReverseIterator(this.index_):r.getIterator(this.index_);let n=0;for(;e.hasNext();){const t=e.getNext();n<this.limit_&&this.withinDirectionalStart(t)&&this.withinDirectionalEnd(t)?n++:r=r.updateImmediateChild(t.name,er.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,r,n)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,t,r,i,s){let o;if(this.reverse_){const e=this.index_.getCompare();o=(t,n)=>e(n,t)}else o=this.index_.getCompare();const a=e;n(a.numChildren()===this.limit_,"");const c=new Dn(t,r),l=this.reverse_?a.getFirstChild(this.index_):a.getLastChild(this.index_),u=this.rangedFilter_.matches(c);if(a.hasChild(t)){const e=a.getImmediateChild(t);let n=i.getChildAfterChild(this.index_,l,this.reverse_);for(;null!=n&&(n.name===t||a.hasChild(n.name));)n=i.getChildAfterChild(this.index_,n,this.reverse_);const d=null==n?1:o(n,c);if(u&&!r.isEmpty()&&d>=0)return null!=s&&s.trackChildChange(cr(t,r,e)),a.updateImmediateChild(t,r);{null!=s&&s.trackChildChange(ar(t,e));const r=a.updateImmediateChild(t,er.EMPTY_NODE);return null!=n&&this.rangedFilter_.matches(n)?(null!=s&&s.trackChildChange(or(n.name,n.node)),r.updateImmediateChild(n.name,n.node)):r}}return r.isEmpty()?e:u&&o(l,c)>=0?(null!=s&&(s.trackChildChange(ar(l.name,l.node)),s.trackChildChange(or(t,r))),a.updateImmediateChild(t,r).updateImmediateChild(l.name,er.EMPTY_NODE)):e}}class hr{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=Hn}hasStart(){return this.startSet_}isViewFromLeft(){return""===this.viewFrom_?this.startSet_:"l"===this.viewFrom_}getIndexStartValue(){return n(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return n(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:St}hasEnd(){return this.endSet_}getIndexEndValue(){return n(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return n(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:Tt}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&""!==this.viewFrom_}getLimit(){return n(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===Hn}copy(){const e=new hr;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function pr(e){const t={};if(e.isDefault())return t;let r;if(e.index_===Hn?r="$priority":e.index_===ir?r="$value":e.index_===xn?r="$key":(n(e.index_ instanceof rr,"Unrecognized index type!"),r=e.index_.toString()),t.orderBy=E(r),e.startSet_){const n=e.startAfterSet_?"startAfter":"startAt";t[n]=E(e.indexStartValue_),e.startNameSet_&&(t[n]+=","+E(e.indexStartName_))}if(e.endSet_){const n=e.endBeforeSet_?"endBefore":"endAt";t[n]=E(e.indexEndValue_),e.endNameSet_&&(t[n]+=","+E(e.indexEndName_))}return e.limitSet_&&(e.isViewFromLeft()?t.limitToFirst=e.limit_:t.limitToLast=e.limit_),t}function fr(e){const t={};if(e.startSet_&&(t.sp=e.indexStartValue_,e.startNameSet_&&(t.sn=e.indexStartName_),t.sin=!e.startAfterSet_),e.endSet_&&(t.ep=e.indexEndValue_,e.endNameSet_&&(t.en=e.indexEndName_),t.ein=!e.endBeforeSet_),e.limitSet_){t.l=e.limit_;let n=e.viewFrom_;""===n&&(n=e.isViewFromLeft()?"l":"r"),t.vf=n}return e.index_!==Hn&&(t.i=e.index_.toString()),t}class _r extends on{constructor(e,t,n,r){super(),this.repoInfo_=e,this.onDataUpdate_=t,this.authTokenProvider_=n,this.appCheckTokenProvider_=r,this.log_=bt("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,t){return void 0!==t?"tag$"+t:(n(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,t,n,r){const i=e._path.toString();this.log_("Listen called for "+i+" "+e._queryIdentifier);const s=_r.getListenId_(e,n),o={};this.listens_[s]=o;const a=pr(e._queryParams);this.restRequest_(i+".json",a,((e,t)=>{let a=t;if(404===e&&(a=null,e=null),null===e&&this.onDataUpdate_(i,a,!1,n),T(this.listens_,s)===o){let t;t=e?401===e?"permission_denied":"rest_error:"+e:"ok",r(t,null)}}))}unlisten(e,t){const n=_r.getListenId_(e,t);delete this.listens_[n]}get(e){const t=pr(e._queryParams),n=e._path.toString(),r=new m;return this.restRequest_(n+".json",t,((e,t)=>{let i=t;404===e&&(i=null,e=null),null===e?(this.onDataUpdate_(n,i,!1,null),r.resolve(i)):r.reject(new Error(i))})),r.promise}refreshAuthToken(e){}restRequest_(e,t={},n){return t.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then((([r,i])=>{r&&r.accessToken&&(t.auth=r.accessToken),i&&i.token&&(t.ac=i.token);const s=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+function(e){const t=[];for(const[n,r]of Object.entries(e))Array.isArray(r)?r.forEach((e=>{t.push(encodeURIComponent(n)+"="+encodeURIComponent(e))})):t.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return t.length?"&"+t.join("&"):""}(t);this.log_("Sending REST request for "+s);const o=new XMLHttpRequest;o.onreadystatechange=()=>{if(n&&4===o.readyState){this.log_("REST Response for "+s+" received. status:",o.status,"response:",o.responseText);let e=null;if(o.status>=200&&o.status<300){try{e=C(o.responseText)}catch(e){Et("Failed to parse JSON response for "+s+": "+o.responseText)}n(null,e)}else 401!==o.status&&404!==o.status&&Et("Got unsuccessful REST response for "+s+" Status: "+o.status),n(o.status);n=null}},o.open("GET",s,!0),o.send()}))}}class mr{constructor(){this.rootNode_=er.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)}}function gr(){return{value:null,children:new Map}}function yr(e,t,n){if(yn(t))e.value=n,e.children.clear();else if(null!==e.value)e.value=e.value.updateChild(t,n);else{const r=dn(t);e.children.has(r)||e.children.set(r,gr());yr(e.children.get(r),t=pn(t),n)}}function vr(e,t,n){null!==e.value?n(t,e.value):function(e,t){e.children.forEach(((e,n)=>{t(n,e)}))}(e,((e,r)=>{vr(r,new ln(t.toString()+"/"+e),n)}))}class br{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),t=Object.assign({},e);return this.last_&&Ot(this.last_,((e,n)=>{t[e]=t[e]-n})),this.last_=e,t}}class wr{constructor(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new br(e);const n=1e4+2e4*Math.random();jt(this.reportStats_.bind(this),Math.floor(n))}reportStats_(){const e=this.statsListener_.get(),t={};let n=!1;Ot(e,((e,r)=>{r>0&&S(this.statsToReport_,e)&&(t[e]=r,n=!0)})),n&&this.server_.reportStats(t),jt(this.reportStats_.bind(this),Math.floor(2*Math.random()*3e5))}}var Cr;function Er(e){return{fromUser:!1,fromServer:!0,queryId:e,tagged:!0}}!function(e){e[e.OVERWRITE=0]="OVERWRITE",e[e.MERGE=1]="MERGE",e[e.ACK_USER_WRITE=2]="ACK_USER_WRITE",e[e.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"}(Cr||(Cr={}));class Ir{constructor(e,t,n){this.path=e,this.affectedTree=t,this.revert=n,this.type=Cr.ACK_USER_WRITE,this.source={fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}operationForChild(e){if(yn(this.path)){if(null!=this.affectedTree.value)return n(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const t=this.affectedTree.subtree(new ln(e));return new Ir(un(),t,this.revert)}}return n(dn(this.path)===e,"operationForChild called for unrelated child."),new Ir(pn(this.path),this.affectedTree,this.revert)}}class Sr{constructor(e,t){this.source=e,this.path=t,this.type=Cr.LISTEN_COMPLETE}operationForChild(e){return yn(this.path)?new Sr(this.source,un()):new Sr(this.source,pn(this.path))}}class Tr{constructor(e,t,n){this.source=e,this.path=t,this.snap=n,this.type=Cr.OVERWRITE}operationForChild(e){return yn(this.path)?new Tr(this.source,un(),this.snap.getImmediateChild(e)):new Tr(this.source,pn(this.path),this.snap)}}class Nr{constructor(e,t,n){this.source=e,this.path=t,this.children=n,this.type=Cr.MERGE}operationForChild(e){if(yn(this.path)){const t=this.children.subtree(new ln(e));return t.isEmpty()?null:t.value?new Tr(this.source,un(),t.value):new Nr(this.source,un(),t)}return n(dn(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new Nr(this.source,pn(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}class kr{constructor(e,t,n){this.node_=e,this.fullyInitialized_=t,this.filtered_=n}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(yn(e))return this.isFullyInitialized()&&!this.filtered_;const t=dn(e);return this.isCompleteForChild(t)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}class Dr{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}}function Pr(e,t,n,i,s,o){const a=i.filter((e=>e.type===n));a.sort(((t,n)=>function(e,t,n){if(null==t.childName||null==n.childName)throw r("Should only compare child_ events.");const i=new Dn(t.childName,t.snapshotNode),s=new Dn(n.childName,n.snapshotNode);return e.index_.compare(i,s)}(e,t,n))),a.forEach((n=>{const r=function(e,t,n){return"value"===t.type||"child_removed"===t.type||(t.prevName=n.getPredecessorChildName(t.childName,t.snapshotNode,e.index_)),t}(e,n,o);s.forEach((i=>{i.respondsTo(n.type)&&t.push(i.createEvent(r,e.query_))}))}))}function Rr(e,t){return{eventCache:e,serverCache:t}}function Or(e,t,n,r){return Rr(new kr(t,n,r),e.serverCache)}function xr(e,t,n,r){return Rr(e.eventCache,new kr(t,n,r))}function Ar(e){return e.eventCache.isFullyInitialized()?e.eventCache.getNode():null}function Mr(e){return e.serverCache.isFullyInitialized()?e.serverCache.getNode():null}let qr;class jr{constructor(e,t=(()=>(qr||(qr=new qn(kt)),qr))()){this.value=e,this.children=t}static fromObject(e){let t=new jr(null);return Ot(e,((e,n)=>{t=t.set(new ln(e),n)})),t}isEmpty(){return null===this.value&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,t){if(null!=this.value&&t(this.value))return{path:un(),value:this.value};if(yn(e))return null;{const n=dn(e),r=this.children.get(n);if(null!==r){const i=r.findRootMostMatchingPathAndValue(pn(e),t);if(null!=i){return{path:gn(new ln(n),i.path),value:i.value}}return null}return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,(()=>!0))}subtree(e){if(yn(e))return this;{const t=dn(e),n=this.children.get(t);return null!==n?n.subtree(pn(e)):new jr(null)}}set(e,t){if(yn(e))return new jr(t,this.children);{const n=dn(e),r=(this.children.get(n)||new jr(null)).set(pn(e),t),i=this.children.insert(n,r);return new jr(this.value,i)}}remove(e){if(yn(e))return this.children.isEmpty()?new jr(null):new jr(null,this.children);{const t=dn(e),n=this.children.get(t);if(n){const r=n.remove(pn(e));let i;return i=r.isEmpty()?this.children.remove(t):this.children.insert(t,r),null===this.value&&i.isEmpty()?new jr(null):new jr(this.value,i)}return this}}get(e){if(yn(e))return this.value;{const t=dn(e),n=this.children.get(t);return n?n.get(pn(e)):null}}setTree(e,t){if(yn(e))return t;{const n=dn(e),r=(this.children.get(n)||new jr(null)).setTree(pn(e),t);let i;return i=r.isEmpty()?this.children.remove(n):this.children.insert(n,r),new jr(this.value,i)}}fold(e){return this.fold_(un(),e)}fold_(e,t){const n={};return this.children.inorderTraversal(((r,i)=>{n[r]=i.fold_(gn(e,r),t)})),t(e,this.value,n)}findOnPath(e,t){return this.findOnPath_(e,un(),t)}findOnPath_(e,t,n){const r=!!this.value&&n(t,this.value);if(r)return r;if(yn(e))return null;{const r=dn(e),i=this.children.get(r);return i?i.findOnPath_(pn(e),gn(t,r),n):null}}foreachOnPath(e,t){return this.foreachOnPath_(e,un(),t)}foreachOnPath_(e,t,n){if(yn(e))return this;{this.value&&n(t,this.value);const r=dn(e),i=this.children.get(r);return i?i.foreachOnPath_(pn(e),gn(t,r),n):new jr(null)}}foreach(e){this.foreach_(un(),e)}foreach_(e,t){this.children.inorderTraversal(((n,r)=>{r.foreach_(gn(e,n),t)})),this.value&&t(e,this.value)}foreachChild(e){this.children.inorderTraversal(((t,n)=>{n.value&&e(t,n.value)}))}}class Fr{constructor(e){this.writeTree_=e}static empty(){return new Fr(new jr(null))}}function Lr(e,t,n){if(yn(t))return new Fr(new jr(n));{const r=e.writeTree_.findRootMostValueAndPath(t);if(null!=r){const i=r.path;let s=r.value;const o=vn(i,t);return s=s.updateChild(o,n),new Fr(e.writeTree_.set(i,s))}{const r=new jr(n),i=e.writeTree_.setTree(t,r);return new Fr(i)}}}function $r(e,t,n){let r=e;return Ot(n,((e,n)=>{r=Lr(r,gn(t,e),n)})),r}function Vr(e,t){if(yn(t))return Fr.empty();{const n=e.writeTree_.setTree(t,new jr(null));return new Fr(n)}}function Ur(e,t){return null!=zr(e,t)}function zr(e,t){const n=e.writeTree_.findRootMostValueAndPath(t);return null!=n?e.writeTree_.get(n.path).getChild(vn(n.path,t)):null}function Wr(e){const t=[],n=e.writeTree_.value;return null!=n?n.isLeafNode()||n.forEachChild(Hn,((e,n)=>{t.push(new Dn(e,n))})):e.writeTree_.children.inorderTraversal(((e,n)=>{null!=n.value&&t.push(new Dn(e,n.value))})),t}function Br(e,t){if(yn(t))return e;{const n=zr(e,t);return new Fr(null!=n?new jr(n):e.writeTree_.subtree(t))}}function Hr(e){return e.writeTree_.isEmpty()}function Qr(e,t){return Kr(un(),e.writeTree_,t)}function Kr(e,t,r){if(null!=t.value)return r.updateChild(e,t.value);{let i=null;return t.children.inorderTraversal(((t,s)=>{".priority"===t?(n(null!==s.value,"Priority writes must always be leaf nodes"),i=s.value):r=Kr(gn(e,t),s,r)})),r.getChild(e).isEmpty()||null===i||(r=r.updateChild(gn(e,".priority"),i)),r}}function Yr(e,t){return ci(t,e)}function Gr(e,t){const r=e.allWrites.findIndex((e=>e.writeId===t));n(r>=0,"removeWrite called with nonexistent writeId.");const i=e.allWrites[r];e.allWrites.splice(r,1);let s=i.visible,o=!1,a=e.allWrites.length-1;for(;s&&a>=0;){const t=e.allWrites[a];t.visible&&(a>=r&&Jr(t,i.path)?s=!1:Cn(i.path,t.path)&&(o=!0)),a--}if(s){if(o)return function(e){e.visibleWrites=Zr(e.allWrites,Xr,un()),e.allWrites.length>0?e.lastWriteId=e.allWrites[e.allWrites.length-1].writeId:e.lastWriteId=-1}(e),!0;if(i.snap)e.visibleWrites=Vr(e.visibleWrites,i.path);else{Ot(i.children,(t=>{e.visibleWrites=Vr(e.visibleWrites,gn(i.path,t))}))}return!0}return!1}function Jr(e,t){if(e.snap)return Cn(e.path,t);for(const n in e.children)if(e.children.hasOwnProperty(n)&&Cn(gn(e.path,n),t))return!0;return!1}function Xr(e){return e.visible}function Zr(e,t,n){let i=Fr.empty();for(let s=0;s<e.length;++s){const o=e[s];if(t(o)){const e=o.path;let t;if(o.snap)Cn(n,e)?(t=vn(n,e),i=Lr(i,t,o.snap)):Cn(e,n)&&(t=vn(e,n),i=Lr(i,un(),o.snap.getChild(t)));else{if(!o.children)throw r("WriteRecord should have .snap or .children");if(Cn(n,e))t=vn(n,e),i=$r(i,t,o.children);else if(Cn(e,n))if(t=vn(e,n),yn(t))i=$r(i,un(),o.children);else{const e=T(o.children,dn(t));if(e){const n=e.getChild(pn(t));i=Lr(i,un(),n)}}}}}return i}function ei(e,t,n,r,i){if(r||i){const s=Br(e.visibleWrites,t);if(!i&&Hr(s))return n;if(i||null!=n||Ur(s,un())){const s=function(e){return(e.visible||i)&&(!r||!~r.indexOf(e.writeId))&&(Cn(e.path,t)||Cn(t,e.path))};return Qr(Zr(e.allWrites,s,t),n||er.EMPTY_NODE)}return null}{const r=zr(e.visibleWrites,t);if(null!=r)return r;{const r=Br(e.visibleWrites,t);if(Hr(r))return n;if(null!=n||Ur(r,un())){return Qr(r,n||er.EMPTY_NODE)}return null}}}function ti(e,t,n,r){return ei(e.writeTree,e.treePath,t,n,r)}function ni(e,t){return function(e,t,n){let r=er.EMPTY_NODE;const i=zr(e.visibleWrites,t);if(i)return i.isLeafNode()||i.forEachChild(Hn,((e,t)=>{r=r.updateImmediateChild(e,t)})),r;if(n){const i=Br(e.visibleWrites,t);return n.forEachChild(Hn,((e,t)=>{const n=Qr(Br(i,new ln(e)),t);r=r.updateImmediateChild(e,n)})),Wr(i).forEach((e=>{r=r.updateImmediateChild(e.name,e.node)})),r}return Wr(Br(e.visibleWrites,t)).forEach((e=>{r=r.updateImmediateChild(e.name,e.node)})),r}(e.writeTree,e.treePath,t)}function ri(e,t,r,i){return function(e,t,r,i,s){n(i||s,"Either existingEventSnap or existingServerSnap must exist");const o=gn(t,r);if(Ur(e.visibleWrites,o))return null;{const t=Br(e.visibleWrites,o);return Hr(t)?s.getChild(r):Qr(t,s.getChild(r))}}(e.writeTree,e.treePath,t,r,i)}function ii(e,t){return function(e,t){return zr(e.visibleWrites,t)}(e.writeTree,gn(e.treePath,t))}function si(e,t,n,r,i,s){return function(e,t,n,r,i,s,o){let a;const c=Br(e.visibleWrites,t),l=zr(c,un());if(null!=l)a=l;else{if(null==n)return[];a=Qr(c,n)}if(a=a.withIndex(o),a.isEmpty()||a.isLeafNode())return[];{const e=[],t=o.getCompare(),n=s?a.getReverseIteratorFrom(r,o):a.getIteratorFrom(r,o);let c=n.getNext();for(;c&&e.length<i;)0!==t(c,r)&&e.push(c),c=n.getNext();return e}}(e.writeTree,e.treePath,t,n,r,i,s)}function oi(e,t,n){return function(e,t,n,r){const i=gn(t,n),s=zr(e.visibleWrites,i);if(null!=s)return s;if(r.isCompleteForChild(n))return Qr(Br(e.visibleWrites,i),r.getNode().getImmediateChild(n));return null}(e.writeTree,e.treePath,t,n)}function ai(e,t){return ci(gn(e.treePath,t),e.writeTree)}function ci(e,t){return{treePath:e,writeTree:t}}class li{constructor(){this.changeMap=new Map}trackChildChange(e){const t=e.type,i=e.childName;n("child_added"===t||"child_changed"===t||"child_removed"===t,"Only child changes supported for tracking"),n(".priority"!==i,"Only non-priority child changes can be tracked.");const s=this.changeMap.get(i);if(s){const n=s.type;if("child_added"===t&&"child_removed"===n)this.changeMap.set(i,cr(i,e.snapshotNode,s.snapshotNode));else if("child_removed"===t&&"child_added"===n)this.changeMap.delete(i);else if("child_removed"===t&&"child_changed"===n)this.changeMap.set(i,ar(i,s.oldSnap));else if("child_changed"===t&&"child_added"===n)this.changeMap.set(i,or(i,e.snapshotNode));else{if("child_changed"!==t||"child_changed"!==n)throw r("Illegal combination of changes: "+e+" occurred after "+s);this.changeMap.set(i,cr(i,e.snapshotNode,s.oldSnap))}}else this.changeMap.set(i,e)}getChanges(){return Array.from(this.changeMap.values())}}const ui=new class{getCompleteChild(e){return null}getChildAfterChild(e,t,n){return null}};class di{constructor(e,t,n=null){this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=n}getCompleteChild(e){const t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);{const t=null!=this.optCompleteServerCache_?new kr(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return oi(this.writes_,e,t)}}getChildAfterChild(e,t,n){const r=null!=this.optCompleteServerCache_?this.optCompleteServerCache_:Mr(this.viewCache_),i=si(this.writes_,r,t,1,n,e);return 0===i.length?null:i[0]}}function hi(e,t,i,s,o){const a=new li;let c,l;if(i.type===Cr.OVERWRITE){const r=i;r.source.fromUser?c=_i(e,t,r.path,r.snap,s,o,a):(n(r.source.fromServer,"Unknown source."),l=r.source.tagged||t.serverCache.isFiltered()&&!yn(r.path),c=fi(e,t,r.path,r.snap,s,o,l,a))}else if(i.type===Cr.MERGE){const r=i;r.source.fromUser?c=function(e,t,n,r,i,s,o){let a=t;return r.foreach(((r,c)=>{const l=gn(n,r);mi(t,dn(l))&&(a=_i(e,a,l,c,i,s,o))})),r.foreach(((r,c)=>{const l=gn(n,r);mi(t,dn(l))||(a=_i(e,a,l,c,i,s,o))})),a}(e,t,r.path,r.children,s,o,a):(n(r.source.fromServer,"Unknown source."),l=r.source.tagged||t.serverCache.isFiltered(),c=yi(e,t,r.path,r.children,s,o,l,a))}else if(i.type===Cr.ACK_USER_WRITE){const r=i;c=r.revert?function(e,t,r,i,s,o){let a;if(null!=ii(i,r))return t;{const c=new di(i,t,s),l=t.eventCache.getNode();let u;if(yn(r)||".priority"===dn(r)){let r;if(t.serverCache.isFullyInitialized())r=ti(i,Mr(t));else{const e=t.serverCache.getNode();n(e instanceof er,"serverChildren would be complete if leaf node"),r=ni(i,e)}u=e.filter.updateFullNode(l,r,o)}else{const n=dn(r);let s=oi(i,n,t.serverCache);null==s&&t.serverCache.isCompleteForChild(n)&&(s=l.getImmediateChild(n)),u=null!=s?e.filter.updateChild(l,n,s,pn(r),c,o):t.eventCache.getNode().hasChild(n)?e.filter.updateChild(l,n,er.EMPTY_NODE,pn(r),c,o):l,u.isEmpty()&&t.serverCache.isFullyInitialized()&&(a=ti(i,Mr(t)),a.isLeafNode()&&(u=e.filter.updateFullNode(u,a,o)))}return a=t.serverCache.isFullyInitialized()||null!=ii(i,un()),Or(t,u,a,e.filter.filtersNodes())}}(e,t,r.path,s,o,a):function(e,t,n,r,i,s,o){if(null!=ii(i,n))return t;const a=t.serverCache.isFiltered(),c=t.serverCache;if(null!=r.value){if(yn(n)&&c.isFullyInitialized()||c.isCompleteForPath(n))return fi(e,t,n,c.getNode().getChild(n),i,s,a,o);if(yn(n)){let r=new jr(null);return c.getNode().forEachChild(xn,((e,t)=>{r=r.set(new ln(e),t)})),yi(e,t,n,r,i,s,a,o)}return t}{let l=new jr(null);return r.foreach(((e,t)=>{const r=gn(n,e);c.isCompleteForPath(r)&&(l=l.set(e,c.getNode().getChild(r)))})),yi(e,t,n,l,i,s,a,o)}}(e,t,r.path,r.affectedTree,s,o,a)}else{if(i.type!==Cr.LISTEN_COMPLETE)throw r("Unknown operation type: "+i.type);c=function(e,t,n,r,i){const s=t.serverCache,o=xr(t,s.getNode(),s.isFullyInitialized()||yn(n),s.isFiltered());return pi(e,o,n,r,ui,i)}(e,t,i.path,s,a)}const u=a.getChanges();return function(e,t,n){const r=t.eventCache;if(r.isFullyInitialized()){const i=r.getNode().isLeafNode()||r.getNode().isEmpty(),s=Ar(e);(n.length>0||!e.eventCache.isFullyInitialized()||i&&!r.getNode().equals(s)||!r.getNode().getPriority().equals(s.getPriority()))&&n.push(sr(Ar(t)))}}(t,c,u),{viewCache:c,changes:u}}function pi(e,t,r,i,s,o){const a=t.eventCache;if(null!=ii(i,r))return t;{let c,l;if(yn(r))if(n(t.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),t.serverCache.isFiltered()){const n=Mr(t),r=ni(i,n instanceof er?n:er.EMPTY_NODE);c=e.filter.updateFullNode(t.eventCache.getNode(),r,o)}else{const n=ti(i,Mr(t));c=e.filter.updateFullNode(t.eventCache.getNode(),n,o)}else{const u=dn(r);if(".priority"===u){n(1===hn(r),"Can't have a priority with additional path components");const s=a.getNode();l=t.serverCache.getNode();const o=ri(i,r,s,l);c=null!=o?e.filter.updatePriority(s,o):a.getNode()}else{const n=pn(r);let d;if(a.isCompleteForChild(u)){l=t.serverCache.getNode();const e=ri(i,r,a.getNode(),l);d=null!=e?a.getNode().getImmediateChild(u).updateChild(n,e):a.getNode().getImmediateChild(u)}else d=oi(i,u,t.serverCache);c=null!=d?e.filter.updateChild(a.getNode(),u,d,n,s,o):a.getNode()}}return Or(t,c,a.isFullyInitialized()||yn(r),e.filter.filtersNodes())}}function fi(e,t,n,r,i,s,o,a){const c=t.serverCache;let l;const u=o?e.filter:e.filter.getIndexedFilter();if(yn(n))l=u.updateFullNode(c.getNode(),r,null);else if(u.filtersNodes()&&!c.isFiltered()){const e=c.getNode().updateChild(n,r);l=u.updateFullNode(c.getNode(),e,null)}else{const e=dn(n);if(!c.isCompleteForPath(n)&&hn(n)>1)return t;const i=pn(n),s=c.getNode().getImmediateChild(e).updateChild(i,r);l=".priority"===e?u.updatePriority(c.getNode(),s):u.updateChild(c.getNode(),e,s,i,ui,null)}const d=xr(t,l,c.isFullyInitialized()||yn(n),u.filtersNodes());return pi(e,d,n,i,new di(i,d,s),a)}function _i(e,t,n,r,i,s,o){const a=t.eventCache;let c,l;const u=new di(i,t,s);if(yn(n))l=e.filter.updateFullNode(t.eventCache.getNode(),r,o),c=Or(t,l,!0,e.filter.filtersNodes());else{const i=dn(n);if(".priority"===i)l=e.filter.updatePriority(t.eventCache.getNode(),r),c=Or(t,l,a.isFullyInitialized(),a.isFiltered());else{const s=pn(n),l=a.getNode().getImmediateChild(i);let d;if(yn(s))d=r;else{const e=u.getCompleteChild(i);d=null!=e?".priority"===fn(s)&&e.getChild(mn(s)).isEmpty()?e:e.updateChild(s,r):er.EMPTY_NODE}if(l.equals(d))c=t;else{c=Or(t,e.filter.updateChild(a.getNode(),i,d,s,u,o),a.isFullyInitialized(),e.filter.filtersNodes())}}}return c}function mi(e,t){return e.eventCache.isCompleteForChild(t)}function gi(e,t,n){return n.foreach(((e,n)=>{t=t.updateChild(e,n)})),t}function yi(e,t,n,r,i,s,o,a){if(t.serverCache.getNode().isEmpty()&&!t.serverCache.isFullyInitialized())return t;let c,l=t;c=yn(n)?r:new jr(null).setTree(n,r);const u=t.serverCache.getNode();return c.children.inorderTraversal(((n,r)=>{if(u.hasChild(n)){const c=gi(0,t.serverCache.getNode().getImmediateChild(n),r);l=fi(e,l,new ln(n),c,i,s,o,a)}})),c.children.inorderTraversal(((n,r)=>{const c=!t.serverCache.isCompleteForChild(n)&&null===r.value;if(!u.hasChild(n)&&!c){const c=gi(0,t.serverCache.getNode().getImmediateChild(n),r);l=fi(e,l,new ln(n),c,i,s,o,a)}})),l}class vi{constructor(e,t){this.query_=e,this.eventRegistrations_=[];const n=this.query_._queryParams,r=new lr(n.getIndex()),i=(s=n).loadsAllData()?new lr(s.getIndex()):s.hasLimit()?new dr(s):new ur(s);var s;this.processor_=function(e){return{filter:e}}(i);const o=t.serverCache,a=t.eventCache,c=r.updateFullNode(er.EMPTY_NODE,o.getNode(),null),l=i.updateFullNode(er.EMPTY_NODE,a.getNode(),null),u=new kr(c,o.isFullyInitialized(),r.filtersNodes()),d=new kr(l,a.isFullyInitialized(),i.filtersNodes());this.viewCache_=Rr(d,u),this.eventGenerator_=new Dr(this.query_)}get query(){return this.query_}}function bi(e,t){const n=Mr(e.viewCache_);return n&&(e.query._queryParams.loadsAllData()||!yn(t)&&!n.getImmediateChild(dn(t)).isEmpty())?n.getChild(t):null}function wi(e){return 0===e.eventRegistrations_.length}function Ci(e,t,r){const i=[];if(r){n(null==t,"A cancel should cancel all event registrations.");const s=e.query._path;e.eventRegistrations_.forEach((e=>{const t=e.createCancelEvent(r,s);t&&i.push(t)}))}if(t){let n=[];for(let r=0;r<e.eventRegistrations_.length;++r){const i=e.eventRegistrations_[r];if(i.matches(t)){if(t.hasAnyCallback()){n=n.concat(e.eventRegistrations_.slice(r+1));break}}else n.push(i)}e.eventRegistrations_=n}else e.eventRegistrations_=[];return i}function Ei(e,t,r,i){t.type===Cr.MERGE&&null!==t.source.queryId&&(n(Mr(e.viewCache_),"We should always have a full cache before handling merges"),n(Ar(e.viewCache_),"Missing event cache, even though we have a server cache"));const s=e.viewCache_,o=hi(e.processor_,s,t,r,i);var a,c;return a=e.processor_,c=o.viewCache,n(c.eventCache.getNode().isIndexed(a.filter.getIndex()),"Event snap not indexed"),n(c.serverCache.getNode().isIndexed(a.filter.getIndex()),"Server snap not indexed"),n(o.viewCache.serverCache.isFullyInitialized()||!s.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),e.viewCache_=o.viewCache,Ii(e,o.changes,o.viewCache.eventCache.getNode(),null)}function Ii(e,t,n,r){const i=r?[r]:e.eventRegistrations_;return function(e,t,n,r){const i=[],s=[];return t.forEach((t=>{var n;"child_changed"===t.type&&e.index_.indexedValueChanged(t.oldSnap,t.snapshotNode)&&s.push((n=t.childName,{type:"child_moved",snapshotNode:t.snapshotNode,childName:n}))})),Pr(e,i,"child_removed",t,r,n),Pr(e,i,"child_added",t,r,n),Pr(e,i,"child_moved",s,r,n),Pr(e,i,"child_changed",t,r,n),Pr(e,i,"value",t,r,n),i}(e.eventGenerator_,t,n,i)}let Si,Ti;class Ni{constructor(){this.views=new Map}}function ki(e,t,r,i){const s=t.source.queryId;if(null!==s){const o=e.views.get(s);return n(null!=o,"SyncTree gave us an op for an invalid query."),Ei(o,t,r,i)}{let n=[];for(const s of e.views.values())n=n.concat(Ei(s,t,r,i));return n}}function Di(e,t,n,r,i){const s=t._queryIdentifier,o=e.views.get(s);if(!o){let e=ti(n,i?r:null),s=!1;e?s=!0:r instanceof er?(e=ni(n,r),s=!1):(e=er.EMPTY_NODE,s=!1);const o=Rr(new kr(e,s,!1),new kr(r,i,!1));return new vi(t,o)}return o}function Pi(e,t,n,r,i,s){const o=Di(e,t,r,i,s);return e.views.has(t._queryIdentifier)||e.views.set(t._queryIdentifier,o),function(e,t){e.eventRegistrations_.push(t)}(o,n),function(e,t){const n=e.viewCache_.eventCache,r=[];n.getNode().isLeafNode()||n.getNode().forEachChild(Hn,((e,t)=>{r.push(or(e,t))}));return n.isFullyInitialized()&&r.push(sr(n.getNode())),Ii(e,r,n.getNode(),t)}(o,n)}function Ri(e,t,r,i){const s=t._queryIdentifier,o=[];let a=[];const c=qi(e);if("default"===s)for(const[t,n]of e.views.entries())a=a.concat(Ci(n,r,i)),wi(n)&&(e.views.delete(t),n.query._queryParams.loadsAllData()||o.push(n.query));else{const t=e.views.get(s);t&&(a=a.concat(Ci(t,r,i)),wi(t)&&(e.views.delete(s),t.query._queryParams.loadsAllData()||o.push(t.query)))}return c&&!qi(e)&&o.push(new(n(Si,"Reference.ts has not been loaded"),Si)(t._repo,t._path)),{removed:o,events:a}}function Oi(e){const t=[];for(const n of e.views.values())n.query._queryParams.loadsAllData()||t.push(n);return t}function xi(e,t){let n=null;for(const r of e.views.values())n=n||bi(r,t);return n}function Ai(e,t){if(t._queryParams.loadsAllData())return ji(e);{const n=t._queryIdentifier;return e.views.get(n)}}function Mi(e,t){return null!=Ai(e,t)}function qi(e){return null!=ji(e)}function ji(e){for(const t of e.views.values())if(t.query._queryParams.loadsAllData())return t;return null}let Fi=1;class Li{constructor(e){this.listenProvider_=e,this.syncPointTree_=new jr(null),this.pendingWriteTree_={visibleWrites:Fr.empty(),allWrites:[],lastWriteId:-1},this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function $i(e,t,r,i,s){return function(e,t,r,i,s){n(i>e.lastWriteId,"Stacking an older write on top of newer ones"),void 0===s&&(s=!0),e.allWrites.push({path:t,snap:r,writeId:i,visible:s}),s&&(e.visibleWrites=Lr(e.visibleWrites,t,r)),e.lastWriteId=i}(e.pendingWriteTree_,t,r,i,s),s?Yi(e,new Tr({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},t,r)):[]}function Vi(e,t,r,i){!function(e,t,r,i){n(i>e.lastWriteId,"Stacking an older merge on top of newer ones"),e.allWrites.push({path:t,children:r,writeId:i,visible:!0}),e.visibleWrites=$r(e.visibleWrites,t,r),e.lastWriteId=i}(e.pendingWriteTree_,t,r,i);const s=jr.fromObject(r);return Yi(e,new Nr({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},t,s))}function Ui(e,t,n=!1){const r=function(e,t){for(let n=0;n<e.allWrites.length;n++){const r=e.allWrites[n];if(r.writeId===t)return r}return null}(e.pendingWriteTree_,t);if(Gr(e.pendingWriteTree_,t)){let t=new jr(null);return null!=r.snap?t=t.set(un(),!0):Ot(r.children,(e=>{t=t.set(new ln(e),!0)})),Yi(e,new Ir(r.path,t,n))}return[]}function zi(e,t,n){return Yi(e,new Tr({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t,n))}function Wi(e,t,n,r,i=!1){const s=t._path,o=e.syncPointTree_.get(s);let a=[];if(o&&("default"===t._queryIdentifier||Mi(o,t))){const c=Ri(o,t,n,r);0===o.views.size&&(e.syncPointTree_=e.syncPointTree_.remove(s));const l=c.removed;if(a=c.events,!i){const n=-1!==l.findIndex((e=>e._queryParams.loadsAllData())),i=e.syncPointTree_.findOnPath(s,((e,t)=>qi(t)));if(n&&!i){const t=e.syncPointTree_.subtree(s);if(!t.isEmpty()){const n=function(e){return e.fold(((e,t,n)=>{if(t&&qi(t)){return[ji(t)]}{let e=[];return t&&(e=Oi(t)),Ot(n,((t,n)=>{e=e.concat(n)})),e}}))}(t);for(let t=0;t<n.length;++t){const r=n[t],i=r.query,s=Xi(e,r);e.listenProvider_.startListening(is(i),Zi(e,i),s.hashFn,s.onComplete)}}}if(!i&&l.length>0&&!r)if(n){const n=null;e.listenProvider_.stopListening(is(t),n)}else l.forEach((t=>{const n=e.queryToTagMap.get(es(t));e.listenProvider_.stopListening(is(t),n)}))}!function(e,t){for(let n=0;n<t.length;++n){const r=t[n];if(!r._queryParams.loadsAllData()){const t=es(r),n=e.queryToTagMap.get(t);e.queryToTagMap.delete(t),e.tagToQueryMap.delete(n)}}}(e,l)}return a}function Bi(e,t,n,r){const i=ts(e,r);if(null!=i){const r=ns(i),s=r.path,o=r.queryId,a=vn(s,t);return rs(e,s,new Tr(Er(o),a,n))}return[]}function Hi(e,t,r,i=!1){const s=t._path;let o=null,a=!1;e.syncPointTree_.foreachOnPath(s,((e,t)=>{const n=vn(e,s);o=o||xi(t,n),a=a||qi(t)}));let c,l=e.syncPointTree_.get(s);if(l?(a=a||qi(l),o=o||xi(l,un())):(l=new Ni,e.syncPointTree_=e.syncPointTree_.set(s,l)),null!=o)c=!0;else{c=!1,o=er.EMPTY_NODE;e.syncPointTree_.subtree(s).foreachChild(((e,t)=>{const n=xi(t,un());n&&(o=o.updateImmediateChild(e,n))}))}const u=Mi(l,t);if(!u&&!t._queryParams.loadsAllData()){const r=es(t);n(!e.queryToTagMap.has(r),"View does not exist, but we have a tag");const i=Fi++;e.queryToTagMap.set(r,i),e.tagToQueryMap.set(i,r)}let d=Pi(l,t,r,Yr(e.pendingWriteTree_,s),o,c);if(!u&&!a&&!i){const r=Ai(l,t);d=d.concat(function(e,t,r){const i=t._path,s=Zi(e,t),o=Xi(e,r),a=e.listenProvider_.startListening(is(t),s,o.hashFn,o.onComplete),c=e.syncPointTree_.subtree(i);if(s)n(!qi(c.value),"If we're adding a query, it shouldn't be shadowed");else{const t=c.fold(((e,t,n)=>{if(!yn(e)&&t&&qi(t))return[ji(t).query];{let e=[];return t&&(e=e.concat(Oi(t).map((e=>e.query)))),Ot(n,((t,n)=>{e=e.concat(n)})),e}}));for(let n=0;n<t.length;++n){const r=t[n];e.listenProvider_.stopListening(is(r),Zi(e,r))}}return a}(e,t,r))}return d}function Qi(e,t,n){const r=e.pendingWriteTree_,i=e.syncPointTree_.findOnPath(t,((e,n)=>{const r=xi(n,vn(e,t));if(r)return r}));return ei(r,t,i,n,!0)}function Ki(e,t){const n=t._path;let r=null;e.syncPointTree_.foreachOnPath(n,((e,t)=>{const i=vn(e,n);r=r||xi(t,i)}));let i=e.syncPointTree_.get(n);i?r=r||xi(i,un()):(i=new Ni,e.syncPointTree_=e.syncPointTree_.set(n,i));const s=null!=r,o=s?new kr(r,!0,!1):null;return function(e){return Ar(e.viewCache_)}(Di(i,t,Yr(e.pendingWriteTree_,t._path),s?o.getNode():er.EMPTY_NODE,s))}function Yi(e,t){return Gi(t,e.syncPointTree_,null,Yr(e.pendingWriteTree_,un()))}function Gi(e,t,n,r){if(yn(e.path))return Ji(e,t,n,r);{const i=t.get(un());null==n&&null!=i&&(n=xi(i,un()));let s=[];const o=dn(e.path),a=e.operationForChild(o),c=t.children.get(o);if(c&&a){const e=n?n.getImmediateChild(o):null,t=ai(r,o);s=s.concat(Gi(a,c,e,t))}return i&&(s=s.concat(ki(i,e,r,n))),s}}function Ji(e,t,n,r){const i=t.get(un());null==n&&null!=i&&(n=xi(i,un()));let s=[];return t.children.inorderTraversal(((t,i)=>{const o=n?n.getImmediateChild(t):null,a=ai(r,t),c=e.operationForChild(t);c&&(s=s.concat(Ji(c,i,o,a)))})),i&&(s=s.concat(ki(i,e,r,n))),s}function Xi(e,t){const n=t.query,r=Zi(e,n);return{hashFn:()=>{const e=function(e){return e.viewCache_.serverCache.getNode()}(t)||er.EMPTY_NODE;return e.hash()},onComplete:t=>{if("ok"===t)return r?function(e,t,n){const r=ts(e,n);if(r){const n=ns(r),i=n.path,s=n.queryId,o=vn(i,t);return rs(e,i,new Sr(Er(s),o))}return[]}(e,n._path,r):function(e,t){return Yi(e,new Sr({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t))}(e,n._path);{const r=function(e,t){let n="Unknown Error";"too_big"===e?n="The data requested exceeds the maximum size that can be accessed with a single request.":"permission_denied"===e?n="Client doesn't have permission to access the desired data.":"unavailable"===e&&(n="The service is unavailable");const r=new Error(e+" at "+t._path.toString()+": "+n);return r.code=e.toUpperCase(),r}(t,n);return Wi(e,n,null,r)}}}}function Zi(e,t){const n=es(t);return e.queryToTagMap.get(n)}function es(e){return e._path.toString()+"$"+e._queryIdentifier}function ts(e,t){return e.tagToQueryMap.get(t)}function ns(e){const t=e.indexOf("$");return n(-1!==t&&t<e.length-1,"Bad queryKey."),{queryId:e.substr(t+1),path:new ln(e.substr(0,t))}}function rs(e,t,r){const i=e.syncPointTree_.get(t);n(i,"Missing sync point for query tag that we're tracking");return ki(i,r,Yr(e.pendingWriteTree_,t),null)}function is(e){return e._queryParams.loadsAllData()&&!e._queryParams.isDefault()?new(n(Ti,"Reference.ts has not been loaded"),Ti)(e._repo,e._path):e}class ss{constructor(e){this.node_=e}getImmediateChild(e){const t=this.node_.getImmediateChild(e);return new ss(t)}node(){return this.node_}}class os{constructor(e,t){this.syncTree_=e,this.path_=t}getImmediateChild(e){const t=gn(this.path_,e);return new os(this.syncTree_,t)}node(){return Qi(this.syncTree_,this.path_)}}const as=function(e,t,r){return e&&"object"==typeof e?(n(".sv"in e,"Unexpected leaf node or priority contents"),"string"==typeof e[".sv"]?cs(e[".sv"],t,r):"object"==typeof e[".sv"]?ls(e[".sv"],t):void n(!1,"Unexpected server value: "+JSON.stringify(e,null,2))):e},cs=function(e,t,r){if("timestamp"===e)return r.timestamp;n(!1,"Unexpected server value: "+e)},ls=function(e,t,r){e.hasOwnProperty("increment")||n(!1,"Unexpected server value: "+JSON.stringify(e,null,2));const i=e.increment;"number"!=typeof i&&n(!1,"Unexpected increment value: "+i);const s=t.node();if(n(null!=s,"Expected ChildrenNode.EMPTY_NODE for nulls"),!s.isLeafNode())return i;const o=s.getValue();return"number"!=typeof o?i:o+i},us=function(e,t,n,r){return hs(t,new os(n,e),r)},ds=function(e,t,n){return hs(e,new ss(t),n)};function hs(e,t,n){const r=e.getPriority().val(),i=as(r,t.getImmediateChild(".priority"),n);let s;if(e.isLeafNode()){const r=e,s=as(r.getValue(),t,n);return s!==r.getValue()||i!==r.getPriority().val()?new Bn(s,nr(i)):e}{const r=e;return s=r,i!==r.getPriority().val()&&(s=s.updatePriority(new Bn(i))),r.forEachChild(Hn,((e,r)=>{const i=hs(r,t.getImmediateChild(e),n);i!==r&&(s=s.updateImmediateChild(e,i))})),s}}class ps{constructor(e="",t=null,n={children:{},childCount:0}){this.name=e,this.parent=t,this.node=n}}function fs(e,t){let n=t instanceof ln?t:new ln(t),r=e,i=dn(n);for(;null!==i;){const e=T(r.node.children,i)||{children:{},childCount:0};r=new ps(i,r,e),n=pn(n),i=dn(n)}return r}function _s(e){return e.node.value}function ms(e,t){e.node.value=t,ws(e)}function gs(e){return e.node.childCount>0}function ys(e,t){Ot(e.node.children,((n,r)=>{t(new ps(n,e,r))}))}function vs(e,t,n,r){n&&!r&&t(e),ys(e,(e=>{vs(e,t,!0,r)})),n&&r&&t(e)}function bs(e){return new ln(null===e.parent?e.name:bs(e.parent)+"/"+e.name)}function ws(e){null!==e.parent&&function(e,t,n){const r=function(e){return void 0===_s(e)&&!gs(e)}(n),i=S(e.node.children,t);r&&i?(delete e.node.children[t],e.node.childCount--,ws(e)):r||i||(e.node.children[t]=n.node,e.node.childCount++,ws(e))}(e.parent,e.name,e)}const Cs=/[\[\].#$\/\u0000-\u001F\u007F]/,Es=/[\[\].#$\u0000-\u001F\u007F]/,Is=10485760,Ss=function(e){return"string"==typeof e&&0!==e.length&&!Cs.test(e)},Ts=function(e){return"string"==typeof e&&0!==e.length&&!Es.test(e)},Ns=function(e,t,n){const r=n instanceof ln?new En(n,e):n;if(void 0===t)throw new Error(e+"contains undefined "+Sn(r));if("function"==typeof t)throw new Error(e+"contains a function "+Sn(r)+" with contents = "+t.toString());if(It(t))throw new Error(e+"contains "+t.toString()+" "+Sn(r));if("string"==typeof t&&t.length>Is/3&&x(t)>Is)throw new Error(e+"contains a string greater than "+Is+" utf8 bytes "+Sn(r)+" ('"+t.substring(0,50)+"...')");if(t&&"object"==typeof t){let n=!1,i=!1;if(Ot(t,((t,s)=>{if(".value"===t)n=!0;else if(".priority"!==t&&".sv"!==t&&(i=!0,!Ss(t)))throw new Error(e+" contains an invalid key ("+t+") "+Sn(r)+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');!function(e,t){e.parts_.length>0&&(e.byteLength_+=1),e.parts_.push(t),e.byteLength_+=x(t),In(e)}(r,t),Ns(e,s,r),function(e){const t=e.parts_.pop();e.byteLength_-=x(t),e.parts_.length>0&&(e.byteLength_-=1)}(r)})),n&&i)throw new Error(e+' contains ".value" child '+Sn(r)+" in addition to actual children.")}},ks=function(e,t,n,r){const i=O(e,"values");if(!t||"object"!=typeof t||Array.isArray(t))throw new Error(i+" must be an object containing the children to replace.");const s=[];Ot(t,((e,t)=>{const r=new ln(e);if(Ns(i,t,gn(n,r)),".priority"===fn(r)&&!(null===(o=t)||"string"==typeof o||"number"==typeof o&&!It(o)||o&&"object"==typeof o&&S(o,".sv")))throw new Error(i+"contains an invalid value for '"+r.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");var o;s.push(r)})),function(e,t){let n,r;for(n=0;n<t.length;n++){r=t[n];const i=_n(r);for(let t=0;t<i.length;t++)if(".priority"===i[t]&&t===i.length-1);else if(!Ss(i[t]))throw new Error(e+"contains an invalid key ("+i[t]+") in path "+r.toString()+'. Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"')}t.sort(bn);let i=null;for(n=0;n<t.length;n++){if(r=t[n],null!==i&&Cn(i,r))throw new Error(e+"contains a path "+i.toString()+" that is ancestor of another path "+r.toString());i=r}}(i,s)},Ds=function(e,t,n,r){if(!Ts(n))throw new Error(O(e,t)+'was an invalid path = "'+n+'". Paths must be non-empty strings and can\'t contain ".", "#", "$", "[", or "]"')},Ps=function(e,t){const n=t.path.toString();if("string"!=typeof t.repoInfo.host||0===t.repoInfo.host.length||!Ss(t.repoInfo.namespace)&&"localhost"!==t.repoInfo.host.split(":")[0]||0!==n.length&&!function(e){return e&&(e=e.replace(/^\/*\.info(\/|$)/,"/")),Ts(e)}(n))throw new Error(O(e,"url")+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".')};class Rs{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function Os(e,t){let n=null;for(let r=0;r<t.length;r++){const i=t[r],s=i.getPath();null===n||wn(s,n.path)||(e.eventLists_.push(n),n=null),null===n&&(n={events:[],path:s}),n.events.push(i)}n&&e.eventLists_.push(n)}function xs(e,t,n){Os(e,n),function(e,t){e.recursionDepth_++;let n=!0;for(let r=0;r<e.eventLists_.length;r++){const i=e.eventLists_[r];if(i){t(i.path)?(As(e.eventLists_[r]),e.eventLists_[r]=null):n=!1}}n&&(e.eventLists_=[]);e.recursionDepth_--}(e,(e=>Cn(e,t)||Cn(t,e)))}function As(e){for(let t=0;t<e.events.length;t++){const n=e.events[t];if(null!==n){e.events[t]=null;const r=n.getEventRunner();gt&&vt("event: "+n.toString()),qt(r)}}}class Ms{constructor(e,t,n,r){this.repoInfo_=e,this.forceRestClient_=t,this.authTokenProvider_=n,this.appCheckProvider_=r,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new Rs,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=gr(),this.transactionQueueTree_=new ps,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function qs(e,t,n){if(e.stats_=Gt(e.repoInfo_),e.forceRestClient_||("object"==typeof window&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0)e.server_=new _r(e.repoInfo_,((t,n,r,i)=>{Ls(e,t,n,r,i)}),e.authTokenProvider_,e.appCheckProvider_),setTimeout((()=>$s(e,!0)),0);else{if(null!=n){if("object"!=typeof n)throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{E(n)}catch(e){throw new Error("Invalid authOverride provided: "+e)}}e.persistentConnection_=new kn(e.repoInfo_,t,((t,n,r,i)=>{Ls(e,t,n,r,i)}),(t=>{$s(e,t)}),(t=>{!function(e,t){Ot(t,((t,n)=>{Vs(e,t,n)}))}(e,t)}),e.authTokenProvider_,e.appCheckProvider_,n),e.server_=e.persistentConnection_}e.authTokenProvider_.addTokenChangeListener((t=>{e.server_.refreshAuthToken(t)})),e.appCheckProvider_.addTokenChangeListener((t=>{e.server_.refreshAppCheckToken(t.token)})),e.statsReporter_=function(e,t){const n=e.toString();return Yt[n]||(Yt[n]=t()),Yt[n]}(e.repoInfo_,(()=>new wr(e.stats_,e.server_))),e.infoData_=new mr,e.infoSyncTree_=new Li({startListening:(t,n,r,i)=>{let s=[];const o=e.infoData_.getNode(t._path);return o.isEmpty()||(s=zi(e.infoSyncTree_,t._path,o),setTimeout((()=>{i("ok")}),0)),s},stopListening:()=>{}}),Vs(e,"connected",!1),e.serverSyncTree_=new Li({startListening:(t,n,r,i)=>(e.server_.listen(t,r,n,((n,r)=>{const s=i(n,r);xs(e.eventQueue_,t._path,s)})),[]),stopListening:(t,n)=>{e.server_.unlisten(t,n)}})}function js(e){const t=e.infoData_.getNode(new ln(".info/serverTimeOffset")).val()||0;return(new Date).getTime()+t}function Fs(e){return(t=(t={timestamp:js(e)})||{}).timestamp=t.timestamp||(new Date).getTime(),t;var t}function Ls(e,t,n,r,i){e.dataUpdateCount++;const s=new ln(t);n=e.interceptServerDataCallback_?e.interceptServerDataCallback_(t,n):n;let o=[];if(i)if(r){const t=k(n,(e=>nr(e)));o=function(e,t,n,r){const i=ts(e,r);if(i){const r=ns(i),s=r.path,o=r.queryId,a=vn(s,t),c=jr.fromObject(n);return rs(e,s,new Nr(Er(o),a,c))}return[]}(e.serverSyncTree_,s,t,i)}else{const t=nr(n);o=Bi(e.serverSyncTree_,s,t,i)}else if(r){const t=k(n,(e=>nr(e)));o=function(e,t,n){const r=jr.fromObject(n);return Yi(e,new Nr({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t,r))}(e.serverSyncTree_,s,t)}else{const t=nr(n);o=zi(e.serverSyncTree_,s,t)}let a=s;o.length>0&&(a=Qs(e,s)),xs(e.eventQueue_,a,o)}function $s(e,t){Vs(e,"connected",t),!1===t&&function(e){zs(e,"onDisconnectEvents");const t=Fs(e),n=gr();vr(e.onDisconnect_,un(),((r,i)=>{const s=us(r,i,e.serverSyncTree_,t);yr(n,r,s)}));let r=[];vr(n,un(),((t,n)=>{r=r.concat(zi(e.serverSyncTree_,t,n));const i=Xs(e,t);Qs(e,i)})),e.onDisconnect_=gr(),xs(e.eventQueue_,un(),r)}(e)}function Vs(e,t,n){const r=new ln("/.info/"+t),i=nr(n);e.infoData_.updateSnapshot(r,i);const s=zi(e.infoSyncTree_,r,i);xs(e.eventQueue_,r,s)}function Us(e){return e.nextWriteId_++}function zs(e,...t){let n="";e.persistentConnection_&&(n=e.persistentConnection_.id+":"),vt(n,...t)}function Ws(e,t,n,r){t&&qt((()=>{if("ok"===n)t(null);else{const e=(n||"error").toUpperCase();let i=e;r&&(i+=": "+r);const s=new Error(i);s.code=e,t(s)}}))}function Bs(e,t,n){return Qi(e.serverSyncTree_,t,n)||er.EMPTY_NODE}function Hs(e,t=e.transactionQueueTree_){if(t||Js(e,t),_s(t)){const r=Ys(e,t);n(r.length>0,"Sending zero length transaction queue");r.every((e=>0===e.status))&&function(e,t,r){const i=r.map((e=>e.currentWriteId)),s=Bs(e,t,i);let o=s;const a=s.hash();for(let e=0;e<r.length;e++){const i=r[e];n(0===i.status,"tryToSendTransactionQueue_: items in queue should all be run."),i.status=1,i.retryCount++;const s=vn(t,i.path);o=o.updateChild(s,i.currentOutputSnapshotRaw)}const c=o.val(!0),l=t;e.server_.put(l.toString(),c,(n=>{zs(e,"transaction put response",{path:l.toString(),status:n});let i=[];if("ok"===n){const n=[];for(let t=0;t<r.length;t++)r[t].status=2,i=i.concat(Ui(e.serverSyncTree_,r[t].currentWriteId)),r[t].onComplete&&n.push((()=>r[t].onComplete(null,!0,r[t].currentOutputSnapshotResolved))),r[t].unwatcher();Js(e,fs(e.transactionQueueTree_,t)),Hs(e,e.transactionQueueTree_),xs(e.eventQueue_,t,i);for(let e=0;e<n.length;e++)qt(n[e])}else{if("datastale"===n)for(let e=0;e<r.length;e++)3===r[e].status?r[e].status=4:r[e].status=0;else{Et("transaction at "+l.toString()+" failed: "+n);for(let e=0;e<r.length;e++)r[e].status=4,r[e].abortReason=n}Qs(e,t)}}),a)}(e,bs(t),r)}else gs(t)&&ys(t,(t=>{Hs(e,t)}))}function Qs(e,t){const r=Ks(e,t),i=bs(r);return function(e,t,r){if(0===t.length)return;const i=[];let s=[];const o=t.filter((e=>0===e.status)),a=o.map((e=>e.currentWriteId));for(let o=0;o<t.length;o++){const l=t[o],u=vn(r,l.path);let d,h=!1;if(n(null!==u,"rerunTransactionsUnderNode_: relativePath should not be null."),4===l.status)h=!0,d=l.abortReason,s=s.concat(Ui(e.serverSyncTree_,l.currentWriteId,!0));else if(0===l.status)if(l.retryCount>=25)h=!0,d="maxretry",s=s.concat(Ui(e.serverSyncTree_,l.currentWriteId,!0));else{const n=Bs(e,l.path,a);l.currentInputSnapshot=n;const r=t[o].update(n.val());if(void 0!==r){Ns("transaction failed: Data returned ",r,l.path);let t=nr(r);"object"==typeof r&&null!=r&&S(r,".priority")||(t=t.updatePriority(n.getPriority()));const i=l.currentWriteId,o=Fs(e),c=ds(t,n,o);l.currentOutputSnapshotRaw=t,l.currentOutputSnapshotResolved=c,l.currentWriteId=Us(e),a.splice(a.indexOf(i),1),s=s.concat($i(e.serverSyncTree_,l.path,c,l.currentWriteId,l.applyLocally)),s=s.concat(Ui(e.serverSyncTree_,i,!0))}else h=!0,d="nodata",s=s.concat(Ui(e.serverSyncTree_,l.currentWriteId,!0))}xs(e.eventQueue_,r,s),s=[],h&&(t[o].status=2,c=t[o].unwatcher,setTimeout(c,Math.floor(0)),t[o].onComplete&&("nodata"===d?i.push((()=>t[o].onComplete(null,!1,t[o].currentInputSnapshot))):i.push((()=>t[o].onComplete(new Error(d),!1,null)))))}var c;Js(e,e.transactionQueueTree_);for(let e=0;e<i.length;e++)qt(i[e]);Hs(e,e.transactionQueueTree_)}(e,Ys(e,r),i),i}function Ks(e,t){let n,r=e.transactionQueueTree_;for(n=dn(t);null!==n&&void 0===_s(r);)r=fs(r,n),n=dn(t=pn(t));return r}function Ys(e,t){const n=[];return Gs(e,t,n),n.sort(((e,t)=>e.order-t.order)),n}function Gs(e,t,n){const r=_s(t);if(r)for(let e=0;e<r.length;e++)n.push(r[e]);ys(t,(t=>{Gs(e,t,n)}))}function Js(e,t){const n=_s(t);if(n){let e=0;for(let t=0;t<n.length;t++)2!==n[t].status&&(n[e]=n[t],e++);n.length=e,ms(t,n.length>0?n:void 0)}ys(t,(t=>{Js(e,t)}))}function Xs(e,t){const n=bs(Ks(e,t)),r=fs(e.transactionQueueTree_,t);return function(e,t){let n=e.parent;for(;null!==n;){if(t(n))return!0;n=n.parent}}(r,(t=>{Zs(e,t)})),Zs(e,r),vs(r,(t=>{Zs(e,t)})),n}function Zs(e,t){const r=_s(t);if(r){const i=[];let s=[],o=-1;for(let t=0;t<r.length;t++)3===r[t].status||(1===r[t].status?(n(o===t-1,"All SENT items should be at beginning of queue."),o=t,r[t].status=3,r[t].abortReason="set"):(n(0===r[t].status,"Unexpected transaction status in abort"),r[t].unwatcher(),s=s.concat(Ui(e.serverSyncTree_,r[t].currentWriteId,!0)),r[t].onComplete&&i.push(r[t].onComplete.bind(null,new Error("set"),!1,null))));-1===o?ms(t,void 0):r.length=o+1,xs(e.eventQueue_,bs(t),s);for(let e=0;e<i.length;e++)qt(i[e])}}const eo=function(e,t){const n=to(e),r=n.namespace;"firebase.com"===n.domain&&Ct(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),r&&"undefined"!==r||"localhost"===n.domain||Ct("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||"undefined"!=typeof window&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&Et("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().");const i="ws"===n.scheme||"wss"===n.scheme;return{repoInfo:new Bt(n.host,n.secure,r,i,t,"",r!==n.subdomain),path:new ln(n.pathString)}},to=function(e){let t="",n="",r="",i="",s="",o=!0,a="https",c=443;if("string"==typeof e){let l=e.indexOf("//");l>=0&&(a=e.substring(0,l-1),e=e.substring(l+2));let u=e.indexOf("/");-1===u&&(u=e.length);let d=e.indexOf("?");-1===d&&(d=e.length),t=e.substring(0,Math.min(u,d)),u<d&&(i=function(e){let t="";const n=e.split("/");for(let e=0;e<n.length;e++)if(n[e].length>0){let r=n[e];try{r=decodeURIComponent(r.replace(/\+/g," "))}catch(e){}t+="/"+r}return t}(e.substring(u,d)));const h=function(e){const t={};"?"===e.charAt(0)&&(e=e.substring(1));for(const n of e.split("&")){if(0===n.length)continue;const r=n.split("=");2===r.length?t[decodeURIComponent(r[0])]=decodeURIComponent(r[1]):Et(`Invalid query segment '${n}' in query '${e}'`)}return t}(e.substring(Math.min(e.length,d)));l=t.indexOf(":"),l>=0?(o="https"===a||"wss"===a,c=parseInt(t.substring(l+1),10)):l=t.length;const p=t.slice(0,l);if("localhost"===p.toLowerCase())n="localhost";else if(p.split(".").length<=2)n=p;else{const e=t.indexOf(".");r=t.substring(0,e).toLowerCase(),n=t.substring(e+1),s=r}"ns"in h&&(s=h.ns)}return{host:t,port:c,domain:n,subdomain:r,secure:o,scheme:a,pathString:i,namespace:s}},no="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",ro=function(){let e=0;const t=[];return function(r){const i=r===e;let s;e=r;const o=new Array(8);for(s=7;s>=0;s--)o[s]=no.charAt(r%64),r=Math.floor(r/64);n(0===r,"Cannot push at time == 0");let a=o.join("");if(i){for(s=11;s>=0&&63===t[s];s--)t[s]=0;t[s]++}else for(s=0;s<12;s++)t[s]=Math.floor(64*Math.random());for(s=0;s<12;s++)a+=no.charAt(t[s]);return n(20===a.length,"nextPushId: Length should be 20."),a}}();class io{constructor(e,t,n,r){this.eventType=e,this.eventRegistration=t,this.snapshot=n,this.prevName=r}getPath(){const e=this.snapshot.ref;return"value"===this.eventType?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+E(this.snapshot.exportVal())}}class so{constructor(e,t,n){this.eventRegistration=e,this.error=t,this.path=n}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}class oo{constructor(e,t){this.snapshotCallback=e,this.cancelCallback=t}onValue(e,t){this.snapshotCallback.call(null,e,t)}onCancel(e){return n(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||void 0!==this.snapshotCallback.userCallback&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}}class ao{constructor(e,t,n,r){this._repo=e,this._path=t,this._queryParams=n,this._orderByCalled=r}get key(){return yn(this._path)?null:fn(this._path)}get ref(){return new co(this._repo,this._path)}get _queryIdentifier(){const e=fr(this._queryParams),t=Pt(e);return"{}"===t?"default":t}get _queryObject(){return fr(this._queryParams)}isEqual(e){if(!((e=A(e))instanceof ao))return!1;const t=this._repo===e._repo,n=wn(this._path,e._path),r=this._queryIdentifier===e._queryIdentifier;return t&&n&&r}toJSON(){return this.toString()}toString(){return this._repo.toString()+function(e){let t="";for(let n=e.pieceNum_;n<e.pieces_.length;n++)""!==e.pieces_[n]&&(t+="/"+encodeURIComponent(String(e.pieces_[n])));return t||"/"}(this._path)}}class co extends ao{constructor(e,t){super(e,t,new hr,!1)}get parent(){const e=mn(this._path);return null===e?null:new co(this._repo,e)}get root(){let e=this;for(;null!==e.parent;)e=e.parent;return e}}class lo{constructor(e,t,n){this._node=e,this.ref=t,this._index=n}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){const t=new ln(e),n=ho(this.ref,e);return new lo(this._node.getChild(t),n,Hn)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){if(this._node.isLeafNode())return!1;return!!this._node.forEachChild(this._index,((t,n)=>e(new lo(n,ho(this.ref,t),Hn))))}hasChild(e){const t=new ln(e);return!this._node.getChild(t).isEmpty()}hasChildren(){return!this._node.isLeafNode()&&!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function uo(e,t){return(e=A(e))._checkNotDeleted("ref"),void 0!==t?ho(e._root,t):e._root}function ho(e,t){var n,r,i;return null===dn((e=A(e))._path)?(n="child",r="path",(i=t)&&(i=i.replace(/^\/*\.info(\/|$)/,"/")),Ds(n,r,i)):Ds("child","path",t),new co(e._repo,gn(e._path,t))}function po(e,t){(function(e,t){if(".info"===dn(t))throw new Error(e+" failed = Can't modify data under /.info/")})("push",(e=A(e))._path),e._path;const n=js(e._repo),r=ro(n),i=ho(e,r),s=ho(e,r);let o;return o=Promise.resolve(s),i.then=o.then.bind(o),i.catch=o.then.bind(o,void 0),i}function fo(e,t){ks("update",t,e._path);const n=new m;return function(e,t,n,r){zs(e,"update",{path:t.toString(),value:n});let i=!0;const s=Fs(e),o={};if(Ot(n,((n,r)=>{i=!1,o[n]=us(gn(t,n),nr(r),e.serverSyncTree_,s)})),i)vt("update() called with empty data.  Don't do anything."),Ws(0,r,"ok",void 0);else{const i=Us(e),s=Vi(e.serverSyncTree_,t,o,i);Os(e.eventQueue_,s),e.server_.merge(t.toString(),n,((n,s)=>{const o="ok"===n;o||Et("update at "+t+" failed: "+n);const a=Ui(e.serverSyncTree_,i,!o),c=a.length>0?Qs(e,t):t;xs(e.eventQueue_,c,a),Ws(0,r,n,s)})),Ot(n,(n=>{const r=Xs(e,gn(t,n));Qs(e,r)})),xs(e.eventQueue_,t,[])}}(e._repo,e._path,t,n.wrapCallback((()=>{}))),n.promise}function _o(e){e=A(e);const t=new oo((()=>{})),n=new mo(t);return function(e,t,n){const r=Ki(e.serverSyncTree_,t);return null!=r?Promise.resolve(r):e.server_.get(t).then((r=>{const i=nr(r).withIndex(t._queryParams.getIndex());let s;if(Hi(e.serverSyncTree_,t,n,!0),t._queryParams.loadsAllData())s=zi(e.serverSyncTree_,t._path,i);else{const n=Zi(e.serverSyncTree_,t);s=Bi(e.serverSyncTree_,t._path,i,n)}return xs(e.eventQueue_,t._path,s),Wi(e.serverSyncTree_,t,n,null,!0),i}),(n=>(zs(e,"get for query "+E(t)+" failed: "+n),Promise.reject(new Error(n)))))}(e._repo,e,n).then((t=>new lo(t,new co(e._repo,e._path),e._queryParams.getIndex())))}class mo{constructor(e){this.callbackContext=e}respondsTo(e){return"value"===e}createEvent(e,t){const n=t._queryParams.getIndex();return new io("value",this,new lo(e.snapshotNode,new co(t._repo,t._path),n))}getEventRunner(e){return"cancel"===e.getEventType()?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new so(this,e,t):null}matches(e){return e instanceof mo&&(!e.callbackContext||!this.callbackContext||e.callbackContext.matches(this.callbackContext))}hasAnyCallback(){return null!==this.callbackContext}}!function(e){n(!Si,"__referenceConstructor has already been defined"),Si=e}(co),function(e){n(!Ti,"__referenceConstructor has already been defined"),Ti=e}(co);const go={};let yo=!1;function vo(e,t,n,r,i){let s=r||e.options.databaseURL;void 0===s&&(e.options.projectId||Ct("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),vt("Using default host for project ",e.options.projectId),s=`${e.options.projectId}-default-rtdb.firebaseio.com`);let o,a=eo(s,i),c=a.repoInfo;"undefined"!=typeof process&&process.env&&(o=process.env.FIREBASE_DATABASE_EMULATOR_HOST),o?(s=`http://${o}?ns=${c.namespace}`,a=eo(s,i),c=a.repoInfo):a.repoInfo.secure;const l=new Lt(e.name,e.options,t);Ps("Invalid Firebase Database URL",a),yn(a.path)||Ct("Database URL must point to the root of a Firebase Database (not including a child path).");const u=function(e,t,n,r){let i=go[t.name];i||(i={},go[t.name]=i);let s=i[e.toURLString()];s&&Ct("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call.");return s=new Ms(e,yo,n,r),i[e.toURLString()]=s,s}(c,e,l,new Ft(e.name,n));return new bo(u,e)}class bo{constructor(e,t){this._repoInternal=e,this.app=t,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(qs(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new co(this._repo,un())),this._rootInternal}_delete(){return null!==this._rootInternal&&(!function(e,t){const n=go[t];n&&n[e.key]===e||Ct(`Database ${t}(${e.repoInfo_}) has already been deleted.`),function(e){e.persistentConnection_&&e.persistentConnection_.interrupt("repo_interrupt")}(e),delete n[e.key]}(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){null===this._rootInternal&&Ct("Cannot call "+e+" on a deleted database.")}}function wo(e){return`Minified Redux error #${e}; visit https://redux.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}kn.prototype.simpleListen=function(e,t){this.sendRequest("q",{p:e},t)},kn.prototype.echo=function(e,t){this.sendRequest("echo",{d:e},t)},function(e){!function(e){at=e}("10.14.1"),ze(new M("database",((e,{instanceIdentifier:t})=>vo(e.getProvider("app").getImmediate(),e.getProvider("auth-internal"),e.getProvider("app-check-internal"),t)),"PUBLIC").setMultipleInstances(!0)),Ke(st,ot,e),Ke(st,ot,"esm2017")}();var Co=(()=>"function"==typeof Symbol&&Symbol.observable||"@@observable")(),Eo=()=>Math.random().toString(36).substring(7).split("").join("."),Io={INIT:`@@redux/INIT${Eo()}`,REPLACE:`@@redux/REPLACE${Eo()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${Eo()}`};function So(e){if("object"!=typeof e||null===e)return!1;let t=e;for(;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t||null===Object.getPrototypeOf(e)}function To(e){if(void 0===e)return"undefined";if(null===e)return"null";const t=typeof e;switch(t){case"boolean":case"string":case"number":case"symbol":case"function":return t}if(Array.isArray(e))return"array";if(function(e){return e instanceof Date||"function"==typeof e.toDateString&&"function"==typeof e.getDate&&"function"==typeof e.setDate}(e))return"date";if(function(e){return e instanceof Error||"string"==typeof e.message&&e.constructor&&"number"==typeof e.constructor.stackTraceLimit}(e))return"error";const n=function(e){return"function"==typeof e.constructor?e.constructor.name:null}(e);switch(n){case"Symbol":case"Promise":case"WeakMap":case"WeakSet":case"Map":case"Set":return n}return Object.prototype.toString.call(e).slice(8,-1).toLowerCase().replace(/\s/g,"")}function No(e){let t=typeof e;return"production"!==process.env.NODE_ENV&&(t=To(e)),t}function ko(e,t,n){if("function"!=typeof e)throw new Error("production"===process.env.NODE_ENV?wo(2):`Expected the root reducer to be a function. Instead, received: '${No(e)}'`);if("function"==typeof t&&"function"==typeof n||"function"==typeof n&&"function"==typeof arguments[3])throw new Error("production"===process.env.NODE_ENV?wo(0):"It looks like you are passing several store enhancers to createStore(). This is not supported. Instead, compose them together to a single function. See https://redux.js.org/tutorials/fundamentals/part-4-store#creating-a-store-with-enhancers for an example.");if("function"==typeof t&&void 0===n&&(n=t,t=void 0),void 0!==n){if("function"!=typeof n)throw new Error("production"===process.env.NODE_ENV?wo(1):`Expected the enhancer to be a function. Instead, received: '${No(n)}'`);return n(ko)(e,t)}let r=e,i=t,s=new Map,o=s,a=0,c=!1;function l(){o===s&&(o=new Map,s.forEach(((e,t)=>{o.set(t,e)})))}function u(){if(c)throw new Error("production"===process.env.NODE_ENV?wo(3):"You may not call store.getState() while the reducer is executing. The reducer has already received the state as an argument. Pass it down from the top reducer instead of reading it from the store.");return i}function d(e){if("function"!=typeof e)throw new Error("production"===process.env.NODE_ENV?wo(4):`Expected the listener to be a function. Instead, received: '${No(e)}'`);if(c)throw new Error("production"===process.env.NODE_ENV?wo(5):"You may not call store.subscribe() while the reducer is executing. If you would like to be notified after the store has been updated, subscribe from a component and invoke store.getState() in the callback to access the latest state. See https://redux.js.org/api/store#subscribelistener for more details.");let t=!0;l();const n=a++;return o.set(n,e),function(){if(t){if(c)throw new Error("production"===process.env.NODE_ENV?wo(6):"You may not unsubscribe from a store listener while the reducer is executing. See https://redux.js.org/api/store#subscribelistener for more details.");t=!1,l(),o.delete(n),s=null}}}function h(e){if(!So(e))throw new Error("production"===process.env.NODE_ENV?wo(7):`Actions must be plain objects. Instead, the actual type was: '${No(e)}'. You may need to add middleware to your store setup to handle dispatching other values, such as 'redux-thunk' to handle dispatching functions. See https://redux.js.org/tutorials/fundamentals/part-4-store#middleware and https://redux.js.org/tutorials/fundamentals/part-6-async-logic#using-the-redux-thunk-middleware for examples.`);if(void 0===e.type)throw new Error("production"===process.env.NODE_ENV?wo(8):'Actions may not have an undefined "type" property. You may have misspelled an action type string constant.');if("string"!=typeof e.type)throw new Error("production"===process.env.NODE_ENV?wo(17):`Action "type" property must be a string. Instead, the actual type was: '${No(e.type)}'. Value was: '${e.type}' (stringified)`);if(c)throw new Error("production"===process.env.NODE_ENV?wo(9):"Reducers may not dispatch actions.");try{c=!0,i=r(i,e)}finally{c=!1}return(s=o).forEach((e=>{e()})),e}h({type:Io.INIT});return{dispatch:h,subscribe:d,getState:u,replaceReducer:function(e){if("function"!=typeof e)throw new Error("production"===process.env.NODE_ENV?wo(10):`Expected the nextReducer to be a function. Instead, received: '${No(e)}`);r=e,h({type:Io.REPLACE})},[Co]:function(){const e=d;return{subscribe(t){if("object"!=typeof t||null===t)throw new Error("production"===process.env.NODE_ENV?wo(11):`Expected the observer to be an object. Instead, received: '${No(t)}'`);function n(){const e=t;e.next&&e.next(u())}n();return{unsubscribe:e(n)}},[Co](){return this}}}}}function Do(e){"undefined"!=typeof console&&"function"==typeof console.error&&console.error(e);try{throw new Error(e)}catch(e){}}function Po(e){const t=Object.keys(e),n={};for(let r=0;r<t.length;r++){const i=t[r];"production"!==process.env.NODE_ENV&&void 0===e[i]&&Do(`No reducer provided for key "${i}"`),"function"==typeof e[i]&&(n[i]=e[i])}const r=Object.keys(n);let i,s;"production"!==process.env.NODE_ENV&&(i={});try{!function(e){Object.keys(e).forEach((t=>{const n=e[t];if(void 0===n(void 0,{type:Io.INIT}))throw new Error("production"===process.env.NODE_ENV?wo(12):`The slice reducer for key "${t}" returned undefined during initialization. If the state passed to the reducer is undefined, you must explicitly return the initial state. The initial state may not be undefined. If you don't want to set a value for this reducer, you can use null instead of undefined.`);if(void 0===n(void 0,{type:Io.PROBE_UNKNOWN_ACTION()}))throw new Error("production"===process.env.NODE_ENV?wo(13):`The slice reducer for key "${t}" returned undefined when probed with a random type. Don't try to handle '${Io.INIT}' or other actions in "redux/*" namespace. They are considered private. Instead, you must return the current state for any unknown actions, unless it is undefined, in which case you must return the initial state, regardless of the action type. The initial state may not be undefined, but can be null.`)}))}(n)}catch(e){s=e}return function(e={},t){if(s)throw s;if("production"!==process.env.NODE_ENV){const r=function(e,t,n,r){const i=Object.keys(t),s=n&&n.type===Io.INIT?"preloadedState argument passed to createStore":"previous state received by the reducer";if(0===i.length)return"Store does not have a valid reducer. Make sure the argument passed to combineReducers is an object whose values are reducers.";if(!So(e))return`The ${s} has unexpected type of "${No(e)}". Expected argument to be an object with the following keys: "${i.join('", "')}"`;const o=Object.keys(e).filter((e=>!t.hasOwnProperty(e)&&!r[e]));return o.forEach((e=>{r[e]=!0})),n&&n.type===Io.REPLACE?void 0:o.length>0?`Unexpected ${o.length>1?"keys":"key"} "${o.join('", "')}" found in ${s}. Expected to find one of the known reducer keys instead: "${i.join('", "')}". Unexpected keys will be ignored.`:void 0}(e,n,t,i);r&&Do(r)}let o=!1;const a={};for(let i=0;i<r.length;i++){const s=r[i],c=n[s],l=e[s],u=c(l,t);if(void 0===u){const e=t&&t.type;throw new Error("production"===process.env.NODE_ENV?wo(14):`When called with an action of type ${e?`"${String(e)}"`:"(unknown type)"}, the slice reducer for key "${s}" returned undefined. To ignore an action, you must explicitly return the previous state. If you want this reducer to hold no value, you can return null instead of undefined.`)}a[s]=u,o=o||u!==l}return o=o||r.length!==Object.keys(e).length,o?a:e}}function Ro(...e){return 0===e.length?e=>e:1===e.length?e[0]:e.reduce(((e,t)=>(...n)=>e(t(...n))))}function Oo(e){return So(e)&&"type"in e&&"string"==typeof e.type}var xo=Symbol.for("immer-nothing"),Ao=Symbol.for("immer-draftable"),Mo=Symbol.for("immer-state"),qo="production"!==process.env.NODE_ENV?[function(e){return`The plugin for '${e}' has not been loaded into Immer. To enable the plugin, import and call \`enable${e}()\` when initializing your application.`},function(e){return`produce can only be called on things that are draftable: plain objects, arrays, Map, Set or classes that are marked with '[immerable]: true'. Got '${e}'`},"This object has been frozen and should not be mutated",function(e){return"Cannot use a proxy that has been revoked. Did you pass an object from inside an immer function to an async process? "+e},"An immer producer returned a new value *and* modified its draft. Either return a new value *or* modify the draft.","Immer forbids circular references","The first or second argument to `produce` must be a function","The third argument to `produce` must be a function or undefined","First argument to `createDraft` must be a plain object, an array, or an immerable object","First argument to `finishDraft` must be a draft returned by `createDraft`",function(e){return`'current' expects a draft, got: ${e}`},"Object.defineProperty() cannot be used on an Immer draft","Object.setPrototypeOf() cannot be used on an Immer draft","Immer only supports deleting array indices","Immer only supports setting array indices and the 'length' property",function(e){return`'original' expects a draft, got: ${e}`}]:[];function jo(e,...t){if("production"!==process.env.NODE_ENV){const n=qo[e],r="function"==typeof n?n.apply(null,t):n;throw new Error(`[Immer] ${r}`)}throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var Fo=Object.getPrototypeOf;function Lo(e){return!!e&&!!e[Mo]}function $o(e){return!!e&&(Uo(e)||Array.isArray(e)||!!e[Ao]||!!e.constructor?.[Ao]||Ko(e)||Yo(e))}var Vo=Object.prototype.constructor.toString();function Uo(e){if(!e||"object"!=typeof e)return!1;const t=Fo(e);if(null===t)return!0;const n=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return n===Object||"function"==typeof n&&Function.toString.call(n)===Vo}function zo(e,t){0===Wo(e)?Reflect.ownKeys(e).forEach((n=>{t(n,e[n],e)})):e.forEach(((n,r)=>t(r,n,e)))}function Wo(e){const t=e[Mo];return t?t.type_:Array.isArray(e)?1:Ko(e)?2:Yo(e)?3:0}function Bo(e,t){return 2===Wo(e)?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function Ho(e,t){return 2===Wo(e)?e.get(t):e[t]}function Qo(e,t,n){const r=Wo(e);2===r?e.set(t,n):3===r?e.add(n):e[t]=n}function Ko(e){return e instanceof Map}function Yo(e){return e instanceof Set}function Go(e){return e.copy_||e.base_}function Jo(e,t){if(Ko(e))return new Map(e);if(Yo(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);const n=Uo(e);if(!0===t||"class_only"===t&&!n){const t=Object.getOwnPropertyDescriptors(e);delete t[Mo];let n=Reflect.ownKeys(t);for(let r=0;r<n.length;r++){const i=n[r],s=t[i];!1===s.writable&&(s.writable=!0,s.configurable=!0),(s.get||s.set)&&(t[i]={configurable:!0,writable:!0,enumerable:s.enumerable,value:e[i]})}return Object.create(Fo(e),t)}{const t=Fo(e);if(null!==t&&n)return{...e};const r=Object.create(t);return Object.assign(r,e)}}function Xo(e,t=!1){return ea(e)||Lo(e)||!$o(e)||(Wo(e)>1&&(e.set=e.add=e.clear=e.delete=Zo),Object.freeze(e),t&&Object.entries(e).forEach((([e,t])=>Xo(t,!0)))),e}function Zo(){jo(2)}function ea(e){return Object.isFrozen(e)}var ta,na={};function ra(e){const t=na[e];return t||jo(0,e),t}function ia(){return ta}function sa(e,t){t&&(ra("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function oa(e){aa(e),e.drafts_.forEach(la),e.drafts_=null}function aa(e){e===ta&&(ta=e.parent_)}function ca(e){return ta={drafts_:[],parent_:ta,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function la(e){const t=e[Mo];0===t.type_||1===t.type_?t.revoke_():t.revoked_=!0}function ua(e,t){t.unfinalizedDrafts_=t.drafts_.length;const n=t.drafts_[0];return void 0!==e&&e!==n?(n[Mo].modified_&&(oa(t),jo(4)),$o(e)&&(e=da(t,e),t.parent_||pa(t,e)),t.patches_&&ra("Patches").generateReplacementPatches_(n[Mo].base_,e,t.patches_,t.inversePatches_)):e=da(t,n,[]),oa(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==xo?e:void 0}function da(e,t,n){if(ea(t))return t;const r=t[Mo];if(!r)return zo(t,((i,s)=>ha(e,r,t,i,s,n))),t;if(r.scope_!==e)return t;if(!r.modified_)return pa(e,r.base_,!0),r.base_;if(!r.finalized_){r.finalized_=!0,r.scope_.unfinalizedDrafts_--;const t=r.copy_;let i=t,s=!1;3===r.type_&&(i=new Set(t),t.clear(),s=!0),zo(i,((i,o)=>ha(e,r,t,i,o,n,s))),pa(e,t,!1),n&&e.patches_&&ra("Patches").generatePatches_(r,n,e.patches_,e.inversePatches_)}return r.copy_}function ha(e,t,n,r,i,s,o){if("production"!==process.env.NODE_ENV&&i===n&&jo(5),Lo(i)){const o=da(e,i,s&&t&&3!==t.type_&&!Bo(t.assigned_,r)?s.concat(r):void 0);if(Qo(n,r,o),!Lo(o))return;e.canAutoFreeze_=!1}else o&&n.add(i);if($o(i)&&!ea(i)){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1)return;da(e,i),t&&t.scope_.parent_||"symbol"==typeof r||!Object.prototype.propertyIsEnumerable.call(n,r)||pa(e,i)}}function pa(e,t,n=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&Xo(t,n)}var fa={get(e,t){if(t===Mo)return e;const n=Go(e);if(!Bo(n,t))return function(e,t,n){const r=ga(t,n);return r?"value"in r?r.value:r.get?.call(e.draft_):void 0}(e,n,t);const r=n[t];return e.finalized_||!$o(r)?r:r===ma(e.base_,t)?(va(e),e.copy_[t]=ba(r,e)):r},has:(e,t)=>t in Go(e),ownKeys:e=>Reflect.ownKeys(Go(e)),set(e,t,n){const r=ga(Go(e),t);if(r?.set)return r.set.call(e.draft_,n),!0;if(!e.modified_){const r=ma(Go(e),t),o=r?.[Mo];if(o&&o.base_===n)return e.copy_[t]=n,e.assigned_[t]=!1,!0;if(((i=n)===(s=r)?0!==i||1/i==1/s:i!=i&&s!=s)&&(void 0!==n||Bo(e.base_,t)))return!0;va(e),ya(e)}var i,s;return e.copy_[t]===n&&(void 0!==n||t in e.copy_)||Number.isNaN(n)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=n,e.assigned_[t]=!0),!0},deleteProperty:(e,t)=>(void 0!==ma(e.base_,t)||t in e.base_?(e.assigned_[t]=!1,va(e),ya(e)):delete e.assigned_[t],e.copy_&&delete e.copy_[t],!0),getOwnPropertyDescriptor(e,t){const n=Go(e),r=Reflect.getOwnPropertyDescriptor(n,t);return r?{writable:!0,configurable:1!==e.type_||"length"!==t,enumerable:r.enumerable,value:n[t]}:r},defineProperty(){jo(11)},getPrototypeOf:e=>Fo(e.base_),setPrototypeOf(){jo(12)}},_a={};function ma(e,t){const n=e[Mo];return(n?Go(n):e)[t]}function ga(e,t){if(!(t in e))return;let n=Fo(e);for(;n;){const e=Object.getOwnPropertyDescriptor(n,t);if(e)return e;n=Fo(n)}}function ya(e){e.modified_||(e.modified_=!0,e.parent_&&ya(e.parent_))}function va(e){e.copy_||(e.copy_=Jo(e.base_,e.scope_.immer_.useStrictShallowCopy_))}zo(fa,((e,t)=>{_a[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}})),_a.deleteProperty=function(e,t){return"production"!==process.env.NODE_ENV&&isNaN(parseInt(t))&&jo(13),_a.set.call(this,e,t,void 0)},_a.set=function(e,t,n){return"production"!==process.env.NODE_ENV&&"length"!==t&&isNaN(parseInt(t))&&jo(14),fa.set.call(this,e[0],t,n,e[0])};function ba(e,t){const n=Ko(e)?ra("MapSet").proxyMap_(e,t):Yo(e)?ra("MapSet").proxySet_(e,t):function(e,t){const n=Array.isArray(e),r={type_:n?1:0,scope_:t?t.scope_:ia(),modified_:!1,finalized_:!1,assigned_:{},parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1};let i=r,s=fa;n&&(i=[r],s=_a);const{revoke:o,proxy:a}=Proxy.revocable(i,s);return r.draft_=a,r.revoke_=o,a}(e,t);return(t?t.scope_:ia()).drafts_.push(n),n}function wa(e){if(!$o(e)||ea(e))return e;const t=e[Mo];let n;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,n=Jo(e,t.scope_.immer_.useStrictShallowCopy_)}else n=Jo(e,!0);return zo(n,((e,t)=>{Qo(n,e,wa(t))})),t&&(t.finalized_=!1),n}function Ca(){"production"!==process.env.NODE_ENV&&qo.push('Sets cannot have "replace" patches.',(function(e){return"Unsupported patch operation: "+e}),(function(e){return"Cannot apply patch, path doesn't resolve: "+e}),"Patching reserved attributes like __proto__, prototype and constructor is not allowed");const e="replace",t="add",n="remove";function r(e){if(!$o(e))return e;if(Array.isArray(e))return e.map(r);if(Ko(e))return new Map(Array.from(e.entries()).map((([e,t])=>[e,r(t)])));if(Yo(e))return new Set(Array.from(e).map(r));const t=Object.create(Fo(e));for(const n in e)t[n]=r(e[n]);return Bo(e,Ao)&&(t[Ao]=e[Ao]),t}function i(e){return Lo(e)?r(e):e}var s,o;o={applyPatches_:function(i,s){return s.forEach((s=>{const{path:o,op:a}=s;let c=i;for(let e=0;e<o.length-1;e++){const t=Wo(c);let n=o[e];"string"!=typeof n&&"number"!=typeof n&&(n=""+n),0!==t&&1!==t||"__proto__"!==n&&"constructor"!==n||jo(19),"function"==typeof c&&"prototype"===n&&jo(19),c=Ho(c,n),"object"!=typeof c&&jo(18,o.join("/"))}const l=Wo(c),u=r(s.value),d=o[o.length-1];switch(a){case e:switch(l){case 2:return c.set(d,u);case 3:jo(16);default:return c[d]=u}case t:switch(l){case 1:return"-"===d?c.push(u):c.splice(d,0,u);case 2:return c.set(d,u);case 3:return c.add(u);default:return c[d]=u}case n:switch(l){case 1:return c.splice(d,1);case 2:return c.delete(d);case 3:return c.delete(s.value);default:return delete c[d]}default:jo(17,a)}})),i},generatePatches_:function(r,s,o,a){switch(r.type_){case 0:case 2:return function(r,s,o,a){const{base_:c,copy_:l}=r;zo(r.assigned_,((r,u)=>{const d=Ho(c,r),h=Ho(l,r),p=u?Bo(c,r)?e:t:n;if(d===h&&p===e)return;const f=s.concat(r);o.push(p===n?{op:p,path:f}:{op:p,path:f,value:h}),a.push(p===t?{op:n,path:f}:p===n?{op:t,path:f,value:i(d)}:{op:e,path:f,value:i(d)})}))}(r,s,o,a);case 1:return function(r,s,o,a){let{base_:c,assigned_:l}=r,u=r.copy_;u.length<c.length&&([c,u]=[u,c],[o,a]=[a,o]);for(let t=0;t<c.length;t++)if(l[t]&&u[t]!==c[t]){const n=s.concat([t]);o.push({op:e,path:n,value:i(u[t])}),a.push({op:e,path:n,value:i(c[t])})}for(let e=c.length;e<u.length;e++){const n=s.concat([e]);o.push({op:t,path:n,value:i(u[e])})}for(let e=u.length-1;c.length<=e;--e){const t=s.concat([e]);a.push({op:n,path:t})}}(r,s,o,a);case 3:return function(e,r,i,s){let{base_:o,copy_:a}=e,c=0;o.forEach((e=>{if(!a.has(e)){const o=r.concat([c]);i.push({op:n,path:o,value:e}),s.unshift({op:t,path:o,value:e})}c++})),c=0,a.forEach((e=>{if(!o.has(e)){const o=r.concat([c]);i.push({op:t,path:o,value:e}),s.unshift({op:n,path:o,value:e})}c++}))}(r,s,o,a)}},generateReplacementPatches_:function(t,n,r,i){r.push({op:e,path:[],value:n===xo?void 0:n}),i.push({op:e,path:[],value:t})}},na[s="Patches"]||(na[s]=o)}var Ea=new class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(e,t,n)=>{if("function"==typeof e&&"function"!=typeof t){const n=t;t=e;const r=this;return function(e=n,...i){return r.produce(e,(e=>t.call(this,e,...i)))}}let r;if("function"!=typeof t&&jo(6),void 0!==n&&"function"!=typeof n&&jo(7),$o(e)){const i=ca(this),s=ba(e,void 0);let o=!0;try{r=t(s),o=!1}finally{o?oa(i):aa(i)}return sa(i,n),ua(r,i)}if(!e||"object"!=typeof e){if(r=t(e),void 0===r&&(r=e),r===xo&&(r=void 0),this.autoFreeze_&&Xo(r,!0),n){const t=[],i=[];ra("Patches").generateReplacementPatches_(e,r,t,i),n(t,i)}return r}jo(1,e)},this.produceWithPatches=(e,t)=>{if("function"==typeof e)return(t,...n)=>this.produceWithPatches(t,(t=>e(t,...n)));let n,r;return[this.produce(e,t,((e,t)=>{n=e,r=t})),n,r]},"boolean"==typeof e?.autoFreeze&&this.setAutoFreeze(e.autoFreeze),"boolean"==typeof e?.useStrictShallowCopy&&this.setUseStrictShallowCopy(e.useStrictShallowCopy)}createDraft(e){$o(e)||jo(8),Lo(e)&&(e=function(e){Lo(e)||jo(10,e);return wa(e)}(e));const t=ca(this),n=ba(e,void 0);return n[Mo].isManual_=!0,aa(t),n}finishDraft(e,t){const n=e&&e[Mo];n&&n.isManual_||jo(9);const{scope_:r}=n;return sa(r,t),ua(void 0,r)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}applyPatches(e,t){let n;for(n=t.length-1;n>=0;n--){const r=t[n];if(0===r.path.length&&"replace"===r.op){e=r.value;break}}n>-1&&(t=t.slice(n+1));const r=ra("Patches").applyPatches_;return Lo(e)?r(e,t):this.produce(e,(e=>r(e,t)))}},Ia=Ea.produce,Sa=Ea.produceWithPatches.bind(Ea);Ea.setAutoFreeze.bind(Ea),Ea.setUseStrictShallowCopy.bind(Ea);var Ta=Ea.applyPatches.bind(Ea);Ea.createDraft.bind(Ea),Ea.finishDraft.bind(Ea);var Na=(e,t,n)=>{if(1===t.length&&t[0]===n){let t=!1;try{const n={};e(n)===n&&(t=!0)}catch{}if(t){let e;try{throw new Error}catch(t){({stack:e}=t)}console.warn("The result function returned its own inputs without modification. e.g\n`createSelector([state => state.todos], todos => todos)`\nThis could lead to inefficient memoization and unnecessary re-renders.\nEnsure transformation logic is in the result function, and extraction logic is in the input selectors.",{stack:e})}}},ka=(e,t,n)=>{const{memoize:r,memoizeOptions:i}=t,{inputSelectorResults:s,inputSelectorResultsCopy:o}=e,a=r((()=>({})),...i);if(!(a.apply(null,s)===a.apply(null,o))){let e;try{throw new Error}catch(t){({stack:e}=t)}console.warn("An input selector returned a different result when passed same arguments.\nThis means your output selector will likely run more frequently than intended.\nAvoid returning a new reference inside your input selector, e.g.\n`createSelector([state => state.todos.map(todo => todo.id)], todoIds => todoIds.length)`",{arguments:n,firstInputs:s,secondInputs:o,stack:e})}},Da={inputStabilityCheck:"once",identityFunctionCheck:"once"};var Pa=e=>Array.isArray(e)?e:[e];function Ra(e){const t=Array.isArray(e[0])?e[0]:e;return function(e,t="expected all items to be functions, instead received the following types: "){if(!e.every((e=>"function"==typeof e))){const n=e.map((e=>"function"==typeof e?`function ${e.name||"unnamed"}()`:typeof e)).join(", ");throw new TypeError(`${t}[${n}]`)}}(t,"createSelector expects all input-selectors to be functions, but received the following types: "),t}function Oa(e,t){const n=[],{length:r}=e;for(let i=0;i<r;i++)n.push(e[i].apply(null,t));return n}var xa="undefined"!=typeof WeakRef?WeakRef:class{constructor(e){this.value=e}deref(){return this.value}};function Aa(e,t={}){let n={s:0,v:void 0,o:null,p:null};const{resultEqualityCheck:r}=t;let i,s=0;function o(){let t=n;const{length:o}=arguments;for(let e=0,n=o;e<n;e++){const n=arguments[e];if("function"==typeof n||"object"==typeof n&&null!==n){let e=t.o;null===e&&(t.o=e=new WeakMap);const r=e.get(n);void 0===r?(t={s:0,v:void 0,o:null,p:null},e.set(n,t)):t=r}else{let e=t.p;null===e&&(t.p=e=new Map);const r=e.get(n);void 0===r?(t={s:0,v:void 0,o:null,p:null},e.set(n,t)):t=r}}const a=t;let c;if(1===t.s)c=t.v;else if(c=e.apply(null,arguments),s++,r){const e=i?.deref?.()??i;null!=e&&r(e,c)&&(c=e,0!==s&&s--);i="object"==typeof c&&null!==c||"function"==typeof c?new xa(c):c}return a.s=1,a.v=c,c}return o.clearCache=()=>{n={s:0,v:void 0,o:null,p:null},o.resetResultsCount()},o.resultsCount=()=>s,o.resetResultsCount=()=>{s=0},o}function Ma(e,...t){const n="function"==typeof e?{memoize:e,memoizeOptions:t}:e,r=(...e)=>{let t,r=0,i=0,s={},o=e.pop();"object"==typeof o&&(s=o,o=e.pop()),function(e,t="expected a function, instead received "+typeof e){if("function"!=typeof e)throw new TypeError(t)}(o,`createSelector expects an output function after the inputs, but received: [${typeof o}]`);const a={...n,...s},{memoize:c,memoizeOptions:l=[],argsMemoize:u=Aa,argsMemoizeOptions:d=[],devModeChecks:h={}}=a,p=Pa(l),f=Pa(d),_=Ra(e),m=c((function(){return r++,o.apply(null,arguments)}),...p);let g=!0;const y=u((function(){i++;const e=Oa(_,arguments);if(t=m.apply(null,e),"production"!==process.env.NODE_ENV){const{identityFunctionCheck:n,inputStabilityCheck:r}=((e,t)=>{const{identityFunctionCheck:n,inputStabilityCheck:r}={...Da,...t};return{identityFunctionCheck:{shouldRun:"always"===n||"once"===n&&e,run:Na},inputStabilityCheck:{shouldRun:"always"===r||"once"===r&&e,run:ka}}})(g,h);if(n.shouldRun&&n.run(o,e,t),r.shouldRun){const t=Oa(_,arguments);r.run({inputSelectorResults:e,inputSelectorResultsCopy:t},{memoize:c,memoizeOptions:p},arguments)}g&&(g=!1)}return t}),...f);return Object.assign(y,{resultFunc:o,memoizedResultFunc:m,dependencies:_,dependencyRecomputations:()=>i,resetDependencyRecomputations:()=>{i=0},lastResult:()=>t,recomputations:()=>r,resetRecomputations:()=>{r=0},memoize:c,argsMemoize:u})};return Object.assign(r,{withTypes:()=>r}),r}var qa=Ma(Aa),ja=Object.assign(((e,t=qa)=>{!function(e,t="expected an object, instead received "+typeof e){if("object"!=typeof e)throw new TypeError(t)}(e,"createStructuredSelector expects first argument to be an object where each property is a selector, instead received a "+typeof e);const n=Object.keys(e),r=t(n.map((t=>e[t])),((...e)=>e.reduce(((e,t,r)=>(e[n[r]]=t,e)),{})));return r}),{withTypes:()=>ja});function Fa(e){return({dispatch:t,getState:n})=>r=>i=>"function"==typeof i?i(t,n,e):r(i)}var La=Fa(),$a=Fa,Va="undefined"!=typeof window&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(0!==arguments.length)return"object"==typeof arguments[0]?Ro:Ro.apply(null,arguments)},Ua=e=>e&&"function"==typeof e.match;function za(e,t){function n(...n){if(t){let r=t(...n);if(!r)throw new Error("production"===process.env.NODE_ENV?xc(0):"prepareAction did not return an object");return{type:e,payload:r.payload,..."meta"in r&&{meta:r.meta},..."error"in r&&{error:r.error}}}return{type:e,payload:n[0]}}return n.toString=()=>`${e}`,n.type=e,n.match=t=>Oo(t)&&t.type===e,n}function Wa(e){return"function"==typeof e&&"type"in e&&Ua(e)}function Ba(e,t){let n=0;return{measureTime(e){const t=Date.now();try{return e()}finally{const e=Date.now();n+=e-t}},warnIfExceeded(){n>e&&console.warn(`${t} took ${n}ms, which is more than the warning threshold of ${e}ms. \nIf your state or actions are very large, you may want to disable the middleware as it might cause too much of a slowdown in development mode. See https://redux-toolkit.js.org/api/getDefaultMiddleware for instructions.\nIt is disabled in production builds, so you don't need to worry about that.`)}}}var Ha=class e extends Array{constructor(...t){super(...t),Object.setPrototypeOf(this,e.prototype)}static get[Symbol.species](){return e}concat(...e){return super.concat.apply(this,e)}prepend(...t){return 1===t.length&&Array.isArray(t[0])?new e(...t[0].concat(this)):new e(...t.concat(this))}};function Qa(e){return $o(e)?Ia(e,(()=>{})):e}function Ka(e,t,n){if(e.has(t)){let r=e.get(t);return n.update&&(r=n.update(r,t,e),e.set(t,r)),r}if(!n.insert)throw new Error("production"===process.env.NODE_ENV?xc(10):"No insert provided for key not already in map");const r=n.insert(t,e);return e.set(t,r),r}function Ya(e){return"object"!=typeof e||null==e||Object.isFrozen(e)}function Ga(e,t,n){const r=Ja(e,t,n);return{detectMutations:()=>Xa(e,t,r,n)}}function Ja(e,t=[],n,r="",i=new Set){const s={value:n};if(!e(n)&&!i.has(n)){i.add(n),s.children={};for(const i in n){const o=r?r+"."+i:i;t.length&&-1!==t.indexOf(o)||(s.children[i]=Ja(e,t,n[i],o))}}return s}function Xa(e,t=[],n,r,i=!1,s=""){const o=n?n.value:void 0,a=o===r;if(i&&!a&&!Number.isNaN(r))return{wasMutated:!0,path:s};if(e(o)||e(r))return{wasMutated:!1};const c={};for(let e in n.children)c[e]=!0;for(let e in r)c[e]=!0;const l=t.length>0;for(let i in c){const o=s?s+"."+i:i;if(l){if(t.some((e=>e instanceof RegExp?e.test(o):o===e)))continue}const c=Xa(e,t,n.children[i],r[i],a,o);if(c.wasMutated)return c}return{wasMutated:!1}}function Za(e){const t=typeof e;return null==e||"string"===t||"boolean"===t||"number"===t||Array.isArray(e)||So(e)}function ec(e,t="",n=Za,r,i=[],s){let o;if(!n(e))return{keyPath:t||"<root>",value:e};if("object"!=typeof e||null===e)return!1;if(s?.has(e))return!1;const a=null!=r?r(e):Object.entries(e),c=i.length>0;for(const[e,l]of a){const a=t?t+"."+e:e;if(c){if(i.some((e=>e instanceof RegExp?e.test(a):a===e)))continue}if(!n(l))return{keyPath:a,value:l};if("object"==typeof l&&(o=ec(l,a,n,r,i,s),o))return o}return s&&tc(e)&&s.add(e),!1}function tc(e){if(!Object.isFrozen(e))return!1;for(const t of Object.values(e))if("object"==typeof t&&null!==t&&!tc(t))return!1;return!0}function nc(e){return"boolean"==typeof e}var rc=()=>function(e){const{thunk:t=!0,immutableCheck:n=!0,serializableCheck:r=!0,actionCreatorCheck:i=!0}=e??{};let s=new Ha;if(t&&(nc(t)?s.push(La):s.push($a(t.extraArgument))),"production"!==process.env.NODE_ENV){if(n){let e={};nc(n)||(e=n),s.unshift(function(e={}){if("production"===process.env.NODE_ENV)return()=>e=>t=>e(t);{let t=function(e,t,r,i){return JSON.stringify(e,n(t,i),r)},n=function(e,t){let n=[],r=[];return t||(t=function(e,t){return n[0]===t?"[Circular ~]":"[Circular ~."+r.slice(0,n.indexOf(t)).join(".")+"]"}),function(i,s){if(n.length>0){var o=n.indexOf(this);~o?n.splice(o+1):n.push(this),~o?r.splice(o,1/0,i):r.push(i),~n.indexOf(s)&&(s=t.call(this,i,s))}else n.push(s);return null==e?s:e.call(this,i,s)}},{isImmutable:r=Ya,ignoredPaths:i,warnAfter:s=32}=e;const o=Ga.bind(null,r,i);return({getState:e})=>{let n,r=e(),i=o(r);return a=>c=>{const l=Ba(s,"ImmutableStateInvariantMiddleware");l.measureTime((()=>{if(r=e(),n=i.detectMutations(),i=o(r),n.wasMutated)throw new Error("production"===process.env.NODE_ENV?xc(19):`A state mutation was detected between dispatches, in the path '${n.path||""}'.  This may cause incorrect behavior. (https://redux.js.org/style-guide/style-guide#do-not-mutate-state)`)}));const u=a(c);return l.measureTime((()=>{if(r=e(),n=i.detectMutations(),i=o(r),n.wasMutated)throw new Error("production"===process.env.NODE_ENV?xc(20):`A state mutation was detected inside a dispatch, in the path: ${n.path||""}. Take a look at the reducer(s) handling the action ${t(c)}. (https://redux.js.org/style-guide/style-guide#do-not-mutate-state)`)})),l.warnIfExceeded(),u}}}}(e))}if(r){let e={};nc(r)||(e=r),s.push(function(e={}){if("production"===process.env.NODE_ENV)return()=>e=>t=>e(t);{const{isSerializable:t=Za,getEntries:n,ignoredActions:r=[],ignoredActionPaths:i=["meta.arg","meta.baseQueryMeta"],ignoredPaths:s=[],warnAfter:o=32,ignoreState:a=!1,ignoreActions:c=!1,disableCache:l=!1}=e,u=!l&&WeakSet?new WeakSet:void 0;return e=>l=>d=>{if(!Oo(d))return l(d);const h=l(d),p=Ba(o,"SerializableStateInvariantMiddleware");return c||r.length&&-1!==r.indexOf(d.type)||p.measureTime((()=>{const e=ec(d,"",t,n,i,u);if(e){const{keyPath:t,value:n}=e;console.error(`A non-serializable value was detected in an action, in the path: \`${t}\`. Value:`,n,"\nTake a look at the logic that dispatched this action: ",d,"\n(See https://redux.js.org/faq/actions#why-should-type-be-a-string-or-at-least-serializable-why-should-my-action-types-be-constants)","\n(To allow non-serializable values see: https://redux-toolkit.js.org/usage/usage-guide#working-with-non-serializable-data)")}})),a||(p.measureTime((()=>{const r=ec(e.getState(),"",t,n,s,u);if(r){const{keyPath:e,value:t}=r;console.error(`A non-serializable value was detected in the state, in the path: \`${e}\`. Value:`,t,`\nTake a look at the reducer(s) handling this action type: ${d.type}.\n(See https://redux.js.org/faq/organizing-state#can-i-put-functions-promises-or-other-non-serializable-items-in-my-store-state)`)}})),p.warnIfExceeded()),h}}}(e))}if(i){let e={};nc(i)||(e=i),s.unshift(function(e={}){if("production"===process.env.NODE_ENV)return()=>e=>t=>e(t);const{isActionCreator:t=Wa}=e;return()=>e=>n=>(t(n)&&console.warn(function(e){const t=e?`${e}`.split("/"):[],n=t[t.length-1]||"actionCreator";return`Detected an action creator with type "${e||"unknown"}" being dispatched. \nMake sure you're calling the action creator before dispatching, i.e. \`dispatch(${n}())\` instead of \`dispatch(${n})\`. This is necessary even if the action has no payload.`}(n.type)),e(n))}(e))}}return s},ic="RTK_autoBatch",sc=()=>e=>({payload:e,meta:{[ic]:!0}}),oc=e=>t=>{setTimeout(t,e)},ac="undefined"!=typeof window&&window.requestAnimationFrame?window.requestAnimationFrame:oc(10),cc=e=>function(t){const{autoBatch:n=!0}=t??{};let r=new Ha(e);return n&&r.push(((e={type:"raf"})=>t=>(...n)=>{const r=t(...n);let i=!0,s=!1,o=!1;const a=new Set,c="tick"===e.type?queueMicrotask:"raf"===e.type?ac:"callback"===e.type?e.queueNotification:oc(e.timeout),l=()=>{o=!1,s&&(s=!1,a.forEach((e=>e())))};return Object.assign({},r,{subscribe(e){const t=r.subscribe((()=>i&&e()));return a.add(e),()=>{t(),a.delete(e)}},dispatch(e){try{return i=!e?.meta?.[ic],s=!i,s&&(o||(o=!0,c(l))),r.dispatch(e)}finally{i=!0}}})})("object"==typeof n?n:void 0)),r};function lc(e){const t={},n=[];let r;const i={addCase(e,s){if("production"!==process.env.NODE_ENV){if(n.length>0)throw new Error("production"===process.env.NODE_ENV?xc(26):"`builder.addCase` should only be called before calling `builder.addMatcher`");if(r)throw new Error("production"===process.env.NODE_ENV?xc(27):"`builder.addCase` should only be called before calling `builder.addDefaultCase`")}const o="string"==typeof e?e:e.type;if(!o)throw new Error("production"===process.env.NODE_ENV?xc(28):"`builder.addCase` cannot be called with an empty action type");if(o in t)throw new Error("production"===process.env.NODE_ENV?xc(29):`\`builder.addCase\` cannot be called with two reducers for the same action type '${o}'`);return t[o]=s,i},addMatcher(e,t){if("production"!==process.env.NODE_ENV&&r)throw new Error("production"===process.env.NODE_ENV?xc(30):"`builder.addMatcher` should only be called before calling `builder.addDefaultCase`");return n.push({matcher:e,reducer:t}),i},addDefaultCase(e){if("production"!==process.env.NODE_ENV&&r)throw new Error("production"===process.env.NODE_ENV?xc(31):"`builder.addDefaultCase` can only be called once");return r=e,i}};return e(i),[t,n,r]}var uc=(e,t)=>Ua(e)?e.match(t):e(t);function dc(...e){return t=>e.some((e=>uc(e,t)))}function hc(...e){return t=>e.every((e=>uc(e,t)))}function pc(e,t){if(!e||!e.meta)return!1;const n="string"==typeof e.meta.requestId,r=t.indexOf(e.meta.requestStatus)>-1;return n&&r}function fc(e){return"function"==typeof e[0]&&"pending"in e[0]&&"fulfilled"in e[0]&&"rejected"in e[0]}function _c(...e){return 0===e.length?e=>pc(e,["pending"]):fc(e)?dc(...e.map((e=>e.pending))):_c()(e[0])}function mc(...e){return 0===e.length?e=>pc(e,["rejected"]):fc(e)?dc(...e.map((e=>e.rejected))):mc()(e[0])}function gc(...e){const t=e=>e&&e.meta&&e.meta.rejectedWithValue;return 0===e.length||fc(e)?hc(mc(...e),t):gc()(e[0])}function yc(...e){return 0===e.length?e=>pc(e,["fulfilled"]):fc(e)?dc(...e.map((e=>e.fulfilled))):yc()(e[0])}function vc(...e){return 0===e.length?e=>pc(e,["pending","fulfilled","rejected"]):fc(e)?dc(...e.flatMap((e=>[e.pending,e.rejected,e.fulfilled]))):vc()(e[0])}var bc=(e=21)=>{let t="",n=e;for(;n--;)t+="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW"[64*Math.random()|0];return t},wc=["name","message","stack","code"],Cc=class{constructor(e,t){this.payload=e,this.meta=t}_type},Ec=class{constructor(e,t){this.payload=e,this.meta=t}_type},Ic=e=>{if("object"==typeof e&&null!==e){const t={};for(const n of wc)"string"==typeof e[n]&&(t[n]=e[n]);return t}return{message:String(e)}},Sc=(()=>{function e(e,t,n){const r=za(e+"/fulfilled",((e,t,n,r)=>({payload:e,meta:{...r||{},arg:n,requestId:t,requestStatus:"fulfilled"}}))),i=za(e+"/pending",((e,t,n)=>({payload:void 0,meta:{...n||{},arg:t,requestId:e,requestStatus:"pending"}}))),s=za(e+"/rejected",((e,t,r,i,s)=>({payload:i,error:(n&&n.serializeError||Ic)(e||"Rejected"),meta:{...s||{},arg:r,requestId:t,rejectedWithValue:!!i,requestStatus:"rejected",aborted:"AbortError"===e?.name,condition:"ConditionError"===e?.name}})));return Object.assign((function(e){return(o,a,c)=>{const l=n?.idGenerator?n.idGenerator(e):bc(),u=new AbortController;let d,h;function p(e){h=e,u.abort()}const f=async function(){let f;try{let s=n?.condition?.(e,{getState:a,extra:c});if(null!==(_=s)&&"object"==typeof _&&"function"==typeof _.then&&(s=await s),!1===s||u.signal.aborted)throw{name:"ConditionError",message:"Aborted due to condition callback returning false."};const m=new Promise(((e,t)=>{d=()=>{t({name:"AbortError",message:h||"Aborted"})},u.signal.addEventListener("abort",d)}));o(i(l,e,n?.getPendingMeta?.({requestId:l,arg:e},{getState:a,extra:c}))),f=await Promise.race([m,Promise.resolve(t(e,{dispatch:o,getState:a,extra:c,requestId:l,signal:u.signal,abort:p,rejectWithValue:(e,t)=>new Cc(e,t),fulfillWithValue:(e,t)=>new Ec(e,t)})).then((t=>{if(t instanceof Cc)throw t;return t instanceof Ec?r(t.payload,l,e,t.meta):r(t,l,e)}))])}catch(t){f=t instanceof Cc?s(null,l,e,t.payload,t.meta):s(t,l,e)}finally{d&&u.signal.removeEventListener("abort",d)}var _;return n&&!n.dispatchConditionRejection&&s.match(f)&&f.meta.condition||o(f),f}();return Object.assign(f,{abort:p,requestId:l,arg:e,unwrap:()=>f.then(Tc)})}}),{pending:i,rejected:s,fulfilled:r,settled:dc(s,r),typePrefix:e})}return e.withTypes=()=>e,e})();function Tc(e){if(e.meta&&e.meta.rejectedWithValue)throw e.payload;if(e.error)throw e.error;return e.payload}var Nc=Symbol.for("rtk-slice-createasyncthunk");function kc(e,t){return`${e}/${t}`}function Dc({creators:e}={}){const t=e?.asyncThunk?.[Nc];return function(e){const{name:n,reducerPath:r=n}=e;if(!n)throw new Error("production"===process.env.NODE_ENV?xc(11):"`name` is a required option for createSlice");"undefined"!=typeof process&&"development"===process.env.NODE_ENV&&void 0===e.initialState&&console.error("You must provide an `initialState` value that is not `undefined`. You may have misspelled `initialState`");const i=("function"==typeof e.reducers?e.reducers(function(){function e(e,t){return{_reducerDefinitionType:"asyncThunk",payloadCreator:e,...t}}return e.withTypes=()=>e,{reducer:e=>Object.assign({[e.name]:(...t)=>e(...t)}[e.name],{_reducerDefinitionType:"reducer"}),preparedReducer:(e,t)=>({_reducerDefinitionType:"reducerWithPrepare",prepare:e,reducer:t}),asyncThunk:e}}()):e.reducers)||{},s=Object.keys(i),o={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},a={addCase(e,t){const n="string"==typeof e?e:e.type;if(!n)throw new Error("production"===process.env.NODE_ENV?xc(12):"`context.addCase` cannot be called with an empty action type");if(n in o.sliceCaseReducersByType)throw new Error("production"===process.env.NODE_ENV?xc(13):"`context.addCase` cannot be called with two reducers for the same action type: "+n);return o.sliceCaseReducersByType[n]=t,a},addMatcher:(e,t)=>(o.sliceMatchers.push({matcher:e,reducer:t}),a),exposeAction:(e,t)=>(o.actionCreators[e]=t,a),exposeCaseReducer:(e,t)=>(o.sliceCaseReducersByName[e]=t,a)};function c(){if("production"!==process.env.NODE_ENV&&"object"==typeof e.extraReducers)throw new Error("production"===process.env.NODE_ENV?xc(14):"The object notation for `createSlice.extraReducers` has been removed. Please use the 'builder callback' notation instead: https://redux-toolkit.js.org/api/createSlice");const[t={},n=[],r]="function"==typeof e.extraReducers?lc(e.extraReducers):[e.extraReducers],i={...t,...o.sliceCaseReducersByType};return function(e,t){if("production"!==process.env.NODE_ENV&&"object"==typeof t)throw new Error("production"===process.env.NODE_ENV?xc(8):"The object notation for `createReducer` has been removed. Please use the 'builder callback' notation instead: https://redux-toolkit.js.org/api/createReducer");let n,[r,i,s]=lc(t);if("function"==typeof e)n=()=>Qa(e());else{const t=Qa(e);n=()=>t}function o(e=n(),t){let o=[r[t.type],...i.filter((({matcher:e})=>e(t))).map((({reducer:e})=>e))];return 0===o.filter((e=>!!e)).length&&(o=[s]),o.reduce(((e,n)=>{if(n){if(Lo(e)){const r=n(e,t);return void 0===r?e:r}if($o(e))return Ia(e,(e=>n(e,t)));{const r=n(e,t);if(void 0===r){if(null===e)return e;throw Error("A case reducer on a non-draftable value must not return undefined")}return r}}return e}),e)}return o.getInitialState=n,o}(e.initialState,(e=>{for(let t in i)e.addCase(t,i[t]);for(let t of o.sliceMatchers)e.addMatcher(t.matcher,t.reducer);for(let t of n)e.addMatcher(t.matcher,t.reducer);r&&e.addDefaultCase(r)}))}s.forEach((r=>{const s=i[r],o={reducerName:r,type:kc(n,r),createNotation:"function"==typeof e.reducers};!function(e){return"asyncThunk"===e._reducerDefinitionType}(s)?function({type:e,reducerName:t,createNotation:n},r,i){let s,o;if("reducer"in r){if(n&&!function(e){return"reducerWithPrepare"===e._reducerDefinitionType}(r))throw new Error("production"===process.env.NODE_ENV?xc(17):"Please use the `create.preparedReducer` notation for prepared action creators with the `create` notation.");s=r.reducer,o=r.prepare}else s=r;i.addCase(e,s).exposeCaseReducer(t,s).exposeAction(t,o?za(e,o):za(e))}(o,s,a):function({type:e,reducerName:t},n,r,i){if(!i)throw new Error("production"===process.env.NODE_ENV?xc(18):"Cannot use `create.asyncThunk` in the built-in `createSlice`. Use `buildCreateSlice({ creators: { asyncThunk: asyncThunkCreator } })` to create a customised version of `createSlice`.");const{payloadCreator:s,fulfilled:o,pending:a,rejected:c,settled:l,options:u}=n,d=i(e,s,u);r.exposeAction(t,d),o&&r.addCase(d.fulfilled,o);a&&r.addCase(d.pending,a);c&&r.addCase(d.rejected,c);l&&r.addMatcher(d.settled,l);r.exposeCaseReducer(t,{fulfilled:o||Oc,pending:a||Oc,rejected:c||Oc,settled:l||Oc})}(o,s,a,t)}));const l=e=>e,u=new Map;let d;function h(e,t){return d||(d=c()),d(e,t)}function p(){return d||(d=c()),d.getInitialState()}function f(t,n=!1){function r(e){let r=e[t];if(void 0===r)if(n)r=p();else if("production"!==process.env.NODE_ENV)throw new Error("production"===process.env.NODE_ENV?xc(15):"selectSlice returned undefined for an uninjected slice reducer");return r}function i(t=l){const r=Ka(u,n,{insert:()=>new WeakMap});return Ka(r,t,{insert:()=>{const r={};for(const[i,s]of Object.entries(e.selectors??{}))r[i]=Pc(s,t,p,n);return r}})}return{reducerPath:t,getSelectors:i,get selectors(){return i(r)},selectSlice:r}}const _={name:n,reducer:h,actions:o.actionCreators,caseReducers:o.sliceCaseReducersByName,getInitialState:p,...f(r),injectInto(e,{reducerPath:t,...n}={}){const i=t??r;return e.inject({reducerPath:i,reducer:h},n),{..._,...f(i,!0)}}};return _}}function Pc(e,t,n,r){function i(i,...s){let o=t(i);if(void 0===o)if(r)o=n();else if("production"!==process.env.NODE_ENV)throw new Error("production"===process.env.NODE_ENV?xc(16):"selectState returned undefined for an uninjected slice reducer");return e(o,...s)}return i.unwrapped=e,i}var Rc=Dc();function Oc(){}function xc(e){return`Minified Redux Toolkit error #${e}; visit https://redux-toolkit.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var Ac=So;function Mc(e,t){if(e===t||!(Ac(e)&&Ac(t)||Array.isArray(e)&&Array.isArray(t)))return t;const n=Object.keys(t),r=Object.keys(e);let i=n.length===r.length;const s=Array.isArray(t)?[]:{};for(const r of n)s[r]=Mc(e[r],t[r]),i&&(i=e[r]===s[r]);return i?e:s}function qc(e){let t=0;for(const n in e)t++;return t}var jc=e=>[].concat(...e);function Fc(e){return null!=e}var Lc=class{constructor(e,t=void 0){this.value=e,this.meta=t}},$c=za("__rtkq/focused"),Vc=za("__rtkq/unfocused"),Uc=za("__rtkq/online"),zc=za("__rtkq/offline"),Wc=!1;function Bc(e){return"query"===e.type}function Hc(e,t,n,r,i,s){return"function"==typeof e?e(t,n,r,i).map(Qc).map(s):Array.isArray(e)?e.map(Qc).map(s):[]}function Qc(e){return"string"==typeof e?{type:e}:e}var Kc=Symbol("forceQueryFn"),Yc=e=>"function"==typeof e[Kc];function Gc(e){return e}function Jc(e,t,n,r){return Hc(n[e.meta.arg.endpointName][t],yc(e)?e.payload:void 0,gc(e)?e.payload:void 0,e.meta.arg.originalArgs,"baseQueryMeta"in e.meta?e.meta.baseQueryMeta:void 0,r)}function Xc(e,t,n){const r=e[t];r&&n(r)}function Zc(e){return("arg"in e?e.arg.fixedCacheKey:e.fixedCacheKey)??e.requestId}function el(e,t,n){const r=e[Zc(t)];r&&n(r)}var tl={};function nl({reducerPath:e,queryThunk:t,mutationThunk:n,context:{endpointDefinitions:r,apiUid:i,extractRehydrationInfo:s,hasRehydrationInfo:o},assertTagType:a,config:c}){const l=za(`${e}/resetApiState`),u=Rc({name:`${e}/queries`,initialState:tl,reducers:{removeQueryResult:{reducer(e,{payload:{queryCacheKey:t}}){delete e[t]},prepare:sc()},queryResultPatched:{reducer(e,{payload:{queryCacheKey:t,patches:n}}){Xc(e,t,(e=>{e.data=Ta(e.data,n.concat())}))},prepare:sc()}},extraReducers(e){e.addCase(t.pending,((e,{meta:t,meta:{arg:n}})=>{const r=Yc(n);e[n.queryCacheKey]??={status:"uninitialized",endpointName:n.endpointName},Xc(e,n.queryCacheKey,(e=>{e.status="pending",e.requestId=r&&e.requestId?e.requestId:t.requestId,void 0!==n.originalArgs&&(e.originalArgs=n.originalArgs),e.startedTimeStamp=t.startedTimeStamp}))})).addCase(t.fulfilled,((e,{meta:t,payload:n})=>{Xc(e,t.arg.queryCacheKey,(e=>{if(e.requestId!==t.requestId&&!Yc(t.arg))return;const{merge:i}=r[t.arg.endpointName];if(e.status="fulfilled",i)if(void 0!==e.data){const{fulfilledTimeStamp:r,arg:s,baseQueryMeta:o,requestId:a}=t;let c=Ia(e.data,(e=>i(e,n,{arg:s.originalArgs,baseQueryMeta:o,fulfilledTimeStamp:r,requestId:a})));e.data=c}else e.data=n;else e.data=r[t.arg.endpointName].structuralSharing??1?Mc(Lo(e.data)?(Lo(s=e.data)||jo(15,s),s[Mo].base_):e.data,n):n;var s;delete e.error,e.fulfilledTimeStamp=t.fulfilledTimeStamp}))})).addCase(t.rejected,((e,{meta:{condition:t,arg:n,requestId:r},error:i,payload:s})=>{Xc(e,n.queryCacheKey,(e=>{if(t);else{if(e.requestId!==r)return;e.status="rejected",e.error=s??i}}))})).addMatcher(o,((e,t)=>{const{queries:n}=s(t);for(const[t,r]of Object.entries(n))"fulfilled"!==r?.status&&"rejected"!==r?.status||(e[t]=r)}))}}),d=Rc({name:`${e}/mutations`,initialState:tl,reducers:{removeMutationResult:{reducer(e,{payload:t}){const n=Zc(t);n in e&&delete e[n]},prepare:sc()}},extraReducers(e){e.addCase(n.pending,((e,{meta:t,meta:{requestId:n,arg:r,startedTimeStamp:i}})=>{r.track&&(e[Zc(t)]={requestId:n,status:"pending",endpointName:r.endpointName,startedTimeStamp:i})})).addCase(n.fulfilled,((e,{payload:t,meta:n})=>{n.arg.track&&el(e,n,(e=>{e.requestId===n.requestId&&(e.status="fulfilled",e.data=t,e.fulfilledTimeStamp=n.fulfilledTimeStamp)}))})).addCase(n.rejected,((e,{payload:t,error:n,meta:r})=>{r.arg.track&&el(e,r,(e=>{e.requestId===r.requestId&&(e.status="rejected",e.error=t??n)}))})).addMatcher(o,((e,t)=>{const{mutations:n}=s(t);for(const[t,r]of Object.entries(n))"fulfilled"!==r?.status&&"rejected"!==r?.status||t===r?.requestId||(e[t]=r)}))}}),h=Rc({name:`${e}/invalidation`,initialState:tl,reducers:{updateProvidedBy:{reducer(e,t){const{queryCacheKey:n,providedTags:r}=t.payload;for(const t of Object.values(e))for(const e of Object.values(t)){const t=e.indexOf(n);-1!==t&&e.splice(t,1)}for(const{type:t,id:i}of r){const r=(e[t]??={})[i||"__internal_without_id"]??=[];r.includes(n)||r.push(n)}},prepare:sc()}},extraReducers(e){e.addCase(u.actions.removeQueryResult,((e,{payload:{queryCacheKey:t}})=>{for(const n of Object.values(e))for(const e of Object.values(n)){const n=e.indexOf(t);-1!==n&&e.splice(n,1)}})).addMatcher(o,((e,t)=>{const{provided:n}=s(t);for(const[t,r]of Object.entries(n))for(const[n,i]of Object.entries(r)){const r=(e[t]??={})[n||"__internal_without_id"]??=[];for(const e of i){r.includes(e)||r.push(e)}}})).addMatcher(dc(yc(t),gc(t)),((e,t)=>{const n=Jc(t,"providesTags",r,a),{queryCacheKey:i}=t.meta.arg;h.caseReducers.updateProvidedBy(e,h.actions.updateProvidedBy({queryCacheKey:i,providedTags:n}))}))}}),p=Rc({name:`${e}/subscriptions`,initialState:tl,reducers:{updateSubscriptionOptions(e,t){},unsubscribeQueryResult(e,t){},internal_getRTKQSubscriptions(){}}}),f=Rc({name:`${e}/internalSubscriptions`,initialState:tl,reducers:{subscriptionsUpdated:{reducer:(e,t)=>Ta(e,t.payload),prepare:sc()}}}),_=Rc({name:`${e}/config`,initialState:{online:"undefined"==typeof navigator||void 0===navigator.onLine||navigator.onLine,focused:"undefined"==typeof document||"hidden"!==document.visibilityState,middlewareRegistered:!1,...c},reducers:{middlewareRegistered(e,{payload:t}){e.middlewareRegistered="conflict"!==e.middlewareRegistered&&i===t||"conflict"}},extraReducers:e=>{e.addCase(Uc,(e=>{e.online=!0})).addCase(zc,(e=>{e.online=!1})).addCase($c,(e=>{e.focused=!0})).addCase(Vc,(e=>{e.focused=!1})).addMatcher(o,(e=>({...e})))}}),m=Po({queries:u.reducer,mutations:d.reducer,provided:h.reducer,subscriptions:f.reducer,config:_.reducer});return{reducer:(e,t)=>m(l.match(t)?void 0:e,t),actions:{..._.actions,...u.actions,...p.actions,...f.actions,...d.actions,...h.actions,resetApiState:l}}}var rl=Symbol.for("RTKQ/skipToken"),il={status:"uninitialized"},sl=Ia(il,(()=>{})),ol=Ia(il,(()=>{}));var al=WeakMap?new WeakMap:void 0,cl=({endpointName:e,queryArgs:t})=>{let n="";const r=al?.get(t);if("string"==typeof r)n=r;else{const e=JSON.stringify(t,((e,t)=>t=So(t="bigint"==typeof t?{$bigint:t.toString()}:t)?Object.keys(t).sort().reduce(((e,n)=>(e[n]=t[n],e)),{}):t));So(t)&&al?.set(t,e),n=e}return`${e}(${n})`};function ll(...e){return function(t){const n=Aa((e=>t.extractRehydrationInfo?.(e,{reducerPath:t.reducerPath??"api"}))),r={reducerPath:"api",keepUnusedDataFor:60,refetchOnMountOrArgChange:!1,refetchOnFocus:!1,refetchOnReconnect:!1,invalidationBehavior:"delayed",...t,extractRehydrationInfo:n,serializeQueryArgs(e){let n=cl;if("serializeQueryArgs"in e.endpointDefinition){const t=e.endpointDefinition.serializeQueryArgs;n=e=>{const n=t(e);return"string"==typeof n?n:cl({...e,queryArgs:n})}}else t.serializeQueryArgs&&(n=t.serializeQueryArgs);return n(e)},tagTypes:[...t.tagTypes||[]]},i={endpointDefinitions:{},batch(e){e()},apiUid:bc(),extractRehydrationInfo:n,hasRehydrationInfo:Aa((e=>null!=n(e)))},s={injectEndpoints:function(e){const t=e.endpoints({query:e=>({...e,type:"query"}),mutation:e=>({...e,type:"mutation"})});for(const[n,r]of Object.entries(t))if(!0!==e.overrideExisting&&n in i.endpointDefinitions){if("throw"===e.overrideExisting)throw new Error("production"===process.env.NODE_ENV?xc(39):`called \`injectEndpoints\` to override already-existing endpointName ${n} without specifying \`overrideExisting: true\``);"undefined"!=typeof process&&"development"===process.env.NODE_ENV&&console.error(`called \`injectEndpoints\` to override already-existing endpointName ${n} without specifying \`overrideExisting: true\``)}else{i.endpointDefinitions[n]=r;for(const e of o)e.injectEndpoint(n,r)}return s},enhanceEndpoints({addTagTypes:e,endpoints:t}){if(e)for(const t of e)r.tagTypes.includes(t)||r.tagTypes.push(t);if(t)for(const[e,n]of Object.entries(t))"function"==typeof n?n(i.endpointDefinitions[e]):Object.assign(i.endpointDefinitions[e]||{},n);return s}},o=e.map((e=>e.init(s,r,i)));return s.injectEndpoints({endpoints:t.endpoints})}}function ul(e,...t){return Object.assign(e,...t)}var dl=({api:e,queryThunk:t,internalState:n})=>{const r=`${e.reducerPath}/subscriptions`;let i=null,s=null;const{updateSubscriptionOptions:o,unsubscribeQueryResult:a}=e.internalActions,c=()=>n.currentSubscriptions,l={getSubscriptions:c,getSubscriptionCount:e=>qc(c()[e]??{}),isRequestSubscribed:(e,t)=>{const n=c();return!!n?.[e]?.[t]}};return(c,u)=>{if(i||(i=JSON.parse(JSON.stringify(n.currentSubscriptions))),e.util.resetApiState.match(c))return i=n.currentSubscriptions={},s=null,[!0,!1];if(e.internalActions.internal_getRTKQSubscriptions.match(c))return[!1,l];const d=((n,r)=>{if(o.match(r)){const{queryCacheKey:e,requestId:t,options:i}=r.payload;return n?.[e]?.[t]&&(n[e][t]=i),!0}if(a.match(r)){const{queryCacheKey:e,requestId:t}=r.payload;return n[e]&&delete n[e][t],!0}if(e.internalActions.removeQueryResult.match(r))return delete n[r.payload.queryCacheKey],!0;if(t.pending.match(r)){const{meta:{arg:e,requestId:t}}=r,i=n[e.queryCacheKey]??={};return i[`${t}_running`]={},e.subscribe&&(i[t]=e.subscriptionOptions??i[t]??{}),!0}let i=!1;if(t.fulfilled.match(r)||t.rejected.match(r)){const e=n[r.meta.arg.queryCacheKey]||{},t=`${r.meta.requestId}_running`;i||=!!e[t],delete e[t]}if(t.rejected.match(r)){const{meta:{condition:e,arg:t,requestId:s}}=r;if(e&&t.subscribe){const e=n[t.queryCacheKey]??={};e[s]=t.subscriptionOptions??e[s]??{},i=!0}}return i})(n.currentSubscriptions,c);let h=!0;if(d){s||(s=setTimeout((()=>{const t=JSON.parse(JSON.stringify(n.currentSubscriptions)),[,r]=Sa(i,(()=>t));u.next(e.internalActions.subscriptionsUpdated(r)),i=t,s=null}),500));const o="string"==typeof c.type&&!!c.type.startsWith(r),a=t.rejected.match(c)&&c.meta.condition&&!!c.meta.arg.subscribe;h=!o&&!a}return[h,!1]}};var hl=({reducerPath:e,api:t,queryThunk:n,context:r,internalState:i})=>{const{removeQueryResult:s,unsubscribeQueryResult:o}=t.internalActions,a=dc(o.match,n.fulfilled,n.rejected);function c(e){const t=i.currentSubscriptions[e];return!!t&&!function(e){for(const t in e)return!1;return!0}(t)}const l={};function u(e,t,n,i){const o=r.endpointDefinitions[t],a=o?.keepUnusedDataFor??i.keepUnusedDataFor;if(a===1/0)return;const u=Math.max(0,Math.min(a,2147482.647));if(!c(e)){const t=l[e];t&&clearTimeout(t),l[e]=setTimeout((()=>{c(e)||n.dispatch(s({queryCacheKey:e})),delete l[e]}),1e3*u)}}return(n,i,s)=>{if(a(n)){const t=i.getState()[e],{queryCacheKey:r}=o.match(n)?n.payload:n.meta.arg;u(r,t.queries[r]?.endpointName,i,t.config)}if(t.util.resetApiState.match(n))for(const[e,t]of Object.entries(l))t&&clearTimeout(t),delete l[e];if(r.hasRehydrationInfo(n)){const t=i.getState()[e],{queries:s}=r.extractRehydrationInfo(n);for(const[e,n]of Object.entries(s))u(e,n?.endpointName,i,t.config)}}},pl=new Error("Promise never resolved before cacheEntryRemoved."),fl=({api:e,reducerPath:t,context:n,queryThunk:r,mutationThunk:i,internalState:s})=>{const o=vc(r),a=vc(i),c=yc(r,i),l={};function u(t,r,i,s,o){const a=n.endpointDefinitions[t],c=a?.onCacheEntryAdded;if(!c)return;const u={},d=new Promise((e=>{u.cacheEntryRemoved=e})),h=Promise.race([new Promise((e=>{u.valueResolved=e})),d.then((()=>{throw pl}))]);h.catch((()=>{})),l[i]=u;const p=e.endpoints[t].select("query"===a.type?r:i),f=s.dispatch(((e,t,n)=>n)),_={...s,getCacheEntry:()=>p(s.getState()),requestId:o,extra:f,updateCachedData:"query"===a.type?n=>s.dispatch(e.util.updateQueryData(t,r,n)):void 0,cacheDataLoaded:h,cacheEntryRemoved:d},m=c(r,_);Promise.resolve(m).catch((e=>{if(e!==pl)throw e}))}return(n,s,d)=>{const h=function(t){if(o(t))return t.meta.arg.queryCacheKey;if(a(t))return t.meta.arg.fixedCacheKey??t.meta.requestId;return e.internalActions.removeQueryResult.match(t)?t.payload.queryCacheKey:e.internalActions.removeMutationResult.match(t)?Zc(t.payload):""}(n);if(r.pending.match(n)){const e=d[t].queries[h],r=s.getState()[t].queries[h];!e&&r&&u(n.meta.arg.endpointName,n.meta.arg.originalArgs,h,s,n.meta.requestId)}else if(i.pending.match(n)){s.getState()[t].mutations[h]&&u(n.meta.arg.endpointName,n.meta.arg.originalArgs,h,s,n.meta.requestId)}else if(c(n)){const e=l[h];e?.valueResolved&&(e.valueResolved({data:n.payload,meta:n.meta.baseQueryMeta}),delete e.valueResolved)}else if(e.internalActions.removeQueryResult.match(n)||e.internalActions.removeMutationResult.match(n)){const e=l[h];e&&(delete l[h],e.cacheEntryRemoved())}else if(e.util.resetApiState.match(n))for(const[e,t]of Object.entries(l))delete l[e],t.cacheEntryRemoved()}},_l=({api:e,context:{apiUid:t},reducerPath:n})=>(r,i)=>{e.util.resetApiState.match(r)&&i.dispatch(e.internalActions.middlewareRegistered(t)),"undefined"!=typeof process&&"development"===process.env.NODE_ENV&&e.internalActions.middlewareRegistered.match(r)&&r.payload===t&&"conflict"===i.getState()[n]?.config?.middlewareRegistered&&console.warn(`There is a mismatch between slice and middleware for the reducerPath "${n}".\nYou can only have one api per reducer path, this will lead to crashes in various situations!${"api"===n?"\nIf you have multiple apis, you *have* to specify the reducerPath option when using createApi!":""}`)},ml=({reducerPath:e,context:t,context:{endpointDefinitions:n},mutationThunk:r,queryThunk:i,api:s,assertTagType:o,refetchQuery:a,internalState:c})=>{const{removeQueryResult:l}=s.internalActions,u=dc(yc(r),gc(r)),d=dc(yc(r,i),mc(r,i));let h=[];function p(n,r){const i=r.getState(),o=i[e];if(h.push(...n),"delayed"===o.config.invalidationBehavior&&function(e){for(const t in e.queries)if("pending"===e.queries[t]?.status)return!0;for(const t in e.mutations)if("pending"===e.mutations[t]?.status)return!0;return!1}(o))return;const u=h;if(h=[],0===u.length)return;const d=s.util.selectInvalidatedBy(i,u);t.batch((()=>{const e=Array.from(d.values());for(const{queryCacheKey:t}of e){const e=o.queries[t],n=c.currentSubscriptions[t]??{};e&&(0===qc(n)?r.dispatch(l({queryCacheKey:t})):"uninitialized"!==e.status&&r.dispatch(a(e)))}}))}return(e,t)=>{u(e)?p(Jc(e,"invalidatesTags",n,o),t):d(e)?p([],t):s.util.invalidateTags.match(e)&&p(Hc(e.payload,void 0,void 0,void 0,void 0,o),t)}},gl=({reducerPath:e,queryThunk:t,api:n,refetchQuery:r,internalState:i})=>{const s={};function o({queryCacheKey:t},n){const a=n.getState()[e],c=a.queries[t],u=i.currentSubscriptions[t];if(!c||"uninitialized"===c.status)return;const{lowestPollingInterval:d,skipPollingIfUnfocused:h}=l(u);if(!Number.isFinite(d))return;const p=s[t];p?.timeout&&(clearTimeout(p.timeout),p.timeout=void 0);const f=Date.now()+d;s[t]={nextPollTimestamp:f,pollingInterval:d,timeout:setTimeout((()=>{!a.config.focused&&h||n.dispatch(r(c)),o({queryCacheKey:t},n)}),d)}}function a({queryCacheKey:t},n){const r=n.getState()[e].queries[t],a=i.currentSubscriptions[t];if(!r||"uninitialized"===r.status)return;const{lowestPollingInterval:u}=l(a);if(!Number.isFinite(u))return void c(t);const d=s[t],h=Date.now()+u;(!d||h<d.nextPollTimestamp)&&o({queryCacheKey:t},n)}function c(e){const t=s[e];t?.timeout&&clearTimeout(t.timeout),delete s[e]}function l(e={}){let t=!1,n=Number.POSITIVE_INFINITY;for(let r in e)e[r].pollingInterval&&(n=Math.min(e[r].pollingInterval,n),t=e[r].skipPollingIfUnfocused||t);return{lowestPollingInterval:n,skipPollingIfUnfocused:t}}return(e,r)=>{(n.internalActions.updateSubscriptionOptions.match(e)||n.internalActions.unsubscribeQueryResult.match(e))&&a(e.payload,r),(t.pending.match(e)||t.rejected.match(e)&&e.meta.condition)&&a(e.meta.arg,r),(t.fulfilled.match(e)||t.rejected.match(e)&&!e.meta.condition)&&o(e.meta.arg,r),n.util.resetApiState.match(e)&&function(){for(const e of Object.keys(s))c(e)}()}},yl=({api:e,context:t,queryThunk:n,mutationThunk:r})=>{const i=_c(n,r),s=mc(n,r),o=yc(n,r),a={};return(n,r)=>{if(i(n)){const{requestId:i,arg:{endpointName:s,originalArgs:o}}=n.meta,c=t.endpointDefinitions[s],l=c?.onQueryStarted;if(l){const t={},n=new Promise(((e,n)=>{t.resolve=e,t.reject=n}));n.catch((()=>{})),a[i]=t;const u=e.endpoints[s].select("query"===c.type?o:i),d=r.dispatch(((e,t,n)=>n)),h={...r,getCacheEntry:()=>u(r.getState()),requestId:i,extra:d,updateCachedData:"query"===c.type?t=>r.dispatch(e.util.updateQueryData(s,o,t)):void 0,queryFulfilled:n};l(o,h)}}else if(o(n)){const{requestId:e,baseQueryMeta:t}=n.meta;a[e]?.resolve({data:n.payload,meta:t}),delete a[e]}else if(s(n)){const{requestId:e,rejectedWithValue:t,baseQueryMeta:r}=n.meta;a[e]?.reject({error:n.payload??n.error,isUnhandledError:!t,meta:r}),delete a[e]}}};function vl(e){const{reducerPath:t,queryThunk:n,api:r,context:i}=e,{apiUid:s}=i,o={invalidateTags:za(`${t}/invalidateTags`)},a=e=>e.type.startsWith(`${t}/`),c=[_l,hl,ml,gl,fl,yl];return{middleware:n=>{let o=!1;const u={...e,internalState:{currentSubscriptions:{}},refetchQuery:l,isThisApiSliceAction:a},d=c.map((e=>e(u))),h=dl(u),p=(({reducerPath:e,context:t,api:n,refetchQuery:r,internalState:i})=>{const{removeQueryResult:s}=n.internalActions;function o(n,o){const a=n.getState()[e],c=a.queries,l=i.currentSubscriptions;t.batch((()=>{for(const e of Object.keys(l)){const t=c[e],i=l[e];i&&t&&((Object.values(i).some((e=>!0===e[o]))||Object.values(i).every((e=>void 0===e[o]))&&a.config[o])&&(0===qc(i)?n.dispatch(s({queryCacheKey:e})):"uninitialized"!==t.status&&n.dispatch(r(t))))}}))}return(e,t)=>{$c.match(e)&&o(t,"refetchOnFocus"),Uc.match(e)&&o(t,"refetchOnReconnect")}})(u);return e=>c=>{if(!Oo(c))return e(c);o||(o=!0,n.dispatch(r.internalActions.middlewareRegistered(s)));const l={...n,next:e},u=n.getState(),[f,_]=h(c,l,u);let m;if(m=f?e(c):_,n.getState()[t]&&(p(c,l,u),a(c)||i.hasRehydrationInfo(c)))for(const e of d)e(c,l,u);return m}},actions:o};function l(t){return e.api.endpoints[t.endpointName].initiate(t.originalArgs,{subscribe:!1,forceRefetch:!0})}}var bl=Symbol(),wl=ll((({createSelector:e=qa}={})=>({name:bl,init(t,{baseQuery:n,tagTypes:r,reducerPath:i,serializeQueryArgs:s,keepUnusedDataFor:o,refetchOnMountOrArgChange:a,refetchOnFocus:c,refetchOnReconnect:l,invalidationBehavior:u},d){Ca();const h=e=>("undefined"!=typeof process&&"development"===process.env.NODE_ENV&&(r.includes(e.type)||console.error(`Tag type '${e.type}' was used, but not specified in \`tagTypes\`!`)),e);Object.assign(t,{reducerPath:i,endpoints:{},internalActions:{onOnline:Uc,onOffline:zc,onFocus:$c,onFocusLost:Vc},util:{}});const{queryThunk:p,mutationThunk:f,patchQueryData:_,updateQueryData:m,upsertQueryData:g,prefetch:y,buildMatchThunkActions:v}=function({reducerPath:e,baseQuery:t,context:{endpointDefinitions:n},serializeQueryArgs:r,api:i,assertTagType:s}){const o=async(e,{signal:r,abort:i,rejectWithValue:s,fulfillWithValue:o,dispatch:c,getState:l,extra:u})=>{const d=n[e.endpointName];try{let n,s=Gc;const h={signal:r,abort:i,dispatch:c,getState:l,extra:u,endpoint:e.endpointName,type:e.type,forced:"query"===e.type?a(e,l()):void 0,queryCacheKey:"query"===e.type?e.queryCacheKey:void 0},p="query"===e.type?e[Kc]:void 0;if(p?n=p():d.query?(n=await t(d.query(e.originalArgs),h,d.extraOptions),d.transformResponse&&(s=d.transformResponse)):n=await d.queryFn(e.originalArgs,h,d.extraOptions,(e=>t(e,h,d.extraOptions))),"undefined"!=typeof process&&"development"===process.env.NODE_ENV){const t=d.query?"`baseQuery`":"`queryFn`";let r;if(n){if("object"!=typeof n)r=`${t} did not return an object.`;else if(n.error&&n.data)r=`${t} returned an object containing both \`error\` and \`result\`.`;else if(void 0===n.error&&void 0===n.data)r=`${t} returned an object containing neither a valid \`error\` and \`result\`. At least one of them should not be \`undefined\``;else for(const e of Object.keys(n))if("error"!==e&&"data"!==e&&"meta"!==e){r=`The object returned by ${t} has the unknown property ${e}.`;break}}else r=`${t} did not return anything.`;r&&console.error(`Error encountered handling the endpoint ${e.endpointName}.\n              ${r}\n              It needs to return an object with either the shape \`{ data: <value> }\` or \`{ error: <value> }\` that may contain an optional \`meta\` property.\n              Object returned was:`,n)}if(n.error)throw new Lc(n.error,n.meta);return o(await s(n.data,n.meta,e.originalArgs),{fulfilledTimeStamp:Date.now(),baseQueryMeta:n.meta,[ic]:!0})}catch(t){let n=t;if(n instanceof Lc){let t=Gc;d.query&&d.transformErrorResponse&&(t=d.transformErrorResponse);try{return s(await t(n.value,n.meta,e.originalArgs),{baseQueryMeta:n.meta,[ic]:!0})}catch(e){n=e}}throw"undefined"!=typeof process&&"production"!==process.env.NODE_ENV?console.error(`An unhandled error occurred processing a request for the endpoint "${e.endpointName}".\nIn the case of an unhandled error, no tags will be "provided" or "invalidated".`,n):console.error(n),n}};function a(t,n){const r=n[e]?.queries?.[t.queryCacheKey],i=n[e]?.config.refetchOnMountOrArgChange,s=r?.fulfilledTimeStamp,o=t.forceRefetch??(t.subscribe&&i);return!!o&&(!0===o||(Number(new Date)-Number(s))/1e3>=o)}const c=Sc(`${e}/executeQuery`,o,{getPendingMeta:()=>({startedTimeStamp:Date.now(),[ic]:!0}),condition(t,{getState:r}){const i=r(),s=i[e]?.queries?.[t.queryCacheKey],o=s?.fulfilledTimeStamp,c=t.originalArgs,l=s?.originalArgs,u=n[t.endpointName];return!(!Yc(t)&&("pending"===s?.status||!a(t,i)&&(!Bc(u)||!u?.forceRefetch?.({currentArg:c,previousArg:l,endpointState:s,state:i}))&&o))},dispatchConditionRejection:!0}),l=Sc(`${e}/executeMutation`,o,{getPendingMeta:()=>({startedTimeStamp:Date.now(),[ic]:!0})});function u(e){return t=>t?.meta?.arg?.endpointName===e}return{queryThunk:c,mutationThunk:l,prefetch:(e,t,n)=>(r,s)=>{const o=(e=>"force"in e)(n)&&n.force,a=(e=>"ifOlderThan"in e)(n)&&n.ifOlderThan,c=(n=!0)=>{const r={forceRefetch:n,isPrefetch:!0};return i.endpoints[e].initiate(t,r)},l=i.endpoints[e].select(t)(s());if(o)r(c());else if(a){const e=l?.fulfilledTimeStamp;if(!e)return void r(c());(Number(new Date)-Number(new Date(e)))/1e3>=a&&r(c())}else r(c(!1))},updateQueryData:(e,t,n,r=!0)=>(s,o)=>{const a=i.endpoints[e].select(t)(o()),c={patches:[],inversePatches:[],undo:()=>s(i.util.patchQueryData(e,t,c.inversePatches,r))};if("uninitialized"===a.status)return c;let l;if("data"in a)if($o(a.data)){const[e,t,r]=Sa(a.data,n);c.patches.push(...t),c.inversePatches.push(...r),l=e}else l=n(a.data),c.patches.push({op:"replace",path:[],value:l}),c.inversePatches.push({op:"replace",path:[],value:a.data});return 0===c.patches.length||s(i.util.patchQueryData(e,t,c.patches,r)),c},upsertQueryData:(e,t,n)=>r=>r(i.endpoints[e].initiate(t,{subscribe:!1,forceRefetch:!0,[Kc]:()=>({data:n})})),patchQueryData:(e,t,o,a)=>(c,l)=>{const u=n[e],d=r({queryArgs:t,endpointDefinition:u,endpointName:e});if(c(i.internalActions.queryResultPatched({queryCacheKey:d,patches:o})),!a)return;const h=i.endpoints[e].select(t)(l()),p=Hc(u.providesTags,h.data,void 0,t,{},s);c(i.internalActions.updateProvidedBy({queryCacheKey:d,providedTags:p}))},buildMatchThunkActions:function(e,t){return{matchPending:hc(_c(e),u(t)),matchFulfilled:hc(yc(e),u(t)),matchRejected:hc(mc(e),u(t))}}}}({baseQuery:n,reducerPath:i,context:d,api:t,serializeQueryArgs:s,assertTagType:h}),{reducer:b,actions:w}=nl({context:d,queryThunk:p,mutationThunk:f,reducerPath:i,assertTagType:h,config:{refetchOnFocus:c,refetchOnReconnect:l,refetchOnMountOrArgChange:a,keepUnusedDataFor:o,reducerPath:i,invalidationBehavior:u}});ul(t.util,{patchQueryData:_,updateQueryData:m,upsertQueryData:g,prefetch:y,resetApiState:w.resetApiState}),ul(t.internalActions,w);const{middleware:C,actions:E}=vl({reducerPath:i,context:d,queryThunk:p,mutationThunk:f,api:t,assertTagType:h});ul(t.util,E),ul(t,{reducer:b,middleware:C});const{buildQuerySelector:I,buildMutationSelector:S,selectInvalidatedBy:T,selectCachedArgsForQuery:N}=function({serializeQueryArgs:e,reducerPath:t,createSelector:n}){const r=e=>sl,i=e=>ol;return{buildQuerySelector:function(t,i){return a=>{const c=e({queryArgs:a,endpointDefinition:i,endpointName:t});return n(a===rl?r:e=>o(e)?.queries?.[c]??sl,s)}},buildMutationSelector:function(){return e=>{let t;return t="object"==typeof e?Zc(e)??rl:e,n(t===rl?i:e=>o(e)?.mutations?.[t]??ol,s)}},selectInvalidatedBy:function(e,n){const r=e[t],i=new Set;for(const e of n.map(Qc)){const t=r.provided[e.type];if(!t)continue;let n=(void 0!==e.id?t[e.id]:jc(Object.values(t)))??[];for(const e of n)i.add(e)}return jc(Array.from(i.values()).map((e=>{const t=r.queries[e];return t?[{queryCacheKey:e,endpointName:t.endpointName,originalArgs:t.originalArgs}]:[]})))},selectCachedArgsForQuery:function(e,n){return Object.values(e[t].queries).filter((e=>e?.endpointName===n&&"uninitialized"!==e.status)).map((e=>e.originalArgs))}};function s(e){return{...e,...(t=e.status,{status:t,isUninitialized:"uninitialized"===t,isLoading:"pending"===t,isSuccess:"fulfilled"===t,isError:"rejected"===t})};var t}function o(e){const n=e[t];if("production"!==process.env.NODE_ENV&&!n){if(o.triggered)return n;o.triggered=!0,console.error(`Error: No data found at \`state.${t}\`. Did you forget to add the reducer to the store?`)}return n}}({serializeQueryArgs:s,reducerPath:i,createSelector:e});ul(t.util,{selectInvalidatedBy:T,selectCachedArgsForQuery:N});const{buildInitiateQuery:k,buildInitiateMutation:D,getRunningMutationThunk:P,getRunningMutationsThunk:R,getRunningQueriesThunk:O,getRunningQueryThunk:x}=function({serializeQueryArgs:e,queryThunk:t,mutationThunk:n,api:r,context:i}){const s=new Map,o=new Map,{unsubscribeQueryResult:a,removeMutationResult:c,updateSubscriptionOptions:l}=r.internalActions;return{buildInitiateQuery:function(n,i){const o=(c,{subscribe:d=!0,forceRefetch:h,subscriptionOptions:p,[Kc]:f,..._}={})=>(m,g)=>{const y=e({queryArgs:c,endpointDefinition:i,endpointName:n}),v=t({..._,type:"query",subscribe:d,forceRefetch:h,subscriptionOptions:p,endpointName:n,originalArgs:c,queryCacheKey:y,[Kc]:f}),b=r.endpoints[n].select(c),w=m(v),C=b(g());u(m);const{requestId:E,abort:I}=w,S=C.requestId!==E,T=s.get(m)?.[y],N=()=>b(g()),k=Object.assign(f?w.then(N):S&&!T?Promise.resolve(C):Promise.all([T,w]).then(N),{arg:c,requestId:E,subscriptionOptions:p,queryCacheKey:y,abort:I,async unwrap(){const e=await k;if(e.isError)throw e.error;return e.data},refetch:()=>m(o(c,{subscribe:!1,forceRefetch:!0})),unsubscribe(){d&&m(a({queryCacheKey:y,requestId:E}))},updateSubscriptionOptions(e){k.subscriptionOptions=e,m(l({endpointName:n,requestId:E,queryCacheKey:y,options:e}))}});if(!T&&!S&&!f){const e=s.get(m)||{};e[y]=k,s.set(m,e),k.then((()=>{delete e[y],qc(e)||s.delete(m)}))}return k};return o},buildInitiateMutation:function(e){return(t,{track:r=!0,fixedCacheKey:i}={})=>(s,a)=>{const l=n({type:"mutation",endpointName:e,originalArgs:t,track:r,fixedCacheKey:i}),d=s(l);u(s);const{requestId:h,abort:p,unwrap:f}=d,_=(m=e=>({error:e}),d.unwrap().then((e=>({data:e}))).catch(m));var m;const g=Object.assign(_,{arg:d.arg,requestId:h,abort:p,unwrap:f,reset:()=>{s(c({requestId:h,fixedCacheKey:i}))}}),y=o.get(s)||{};return o.set(s,y),y[h]=g,g.then((()=>{delete y[h],qc(y)||o.delete(s)})),i&&(y[i]=g,g.then((()=>{y[i]===g&&(delete y[i],qc(y)||o.delete(s))}))),g}},getRunningQueryThunk:function(t,n){return r=>{const o=i.endpointDefinitions[t],a=e({queryArgs:n,endpointDefinition:o,endpointName:t});return s.get(r)?.[a]}},getRunningMutationThunk:function(e,t){return e=>o.get(e)?.[t]},getRunningQueriesThunk:function(){return e=>Object.values(s.get(e)||{}).filter(Fc)},getRunningMutationsThunk:function(){return e=>Object.values(o.get(e)||{}).filter(Fc)}};function u(e){if("production"!==process.env.NODE_ENV){if(u.triggered)return;const t=e(r.internalActions.internal_getRTKQSubscriptions());if(u.triggered=!0,"object"!=typeof t||"string"==typeof t?.type)throw new Error("production"===process.env.NODE_ENV?xc(34):`Warning: Middleware for RTK-Query API at reducerPath "${r.reducerPath}" has not been added to the store.\nYou must add the middleware for RTK-Query to function correctly!`)}}}({queryThunk:p,mutationThunk:f,api:t,serializeQueryArgs:s,context:d});return ul(t.util,{getRunningMutationThunk:P,getRunningMutationsThunk:R,getRunningQueryThunk:x,getRunningQueriesThunk:O}),{name:bl,injectEndpoint(e,n){const r=t;r.endpoints[e]??={},Bc(n)?ul(r.endpoints[e],{name:e,select:I(e,n),initiate:k(e,n)},v(p,e)):"mutation"===n.type&&ul(r.endpoints[e],{name:e,select:S(),initiate:D(e)},v(f,e))}}}}))());let Cl=[{conto:"20202",name:"Касса кредитных организаций",id:"20202",sortby:"20202",type:"asset",add:!0,parentbalanceId:100,debetDescription:"По дебету счета отражаются...",creditDescription:"По кредиту счета отражаются..."},{conto:"30102",name:"Корреспондентские счета кредитных организаций в Банке России",id:"30102",sortby:"30102",type:"asset",add:!0,parentbalanceId:200,debetDescription:"По дебету счета отражаются...",creditDescription:"По кредиту счета отражаются..."},{conto:"30110",name:"Корреспондентские счета в кредитных организациях - корреспондентах",id:"30110",sortby:"30110",type:"asset",add:!0,parentbalanceId:300,debetDescription:"По дебету счета отражаются...",creditDescription:"По кредиту счета отражаются..."},{conto:"50104",name:"Долговые ценные бумаги Российской Федерации",id:"50104",sortby:"50104",type:"asset",add:!0,parentbalanceId:400,debetDescription:"По дебету счета отражаются...",creditDescription:"По кредиту счета отражаются..."},{conto:"45208",name:"Кредиты, предоставленные негосударственным коммерческим организациям на срок свыше 3 лет",id:"45208",sortby:"45208",type:"asset",add:!0,parentbalanceId:500,debetDescription:"По дебету счета отражаются...",creditDescription:"По кредиту счета отражаются..."},{conto:"45215",name:"Кредиты, предоставленные негосударственным коммерческим организациям Резервы на возможные потери",id:"45216",sortby:"45215",type:"asset",add:!0,parentbalanceId:500,debetDescription:"По дебету счета отражаются...",creditDescription:"По кредиту счета отражаются..."},{conto:"47427",name:"Прочие активы и пассивы Начисленные проценты по предоставленным (размещенным) денежным средствам",id:"47427",sortby:"47427",type:"asset",add:!0,parentbalanceId:500,debetDescription:"По дебету счета отражаются...",creditDescription:"По кредиту счета отражаются..."},{conto:"45812",name:"Просроченная задолженность по предоставленным кредитам и прочим размещенным средствам Негосударственным коммерческим организациям",id:"45812",sortby:"45812",type:"asset",add:!0,parentbalanceId:500,debetDescription:"По дебету счета отражаются...",creditDescription:"По кредиту счета отражаются..."},{conto:"45818",name:"Просроченная задолженность по предоставленным кредитам и прочим размещенным средствам Резервы на возможные потери",id:"45818",sortby:"45818",type:"asset",add:!0,parentbalanceId:500,debetDescription:"По дебету счета отражаются...",creditDescription:"По кредиту счета отражаются..."},{conto:"45918",name:"Просроченные проценты по предоставленным кредитам и прочим размещенным средствам Резервы на возможные потери",id:"45918",sortby:"45918",type:"asset",add:!0,parentbalanceId:500,debetDescription:"По дебету счета отражаются...",creditDescription:"По кредиту счета отражаются..."},{conto:"45912",name:"Просроченные проценты по предоставленным кредитам и прочим размещенным средствам Негосударственным коммерческим организациям",id:"45912",sortby:"45912",type:"asset",add:!0,parentbalanceId:500,debetDescription:"По дебету счета отражаются...",creditDescription:"По кредиту счета отражаются..."},{conto:"50706",name:"Долевые ценные бумаги прочих резидентов",id:"50706",sortby:"50706",type:"asset",add:!0,parentbalanceId:600,debetDescription:"По дебету счета отражаются...",creditDescription:"По кредиту счета отражаются..."},{conto:"60401",name:"Основные средства (кроме земли)",id:"60401",sortby:"60401",type:"asset",add:!0,parentbalanceId:1100,debetDescription:"По дебету счета отражаются...",creditDescription:"По кредиту счета отражаются..."},{conto:"60312",name:"Расчеты с дебиторами и кредиторами Расчеты с поставщиками, подрядчиками и покупателями",id:"60312",sortby:"60312",type:"asset",add:!0,parentbalanceId:1300,debetDescription:"По дебету счета отражаются...",creditDescription:"По кредиту счета отражаются..."},{conto:"60323",name:"Расчеты с дебиторами и кредиторами Расчеты с прочими дебиторами",id:"60323",sortby:"60323",type:"asset",add:!0,parentbalanceId:1300,debetDescription:"По дебету счета отражаются...",creditDescription:"По кредиту счета отражаются..."},{conto:"40702",name:"Счета негосударственных организаций  Коммерческие организации",id:"40702",sortby:"40702",type:"liability",add:!0,parentbalanceId:1620,debetDescription:"По дебету счета отражаются...",creditDescription:"По кредиту счета отражаются..."},{conto:"40817",name:"Прочие счета Физические лица",id:"40817",sortby:"40817",type:"liability",add:!0,parentbalanceId:1620,debetDescription:"По дебету счета отражаются...",creditDescription:"По кредиту счета отражаются..."},{conto:"47411",name:"Расчеты по отдельным операциям и корректировки Начисленные проценты по банковским счетам и привлеченным средствам физических лиц",id:"47411",sortby:"47411",type:"liability",add:!0,parentbalanceId:1620,debetDescription:"По дебету счета отражаются...",creditDescription:"По кредиту счета отражаются..."},{conto:"42303",name:"Депозиты и прочие привлеченные средства физических лиц Депозиты на срок от 31 дня до 90 дней",id:"42303",sortby:"42303",type:"liability",add:!0,parentbalanceId:1620,debetDescription:"По дебету счета отражаются...",creditDescription:"По кредиту счета отражаются..."},{conto:"52001",name:"Выпущенные облигации  со сроком погашения до 30 дней",id:"52001",sortby:"52001",type:"liability",add:!0,parentbalanceId:1800,debetDescription:"По дебету счета отражаются...",creditDescription:"По кредиту счета отражаются..."},{conto:"60322",name:"Расчеты с дебиторами и кредиторами Расчеты с прочими кредиторами",id:"60322",sortby:"60322",type:"liability",add:!0,parentbalanceId:2200,debetDescription:"По дебету счета отражаются...",creditDescription:"По кредиту счета отражаются..."},{conto:"60311",name:"Расчеты с дебиторами и кредиторами Расчеты с поставщиками, подрядчиками и покупателями",id:"60311",sortby:"60311",type:"liability",add:!0,parentbalanceId:2200,debetDescription:"По дебету счета отражаются...",creditDescription:"По кредиту счета отражаются..."},{conto:"10207",id:"10207",name:"Уставный капитал кредитных организаций, созданных в форме акционерного общества",sortby:"10207",type:"equity",add:!0,parentbalanceId:2500,debetDescription:"По дебету счета отражаются...",creditDescription:"По кредиту счета отражаются..."},{conto:"70601",id:"70601",name:"Финансовый результат текущего года Доходы",sortby:"70601",type:"equity",add:!0,parentbalanceId:3700,debetDescription:"По дебету счета отражаются...",creditDescription:"По кредиту счета отражаются..."},{conto:"70606",id:"70606",name:"Финансовый результат текущего года Расходы",sortby:"70606",type:"equity",add:!0,parentbalanceId:3700,debetDescription:"По дебету счета отражаются...",creditDescription:"По кредиту счета отражаются..."}],El=[{id:100,name:"1. Денежные средства",type:"asset"},{id:200,name:"2. Средства кредитной организации в Центральном банке Российской Федерации",type:"asset"},{id:300,name:"3. Средства в кредитных организациях",type:"asset"},{id:400,name:"4. Финансовые активы, оцениваемые по справедливой стоимости через прибыль или убыток",type:"asset"},{id:500,name:"5. Чистая ссудная задолженность, оцениваемая по амортизированной стоимости",type:"asset"},{id:600,name:"6. Чистые вложения в финансовые активы, оцениваемые по справедливой стоимости через прочий совокупный доход",type:"asset"},{id:700,name:"7. Чистые вложения в ценные бумаги и иные финансовые активы, оцениваемые по амортизированной стоимости (кроме ссудной задолженности)",type:"asset"},{id:800,name:"8. Инвестиции в дочерние и зависимые организации",type:"asset"},{id:900,name:"9. Требования по текущему налогу на прибыль",type:"asset"},{id:1e3,name:"10. Отложенный налоговый актив",type:"asset"},{id:1100,name:"11. Основные средства, активы в форме права пользования и нематериальные активы",type:"asset"},{id:1200,name:"12. Долгосрочные активы, предназначенные для продажи",type:"asset"},{id:1300,name:"13. Прочие активы",type:"asset"},{id:1500,name:"Кредиты, депозиты и прочие средства Центрального банка Российской Федерации",type:"liability"},{id:1610,name:"16.1 Cредства кредитных организаций",type:"liability"},{id:1620,name:"16.1 Cредства клиентов, не являющихся кредитными организациями",type:"liability"},{id:1700,name:"17. Финансовые обязательства, оцениваемые по справедливой стоимости через прибыль или убыток",type:"liability"},{id:1800,name:"18. Выпущенные долговые ценные бумаги",type:"liability"},{id:1900,name:"19. Привлеченные субординированные кредиты (депозиты, займы) и выпущенные субординированные облигационные займы, классифицированные в качестве обязательств",type:"liability"},{id:2e3,name:"20. Обязательства по текущему налогу на прибыль",type:"liability"},{id:2100,name:"21. Отложенные налоговые обязательства",type:"liability"},{id:2200,name:"22. Прочие обязательства",type:"liability"},{id:2300,name:"23. Резервы на возможные потери по условным обязательствам кредитного характера, прочим возможным потерям и операциям с резидентами офшорных зон",type:"liability"},{id:2500,name:"25. Средства акционеров (участников)",type:"equity"},{id:2600,name:"26. Собственные акции (доли), выкупленные у акционеров (участников)",type:"equity"},{id:2700,name:"27. Эмиссионный доход",type:"equity"},{id:2800,name:"28. Резервный фонд",type:"equity"},{id:2900,name:"29. Переоценка финансовых активов, оцениваемых по справедливой стоимости через прочий совокупный доход, уменьшенная на отложенное налоговое обязательство (увеличенная на отложенный налоговый актив)",type:"equity"},{id:3e3,name:"30. Переоценка основных средств, активов в форме права пользования и нематериальных активов, уменьшенная на отложенное налоговое обязательство",type:"equity"},{id:3100,name:"31. Переоценка обязательств (требований) по выплате долгосрочных вознаграждений",type:"equity"},{id:3200,name:"32. Переоценка инструментов хеджирования",type:"equity"},{id:3300,name:"33. Денежные средства безвозмездного финансирования (вклады в имущество)",type:"equity"},{id:3400,name:"34. Изменение справедливой стоимости финансового обязательства, обусловленное изменением кредитного риска",type:"equity"},{id:3500,name:"35. Привлеченные субординированные кредиты (депозиты, займы) и выпущенные субординированные облигационные займы, классифицированные в качестве долевых инструментов",type:"equity"},{id:3600,name:"36. Оценочные резервы под ожидаемые кредитные убытки",type:"equity"},{id:3700,name:"37. Неиспользованная прибыль (убыток)",type:"equity"}];document.querySelectorAll.bind(document);const Il=document.querySelector.bind(document);if(Qe().length>1&&deleteApp(Qe()[1]).then((function(){console.log("App deleted successfully")})).catch((function(e){console.log("Error deleting app:",e)})),Qe().length<1){let e={};try{e=document.body.dataset}catch(e){throw new Error("Unable to get params"+e)}He({apiKey:e.api,databaseURL:"https://"+e.base+".firebaseio.com",appId:e.app})}const Sl=function(e=function(e=je){const t=Le.get(e);if(!t&&e===je&&_())return He();if(!t)throw We.create("no-app",{appName:e});return t}(),t){const n=function(e,t){const n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}(e,"database").getImmediate({identifier:t});if(!n._instanceStarted){const e=f("database");e&&function(e,t,n,r={}){e=A(e),e._checkNotDeleted("useEmulator"),e._instanceStarted&&Ct("Cannot call useEmulator() after instance has already been initialized.");const i=e._repoInternal;let s;if(i.repoInfo_.nodeAdmin)r.mockUserToken&&Ct('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),s=new $t($t.OWNER);else if(r.mockUserToken){const t="string"==typeof r.mockUserToken?r.mockUserToken:function(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n=t||"demo-project",r=e.iat||0,i=e.sub||e.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const s=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:r,exp:r+3600,auth_time:r,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},e);return[c(JSON.stringify({alg:"none",type:"JWT"})),c(JSON.stringify(s)),""].join(".")}(r.mockUserToken,e.app.options.projectId);s=new $t(t)}!function(e,t,n,r){e.repoInfo_=new Bt(`${t}:${n}`,!1,e.repoInfo_.namespace,e.repoInfo_.webSocketOnly,e.repoInfo_.nodeAdmin,e.repoInfo_.persistenceKey,e.repoInfo_.includeNamespaceInQueryParams,!0),r&&(e.authTokenProvider_=r)}(i,t,n,s)}(n,...e)}return n}();async function Tl({url:e="crafts/temp_gmail_com/posts/-Ml6DEjYhdnjuW6HiHB7",type:t="array"}){try{let n=await _o(uo(Sl,e));if(n.exists()){let e=n.val();return"array"===t?Object.keys(e).map((t=>e[t])):e}return"array"===t?[]:null}catch(e){return console.log(e),"array"===t?[]:{}}}async function Nl(e={temp:"temp"}){try{return await fo(uo(Sl),e),!0}catch(e){return console.error(e),e}}function kl(e){return po(ho(uo(Sl),e+"/")).key}const Dl=Rc({name:"application",initialState:{email:"",userEmail:"",user:"",avatarUrl:"",isLoading:!0,recordsArray:[],contoArray:[],postId:null,currPage:1,pageLength:10,mediaObject:null,mediaId:null},reducers:{addRecord:(e,t)=>{e.recordsArray.push(t.payload)},addRecords:(e,t)=>{e.recordsArray=t.payload},fillContoArray:(e,t)=>{e.contoArray=t.payload},setPostId:(e,t)=>{e.postId=t.payload},setMediaId:(e,t)=>{e.mediaId=t.payload},setMedia:(e,t)=>{e.mediaObject=t.payload},setPreviousCurrentPage:e=>{e.currPage=1===e.currPage?1:e.currPage-1},setNextCurrentPage:e=>{e.currPage=e.currPage+1},setUser:(e,t)=>{e.email=t.payload.email,e.userEmail=t.payload.userEmail,e.user=t.payload.user,e.avatarUrl=t.payload?.avatarUrl?t.payload?.avatarUrl:"https://images.unsplash.com/photo-1536300099515-6c61b290b654?q=80&w=200&auto=format&fit=crop",e.isLoading=!1}}}),{addRecord:Pl,fillContoArray:Rl,setUser:Ol,setNextCurrentPage:xl,setPreviousCurrentPage:Al,setPostId:Ml,setMedia:ql,setMediaId:jl,addRecords:Fl}=Dl.actions;var Ll=Dl.reducer;const $l=wl({reducerPath:"api",tagTypes:["Post","Media"],baseQuery:function(){throw new Error("production"===process.env.NODE_ENV?xc(33):"When using `fakeBaseQuery`, all queries & mutations must use the `queryFn` definition syntax.")},endpoints:e=>({fetchUserPosts:e.query({async queryFn(e){try{let t=await Tl({url:"usersCraft/"+e+"/posts",type:"array"});return{data:Array.isArray(t)?t.filter((e=>"media"===e.type||"accountingwithprofitscash"===e.type)):[]}}catch(e){return console.log(e),{error:e}}},providesTags:(e,t,n)=>[{type:"Post",id:n}]}),fetchUserMediaData:e.query({async queryFn(e){try{let t=await Tl({url:e,type:"object"});return console.log(t),{data:t}}catch(e){return console.log(e),{error:e}}},providesTags:(e,t,n)=>[{type:"Media",id:"media"}]}),deletePost:e.mutation({async queryFn({userEmail:e,id:t}){let n={};n["usersCraft/"+e+"/posts/"+t]=null;try{await Nl(n)}catch(e){return console.log(e),{error:e}}return{data:n}},invalidatesTags:["Post"]}),deleteMedia:e.mutation({async queryFn({userEmail:e,id:t}){let n={};n["usersCraft/"+e+"/data/"+t]=null;try{await Nl(n)}catch(e){return console.log(e),{error:e}}return{data:n}},invalidatesTags:["Media"]}),updatesForUserPosts:e.mutation({async queryFn({base:e="",updates:t={temp:"temp"}}){let n={};Object.keys(t).forEach((r=>{n[e+"/"+r]=t[r]}));try{await Nl(n)}catch(e){return console.log(e),{error:e}}return{data:n}},invalidatesTags:["Post","Media"]})})}),Vl=function(e){const t=rc(),{reducer:n,middleware:r,devTools:i=!0,preloadedState:s,enhancers:o}=e||{};let a,c;if("function"==typeof n)a=n;else{if(!So(n))throw new Error("production"===process.env.NODE_ENV?xc(1):"`reducer` is a required argument, and must be a function or an object of functions that can be passed to combineReducers");a=Po(n)}if("production"!==process.env.NODE_ENV&&r&&"function"!=typeof r)throw new Error("production"===process.env.NODE_ENV?xc(2):"`middleware` field must be a callback");if("function"==typeof r){if(c=r(t),"production"!==process.env.NODE_ENV&&!Array.isArray(c))throw new Error("production"===process.env.NODE_ENV?xc(3):"when using a middleware builder function, an array of middleware must be returned")}else c=t();if("production"!==process.env.NODE_ENV&&c.some((e=>"function"!=typeof e)))throw new Error("production"===process.env.NODE_ENV?xc(4):"each middleware provided to configureStore must be a function");let l=Ro;i&&(l=Va({trace:"production"!==process.env.NODE_ENV,..."object"==typeof i&&i}));const u=function(...e){return t=>(n,r)=>{const i=t(n,r);let s=()=>{throw new Error("production"===process.env.NODE_ENV?wo(15):"Dispatching while constructing your middleware is not allowed. Other middleware would not be applied to this dispatch.")};const o={getState:i.getState,dispatch:(e,...t)=>s(e,...t)},a=e.map((e=>e(o)));return s=Ro(...a)(i.dispatch),{...i,dispatch:s}}}(...c),d=cc(u);if("production"!==process.env.NODE_ENV&&o&&"function"!=typeof o)throw new Error("production"===process.env.NODE_ENV?xc(5):"`enhancers` field must be a callback");let h="function"==typeof o?o(d):d();if("production"!==process.env.NODE_ENV&&!Array.isArray(h))throw new Error("production"===process.env.NODE_ENV?xc(6):"`enhancers` callback must return an array");if("production"!==process.env.NODE_ENV&&h.some((e=>"function"!=typeof e)))throw new Error("production"===process.env.NODE_ENV?xc(7):"each enhancer provided to configureStore must be a function");return"production"!==process.env.NODE_ENV&&c.length&&!h.includes(u)&&console.error("middlewares were provided, but middleware enhancer was not included in final enhancers - make sure to call `getDefaultEnhancers`"),ko(a,s,l(...h))}({reducer:{application:Dl.reducer,[$l.reducerPath]:$l.reducer},middleware:e=>e().concat($l.middleware)});var Ul;async function zl(){let e=function(){try{const e=localStorage.getItem("econolabs");if(null===e)return;return JSON.parse(e)}catch(e){return}}();return e&&e?.application?{...e.application,userEmail:e?.application?e.application?.email.replace(/[^a-zA-Z0-9]/g,"_"):null}:null}function Wl(e){e.preventDefault(),(e=>{try{const t=JSON.stringify(e);localStorage.setItem("econolabs",t)}catch(e){console.log(e)}})({application:{email:Il("#emailInput")?.value,user:Il("#userInput")?.value}}),window.location.reload()}function Bl(e){console.log(Vl.getState().application.contoArray);let t=0,n=0,r="asset"===El.find((t=>t.name===e)).type;console.log(El.find((t=>t.name===e)));let i=El.find((t=>t.name===e)).id,s=Vl.getState().application.contoArray.filter((e=>e.parentbalanceId===i)).map((e=>e.conto));return console.log(s),Array.isArray(Vl.getState().application.recordsArray)&&Vl.getState().application.recordsArray.forEach((e=>{console.log(e.d,e.k),s.includes(e.d)&&(console.log(e.sum),t+=parseFloat(e.sum)),s.includes(e.k)&&(console.log(e.sum),n+=parseFloat(e.sum))})),s.length>0&&(console.log(e),console.log(t),console.log(n)),r?t-n:n-t}function Hl(){let e=El.filter((e=>"asset"===e.type)).map((e=>{let t=Bl(e.name);return 0===t?"":`<div>${e.name} ${t}</div>`})).join("");Il("#assetsMarkup").innerHTML=e;let t=El.filter((e=>"liability"===e.type)).map((e=>{let t=Bl(e.name);return 0===t?"":`<div>${e.name} ${t}</div>`})).join("");Il("#liabilitiesMarkup").innerHTML=t;let n=El.filter((e=>"equity"===e.type)).map((e=>{let t=Bl(e.name);return 0===t?"":`<div>${e.name} ${t}</div>`})).join("");return Il("#equityMarkup").innerHTML=n,`\n    <div class="row">\n                    <div class="col">\n                        <div class="m-1 text-primary">Активы</div>\n                        <div class="m-1" id="assetsMarkup">\n                           ${e}\n                        </div>\n                    </div>\n                    <div class="col">\n                        <div class="m-1">Пассивы</div>\n                        <div class="m-1 text-danger">Обязательства</div>\n                        <div class="m-1" id="liabilitiesMarkup">\n                            ${t}\n                        </div>\n                        <div class="m-1 text-success">Собственные средства</div>\n                        <div class="m-1" id="equityMarkup">\n                            ${n}\n                        </div>\n                    </div>\n                </div>\n    \n    `}function Ql(){let e=Array.isArray(Vl.getState().application.recordsArray)&&Vl.getState().application.recordsArray.length>0?'<table class="table">\n  <thead>\n    <tr>\n      <th scope="col">#</th>\n      <th scope="col">Дебет</th>\n      <th scope="col">Кредит</th>\n      <th scope="col">Сумма</th>\n      <th scope="col">Тип</th>\n    </tr>\n  </thead>\n  <tbody>\n    '+Vl.getState().application.recordsArray.map(((e,t)=>`\n        <tr>\n      <th scope="row">${t+1}</th>\n      <td>${e.d}</td>\n      <td>${e.k}</td>\n      <td>${e.sum}</td>\n       <td>${e?.type?e.type:""}</td>\n    </tr>\n    <tr>\n    <th scope='row'>Ком</th>\n    <td colspan='4'>${e?.comment?e.comment:""}</td>\n    </tr>\n    `)).join("")+"\n    </tbody>\n</table> \n    ":"";return Il("#records").innerHTML=e,e}return Ul=Vl.dispatch,function(){const e=()=>Ul($c()),t=()=>Ul(Uc()),n=()=>Ul(zc()),r=()=>{"visible"===window.document.visibilityState?e():Ul(Vc())};Wc||"undefined"!=typeof window&&window.addEventListener&&(window.addEventListener("visibilitychange",r,!1),window.addEventListener("focus",e,!1),window.addEventListener("online",t,!1),window.addEventListener("offline",n,!1),Wc=!0)}(),Il("#loginbutton").addEventListener("click",(e=>Wl(e)),!1),Il("#addrecord").addEventListener("click",(e=>function(e){if(e.preventDefault(),Il("#ds").value.length>1&&Il("#ks").value.length>1&&Il("#sum").value.length>1&&Il("#periods").value.length>1&&Array.isArray(Vl.getState().application.contoArray)&&Vl.getState().application.contoArray.length>0){console.log(Vl.getState().application.contoArray.find((e=>Il("#ds").value===e.id)).conto),console.log(Vl.getState().application.contoArray.find((e=>Il("#ks").value===e.id)).conto);let e={d:Vl.getState().application.contoArray.find((e=>Il("#ds").value===e.id)).conto,k:Vl.getState().application.contoArray.find((e=>Il("#ks").value===e.id)).conto,sum:Il("#sum").value,period:Il("#periods").value,id:kl("temp"),comment:`\n            Дт ${Vl.getState().application.contoArray.find((e=>Il("#ds").value===e.id)).name} <br>\n            Кт ${Vl.getState().application.contoArray.find((e=>Il("#ks").value===e.id)).name} <br>\n    \n            `+Il("#commentInput").value};console.log(e),Vl.dispatch(Pl(e)),Il("#ds").value="",Il("#ks").value="",Il("#sum").value="",Il("#periods").value=""}Il("#balance").innerHTML=""+Hl(),Hl(),Ql(),Il("#post").innerHTML=""+Ql()+Hl()}(e)),!1),Il("#ds").addEventListener("input",(e=>{!function(e){let t=Cl.find((t=>t.id===e));Il("#debetDescription").innerHTML=`<span>${t.name}</span> <br> <span>${t.type}</span>`}(e.target.value)}),!1),Il("#ks").addEventListener("input",(e=>{!function(e){let t=Cl.find((t=>t.id===e));Il("#creditDescription").innerHTML=`<span>${t.name}</span> <br> <span>${t.type}</span>`}(e.target.value)}),!1),Il("#savePost").addEventListener("click",(e=>function(){let e=Vl.getState().application.userEmail,t=Vl.getState().application.avatarUrl,n=Vl.getState().application.user,r=Vl.getState().application.email,i=Vl.getState().mediaId?!!Vl.getState().mediaId:kl("usersCraft/"+e+"/data/"),s=Vl.getState().postId?Vl.getState().postId:kl("usersCraft/"+e+"/posts/"),o={id:s,title:"Кейс по учету операций в банке "+s,theme:"Кейс по учету операций в банке",answer:"",comment:"Проводки",type:"media",content:i,quizString:"",deleted:!1,email:r,user:n,avatarUrl:t,date:new Intl.DateTimeFormat("ru",{weekday:"short",year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"numeric"}).format(new Date)},a={};a["usersCraft/"+e+"/posts/"+s]=o,a["usersCraft/"+e+"/data/"+i]={html:Il("#post").innerHTML},Vl.dispatch($l.endpoints.updatesForUserPosts.initiate({base:"",updates:a})).then((e=>{console.log(e),Vl.dispatch(Ml(s)),Vl.dispatch(jl(i))}))}()),!1),async function(){let e=await zl();if(e){t=Cl,Il("#ds").innerHTML=t.map((e=>`<option value=${e.id}>${e.conto}</option>`)).join(""),Il("#ks").innerHTML=t.map((e=>`<option value=${e.id}>${e.conto}</option>`)).join(""),Il("#periods").innerHTML=["2023","2024","2025","2026","2027"].map((e=>`<option value=${e}>${e}</option>`)).join(""),Il("#balancerecords").innerHTML=El.map((e=>`<option value=${e.name}>${e.name}</option>`)).join(""),Vl.dispatch(Rl(Cl)),await Vl.dispatch($l.endpoints.fetchUserPosts.initiate(e.userEmail)),Vl.dispatch(Ol(e));let n=await function(e,t="fulfilled"){return new Promise((n=>setTimeout((()=>n(t)),e)))}(2e3,"Loaded");return n}var t;Il("#formcontainer").style.display="block"}().then((()=>{console.log("simpleaccounting"),Ql()})),Ll}();
