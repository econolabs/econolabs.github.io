(window.webpackJsonp=window.webpackJsonp||[]).push([[426],{S6L3:function(e,t,n){"use strict";n.r(t);var r=n("q1tI"),a=n.n(r),o=(n("xtjI"),n("pJf4"),n("q8oJ"),n("cFtU"),n("m210"),n("4DPX"),n("HQhv"),n("gu/5"),n("eoYm"),n("Ggvi"),n("E5k/"),n("6kNP"),n("rzGZ"),n("Dq+y"),n("8npG"),n("YbXK"),n("Til1")),l=n("eDuk"),c=n.n(l),u=n("WV72"),i=(n("CtJk"),n("n7j8"),"undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)),s=new Uint8Array(16);function m(){if(!i)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return i(s)}n("C9fy");for(var f=[],p=0;p<256;++p)f.push((p+256).toString(16).substr(1));var y=function(e,t){var n=t||0;return(f[e[n+0]]+f[e[n+1]]+f[e[n+2]]+f[e[n+3]]+"-"+f[e[n+4]]+f[e[n+5]]+"-"+f[e[n+6]]+f[e[n+7]]+"-"+f[e[n+8]]+f[e[n+9]]+"-"+f[e[n+10]]+f[e[n+11]]+f[e[n+12]]+f[e[n+13]]+f[e[n+14]]+f[e[n+15]]).toLowerCase()};var b=function(e,t,n){var r=(e=e||{}).random||(e.rng||m)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,t){n=n||0;for(var a=0;a<16;++a)t[n+a]=r[a];return t}return y(r)},v=n("SGa5"),d=n("pKDO"),g=n("7vrA"),j=n("+YzT"),O=n("3Z9Z"),h=n("JI6e");function E(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function k(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?E(Object(n),!0).forEach((function(t){S(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):E(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function S(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _(e){return function(e){if(Array.isArray(e))return I(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return I(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return I(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function I(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var w=new c.a({allErrors:!0});function V(e){var t=w.compile(e);return function(e){if(t(e),t.errors&&t.errors.length)throw{details:t.errors}}}var D=function(e){var t,n,o=Object(r.useState)(!1),l=o[0],c=o[1],u=Object(r.useState)({}),i=u[0],s=u[1],m=Object(r.useState)(null),f=m[0],p=m[1],y=Object(r.useState)({}),b=y[0],O=y[1],h=Object(r.useState)({}),E=h[0],k=h[1],S=Object(d.a)();return Object(r.useEffect)((function(){var t,n=[];S.edges.forEach((function(e){n.push(e.node)}));var r,a={},o={};Object.keys(e.uniformSchema.properties).map((function(e){var t,r;a[e]=(null===(t=n.filter((function(t){return t.dictionaryId===e}))[0])||void 0===t?void 0:t.comment)||"Показатель",o[e]=(null===(r=n.filter((function(t){return t.dictionaryId===e}))[0])||void 0===r?void 0:r.type)||"text"})),O(a),k(o),(r=(null===(t=e.uniformSchema)||void 0===t?void 0:t.properties)?Object.keys(e.uniformSchema.properties):[],Promise.all(["currenttask"].concat(_(r)).map((function(e){return v.userCraft.getItem(e).then((function(t){var n;return(n={})[e]=t,n})).catch((function(t){var n;return console.log(t),(n={})[e]=null,n}))}))).then((function(e){return Object.assign.apply(Object,_(e))}))).then((function(e){var t=e.currenttask,n=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,["currenttask"]);p(t),s(n),c(!0)})).catch((function(e){console.log(e)}))}),[]),console.log(e),l&&!(null===(t=e.uniformSchema)||void 0===t?void 0:t.columns)?a.a.createElement(g.a,null,a.a.createElement(j.a,{fill:!0,className:"justify-content-center"},a.a.createElement(j.a.Item,null,a.a.createElement("small",null,f)),a.a.createElement(j.a.Item,null,a.a.createElement("small",null,e.uniformSchema.title))),a.a.createElement(C,{formDictionaryTitles:b,formDictionaryTypes:E,formInitialValues:i,currentTask:f,uniformSchema:e.uniformSchema})):l&&(null===(n=e.uniformSchema)||void 0===n?void 0:n.columns)&&e.uniformSchema.columns.length>1?a.a.createElement(g.a,null,a.a.createElement(j.a,{fill:!0,className:"justify-content-center"},a.a.createElement(j.a.Item,null,a.a.createElement("small",null,f)),a.a.createElement(j.a.Item,null,a.a.createElement("small",null,e.uniformSchema.title))),a.a.createElement(P,{formDictionaryTitles:b,formDictionaryTypes:E,formInitialValues:i,formColumns:e.uniformSchema.columns,currentTask:f,uniformSchema:e.uniformSchema})):null};function P(e){var t=Object(r.useState)(!1),n=t[0],l=t[1],c=Object(r.useState)({}),i=c[0],s=c[1],m=Object(r.useState)({}),f=m[0],p=m[1],y=Object(r.useState)([]),d=y[0],j=y[1],E=e.currentTask;Object(r.useEffect)((function(){var t={},n=[],r={};console.log(e.formInitialValues),Object.keys(e.uniformSchema.properties).map((function(r){e.formColumns.map((function(a){var o=r+"_|_"+a;t[o]=e.uniformSchema.properties[r],n.push(o)}))})),console.log(t),Object.keys(e.formInitialValues||{}).forEach((function(t){var n=e.formInitialValues[t];Object.keys(n||{}).forEach((function(e){var a;if((null===(a=n[e])||void 0===a?void 0:a.currenttask)&&n[e].currenttask===E){var o,l,c=null==n||null===(o=n[e])||void 0===o?void 0:o.period,u=null==n||null===(l=n[e])||void 0===l?void 0:l.value;r[t+"_|_"+c]=u}}))})),j(n),p(t),s(r),l(!0)}),[]),console.log(e);var S=k(k({},e.uniformSchema),{},{properties:f,required:d}),_=new u.a(S,V(S));return console.log(i),a.a.createElement(g.a,null,n?a.a.createElement(o.b,{schema:_,model:i,onSubmit:function(t){return function(t){console.log(t);var n={};Object.keys(e.formInitialValues).map((function(r){n[r]=k({},e.formInitialValues[r]),Object.keys(t).map((function(a){if(a.includes(r)){var o=a.split("_|_"),l=null;e.formInitialValues[r]&&Object.keys(e.formInitialValues[r]).forEach((function(t){var n=e.formInitialValues[r][t];n.currenttask===E&&n.period===o[1]&&(l=t)})),l?(n[r][l]={currenttask:E,period:o[1],context:"Default",value:t[a]},console.log(n[r])):(n[r][b()]={currenttask:E,period:o[1],context:"Default",value:t[a]},console.log(n[r]))}}))}));var r=[];for(var a in Object.keys(n)){var o=Object.keys(n)[a];r.push(v.userCraft.setItem(o,n[o]))}Promise.all(r).then((function(){l(!0)}))}(t)},className:"m-3"},a.a.createElement(O.a,null,a.a.createElement(h.a,null,"Показатели"),e.formColumns.map((function(e){return a.a.createElement(h.a,{key:e},e)}))),Object.keys(e.uniformSchema.properties).map((function(t){return a.a.createElement(O.a,{key:t},a.a.createElement(h.a,null,e.formDictionaryTitles[t]),e.formColumns.map((function(e){return a.a.createElement(h.a,{key:e},a.a.createElement(o.a,{name:t+"_|_"+e,key:t+"_|_"+e}))})))})),Object.keys(f).map((function(e){return a.a.createElement(O.a,{key:e},a.a.createElement(o.c,{name:e,key:e}))})),a.a.createElement(o.e,null)):null)}function C(e){var t=Object(r.useState)(!1),n=t[0],l=t[1],c=Object(r.useState)({}),i=c[0],s=c[1],m=e.currentTask;Object(r.useEffect)((function(){var t={};Object.keys(e.formInitialValues||{}).forEach((function(n){var r=e.formInitialValues[n];Object.keys(r||{}).forEach((function(e){var a;if((null===(a=r[e])||void 0===a?void 0:a.currenttask)&&r[e].currenttask===m){var o,l=null==r||null===(o=r[e])||void 0===o?void 0:o.value;t[n]=l}}))})),s(t),l(!0)}),[]),console.log(i);var f=k({},e.uniformSchema),p=new u.a(f,V(f));return n?a.a.createElement("div",{style:{margin:"0 auto",maxWidth:800,padding:"2rem"}},a.a.createElement("div",{className:"m-3"},a.a.createElement(o.b,{schema:p,model:i,onSubmit:function(t){return function(t){var n={};Object.keys(e.formInitialValues).map((function(r){console.log(r),n[r]=k({},e.formInitialValues[r]),console.log(r),Object.keys(t).map((function(a){if(a.includes(r)){var o=null;e.formInitialValues[r]&&Object.keys(e.formInitialValues[r]).forEach((function(t){e.formInitialValues[r][t].currenttask===m&&(o=t)})),o?(n[r][o]={currenttask:m,context:"Default",value:t[a]},console.log(n[r])):(n[r][b()]={currenttask:m,context:"Default",value:t[a]},console.log(n[r]))}}))}));var r=[];for(var a in Object.keys(n)){var o=Object.keys(n)[a];r.push(v.userCraft.setItem(o,n[o]))}Promise.all(r).then((function(){l(!0)}))}(t)}}))):null}var T=n("LbRr"),x=n("pJDg"),N=n("cWnB"),A=[{title:"Сведения о проекте",type:"object",properties:{currentcompanyfullname:{type:"string",label:"Название компании"},currentcompanyreporturl:{type:"string",label:"Название компании"},currentcompanyunitofmoney:{type:"string",label:"Ден. ед."},additionalInfo:{type:"string",label:"Комментарий"}},required:["currentcompanyfullname","currentcompanyreporturl","currentcompanyunitofmoney"]},{title:"Структура баланса",type:"object",columns:["2017","2018","2019"],properties:{code2110_minfin_ru_66n:{type:"integer",label:""},code1100_minfin_ru_66n:{type:"integer",label:""},code1200_minfin_ru_66n:{type:"integer",label:""},code1300_minfin_ru_66n:{type:"integer",label:""},code1400_minfin_ru_66n:{type:"integer",label:""},code1500_minfin_ru_66n:{type:"integer",label:""}},required:["code2110_minfin_ru_66n","code1100_minfin_ru_66n","code1200_minfin_ru_66n","code1300_minfin_ru_66n","code1400_minfin_ru_66n","code1500_minfin_ru_66n"]}];t.default=function(){var e=Object(r.useState)(0),t=e[0],n=e[1],o=Object(r.useState)(!0),l=o[0],c=o[1],u=Object(r.useState)(A[0]),i=u[0],s=u[1];return a.a.useEffect((function(){c(!1),s(A[t]);var e=setTimeout((function(){c(!0)}),0);return function(){return clearTimeout(e)}}),[t]),console.log(A[t]),a.a.createElement(a.a.Fragment,null,a.a.createElement(T.a,{siteTitle:"Econolabs"}),a.a.createElement(O.a,null,a.a.createElement(h.a,{sm:"3"},a.a.createElement(x.a,{vertical:!0,className:"m-5",size:"sm",style:{with:"100%"}},A.map((function(e,t){return a.a.createElement(N.a,{key:t,variant:"outline-secondary",onClick:function(){return n(t)}},e.title)})))),a.a.createElement(h.a,{sm:"9"},a.a.createElement(g.a,null,l?a.a.createElement(D,{uniformSchema:i}):null))))}},pJDg:function(e,t,n){"use strict";var r=n("wx14"),a=n("zLVn"),o=n("TSYQ"),l=n.n(o),c=n("q1tI"),u=n.n(c),i=n("vUet"),s=u.a.forwardRef((function(e,t){var n=e.bsPrefix,o=e.size,c=e.toggle,s=e.vertical,m=e.className,f=e.as,p=void 0===f?"div":f,y=Object(a.a)(e,["bsPrefix","size","toggle","vertical","className","as"]),b=Object(i.b)(n,"btn-group"),v=b;return s&&(v=b+"-vertical"),u.a.createElement(p,Object(r.a)({},y,{ref:t,className:l()(m,v,o&&b+"-"+o,c&&b+"-toggle")}))}));s.displayName="ButtonGroup",s.defaultProps={vertical:!1,toggle:!1,role:"group"},t.a=s}}]);
//# sourceMappingURL=component---src-pages-financial-analysis-lab-js-b44b0e80ef9859ff4ba2.js.map