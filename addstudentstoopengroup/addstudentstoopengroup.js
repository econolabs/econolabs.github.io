!function(){"use strict";!function(){const e={NODE_ENV:"production"};try{if(process)return process.env=Object.assign({},process.env),void Object.assign(process.env,e)}catch(e){}globalThis.process={env:e}}();const e=!1,t="${JSCORE_VERSION}",n=function(e,t){if(!e)throw r(t)},r=function(e){return new Error("Firebase Database ("+t+") INTERNAL ASSERT FAILED: "+e)},i=function(e){const t=[];let n=0;for(let r=0;r<e.length;r++){let i=e.charCodeAt(r);i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):55296==(64512&i)&&r+1<e.length&&56320==(64512&e.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&e.charCodeAt(++r)),t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t},s={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let t=0;t<e.length;t+=3){const i=e[t],s=t+1<e.length,o=s?e[t+1]:0,a=t+2<e.length,c=a?e[t+2]:0,u=i>>2,l=(3&i)<<4|o>>4;let h=(15&o)<<2|c>>6,d=63&c;a||(d=64,s||(h=64)),r.push(n[u],n[l],n[h],n[d])}return r.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(i(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){const t=[];let n=0,r=0;for(;n<e.length;){const i=e[n++];if(i<128)t[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=e[n++];t[r++]=String.fromCharCode((31&i)<<6|63&s)}else if(i>239&&i<365){const s=((7&i)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536;t[r++]=String.fromCharCode(55296+(s>>10)),t[r++]=String.fromCharCode(56320+(1023&s))}else{const s=e[n++],o=e[n++];t[r++]=String.fromCharCode((15&i)<<12|(63&s)<<6|63&o)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let t=0;t<e.length;){const i=n[e.charAt(t++)],s=t<e.length?n[e.charAt(t)]:0;++t;const a=t<e.length?n[e.charAt(t)]:64;++t;const c=t<e.length?n[e.charAt(t)]:64;if(++t,null==i||null==s||null==a||null==c)throw new o;const u=i<<2|s>>4;if(r.push(u),64!==a){const e=s<<4&240|a>>2;if(r.push(e),64!==c){const e=a<<6&192|c;r.push(e)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class o extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const a=function(e){const t=i(e);return s.encodeByteArray(t,!0)},c=function(e){return a(e).replace(/\./g,"")},u=function(e){try{return s.decodeString(e,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function l(e){return h(void 0,e)}function h(e,t){if(!(t instanceof Object))return t;switch(t.constructor){case Date:return new Date(t.getTime());case Object:void 0===e&&(e={});break;case Array:e=[];break;default:return t}for(const n in t)t.hasOwnProperty(n)&&"__proto__"!==n&&(e[n]=h(e[n],t[n]));return e}const d=()=>function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if("undefined"!=typeof global)return global;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__,p=()=>{try{return d()||(()=>{if("undefined"==typeof process||void 0===process.env)return;const e=process.env.__FIREBASE_DEFAULTS__;return e?JSON.parse(e):void 0})()||(()=>{if("undefined"==typeof document)return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(e){return}const t=e&&u(e[1]);return t&&JSON.parse(t)})()}catch(e){return void console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${e}`)}},f=e=>{var t,n;return null===(n=null===(t=p())||void 0===t?void 0:t.emulatorHosts)||void 0===n?void 0:n[e]},m=()=>{var e;return null===(e=p())||void 0===e?void 0:e.config},g=e=>{var t;return null===(t=p())||void 0===t?void 0:t[`_${e}`]};class _{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),"function"==typeof e&&(this.promise.catch((()=>{})),1===e.length?e(t):e(t,n))}}}function y(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function v(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(y())}function w(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function b(){return!0===e}class I extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,I.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,C.prototype.create)}}class C{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e,...t){const n=t[0]||{},r=`${this.service}/${e}`,i=this.errors[e],s=i?function(e,t){return e.replace(E,((e,n)=>{const r=t[n];return null!=r?String(r):`<${n}?>`}))}(i,n):"Error",o=`${this.serviceName}: ${s} (${r}).`;return new I(r,o,n)}}const E=/\{\$([^}]+)}/g;function T(e){return JSON.parse(e)}function S(e){return JSON.stringify(e)}const k=function(e){let t={},n={},r={},i="";try{const s=e.split(".");t=T(u(s[0])||""),n=T(u(s[1])||""),i=s[2],r=n.d||{},delete n.d}catch(e){}return{header:t,claims:n,data:r,signature:i}};function N(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function P(e,t){return Object.prototype.hasOwnProperty.call(e,t)?e[t]:void 0}function R(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}function O(e,t,n){const r={};for(const i in e)Object.prototype.hasOwnProperty.call(e,i)&&(r[i]=t.call(n,e[i],i,e));return r}function A(e,t){if(e===t)return!0;const n=Object.keys(e),r=Object.keys(t);for(const i of n){if(!r.includes(i))return!1;const n=e[i],s=t[i];if(D(n)&&D(s)){if(!A(n,s))return!1}else if(n!==s)return!1}for(const e of r)if(!n.includes(e))return!1;return!0}function D(e){return null!==e&&"object"==typeof e}function x(e){const t=[];for(const[n,r]of Object.entries(e))Array.isArray(r)?r.forEach((e=>{t.push(encodeURIComponent(n)+"="+encodeURIComponent(e))})):t.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return t.length?"&"+t.join("&"):""}class M{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,t){t||(t=0);const n=this.W_;if("string"==typeof e)for(let r=0;r<16;r++)n[r]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3),t+=4;else for(let r=0;r<16;r++)n[r]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],t+=4;for(let e=16;e<80;e++){const t=n[e-3]^n[e-8]^n[e-14]^n[e-16];n[e]=4294967295&(t<<1|t>>>31)}let r,i,s=this.chain_[0],o=this.chain_[1],a=this.chain_[2],c=this.chain_[3],u=this.chain_[4];for(let e=0;e<80;e++){e<40?e<20?(r=c^o&(a^c),i=1518500249):(r=o^a^c,i=1859775393):e<60?(r=o&a|c&(o|a),i=2400959708):(r=o^a^c,i=3395469782);const t=(s<<5|s>>>27)+r+u+i+n[e]&4294967295;u=c,c=a,a=4294967295&(o<<30|o>>>2),o=s,s=t}this.chain_[0]=this.chain_[0]+s&4294967295,this.chain_[1]=this.chain_[1]+o&4294967295,this.chain_[2]=this.chain_[2]+a&4294967295,this.chain_[3]=this.chain_[3]+c&4294967295,this.chain_[4]=this.chain_[4]+u&4294967295}update(e,t){if(null==e)return;void 0===t&&(t=e.length);const n=t-this.blockSize;let r=0;const i=this.buf_;let s=this.inbuf_;for(;r<t;){if(0===s)for(;r<=n;)this.compress_(e,r),r+=this.blockSize;if("string"==typeof e){for(;r<t;)if(i[s]=e.charCodeAt(r),++s,++r,s===this.blockSize){this.compress_(i),s=0;break}}else for(;r<t;)if(i[s]=e[r],++s,++r,s===this.blockSize){this.compress_(i),s=0;break}}this.inbuf_=s,this.total_+=t}digest(){const e=[];let t=8*this.total_;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let e=this.blockSize-1;e>=56;e--)this.buf_[e]=255&t,t/=256;this.compress_(this.buf_);let n=0;for(let t=0;t<5;t++)for(let r=24;r>=0;r-=8)e[n]=this.chain_[t]>>r&255,++n;return e}}class L{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then((()=>{e(this)})).catch((e=>{this.error(e)}))}next(e){this.forEachObserver((t=>{t.next(e)}))}error(e){this.forEachObserver((t=>{t.error(e)})),this.close(e)}complete(){this.forEachObserver((e=>{e.complete()})),this.close()}subscribe(e,t,n){let r;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");r=function(e,t){if("object"!=typeof e||null===e)return!1;for(const n of t)if(n in e&&"function"==typeof e[n])return!0;return!1}(e,["next","error","complete"])?e:{next:e,error:t,complete:n},void 0===r.next&&(r.next=q),void 0===r.error&&(r.error=q),void 0===r.complete&&(r.complete=q);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch(e){}})),this.observers.push(r),i}unsubscribeOne(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then((()=>{if(void 0!==this.observers&&void 0!==this.observers[e])try{t(this.observers[e])}catch(e){"undefined"!=typeof console&&console.error&&console.error(e)}}))}close(e){this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then((()=>{this.observers=void 0,this.onNoObservers=void 0})))}}function q(){}function j(e,t){return`${e} failed: ${t} argument `}const F=function(e){let t=0;for(let n=0;n<e.length;n++){const r=e.charCodeAt(n);r<128?t++:r<2048?t+=2:r>=55296&&r<=56319?(t+=4,n++):t+=3}return t};function U(e){return e&&e._delegate?e._delegate:e}class V{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const z="[DEFAULT]";class W{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const e=new _;if(this.instancesDeferred.set(t,e),this.isInitialized(t)||this.shouldAutoInitialize())try{const n=this.getOrInitializeService({instanceIdentifier:t});n&&e.resolve(n)}catch(e){}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const n=this.normalizeInstanceIdentifier(null==e?void 0:e.identifier),r=null!==(t=null==e?void 0:e.optional)&&void 0!==t&&t;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(r)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(e){if(r)return null;throw e}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,this.shouldAutoInitialize()){if(function(e){return"EAGER"===e.instantiationMode}(e))try{this.getOrInitializeService({instanceIdentifier:z})}catch(e){}for(const[e,t]of this.instancesDeferred.entries()){const n=this.normalizeInstanceIdentifier(e);try{const e=this.getOrInitializeService({instanceIdentifier:n});t.resolve(e)}catch(e){}}}}clearInstance(e=z){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter((e=>"INTERNAL"in e)).map((e=>e.INTERNAL.delete())),...e.filter((e=>"_delete"in e)).map((e=>e._delete()))])}isComponentSet(){return null!=this.component}isInitialized(e=z){return this.instances.has(e)}getOptions(e=z){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[e,t]of this.instancesDeferred.entries()){n===this.normalizeInstanceIdentifier(e)&&t.resolve(r)}return r}onInit(e,t){var n;const r=this.normalizeInstanceIdentifier(t),i=null!==(n=this.onInitCallbacks.get(r))&&void 0!==n?n:new Set;i.add(e),this.onInitCallbacks.set(r,i);const s=this.instances.get(r);return s&&e(s,r),()=>{i.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const r of n)try{r(e,t)}catch(e){}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:(r=e,r===z?void 0:r),options:t}),this.instances.set(e,n),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch(e){}var r;return n||null}normalizeInstanceIdentifier(e=z){return this.component?this.component.multipleInstances?e:z:e}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class ${constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new W(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}var B;!function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"}(B||(B={}));const H={debug:B.DEBUG,verbose:B.VERBOSE,info:B.INFO,warn:B.WARN,error:B.ERROR,silent:B.SILENT},K=B.INFO,Q={[B.DEBUG]:"log",[B.VERBOSE]:"log",[B.INFO]:"info",[B.WARN]:"warn",[B.ERROR]:"error"},G=(e,t,...n)=>{if(t<e.logLevel)return;const r=(new Date).toISOString(),i=Q[t];if(!i)throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`);console[i](`[${r}]  ${e.name}:`,...n)};class Y{constructor(e){this.name=e,this._logLevel=K,this._logHandler=G,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in B))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel="string"==typeof e?H[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!=typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,B.DEBUG,...e),this._logHandler(this,B.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,B.VERBOSE,...e),this._logHandler(this,B.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,B.INFO,...e),this._logHandler(this,B.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,B.WARN,...e),this._logHandler(this,B.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,B.ERROR,...e),this._logHandler(this,B.ERROR,...e)}}const J=(e,t)=>t.some((t=>e instanceof t));let X,Z;const ee=new WeakMap,te=new WeakMap,ne=new WeakMap,re=new WeakMap,ie=new WeakMap;let se={get(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return te.get(e);if("objectStoreNames"===t)return e.objectStoreNames||ne.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return ce(e[t])},set:(e,t,n)=>(e[t]=n,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function oe(e){return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(Z||(Z=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(...t){return e.apply(ue(this),t),ce(ee.get(this))}:function(...t){return ce(e.apply(ue(this),t))}:function(t,...n){const r=e.call(ue(this),t,...n);return ne.set(r,t.sort?t.sort():[t]),ce(r)}}function ae(e){return"function"==typeof e?oe(e):(e instanceof IDBTransaction&&function(e){if(te.has(e))return;const t=new Promise(((t,n)=>{const r=()=>{e.removeEventListener("complete",i),e.removeEventListener("error",s),e.removeEventListener("abort",s)},i=()=>{t(),r()},s=()=>{n(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",i),e.addEventListener("error",s),e.addEventListener("abort",s)}));te.set(e,t)}(e),J(e,X||(X=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(e,se):e)}function ce(e){if(e instanceof IDBRequest)return function(e){const t=new Promise(((t,n)=>{const r=()=>{e.removeEventListener("success",i),e.removeEventListener("error",s)},i=()=>{t(ce(e.result)),r()},s=()=>{n(e.error),r()};e.addEventListener("success",i),e.addEventListener("error",s)}));return t.then((t=>{t instanceof IDBCursor&&ee.set(t,e)})).catch((()=>{})),ie.set(t,e),t}(e);if(re.has(e))return re.get(e);const t=ae(e);return t!==e&&(re.set(e,t),ie.set(t,e)),t}const ue=e=>ie.get(e);const le=["get","getKey","getAll","getAllKeys","count"],he=["put","add","delete","clear"],de=new Map;function pe(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!=typeof t)return;if(de.get(t))return de.get(t);const n=t.replace(/FromIndex$/,""),r=t!==n,i=he.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!i&&!le.includes(n))return;const s=async function(e,...t){const s=this.transaction(e,i?"readwrite":"readonly");let o=s.store;return r&&(o=o.index(t.shift())),(await Promise.all([o[n](...t),i&&s.done]))[0]};return de.set(t,s),s}se=(e=>({...e,get:(t,n,r)=>pe(t,n)||e.get(t,n,r),has:(t,n)=>!!pe(t,n)||e.has(t,n)}))(se);class fe{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map((e=>{if(function(e){const t=e.getComponent();return"VERSION"===(null==t?void 0:t.type)}(e)){const t=e.getImmediate();return`${t.library}/${t.version}`}return null})).filter((e=>e)).join(" ")}}const me="@firebase/app",ge="0.10.9",_e=new Y("@firebase/app"),ye="@firebase/app-compat",ve="@firebase/analytics-compat",we="@firebase/analytics",be="@firebase/app-check-compat",Ie="@firebase/app-check",Ce="@firebase/auth",Ee="@firebase/auth-compat",Te="@firebase/database",Se="@firebase/database-compat",ke="@firebase/functions",Ne="@firebase/functions-compat",Pe="@firebase/installations",Re="@firebase/installations-compat",Oe="@firebase/messaging",Ae="@firebase/messaging-compat",De="@firebase/performance",xe="@firebase/performance-compat",Me="@firebase/remote-config",Le="@firebase/remote-config-compat",qe="@firebase/storage",je="@firebase/storage-compat",Fe="@firebase/firestore",Ue="@firebase/vertexai-preview",Ve="@firebase/firestore-compat",ze="firebase",We="[DEFAULT]",$e={[me]:"fire-core",[ye]:"fire-core-compat",[we]:"fire-analytics",[ve]:"fire-analytics-compat",[Ie]:"fire-app-check",[be]:"fire-app-check-compat",[Ce]:"fire-auth",[Ee]:"fire-auth-compat",[Te]:"fire-rtdb",[Se]:"fire-rtdb-compat",[ke]:"fire-fn",[Ne]:"fire-fn-compat",[Pe]:"fire-iid",[Re]:"fire-iid-compat",[Oe]:"fire-fcm",[Ae]:"fire-fcm-compat",[De]:"fire-perf",[xe]:"fire-perf-compat",[Me]:"fire-rc",[Le]:"fire-rc-compat",[qe]:"fire-gcs",[je]:"fire-gcs-compat",[Fe]:"fire-fst",[Ve]:"fire-fst-compat",[Ue]:"fire-vertex","fire-js":"fire-js",[ze]:"fire-js-all"},Be=new Map,He=new Map,Ke=new Map;function Qe(e,t){try{e.container.addComponent(t)}catch(n){_e.debug(`Component ${t.name} failed to register with FirebaseApp ${e.name}`,n)}}function Ge(e){const t=e.name;if(Ke.has(t))return _e.debug(`There were multiple attempts to register component ${t}.`),!1;Ke.set(t,e);for(const t of Be.values())Qe(t,e);for(const t of He.values())Qe(t,e);return!0}function Ye(e,t){const n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}function Je(e){return void 0!==e.settings}const Xe=new C("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."});class Ze{constructor(e,t,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new V("app",(()=>this),"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Xe.create("app-deleted",{appName:this._name})}}const et="10.13.0";function tt(e,t={}){let n=e;if("object"!=typeof t){t={name:t}}const r=Object.assign({name:We,automaticDataCollectionEnabled:!1},t),i=r.name;if("string"!=typeof i||!i)throw Xe.create("bad-app-name",{appName:String(i)});if(n||(n=m()),!n)throw Xe.create("no-options");const s=Be.get(i);if(s){if(A(n,s.options)&&A(r,s.config))return s;throw Xe.create("duplicate-app",{appName:i})}const o=new $(i);for(const e of Ke.values())o.addComponent(e);const a=new Ze(n,r,o);return Be.set(i,a),a}function nt(e=We){const t=Be.get(e);if(!t&&e===We&&m())return tt();if(!t)throw Xe.create("no-app",{appName:e});return t}function rt(e,t,n){var r;let i=null!==(r=$e[e])&&void 0!==r?r:e;n&&(i+=`-${n}`);const s=i.match(/\s|\//),o=t.match(/\s|\//);if(s||o){const e=[`Unable to register library "${i}" with version "${t}":`];return s&&e.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&o&&e.push("and"),o&&e.push(`version name "${t}" contains illegal characters (whitespace or "/")`),void _e.warn(e.join(" "))}Ge(new V(`${i}-version`,(()=>({library:i,version:t})),"VERSION"))}const it="firebase-heartbeat-database",st=1,ot="firebase-heartbeat-store";let at=null;function ct(){return at||(at=function(e,t,{blocked:n,upgrade:r,blocking:i,terminated:s}={}){const o=indexedDB.open(e,t),a=ce(o);return r&&o.addEventListener("upgradeneeded",(e=>{r(ce(o.result),e.oldVersion,e.newVersion,ce(o.transaction),e)})),n&&o.addEventListener("blocked",(e=>n(e.oldVersion,e.newVersion,e))),a.then((e=>{s&&e.addEventListener("close",(()=>s())),i&&e.addEventListener("versionchange",(e=>i(e.oldVersion,e.newVersion,e)))})).catch((()=>{})),a}(it,st,{upgrade:(e,t)=>{if(0===t)try{e.createObjectStore(ot)}catch(e){console.warn(e)}}}).catch((e=>{throw Xe.create("idb-open",{originalErrorMessage:e.message})}))),at}async function ut(e,t){try{const n=(await ct()).transaction(ot,"readwrite"),r=n.objectStore(ot);await r.put(t,lt(e)),await n.done}catch(e){if(e instanceof I)_e.warn(e.message);else{const t=Xe.create("idb-set",{originalErrorMessage:null==e?void 0:e.message});_e.warn(t.message)}}}function lt(e){return`${e.name}!${e.options.appId}`}class ht{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new pt(t),this._heartbeatsCachePromise=this._storage.read().then((e=>(this._heartbeatsCache=e,e)))}async triggerHeartbeat(){var e,t,n;try{const r=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=dt();if(console.log("heartbeats",null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats),null==(null===(t=this._heartbeatsCache)||void 0===t?void 0:t.heartbeats)&&(this._heartbeatsCache=await this._heartbeatsCachePromise,null==(null===(n=this._heartbeatsCache)||void 0===n?void 0:n.heartbeats)))return;if(this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some((e=>e.date===i)))return;return this._heartbeatsCache.heartbeats.push({date:i,agent:r}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter((e=>{const t=new Date(e.date).valueOf();return Date.now()-t<=2592e6})),this._storage.overwrite(this._heartbeatsCache)}catch(e){_e.warn(e)}}async getHeartbeatsHeader(){var e;try{if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,null==(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)||0===this._heartbeatsCache.heartbeats.length)return"";const t=dt(),{heartbeatsToSend:n,unsentEntries:r}=function(e,t=1024){const n=[];let r=e.slice();for(const i of e){const e=n.find((e=>e.agent===i.agent));if(e){if(e.dates.push(i.date),ft(n)>t){e.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),ft(n)>t){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}(this._heartbeatsCache.heartbeats),i=c(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=t,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(e){return _e.warn(e),""}}}function dt(){return(new Date).toISOString().substring(0,10)}class pt{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!function(){try{return"object"==typeof indexedDB}catch(e){return!1}}()&&new Promise(((e,t)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),e(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var e;t((null===(e=i.error)||void 0===e?void 0:e.message)||"")}}catch(e){t(e)}})).then((()=>!0)).catch((()=>!1))}async read(){if(await this._canUseIndexedDBPromise){const e=await async function(e){try{const t=(await ct()).transaction(ot),n=await t.objectStore(ot).get(lt(e));return await t.done,n}catch(e){if(e instanceof I)_e.warn(e.message);else{const t=Xe.create("idb-get",{originalErrorMessage:null==e?void 0:e.message});_e.warn(t.message)}}}(this.app);return(null==e?void 0:e.heartbeats)?e:{heartbeats:[]}}return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const n=await this.read();return ut(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}}async add(e){var t;if(await this._canUseIndexedDBPromise){const n=await this.read();return ut(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}}}function ft(e){return c(JSON.stringify({version:2,heartbeats:e})).length}var mt;mt="",Ge(new V("platform-logger",(e=>new fe(e)),"PRIVATE")),Ge(new V("heartbeat",(e=>new ht(e)),"PRIVATE")),rt(me,ge,mt),rt(me,ge,"esm2017"),rt("fire-js","");rt("firebase","10.13.0","app");const gt="@firebase/database",_t="1.0.7";let yt="";class vt{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,t){null==t?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),S(t))}get(e){const t=this.domStorage_.getItem(this.prefixedName_(e));return null==t?null:T(t)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}class wt{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,t){null==t?delete this.cache_[e]:this.cache_[e]=t}get(e){return N(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}const bt=function(e){try{if("undefined"!=typeof window&&void 0!==window[e]){const t=window[e];return t.setItem("firebase:sentinel","cache"),t.removeItem("firebase:sentinel"),new vt(t)}}catch(e){}return new wt},It=bt("localStorage"),Ct=bt("sessionStorage"),Et=new Y("@firebase/database"),Tt=function(){let e=1;return function(){return e++}}(),St=function(e){const t=function(e){const t=[];let r=0;for(let i=0;i<e.length;i++){let s=e.charCodeAt(i);if(s>=55296&&s<=56319){const t=s-55296;i++,n(i<e.length,"Surrogate pair missing trail surrogate."),s=65536+(t<<10)+(e.charCodeAt(i)-56320)}s<128?t[r++]=s:s<2048?(t[r++]=s>>6|192,t[r++]=63&s|128):s<65536?(t[r++]=s>>12|224,t[r++]=s>>6&63|128,t[r++]=63&s|128):(t[r++]=s>>18|240,t[r++]=s>>12&63|128,t[r++]=s>>6&63|128,t[r++]=63&s|128)}return t}(e),r=new M;r.update(t);const i=r.digest();return s.encodeByteArray(i)},kt=function(...e){let t="";for(let n=0;n<e.length;n++){const r=e[n];Array.isArray(r)||r&&"object"==typeof r&&"number"==typeof r.length?t+=kt.apply(null,r):t+="object"==typeof r?S(r):r,t+=" "}return t};let Nt=null,Pt=!0;const Rt=function(...e){var t;if(!0===Pt&&(Pt=!1,null===Nt&&!0===Ct.get("logging_enabled")&&(n(!t,"Can't turn on custom loggers persistently."),Et.logLevel=B.VERBOSE,Nt=Et.log.bind(Et))),Nt){const t=kt.apply(null,e);Nt(t)}},Ot=function(e){return function(...t){Rt(e,...t)}},At=function(...e){const t="FIREBASE INTERNAL ERROR: "+kt(...e);Et.error(t)},Dt=function(...e){const t=`FIREBASE FATAL ERROR: ${kt(...e)}`;throw Et.error(t),new Error(t)},xt=function(...e){const t="FIREBASE WARNING: "+kt(...e);Et.warn(t)},Mt=function(e){return"number"==typeof e&&(e!=e||e===Number.POSITIVE_INFINITY||e===Number.NEGATIVE_INFINITY)},Lt="[MIN_NAME]",qt="[MAX_NAME]",jt=function(e,t){if(e===t)return 0;if(e===Lt||t===qt)return-1;if(t===Lt||e===qt)return 1;{const n=Ht(e),r=Ht(t);return null!==n?null!==r?n-r==0?e.length-t.length:n-r:-1:null!==r?1:e<t?-1:1}},Ft=function(e,t){return e===t?0:e<t?-1:1},Ut=function(e,t){if(t&&e in t)return t[e];throw new Error("Missing required key ("+e+") in object: "+S(t))},Vt=function(e){if("object"!=typeof e||null===e)return S(e);const t=[];for(const n in e)t.push(n);t.sort();let n="{";for(let r=0;r<t.length;r++)0!==r&&(n+=","),n+=S(t[r]),n+=":",n+=Vt(e[t[r]]);return n+="}",n},zt=function(e,t){const n=e.length;if(n<=t)return[e];const r=[];for(let i=0;i<n;i+=t)i+t>n?r.push(e.substring(i,n)):r.push(e.substring(i,i+t));return r};function Wt(e,t){for(const n in e)e.hasOwnProperty(n)&&t(n,e[n])}const $t=function(e){n(!Mt(e),"Invalid JSON number");const t=1023;let r,i,s,o,a;0===e?(i=0,s=0,r=1/e==-1/0?1:0):(r=e<0,(e=Math.abs(e))>=Math.pow(2,-1022)?(o=Math.min(Math.floor(Math.log(e)/Math.LN2),t),i=o+t,s=Math.round(e*Math.pow(2,52-o)-Math.pow(2,52))):(i=0,s=Math.round(e/Math.pow(2,-1074))));const c=[];for(a=52;a;a-=1)c.push(s%2?1:0),s=Math.floor(s/2);for(a=11;a;a-=1)c.push(i%2?1:0),i=Math.floor(i/2);c.push(r?1:0),c.reverse();const u=c.join("");let l="";for(a=0;a<64;a+=8){let e=parseInt(u.substr(a,8),2).toString(16);1===e.length&&(e="0"+e),l+=e}return l.toLowerCase()};const Bt=new RegExp("^-?(0*)\\d{1,10}$"),Ht=function(e){if(Bt.test(e)){const t=Number(e);if(t>=-2147483648&&t<=2147483647)return t}return null},Kt=function(e){try{e()}catch(e){setTimeout((()=>{const t=e.stack||"";throw xt("Exception was thrown by user callback.",t),e}),Math.floor(0))}},Qt=function(e,t){const n=setTimeout(e,t);return"number"==typeof n&&"undefined"!=typeof Deno&&Deno.unrefTimer?Deno.unrefTimer(n):"object"==typeof n&&n.unref&&n.unref(),n};class Gt{constructor(e,t){this.appName_=e,this.appCheckProvider=t,this.appCheck=null==t?void 0:t.getImmediate({optional:!0}),this.appCheck||null==t||t.get().then((e=>this.appCheck=e))}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise(((t,n)=>{setTimeout((()=>{this.appCheck?this.getToken(e).then(t,n):t(null)}),0)}))}addTokenChangeListener(e){var t;null===(t=this.appCheckProvider)||void 0===t||t.get().then((t=>t.addTokenListener(e)))}notifyForInvalidToken(){xt(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}}class Yt{constructor(e,t,n){this.appName_=e,this.firebaseOptions_=t,this.authProvider_=n,this.auth_=null,this.auth_=n.getImmediate({optional:!0}),this.auth_||n.onInit((e=>this.auth_=e))}getToken(e){return this.auth_?this.auth_.getToken(e).catch((e=>e&&"auth/token-not-initialized"===e.code?(Rt("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(e))):new Promise(((t,n)=>{setTimeout((()=>{this.auth_?this.getToken(e).then(t,n):t(null)}),0)}))}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then((t=>t.addAuthTokenListener(e)))}removeTokenChangeListener(e){this.authProvider_.get().then((t=>t.removeAuthTokenListener(e)))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',xt(e)}}class Jt{constructor(e){this.accessToken=e}getToken(e){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(e){e(this.accessToken)}removeTokenChangeListener(e){}notifyForInvalidToken(){}}Jt.OWNER="owner";const Xt=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,Zt="ac",en="websocket",tn="long_polling";class nn{constructor(e,t,n,r,i=!1,s="",o=!1,a=!1){this.secure=t,this.namespace=n,this.webSocketOnly=r,this.nodeAdmin=i,this.persistenceKey=s,this.includeNamespaceInQueryParams=o,this.isUsingEmulator=a,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=It.get("host:"+e)||this._host}isCacheableHost(){return"s-"===this.internalHost.substr(0,2)}isCustomHost(){return"firebaseio.com"!==this._domain&&"firebaseio-demo.com"!==this._domain}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&It.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){const e=this.secure?"https://":"http://",t=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${t}`}}function rn(e,t,r){let i;if(n("string"==typeof t,"typeof type must == string"),n("object"==typeof r,"typeof params must == object"),t===en)i=(e.secure?"wss://":"ws://")+e.internalHost+"/.ws?";else{if(t!==tn)throw new Error("Unknown connection type: "+t);i=(e.secure?"https://":"http://")+e.internalHost+"/.lp?"}(function(e){return e.host!==e.internalHost||e.isCustomHost()||e.includeNamespaceInQueryParams})(e)&&(r.ns=e.namespace);const s=[];return Wt(r,((e,t)=>{s.push(e+"="+t)})),i+s.join("&")}class sn{constructor(){this.counters_={}}incrementCounter(e,t=1){N(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t}get(){return l(this.counters_)}}const on={},an={};function cn(e){const t=e.toString();return on[t]||(on[t]=new sn),on[t]}class un{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,t){for(this.pendingResponses[e]=t;this.pendingResponses[this.currentResponseNum];){const e=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let t=0;t<e.length;++t)e[t]&&Kt((()=>{this.onMessage_(e[t])}));if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}const ln="start";class hn{constructor(e,t,n,r,i,s,o){this.connId=e,this.repoInfo=t,this.applicationId=n,this.appCheckToken=r,this.authToken=i,this.transportSessionId=s,this.lastSessionId=o,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=Ot(e),this.stats_=cn(t),this.urlFn=e=>(this.appCheckToken&&(e[Zt]=this.appCheckToken),rn(t,tn,e))}open(e,t){this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new un(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout((()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null}),Math.floor(3e4)),function(e){if("complete"===document.readyState)e();else{let t=!1;const n=function(){document.body?t||(t=!0,e()):setTimeout(n,Math.floor(10))};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",(()=>{"complete"===document.readyState&&n()})),window.attachEvent("onload",n))}}((()=>{if(this.isClosed_)return;this.scriptTagHolder=new dn(((...e)=>{const[t,n,r,i,s]=e;if(this.incrementIncomingBytes_(e),this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,t===ln)this.id=n,this.password=r;else{if("close"!==t)throw new Error("Unrecognized command received: "+t);n?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(n,(()=>{this.onClosed_()}))):this.onClosed_()}}),((...e)=>{const[t,n]=e;this.incrementIncomingBytes_(e),this.myPacketOrderer.handleResponse(t,n)}),(()=>{this.onClosed_()}),this.urlFn);const e={};e[ln]="t",e.ser=Math.floor(1e8*Math.random()),this.scriptTagHolder.uniqueCallbackIdentifier&&(e.cb=this.scriptTagHolder.uniqueCallbackIdentifier),e.v="5",this.transportSessionId&&(e.s=this.transportSessionId),this.lastSessionId&&(e.ls=this.lastSessionId),this.applicationId&&(e.p=this.applicationId),this.appCheckToken&&(e[Zt]=this.appCheckToken),"undefined"!=typeof location&&location.hostname&&Xt.test(location.hostname)&&(e.r="f");const t=this.urlFn(e);this.log_("Connecting via long-poll to "+t),this.scriptTagHolder.addTag(t,(()=>{}))}))}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){hn.forceAllow_=!0}static forceDisallow(){hn.forceDisallow_=!0}static isAvailable(){return!!hn.forceAllow_||!(hn.forceDisallow_||"undefined"==typeof document||null==document.createElement||"object"==typeof window&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href)||"object"==typeof Windows&&"object"==typeof Windows.UI)}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const t=S(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const n=a(t),r=zt(n,1840);for(let e=0;e<r.length;e++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,r.length,r[e]),this.curSegmentNum++}addDisconnectPingFrame(e,t){this.myDisconnFrame=document.createElement("iframe");const n={dframe:"t"};n.id=e,n.pw=t,this.myDisconnFrame.src=this.urlFn(n),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const t=S(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}}class dn{constructor(e,t,n,r){this.onDisconnect=n,this.urlFn=r,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0;{this.uniqueCallbackIdentifier=Tt(),window["pLPCommand"+this.uniqueCallbackIdentifier]=e,window["pRTLPCB"+this.uniqueCallbackIdentifier]=t,this.myIFrame=dn.createIFrame_();let n="";if(this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,11)){n='<script>document.domain="'+document.domain+'";<\/script>'}const r="<html><body>"+n+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(r),this.myIFrame.doc.close()}catch(e){Rt("frame writing exception"),e.stack&&Rt(e.stack),Rt(e)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(e);try{e.contentWindow.document||Rt("No IE domain setting required")}catch(t){const n=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+n+"';document.close();})())"}return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout((()=>{null!==this.myIFrame&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)}),Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e.id=this.myID,e.pw=this.myPW,e.ser=this.currentSerial;let t=this.urlFn(e),n="",r=0;for(;this.pendingSegs.length>0;){if(!(this.pendingSegs[0].d.length+30+n.length<=1870))break;{const e=this.pendingSegs.shift();n=n+"&seg"+r+"="+e.seg+"&ts"+r+"="+e.ts+"&d"+r+"="+e.d,r++}}return t+=n,this.addLongPollTag_(t,this.currentSerial),!0}return!1}enqueueSegment(e,t,n){this.pendingSegs.push({seg:e,ts:t,d:n}),this.alive&&this.newRequest_()}addLongPollTag_(e,t){this.outstandingRequests.add(t);const n=()=>{this.outstandingRequests.delete(t),this.newRequest_()},r=setTimeout(n,Math.floor(25e3));this.addTag(e,(()=>{clearTimeout(r),n()}))}addTag(e,t){setTimeout((()=>{try{if(!this.sendNewPolls)return;const n=this.myIFrame.doc.createElement("script");n.type="text/javascript",n.async=!0,n.src=e,n.onload=n.onreadystatechange=function(){const e=n.readyState;e&&"loaded"!==e&&"complete"!==e||(n.onload=n.onreadystatechange=null,n.parentNode&&n.parentNode.removeChild(n),t())},n.onerror=()=>{Rt("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(n)}catch(e){}}),Math.floor(1))}}let pn=null;"undefined"!=typeof MozWebSocket?pn=MozWebSocket:"undefined"!=typeof WebSocket&&(pn=WebSocket);class fn{constructor(e,t,n,r,i,s,o){this.connId=e,this.applicationId=n,this.appCheckToken=r,this.authToken=i,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=Ot(this.connId),this.stats_=cn(t),this.connURL=fn.connectionURL_(t,s,o,r,n),this.nodeAdmin=t.nodeAdmin}static connectionURL_(e,t,n,r,i){const s={v:"5"};return"undefined"!=typeof location&&location.hostname&&Xt.test(location.hostname)&&(s.r="f"),t&&(s.s=t),n&&(s.ls=n),r&&(s[Zt]=r),i&&(s.p=i),rn(e,en,s)}open(e,t){this.onDisconnect=t,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,It.set("previous_websocket_failure",!0);try{let e;b(),this.mySock=new pn(this.connURL,[],e)}catch(e){this.log_("Error instantiating WebSocket.");const t=e.message||e.data;return t&&this.log_(t),void this.onClosed_()}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=e=>{this.handleIncomingFrame(e)},this.mySock.onerror=e=>{this.log_("WebSocket error.  Closing connection.");const t=e.message||e.data;t&&this.log_(t),this.onClosed_()}}start(){}static forceDisallow(){fn.forceDisallow_=!0}static isAvailable(){let e=!1;if("undefined"!=typeof navigator&&navigator.userAgent){const t=/Android ([0-9]{0,}\.[0-9]{0,})/,n=navigator.userAgent.match(t);n&&n.length>1&&parseFloat(n[1])<4.4&&(e=!0)}return!e&&null!==pn&&!fn.forceDisallow_}static previouslyFailed(){return It.isInMemoryStorage||!0===It.get("previous_websocket_failure")}markConnectionHealthy(){It.remove("previous_websocket_failure")}appendFrame_(e){if(this.frames.push(e),this.frames.length===this.totalFrames){const e=this.frames.join("");this.frames=null;const t=T(e);this.onMessage(t)}}handleNewFrameCount_(e){this.totalFrames=e,this.frames=[]}extractFrameCount_(e){if(n(null===this.frames,"We already have a frame buffer"),e.length<=6){const t=Number(e);if(!isNaN(t))return this.handleNewFrameCount_(t),null}return this.handleNewFrameCount_(1),e}handleIncomingFrame(e){if(null===this.mySock)return;const t=e.data;if(this.bytesReceived+=t.length,this.stats_.incrementCounter("bytes_received",t.length),this.resetKeepAlive(),null!==this.frames)this.appendFrame_(t);else{const e=this.extractFrameCount_(t);null!==e&&this.appendFrame_(e)}}send(e){this.resetKeepAlive();const t=S(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const n=zt(t,16384);n.length>1&&this.sendString_(String(n.length));for(let e=0;e<n.length;e++)this.sendString_(n[e])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval((()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()}),Math.floor(45e3))}sendString_(e){try{this.mySock.send(e)}catch(e){this.log_("Exception thrown from WebSocket.send():",e.message||e.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}fn.responsesRequiredToBeHealthy=2,fn.healthyTimeout=3e4;class mn{constructor(e){this.initTransports_(e)}static get ALL_TRANSPORTS(){return[hn,fn]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(e){const t=fn&&fn.isAvailable();let n=t&&!fn.previouslyFailed();if(e.webSocketOnly&&(t||xt("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),n=!0),n)this.transports_=[fn];else{const e=this.transports_=[];for(const t of mn.ALL_TRANSPORTS)t&&t.isAvailable()&&e.push(t);mn.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}mn.globalTransportInitialized_=!1;class gn{constructor(e,t,n,r,i,s,o,a,c,u){this.id=e,this.repoInfo_=t,this.applicationId_=n,this.appCheckToken_=r,this.authToken_=i,this.onMessage_=s,this.onReady_=o,this.onDisconnect_=a,this.onKill_=c,this.lastSessionId=u,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=Ot("c:"+this.id+":"),this.transportManager_=new mn(t),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.conn_),n=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout((()=>{this.conn_&&this.conn_.open(t,n)}),Math.floor(0));const r=e.healthyTimeout||0;r>0&&(this.healthyTimeout_=Qt((()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>102400?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>10240?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))}),Math.floor(r)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return t=>{e===this.conn_?this.onConnectionLost_(t):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return t=>{2!==this.state_&&(e===this.rx_?this.onPrimaryMessageReceived_(t):e===this.secondaryConn_?this.onSecondaryMessageReceived_(t):this.log_("message on old connection"))}}sendRequest(e){const t={t:"d",d:e};this.sendData_(t)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if("t"in e){const t=e.t;"a"===t?this.upgradeIfSecondaryHealthy_():"r"===t?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),this.tx_!==this.secondaryConn_&&this.rx_!==this.secondaryConn_||this.close()):"o"===t&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const t=Ut("t",e),n=Ut("d",e);if("c"===t)this.onSecondaryControl_(n);else{if("d"!==t)throw new Error("Unknown protocol layer: "+t);this.pendingDataMessages.push(n)}}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:"p",d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:"a",d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:"n",d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const t=Ut("t",e),n=Ut("d",e);"c"===t?this.onControl_(n):"d"===t&&this.onDataMessage_(n)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const t=Ut("t",e);if("d"in e){const n=e.d;if("h"===t){const e=Object.assign({},n);this.repoInfo_.isUsingEmulator&&(e.h=this.repoInfo_.host),this.onHandshake_(e)}else if("n"===t){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let e=0;e<this.pendingDataMessages.length;++e)this.onDataMessage_(this.pendingDataMessages[e]);this.pendingDataMessages=[],this.tryCleanupConnection()}else"s"===t?this.onConnectionShutdown_(n):"r"===t?this.onReset_(n):"e"===t?At("Server Error: "+n):"o"===t?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):At("Unknown control packet command: "+t)}}onHandshake_(e){const t=e.ts,n=e.v,r=e.h;this.sessionId=e.s,this.repoInfo_.host=r,0===this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),"5"!==n&&xt("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.secondaryConn_),n=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(t,n),Qt((()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())}),Math.floor(6e4))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,1===this.state_?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,t){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):Qt((()=>{this.sendPingOnPrimaryIfNecessary_()}),Math.floor(5e3))}sendPingOnPrimaryIfNecessary_(){this.isHealthy_||1!==this.state_||(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:"p",d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,this.tx_!==e&&this.rx_!==e||this.close()}onConnectionLost_(e){this.conn_=null,e||0!==this.state_?1===this.state_&&this.log_("Realtime connection lost."):(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(It.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(1!==this.state_)throw"Connection is not connected";this.tx_.send(e)}close(){2!==this.state_&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}class _n{put(e,t,n,r){}merge(e,t,n,r){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,t,n){}onDisconnectMerge(e,t,n){}onDisconnectCancel(e,t){}reportStats(e){}}class yn{constructor(e){this.allowedEvents_=e,this.listeners_={},n(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...t){if(Array.isArray(this.listeners_[e])){const n=[...this.listeners_[e]];for(let e=0;e<n.length;e++)n[e].callback.apply(n[e].context,t)}}on(e,t,n){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:n});const r=this.getInitialEvent(e);r&&t.apply(n,r)}off(e,t,n){this.validateEventType_(e);const r=this.listeners_[e]||[];for(let e=0;e<r.length;e++)if(r[e].callback===t&&(!n||n===r[e].context))return void r.splice(e,1)}validateEventType_(e){n(this.allowedEvents_.find((t=>t===e)),"Unknown event: "+e)}}class vn extends yn{constructor(){super(["online"]),this.online_=!0,"undefined"==typeof window||void 0===window.addEventListener||v()||(window.addEventListener("online",(()=>{this.online_||(this.online_=!0,this.trigger("online",!0))}),!1),window.addEventListener("offline",(()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))}),!1))}static getInstance(){return new vn}getInitialEvent(e){return n("online"===e,"Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}const wn=32,bn=768;class In{constructor(e,t){if(void 0===t){this.pieces_=e.split("/");let t=0;for(let e=0;e<this.pieces_.length;e++)this.pieces_[e].length>0&&(this.pieces_[t]=this.pieces_[e],t++);this.pieces_.length=t,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}toString(){let e="";for(let t=this.pieceNum_;t<this.pieces_.length;t++)""!==this.pieces_[t]&&(e+="/"+this.pieces_[t]);return e||"/"}}function Cn(){return new In("")}function En(e){return e.pieceNum_>=e.pieces_.length?null:e.pieces_[e.pieceNum_]}function Tn(e){return e.pieces_.length-e.pieceNum_}function Sn(e){let t=e.pieceNum_;return t<e.pieces_.length&&t++,new In(e.pieces_,t)}function kn(e){return e.pieceNum_<e.pieces_.length?e.pieces_[e.pieces_.length-1]:null}function Nn(e,t=0){return e.pieces_.slice(e.pieceNum_+t)}function Pn(e){if(e.pieceNum_>=e.pieces_.length)return null;const t=[];for(let n=e.pieceNum_;n<e.pieces_.length-1;n++)t.push(e.pieces_[n]);return new In(t,0)}function Rn(e,t){const n=[];for(let t=e.pieceNum_;t<e.pieces_.length;t++)n.push(e.pieces_[t]);if(t instanceof In)for(let e=t.pieceNum_;e<t.pieces_.length;e++)n.push(t.pieces_[e]);else{const e=t.split("/");for(let t=0;t<e.length;t++)e[t].length>0&&n.push(e[t])}return new In(n,0)}function On(e){return e.pieceNum_>=e.pieces_.length}function An(e,t){const n=En(e),r=En(t);if(null===n)return t;if(n===r)return An(Sn(e),Sn(t));throw new Error("INTERNAL ERROR: innerPath ("+t+") is not within outerPath ("+e+")")}function Dn(e,t){const n=Nn(e,0),r=Nn(t,0);for(let e=0;e<n.length&&e<r.length;e++){const t=jt(n[e],r[e]);if(0!==t)return t}return n.length===r.length?0:n.length<r.length?-1:1}function xn(e,t){if(Tn(e)!==Tn(t))return!1;for(let n=e.pieceNum_,r=t.pieceNum_;n<=e.pieces_.length;n++,r++)if(e.pieces_[n]!==t.pieces_[r])return!1;return!0}function Mn(e,t){let n=e.pieceNum_,r=t.pieceNum_;if(Tn(e)>Tn(t))return!1;for(;n<e.pieces_.length;){if(e.pieces_[n]!==t.pieces_[r])return!1;++n,++r}return!0}class Ln{constructor(e,t){this.errorPrefix_=t,this.parts_=Nn(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let e=0;e<this.parts_.length;e++)this.byteLength_+=F(this.parts_[e]);qn(this)}}function qn(e){if(e.byteLength_>bn)throw new Error(e.errorPrefix_+"has a key path longer than "+bn+" bytes ("+e.byteLength_+").");if(e.parts_.length>wn)throw new Error(e.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+wn+") or object contains a cycle "+jn(e))}function jn(e){return 0===e.parts_.length?"":"in property '"+e.parts_.join(".")+"'"}class Fn extends yn{constructor(){let e,t;super(["visible"]),"undefined"!=typeof document&&void 0!==document.addEventListener&&(void 0!==document.hidden?(t="visibilitychange",e="hidden"):void 0!==document.mozHidden?(t="mozvisibilitychange",e="mozHidden"):void 0!==document.msHidden?(t="msvisibilitychange",e="msHidden"):void 0!==document.webkitHidden&&(t="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,t&&document.addEventListener(t,(()=>{const t=!document[e];t!==this.visible_&&(this.visible_=t,this.trigger("visible",t))}),!1)}static getInstance(){return new Fn}getInitialEvent(e){return n("visible"===e,"Unknown event type: "+e),[this.visible_]}}const Un=1e3;class Vn extends _n{constructor(e,t,n,r,i,s,o,a){if(super(),this.repoInfo_=e,this.applicationId_=t,this.onDataUpdate_=n,this.onConnectStatus_=r,this.onServerInfoUpdate_=i,this.authTokenProvider_=s,this.appCheckTokenProvider_=o,this.authOverride_=a,this.id=Vn.nextPersistentConnectionId_++,this.log_=Ot("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=Un,this.maxReconnectDelay_=3e5,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,a&&!b())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");Fn.getInstance().on("visible",this.onVisible_,this),-1===e.host.indexOf("fblocal")&&vn.getInstance().on("online",this.onOnline_,this)}sendRequest(e,t,r){const i=++this.requestNumber_,s={r:i,a:e,b:t};this.log_(S(s)),n(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(s),r&&(this.requestCBHash_[i]=r)}get(e){this.initConnection_();const t=new _,n={action:"g",request:{p:e._path.toString(),q:e._queryObject},onComplete:e=>{const n=e.d;"ok"===e.s?t.resolve(n):t.reject(n)}};this.outstandingGets_.push(n),this.outstandingGetCount_++;const r=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(r),t.promise}listen(e,t,r,i){this.initConnection_();const s=e._queryIdentifier,o=e._path.toString();this.log_("Listen called for "+o+" "+s),this.listens.has(o)||this.listens.set(o,new Map),n(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),n(!this.listens.get(o).has(s),"listen() called twice for same path/queryId.");const a={onComplete:i,hashFn:t,query:e,tag:r};this.listens.get(o).set(s,a),this.connected_&&this.sendListen_(a)}sendGet_(e){const t=this.outstandingGets_[e];this.sendRequest("g",t.request,(n=>{delete this.outstandingGets_[e],this.outstandingGetCount_--,0===this.outstandingGetCount_&&(this.outstandingGets_=[]),t.onComplete&&t.onComplete(n)}))}sendListen_(e){const t=e.query,n=t._path.toString(),r=t._queryIdentifier;this.log_("Listen on "+n+" for "+r);const i={p:n};e.tag&&(i.q=t._queryObject,i.t=e.tag),i.h=e.hashFn(),this.sendRequest("q",i,(i=>{const s=i.d,o=i.s;Vn.warnOnListenWarnings_(s,t);(this.listens.get(n)&&this.listens.get(n).get(r))===e&&(this.log_("listen response",i),"ok"!==o&&this.removeListen_(n,r),e.onComplete&&e.onComplete(o,s))}))}static warnOnListenWarnings_(e,t){if(e&&"object"==typeof e&&N(e,"w")){const n=P(e,"w");if(Array.isArray(n)&&~n.indexOf("no_index")){const e='".indexOn": "'+t._queryParams.getIndex().toString()+'"',n=t._path.toString();xt(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${e} at ${n} to your security rules for better performance.`)}}}refreshAuthToken(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},(()=>{})),this.reduceReconnectDelayIfAdminCredential_(e)}reduceReconnectDelayIfAdminCredential_(e){(e&&40===e.length||function(e){const t=k(e).claims;return"object"==typeof t&&!0===t.admin}(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=3e4)}refreshAppCheckToken(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},(()=>{}))}tryAuth(){if(this.connected_&&this.authToken_){const e=this.authToken_,t=function(e){const t=k(e).claims;return!!t&&"object"==typeof t&&t.hasOwnProperty("iat")}(e)?"auth":"gauth",n={cred:e};null===this.authOverride_?n.noauth=!0:"object"==typeof this.authOverride_&&(n.authvar=this.authOverride_),this.sendRequest(t,n,(t=>{const n=t.s,r=t.d||"error";this.authToken_===e&&("ok"===n?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(n,r))}))}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},(e=>{const t=e.s,n=e.d||"error";"ok"===t?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(t,n)}))}unlisten(e,t){const r=e._path.toString(),i=e._queryIdentifier;this.log_("Unlisten called for "+r+" "+i),n(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query");this.removeListen_(r,i)&&this.connected_&&this.sendUnlisten_(r,i,e._queryObject,t)}sendUnlisten_(e,t,n,r){this.log_("Unlisten on "+e+" for "+t);const i={p:e};r&&(i.q=n,i.t=r),this.sendRequest("n",i)}onDisconnectPut(e,t,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,t,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:t,onComplete:n})}onDisconnectMerge(e,t,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,t,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:t,onComplete:n})}onDisconnectCancel(e,t){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,t):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:t})}sendOnDisconnect_(e,t,n,r){const i={p:t,d:n};this.log_("onDisconnect "+e,i),this.sendRequest(e,i,(e=>{r&&setTimeout((()=>{r(e.s,e.d)}),Math.floor(0))}))}put(e,t,n,r){this.putInternal("p",e,t,n,r)}merge(e,t,n,r){this.putInternal("m",e,t,n,r)}putInternal(e,t,n,r,i){this.initConnection_();const s={p:t,d:n};void 0!==i&&(s.h=i),this.outstandingPuts_.push({action:e,request:s,onComplete:r}),this.outstandingPutCount_++;const o=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(o):this.log_("Buffering put: "+t)}sendPut_(e){const t=this.outstandingPuts_[e].action,n=this.outstandingPuts_[e].request,r=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(t,n,(n=>{this.log_(t+" response",n),delete this.outstandingPuts_[e],this.outstandingPutCount_--,0===this.outstandingPutCount_&&(this.outstandingPuts_=[]),r&&r(n.s,n.d)}))}reportStats(e){if(this.connected_){const t={c:e};this.log_("reportStats",t),this.sendRequest("s",t,(e=>{if("ok"!==e.s){const t=e.d;this.log_("reportStats","Error sending stats: "+t)}}))}}onDataMessage_(e){if("r"in e){this.log_("from server: "+S(e));const t=e.r,n=this.requestCBHash_[t];n&&(delete this.requestCBHash_[t],n(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}onDataPush_(e,t){this.log_("handleServerMessage",e,t),"d"===e?this.onDataUpdate_(t.p,t.d,!1,t.t):"m"===e?this.onDataUpdate_(t.p,t.d,!0,t.t):"c"===e?this.onListenRevoked_(t.p,t.q):"ac"===e?this.onAuthRevoked_(t.s,t.d):"apc"===e?this.onAppCheckRevoked_(t.s,t.d):"sd"===e?this.onSecurityDebugPacket_(t):At("Unrecognized action received from server: "+S(e)+"\nAre you using the latest client?")}onReady_(e,t){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=(new Date).getTime(),this.handleTimestamp_(e),this.lastSessionId=t,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(e){n(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout((()=>{this.establishConnectionTimer_=null,this.establishConnection_()}),Math.floor(e))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=Un,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}onOnline_(e){e?(this.log_("Browser went online."),this.reconnectDelay_=Un,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){if(this.visible_){if(this.lastConnectionEstablishedTime_){(new Date).getTime()-this.lastConnectionEstablishedTime_>3e4&&(this.reconnectDelay_=Un),this.lastConnectionEstablishedTime_=null}}else this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=(new Date).getTime();const e=(new Date).getTime()-this.lastConnectionAttemptTime_;let t=Math.max(0,this.reconnectDelay_-e);t=Math.random()*t,this.log_("Trying to reconnect in "+t+"ms"),this.scheduleConnect_(t),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,1.3*this.reconnectDelay_)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=(new Date).getTime(),this.lastConnectionEstablishedTime_=null;const e=this.onDataMessage_.bind(this),t=this.onReady_.bind(this),r=this.onRealtimeDisconnect_.bind(this),i=this.id+":"+Vn.nextConnectionId_++,s=this.lastSessionId;let o=!1,a=null;const c=function(){a?a.close():(o=!0,r())},u=function(e){n(a,"sendRequest call when we're not connected not allowed."),a.sendRequest(e)};this.realtime_={close:c,sendRequest:u};const l=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[n,c]=await Promise.all([this.authTokenProvider_.getToken(l),this.appCheckTokenProvider_.getToken(l)]);o?Rt("getToken() completed but was canceled"):(Rt("getToken() completed. Creating connection."),this.authToken_=n&&n.accessToken,this.appCheckToken_=c&&c.token,a=new gn(i,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,e,t,r,(e=>{xt(e+" ("+this.repoInfo_.toString()+")"),this.interrupt("server_kill")}),s))}catch(e){this.log_("Failed to get token: "+e),o||(this.repoInfo_.nodeAdmin&&xt(e),c())}}}interrupt(e){Rt("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(e){Rt("Resuming connection for reason: "+e),delete this.interruptReasons_[e],R(this.interruptReasons_)&&(this.reconnectDelay_=Un,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(e){const t=e-(new Date).getTime();this.onServerInfoUpdate_({serverTimeOffset:t})}cancelSentTransactions_(){for(let e=0;e<this.outstandingPuts_.length;e++){const t=this.outstandingPuts_[e];t&&"h"in t.request&&t.queued&&(t.onComplete&&t.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])}onListenRevoked_(e,t){let n;n=t?t.map((e=>Vt(e))).join("$"):"default";const r=this.removeListen_(e,n);r&&r.onComplete&&r.onComplete("permission_denied")}removeListen_(e,t){const n=new In(e).toString();let r;if(this.listens.has(n)){const e=this.listens.get(n);r=e.get(t),e.delete(t),0===e.size&&this.listens.delete(n)}else r=void 0;return r}onAuthRevoked_(e,t){Rt("Auth token revoked: "+e+"/"+t),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),"invalid_token"!==e&&"permission_denied"!==e||(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=3&&(this.reconnectDelay_=3e4,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(e,t){Rt("App check token revoked: "+e+"/"+t),this.appCheckToken_=null,this.forceTokenRefresh_=!0,"invalid_token"!==e&&"permission_denied"!==e||(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=3&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace("\n","\nFIREBASE: "))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const e of this.listens.values())for(const t of e.values())this.sendListen_(t);for(let e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);for(;this.onDisconnectRequestQueue_.length;){const e=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(e.action,e.pathString,e.data,e.onComplete)}for(let e=0;e<this.outstandingGets_.length;e++)this.outstandingGets_[e]&&this.sendGet_(e)}sendConnectStats_(){const e={};e["sdk.js."+yt.replace(/\./g,"-")]=1,v()?e["framework.cordova"]=1:w()&&(e["framework.reactnative"]=1),this.reportStats(e)}shouldReconnect_(){const e=vn.getInstance().currentlyOnline();return R(this.interruptReasons_)&&e}}Vn.nextPersistentConnectionId_=0,Vn.nextConnectionId_=0;class zn{constructor(e,t){this.name=e,this.node=t}static Wrap(e,t){return new zn(e,t)}}class Wn{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,t){const n=new zn(Lt,e),r=new zn(Lt,t);return 0!==this.compare(n,r)}minPost(){return zn.MIN}}let $n;class Bn extends Wn{static get __EMPTY_NODE(){return $n}static set __EMPTY_NODE(e){$n=e}compare(e,t){return jt(e.name,t.name)}isDefinedOn(e){throw r("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,t){return!1}minPost(){return zn.MIN}maxPost(){return new zn(qt,$n)}makePost(e,t){return n("string"==typeof e,"KeyIndex indexValue must always be a string."),new zn(e,$n)}toString(){return".key"}}const Hn=new Bn;class Kn{constructor(e,t,n,r,i=null){this.isReverse_=r,this.resultGenerator_=i,this.nodeStack_=[];let s=1;for(;!e.isEmpty();)if(s=t?n(e.key,t):1,r&&(s*=-1),s<0)e=this.isReverse_?e.left:e.right;else{if(0===s){this.nodeStack_.push(e);break}this.nodeStack_.push(e),e=this.isReverse_?e.right:e.left}}getNext(){if(0===this.nodeStack_.length)return null;let e,t=this.nodeStack_.pop();if(e=this.resultGenerator_?this.resultGenerator_(t.key,t.value):{key:t.key,value:t.value},this.isReverse_)for(t=t.left;!t.isEmpty();)this.nodeStack_.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack_.push(t),t=t.left;return e}hasNext(){return this.nodeStack_.length>0}peek(){if(0===this.nodeStack_.length)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}class Qn{constructor(e,t,n,r,i){this.key=e,this.value=t,this.color=null!=n?n:Qn.RED,this.left=null!=r?r:Gn.EMPTY_NODE,this.right=null!=i?i:Gn.EMPTY_NODE}copy(e,t,n,r,i){return new Qn(null!=e?e:this.key,null!=t?t:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let r=this;const i=n(e,r.key);return r=i<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===i?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n)),r.fixUp_()}removeMin_(){if(this.left.isEmpty())return Gn.EMPTY_NODE;let e=this;return e.left.isRed_()||e.left.left.isRed_()||(e=e.moveRedLeft_()),e=e.copy(null,null,null,e.left.removeMin_(),null),e.fixUp_()}remove(e,t){let n,r;if(n=this,t(e,n.key)<0)n.left.isEmpty()||n.left.isRed_()||n.left.left.isRed_()||(n=n.moveRedLeft_()),n=n.copy(null,null,null,n.left.remove(e,t),null);else{if(n.left.isRed_()&&(n=n.rotateRight_()),n.right.isEmpty()||n.right.isRed_()||n.right.left.isRed_()||(n=n.moveRedRight_()),0===t(e,n.key)){if(n.right.isEmpty())return Gn.EMPTY_NODE;r=n.right.min_(),n=n.copy(r.key,r.value,null,null,n.right.removeMin_())}n=n.copy(null,null,null,null,n.right.remove(e,t))}return n.fixUp_()}isRed_(){return this.color}fixUp_(){let e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}moveRedLeft_(){let e=this.colorFlip_();return e.right.left.isRed_()&&(e=e.copy(null,null,null,null,e.right.rotateRight_()),e=e.rotateLeft_(),e=e.colorFlip_()),e}moveRedRight_(){let e=this.colorFlip_();return e.left.left.isRed_()&&(e=e.rotateRight_(),e=e.colorFlip_()),e}rotateLeft_(){const e=this.copy(null,null,Qn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight_(){const e=this.copy(null,null,Qn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip_(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth_(){const e=this.check_();return Math.pow(2,e)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}}Qn.RED=!0,Qn.BLACK=!1;class Gn{constructor(e,t=Gn.EMPTY_NODE){this.comparator_=e,this.root_=t}insert(e,t){return new Gn(this.comparator_,this.root_.insert(e,t,this.comparator_).copy(null,null,Qn.BLACK,null,null))}remove(e){return new Gn(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,Qn.BLACK,null,null))}get(e){let t,n=this.root_;for(;!n.isEmpty();){if(t=this.comparator_(e,n.key),0===t)return n.value;t<0?n=n.left:t>0&&(n=n.right)}return null}getPredecessorKey(e){let t,n=this.root_,r=null;for(;!n.isEmpty();){if(t=this.comparator_(e,n.key),0===t){if(n.left.isEmpty())return r?r.key:null;for(n=n.left;!n.right.isEmpty();)n=n.right;return n.key}t<0?n=n.left:t>0&&(r=n,n=n.right)}throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new Kn(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,t){return new Kn(this.root_,e,this.comparator_,!1,t)}getReverseIteratorFrom(e,t){return new Kn(this.root_,e,this.comparator_,!0,t)}getReverseIterator(e){return new Kn(this.root_,null,this.comparator_,!0,e)}}function Yn(e,t){return jt(e.name,t.name)}function Jn(e,t){return jt(e,t)}let Xn;Gn.EMPTY_NODE=new class{copy(e,t,n,r,i){return this}insert(e,t,n){return new Qn(e,t,null)}remove(e,t){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}};const Zn=function(e){return"number"==typeof e?"number:"+$t(e):"string:"+e},er=function(e){if(e.isLeafNode()){const t=e.val();n("string"==typeof t||"number"==typeof t||"object"==typeof t&&N(t,".sv"),"Priority must be a string or number.")}else n(e===Xn||e.isEmpty(),"priority of unexpected type.");n(e===Xn||e.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};let tr,nr,rr;class ir{constructor(e,t=ir.__childrenNodeConstructor.EMPTY_NODE){this.value_=e,this.priorityNode_=t,this.lazyHash_=null,n(void 0!==this.value_&&null!==this.value_,"LeafNode shouldn't be created with null/undefined value."),er(this.priorityNode_)}static set __childrenNodeConstructor(e){tr=e}static get __childrenNodeConstructor(){return tr}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(e){return new ir(this.value_,e)}getImmediateChild(e){return".priority"===e?this.priorityNode_:ir.__childrenNodeConstructor.EMPTY_NODE}getChild(e){return On(e)?this:".priority"===En(e)?this.priorityNode_:ir.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(e,t){return null}updateImmediateChild(e,t){return".priority"===e?this.updatePriority(t):t.isEmpty()&&".priority"!==e?this:ir.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,t).updatePriority(this.priorityNode_)}updateChild(e,t){const r=En(e);return null===r?t:t.isEmpty()&&".priority"!==r?this:(n(".priority"!==r||1===Tn(e),".priority must be the last token in a path"),this.updateImmediateChild(r,ir.__childrenNodeConstructor.EMPTY_NODE.updateChild(Sn(e),t)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(e,t){return!1}val(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(null===this.lazyHash_){let e="";this.priorityNode_.isEmpty()||(e+="priority:"+Zn(this.priorityNode_.val())+":");const t=typeof this.value_;e+=t+":",e+="number"===t?$t(this.value_):this.value_,this.lazyHash_=St(e)}return this.lazyHash_}getValue(){return this.value_}compareTo(e){return e===ir.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof ir.__childrenNodeConstructor?-1:(n(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))}compareToLeafNode_(e){const t=typeof e.value_,r=typeof this.value_,i=ir.VALUE_TYPE_ORDER.indexOf(t),s=ir.VALUE_TYPE_ORDER.indexOf(r);return n(i>=0,"Unknown leaf type: "+t),n(s>=0,"Unknown leaf type: "+r),i===s?"object"===r?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:s-i}withIndex(){return this}isIndexed(){return!0}equals(e){if(e===this)return!0;if(e.isLeafNode()){const t=e;return this.value_===t.value_&&this.priorityNode_.equals(t.priorityNode_)}return!1}}ir.VALUE_TYPE_ORDER=["object","boolean","number","string"];const sr=new class extends Wn{compare(e,t){const n=e.node.getPriority(),r=t.node.getPriority(),i=n.compareTo(r);return 0===i?jt(e.name,t.name):i}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,t){return!e.getPriority().equals(t.getPriority())}minPost(){return zn.MIN}maxPost(){return new zn(qt,new ir("[PRIORITY-POST]",rr))}makePost(e,t){const n=nr(e);return new zn(t,new ir("[PRIORITY-POST]",n))}toString(){return".priority"}},or=Math.log(2);class ar{constructor(e){var t;this.count=(t=e+1,parseInt(Math.log(t)/or,10)),this.current_=this.count-1;const n=(r=this.count,parseInt(Array(r+1).join("1"),2));var r;this.bits_=e+1&n}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const cr=function(e,t,n,r){e.sort(t);const i=function(t,r){const s=r-t;let o,a;if(0===s)return null;if(1===s)return o=e[t],a=n?n(o):o,new Qn(a,o.node,Qn.BLACK,null,null);{const c=parseInt(s/2,10)+t,u=i(t,c),l=i(c+1,r);return o=e[c],a=n?n(o):o,new Qn(a,o.node,Qn.BLACK,u,l)}},s=function(t){let r=null,s=null,o=e.length;const a=function(t,r){const s=o-t,a=o;o-=t;const u=i(s+1,a),l=e[s],h=n?n(l):l;c(new Qn(h,l.node,r,null,u))},c=function(e){r?(r.left=e,r=e):(s=e,r=e)};for(let e=0;e<t.count;++e){const n=t.nextBitIsOne(),r=Math.pow(2,t.count-(e+1));n?a(r,Qn.BLACK):(a(r,Qn.BLACK),a(r,Qn.RED))}return s}(new ar(e.length));return new Gn(r||t,s)};let ur;const lr={};class hr{constructor(e,t){this.indexes_=e,this.indexSet_=t}static get Default(){return n(lr&&sr,"ChildrenNode.ts has not been loaded"),ur=ur||new hr({".priority":lr},{".priority":sr}),ur}get(e){const t=P(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof Gn?t:null}hasIndex(e){return N(this.indexSet_,e.toString())}addIndex(e,t){n(e!==Hn,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const r=[];let i=!1;const s=t.getIterator(zn.Wrap);let o,a=s.getNext();for(;a;)i=i||e.isDefinedOn(a.node),r.push(a),a=s.getNext();o=i?cr(r,e.getCompare()):lr;const c=e.toString(),u=Object.assign({},this.indexSet_);u[c]=e;const l=Object.assign({},this.indexes_);return l[c]=o,new hr(l,u)}addToIndexes(e,t){const r=O(this.indexes_,((r,i)=>{const s=P(this.indexSet_,i);if(n(s,"Missing index implementation for "+i),r===lr){if(s.isDefinedOn(e.node)){const n=[],r=t.getIterator(zn.Wrap);let i=r.getNext();for(;i;)i.name!==e.name&&n.push(i),i=r.getNext();return n.push(e),cr(n,s.getCompare())}return lr}{const n=t.get(e.name);let i=r;return n&&(i=i.remove(new zn(e.name,n))),i.insert(e,e.node)}}));return new hr(r,this.indexSet_)}removeFromIndexes(e,t){const n=O(this.indexes_,(n=>{if(n===lr)return n;{const r=t.get(e.name);return r?n.remove(new zn(e.name,r)):n}}));return new hr(n,this.indexSet_)}}let dr;class pr{constructor(e,t,r){this.children_=e,this.priorityNode_=t,this.indexMap_=r,this.lazyHash_=null,this.priorityNode_&&er(this.priorityNode_),this.children_.isEmpty()&&n(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return dr||(dr=new pr(new Gn(Jn),null,hr.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||dr}updatePriority(e){return this.children_.isEmpty()?this:new pr(this.children_,e,this.indexMap_)}getImmediateChild(e){if(".priority"===e)return this.getPriority();{const t=this.children_.get(e);return null===t?dr:t}}getChild(e){const t=En(e);return null===t?this:this.getImmediateChild(t).getChild(Sn(e))}hasChild(e){return null!==this.children_.get(e)}updateImmediateChild(e,t){if(n(t,"We should always be passing snapshot nodes"),".priority"===e)return this.updatePriority(t);{const n=new zn(e,t);let r,i;t.isEmpty()?(r=this.children_.remove(e),i=this.indexMap_.removeFromIndexes(n,this.children_)):(r=this.children_.insert(e,t),i=this.indexMap_.addToIndexes(n,this.children_));const s=r.isEmpty()?dr:this.priorityNode_;return new pr(r,s,i)}}updateChild(e,t){const r=En(e);if(null===r)return t;{n(".priority"!==En(e)||1===Tn(e),".priority must be the last token in a path");const i=this.getImmediateChild(r).updateChild(Sn(e),t);return this.updateImmediateChild(r,i)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(e){if(this.isEmpty())return null;const t={};let n=0,r=0,i=!0;if(this.forEachChild(sr,((s,o)=>{t[s]=o.val(e),n++,i&&pr.INTEGER_REGEXP_.test(s)?r=Math.max(r,Number(s)):i=!1})),!e&&i&&r<2*n){const e=[];for(const n in t)e[n]=t[n];return e}return e&&!this.getPriority().isEmpty()&&(t[".priority"]=this.getPriority().val()),t}hash(){if(null===this.lazyHash_){let e="";this.getPriority().isEmpty()||(e+="priority:"+Zn(this.getPriority().val())+":"),this.forEachChild(sr,((t,n)=>{const r=n.hash();""!==r&&(e+=":"+t+":"+r)})),this.lazyHash_=""===e?"":St(e)}return this.lazyHash_}getPredecessorChildName(e,t,n){const r=this.resolveIndex_(n);if(r){const n=r.getPredecessorKey(new zn(e,t));return n?n.name:null}return this.children_.getPredecessorKey(e)}getFirstChildName(e){const t=this.resolveIndex_(e);if(t){const e=t.minKey();return e&&e.name}return this.children_.minKey()}getFirstChild(e){const t=this.getFirstChildName(e);return t?new zn(t,this.children_.get(t)):null}getLastChildName(e){const t=this.resolveIndex_(e);if(t){const e=t.maxKey();return e&&e.name}return this.children_.maxKey()}getLastChild(e){const t=this.getLastChildName(e);return t?new zn(t,this.children_.get(t)):null}forEachChild(e,t){const n=this.resolveIndex_(e);return n?n.inorderTraversal((e=>t(e.name,e.node))):this.children_.inorderTraversal(t)}getIterator(e){return this.getIteratorFrom(e.minPost(),e)}getIteratorFrom(e,t){const n=this.resolveIndex_(t);if(n)return n.getIteratorFrom(e,(e=>e));{const n=this.children_.getIteratorFrom(e.name,zn.Wrap);let r=n.peek();for(;null!=r&&t.compare(r,e)<0;)n.getNext(),r=n.peek();return n}}getReverseIterator(e){return this.getReverseIteratorFrom(e.maxPost(),e)}getReverseIteratorFrom(e,t){const n=this.resolveIndex_(t);if(n)return n.getReverseIteratorFrom(e,(e=>e));{const n=this.children_.getReverseIteratorFrom(e.name,zn.Wrap);let r=n.peek();for(;null!=r&&t.compare(r,e)>0;)n.getNext(),r=n.peek();return n}}compareTo(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===fr?-1:0}withIndex(e){if(e===Hn||this.indexMap_.hasIndex(e))return this;{const t=this.indexMap_.addIndex(e,this.children_);return new pr(this.children_,this.priorityNode_,t)}}isIndexed(e){return e===Hn||this.indexMap_.hasIndex(e)}equals(e){if(e===this)return!0;if(e.isLeafNode())return!1;{const t=e;if(this.getPriority().equals(t.getPriority())){if(this.children_.count()===t.children_.count()){const e=this.getIterator(sr),n=t.getIterator(sr);let r=e.getNext(),i=n.getNext();for(;r&&i;){if(r.name!==i.name||!r.node.equals(i.node))return!1;r=e.getNext(),i=n.getNext()}return null===r&&null===i}return!1}return!1}}resolveIndex_(e){return e===Hn?null:this.indexMap_.get(e.toString())}}pr.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;const fr=new class extends pr{constructor(){super(new Gn(Jn),pr.EMPTY_NODE,hr.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return pr.EMPTY_NODE}isEmpty(){return!1}};Object.defineProperties(zn,{MIN:{value:new zn(Lt,pr.EMPTY_NODE)},MAX:{value:new zn(qt,fr)}}),Bn.__EMPTY_NODE=pr.EMPTY_NODE,ir.__childrenNodeConstructor=pr,Xn=fr,function(e){rr=e}(fr);const mr=!0;function gr(e,t=null){if(null===e)return pr.EMPTY_NODE;if("object"==typeof e&&".priority"in e&&(t=e[".priority"]),n(null===t||"string"==typeof t||"number"==typeof t||"object"==typeof t&&".sv"in t,"Invalid priority type found: "+typeof t),"object"==typeof e&&".value"in e&&null!==e[".value"]&&(e=e[".value"]),"object"!=typeof e||".sv"in e){return new ir(e,gr(t))}if(e instanceof Array||!mr){let n=pr.EMPTY_NODE;return Wt(e,((t,r)=>{if(N(e,t)&&"."!==t.substring(0,1)){const e=gr(r);!e.isLeafNode()&&e.isEmpty()||(n=n.updateImmediateChild(t,e))}})),n.updatePriority(gr(t))}{const n=[];let r=!1;if(Wt(e,((e,t)=>{if("."!==e.substring(0,1)){const i=gr(t);i.isEmpty()||(r=r||!i.getPriority().isEmpty(),n.push(new zn(e,i)))}})),0===n.length)return pr.EMPTY_NODE;const i=cr(n,Yn,(e=>e.name),Jn);if(r){const e=cr(n,sr.getCompare());return new pr(i,gr(t),new hr({".priority":e},{".priority":sr}))}return new pr(i,gr(t),hr.Default)}}!function(e){nr=e}(gr);class _r extends Wn{constructor(e){super(),this.indexPath_=e,n(!On(e)&&".priority"!==En(e),"Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,t){const n=this.extractChild(e.node),r=this.extractChild(t.node),i=n.compareTo(r);return 0===i?jt(e.name,t.name):i}makePost(e,t){const n=gr(e),r=pr.EMPTY_NODE.updateChild(this.indexPath_,n);return new zn(t,r)}maxPost(){const e=pr.EMPTY_NODE.updateChild(this.indexPath_,fr);return new zn(qt,e)}toString(){return Nn(this.indexPath_,0).join("/")}}const yr=new class extends Wn{compare(e,t){const n=e.node.compareTo(t.node);return 0===n?jt(e.name,t.name):n}isDefinedOn(e){return!0}indexedValueChanged(e,t){return!e.equals(t)}minPost(){return zn.MIN}maxPost(){return zn.MAX}makePost(e,t){const n=gr(e);return new zn(t,n)}toString(){return".value"}};function vr(e){return{type:"value",snapshotNode:e}}function wr(e,t){return{type:"child_added",snapshotNode:t,childName:e}}function br(e,t){return{type:"child_removed",snapshotNode:t,childName:e}}function Ir(e,t,n){return{type:"child_changed",snapshotNode:t,childName:e,oldSnap:n}}class Cr{constructor(e){this.index_=e}updateChild(e,t,r,i,s,o){n(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");const a=e.getImmediateChild(t);return a.getChild(i).equals(r.getChild(i))&&a.isEmpty()===r.isEmpty()?e:(null!=o&&(r.isEmpty()?e.hasChild(t)?o.trackChildChange(br(t,a)):n(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):a.isEmpty()?o.trackChildChange(wr(t,r)):o.trackChildChange(Ir(t,r,a))),e.isLeafNode()&&r.isEmpty()?e:e.updateImmediateChild(t,r).withIndex(this.index_))}updateFullNode(e,t,n){return null!=n&&(e.isLeafNode()||e.forEachChild(sr,((e,r)=>{t.hasChild(e)||n.trackChildChange(br(e,r))})),t.isLeafNode()||t.forEachChild(sr,((t,r)=>{if(e.hasChild(t)){const i=e.getImmediateChild(t);i.equals(r)||n.trackChildChange(Ir(t,r,i))}else n.trackChildChange(wr(t,r))}))),t.withIndex(this.index_)}updatePriority(e,t){return e.isEmpty()?pr.EMPTY_NODE:e.updatePriority(t)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}class Er{constructor(e){this.indexedFilter_=new Cr(e.getIndex()),this.index_=e.getIndex(),this.startPost_=Er.getStartPost_(e),this.endPost_=Er.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){const t=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,n=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return t&&n}updateChild(e,t,n,r,i,s){return this.matches(new zn(t,n))||(n=pr.EMPTY_NODE),this.indexedFilter_.updateChild(e,t,n,r,i,s)}updateFullNode(e,t,n){t.isLeafNode()&&(t=pr.EMPTY_NODE);let r=t.withIndex(this.index_);r=r.updatePriority(pr.EMPTY_NODE);const i=this;return t.forEachChild(sr,((e,t)=>{i.matches(new zn(e,t))||(r=r.updateImmediateChild(e,pr.EMPTY_NODE))})),this.indexedFilter_.updateFullNode(e,r,n)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){const t=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),t)}return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){const t=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),t)}return e.getIndex().maxPost()}}class Tr{constructor(e){this.withinDirectionalStart=e=>this.reverse_?this.withinEndPost(e):this.withinStartPost(e),this.withinDirectionalEnd=e=>this.reverse_?this.withinStartPost(e):this.withinEndPost(e),this.withinStartPost=e=>{const t=this.index_.compare(this.rangedFilter_.getStartPost(),e);return this.startIsInclusive_?t<=0:t<0},this.withinEndPost=e=>{const t=this.index_.compare(e,this.rangedFilter_.getEndPost());return this.endIsInclusive_?t<=0:t<0},this.rangedFilter_=new Er(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,t,n,r,i,s){return this.rangedFilter_.matches(new zn(t,n))||(n=pr.EMPTY_NODE),e.getImmediateChild(t).equals(n)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,t,n,r,i,s):this.fullLimitUpdateChild_(e,t,n,i,s)}updateFullNode(e,t,n){let r;if(t.isLeafNode()||t.isEmpty())r=pr.EMPTY_NODE.withIndex(this.index_);else if(2*this.limit_<t.numChildren()&&t.isIndexed(this.index_)){let e;r=pr.EMPTY_NODE.withIndex(this.index_),e=this.reverse_?t.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):t.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let n=0;for(;e.hasNext()&&n<this.limit_;){const t=e.getNext();if(this.withinDirectionalStart(t)){if(!this.withinDirectionalEnd(t))break;r=r.updateImmediateChild(t.name,t.node),n++}}}else{let e;r=t.withIndex(this.index_),r=r.updatePriority(pr.EMPTY_NODE),e=this.reverse_?r.getReverseIterator(this.index_):r.getIterator(this.index_);let n=0;for(;e.hasNext();){const t=e.getNext();n<this.limit_&&this.withinDirectionalStart(t)&&this.withinDirectionalEnd(t)?n++:r=r.updateImmediateChild(t.name,pr.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,r,n)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,t,r,i,s){let o;if(this.reverse_){const e=this.index_.getCompare();o=(t,n)=>e(n,t)}else o=this.index_.getCompare();const a=e;n(a.numChildren()===this.limit_,"");const c=new zn(t,r),u=this.reverse_?a.getFirstChild(this.index_):a.getLastChild(this.index_),l=this.rangedFilter_.matches(c);if(a.hasChild(t)){const e=a.getImmediateChild(t);let n=i.getChildAfterChild(this.index_,u,this.reverse_);for(;null!=n&&(n.name===t||a.hasChild(n.name));)n=i.getChildAfterChild(this.index_,n,this.reverse_);const h=null==n?1:o(n,c);if(l&&!r.isEmpty()&&h>=0)return null!=s&&s.trackChildChange(Ir(t,r,e)),a.updateImmediateChild(t,r);{null!=s&&s.trackChildChange(br(t,e));const r=a.updateImmediateChild(t,pr.EMPTY_NODE);return null!=n&&this.rangedFilter_.matches(n)?(null!=s&&s.trackChildChange(wr(n.name,n.node)),r.updateImmediateChild(n.name,n.node)):r}}return r.isEmpty()?e:l&&o(u,c)>=0?(null!=s&&(s.trackChildChange(br(u.name,u.node)),s.trackChildChange(wr(t,r))),a.updateImmediateChild(t,r).updateImmediateChild(u.name,pr.EMPTY_NODE)):e}}class Sr{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=sr}hasStart(){return this.startSet_}isViewFromLeft(){return""===this.viewFrom_?this.startSet_:"l"===this.viewFrom_}getIndexStartValue(){return n(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return n(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:Lt}hasEnd(){return this.endSet_}getIndexEndValue(){return n(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return n(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:qt}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&""!==this.viewFrom_}getLimit(){return n(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===sr}copy(){const e=new Sr;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function kr(e){const t={};if(e.isDefault())return t;let r;if(e.index_===sr?r="$priority":e.index_===yr?r="$value":e.index_===Hn?r="$key":(n(e.index_ instanceof _r,"Unrecognized index type!"),r=e.index_.toString()),t.orderBy=S(r),e.startSet_){const n=e.startAfterSet_?"startAfter":"startAt";t[n]=S(e.indexStartValue_),e.startNameSet_&&(t[n]+=","+S(e.indexStartName_))}if(e.endSet_){const n=e.endBeforeSet_?"endBefore":"endAt";t[n]=S(e.indexEndValue_),e.endNameSet_&&(t[n]+=","+S(e.indexEndName_))}return e.limitSet_&&(e.isViewFromLeft()?t.limitToFirst=e.limit_:t.limitToLast=e.limit_),t}function Nr(e){const t={};if(e.startSet_&&(t.sp=e.indexStartValue_,e.startNameSet_&&(t.sn=e.indexStartName_),t.sin=!e.startAfterSet_),e.endSet_&&(t.ep=e.indexEndValue_,e.endNameSet_&&(t.en=e.indexEndName_),t.ein=!e.endBeforeSet_),e.limitSet_){t.l=e.limit_;let n=e.viewFrom_;""===n&&(n=e.isViewFromLeft()?"l":"r"),t.vf=n}return e.index_!==sr&&(t.i=e.index_.toString()),t}class Pr extends _n{constructor(e,t,n,r){super(),this.repoInfo_=e,this.onDataUpdate_=t,this.authTokenProvider_=n,this.appCheckTokenProvider_=r,this.log_=Ot("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,t){return void 0!==t?"tag$"+t:(n(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,t,n,r){const i=e._path.toString();this.log_("Listen called for "+i+" "+e._queryIdentifier);const s=Pr.getListenId_(e,n),o={};this.listens_[s]=o;const a=kr(e._queryParams);this.restRequest_(i+".json",a,((e,t)=>{let a=t;if(404===e&&(a=null,e=null),null===e&&this.onDataUpdate_(i,a,!1,n),P(this.listens_,s)===o){let t;t=e?401===e?"permission_denied":"rest_error:"+e:"ok",r(t,null)}}))}unlisten(e,t){const n=Pr.getListenId_(e,t);delete this.listens_[n]}get(e){const t=kr(e._queryParams),n=e._path.toString(),r=new _;return this.restRequest_(n+".json",t,((e,t)=>{let i=t;404===e&&(i=null,e=null),null===e?(this.onDataUpdate_(n,i,!1,null),r.resolve(i)):r.reject(new Error(i))})),r.promise}refreshAuthToken(e){}restRequest_(e,t={},n){return t.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then((([r,i])=>{r&&r.accessToken&&(t.auth=r.accessToken),i&&i.token&&(t.ac=i.token);const s=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+x(t);this.log_("Sending REST request for "+s);const o=new XMLHttpRequest;o.onreadystatechange=()=>{if(n&&4===o.readyState){this.log_("REST Response for "+s+" received. status:",o.status,"response:",o.responseText);let e=null;if(o.status>=200&&o.status<300){try{e=T(o.responseText)}catch(e){xt("Failed to parse JSON response for "+s+": "+o.responseText)}n(null,e)}else 401!==o.status&&404!==o.status&&xt("Got unsuccessful REST response for "+s+" Status: "+o.status),n(o.status);n=null}},o.open("GET",s,!0),o.send()}))}}class Rr{constructor(){this.rootNode_=pr.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)}}function Or(){return{value:null,children:new Map}}function Ar(e,t,n){if(On(t))e.value=n,e.children.clear();else if(null!==e.value)e.value=e.value.updateChild(t,n);else{const r=En(t);e.children.has(r)||e.children.set(r,Or());Ar(e.children.get(r),t=Sn(t),n)}}function Dr(e,t,n){null!==e.value?n(t,e.value):function(e,t){e.children.forEach(((e,n)=>{t(n,e)}))}(e,((e,r)=>{Dr(r,new In(t.toString()+"/"+e),n)}))}class xr{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),t=Object.assign({},e);return this.last_&&Wt(this.last_,((e,n)=>{t[e]=t[e]-n})),this.last_=e,t}}class Mr{constructor(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new xr(e);const n=1e4+2e4*Math.random();Qt(this.reportStats_.bind(this),Math.floor(n))}reportStats_(){const e=this.statsListener_.get(),t={};let n=!1;Wt(e,((e,r)=>{r>0&&N(this.statsToReport_,e)&&(t[e]=r,n=!0)})),n&&this.server_.reportStats(t),Qt(this.reportStats_.bind(this),Math.floor(2*Math.random()*3e5))}}var Lr;function qr(e){return{fromUser:!1,fromServer:!0,queryId:e,tagged:!0}}!function(e){e[e.OVERWRITE=0]="OVERWRITE",e[e.MERGE=1]="MERGE",e[e.ACK_USER_WRITE=2]="ACK_USER_WRITE",e[e.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"}(Lr||(Lr={}));class jr{constructor(e,t,n){this.path=e,this.affectedTree=t,this.revert=n,this.type=Lr.ACK_USER_WRITE,this.source={fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}operationForChild(e){if(On(this.path)){if(null!=this.affectedTree.value)return n(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const t=this.affectedTree.subtree(new In(e));return new jr(Cn(),t,this.revert)}}return n(En(this.path)===e,"operationForChild called for unrelated child."),new jr(Sn(this.path),this.affectedTree,this.revert)}}class Fr{constructor(e,t){this.source=e,this.path=t,this.type=Lr.LISTEN_COMPLETE}operationForChild(e){return On(this.path)?new Fr(this.source,Cn()):new Fr(this.source,Sn(this.path))}}class Ur{constructor(e,t,n){this.source=e,this.path=t,this.snap=n,this.type=Lr.OVERWRITE}operationForChild(e){return On(this.path)?new Ur(this.source,Cn(),this.snap.getImmediateChild(e)):new Ur(this.source,Sn(this.path),this.snap)}}class Vr{constructor(e,t,n){this.source=e,this.path=t,this.children=n,this.type=Lr.MERGE}operationForChild(e){if(On(this.path)){const t=this.children.subtree(new In(e));return t.isEmpty()?null:t.value?new Ur(this.source,Cn(),t.value):new Vr(this.source,Cn(),t)}return n(En(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new Vr(this.source,Sn(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}class zr{constructor(e,t,n){this.node_=e,this.fullyInitialized_=t,this.filtered_=n}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(On(e))return this.isFullyInitialized()&&!this.filtered_;const t=En(e);return this.isCompleteForChild(t)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}class Wr{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}}function $r(e,t,n,i,s,o){const a=i.filter((e=>e.type===n));a.sort(((t,n)=>function(e,t,n){if(null==t.childName||null==n.childName)throw r("Should only compare child_ events.");const i=new zn(t.childName,t.snapshotNode),s=new zn(n.childName,n.snapshotNode);return e.index_.compare(i,s)}(e,t,n))),a.forEach((n=>{const r=function(e,t,n){return"value"===t.type||"child_removed"===t.type||(t.prevName=n.getPredecessorChildName(t.childName,t.snapshotNode,e.index_)),t}(e,n,o);s.forEach((i=>{i.respondsTo(n.type)&&t.push(i.createEvent(r,e.query_))}))}))}function Br(e,t){return{eventCache:e,serverCache:t}}function Hr(e,t,n,r){return Br(new zr(t,n,r),e.serverCache)}function Kr(e,t,n,r){return Br(e.eventCache,new zr(t,n,r))}function Qr(e){return e.eventCache.isFullyInitialized()?e.eventCache.getNode():null}function Gr(e){return e.serverCache.isFullyInitialized()?e.serverCache.getNode():null}let Yr;class Jr{constructor(e,t=(()=>(Yr||(Yr=new Gn(Ft)),Yr))()){this.value=e,this.children=t}static fromObject(e){let t=new Jr(null);return Wt(e,((e,n)=>{t=t.set(new In(e),n)})),t}isEmpty(){return null===this.value&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,t){if(null!=this.value&&t(this.value))return{path:Cn(),value:this.value};if(On(e))return null;{const n=En(e),r=this.children.get(n);if(null!==r){const i=r.findRootMostMatchingPathAndValue(Sn(e),t);if(null!=i){return{path:Rn(new In(n),i.path),value:i.value}}return null}return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,(()=>!0))}subtree(e){if(On(e))return this;{const t=En(e),n=this.children.get(t);return null!==n?n.subtree(Sn(e)):new Jr(null)}}set(e,t){if(On(e))return new Jr(t,this.children);{const n=En(e),r=(this.children.get(n)||new Jr(null)).set(Sn(e),t),i=this.children.insert(n,r);return new Jr(this.value,i)}}remove(e){if(On(e))return this.children.isEmpty()?new Jr(null):new Jr(null,this.children);{const t=En(e),n=this.children.get(t);if(n){const r=n.remove(Sn(e));let i;return i=r.isEmpty()?this.children.remove(t):this.children.insert(t,r),null===this.value&&i.isEmpty()?new Jr(null):new Jr(this.value,i)}return this}}get(e){if(On(e))return this.value;{const t=En(e),n=this.children.get(t);return n?n.get(Sn(e)):null}}setTree(e,t){if(On(e))return t;{const n=En(e),r=(this.children.get(n)||new Jr(null)).setTree(Sn(e),t);let i;return i=r.isEmpty()?this.children.remove(n):this.children.insert(n,r),new Jr(this.value,i)}}fold(e){return this.fold_(Cn(),e)}fold_(e,t){const n={};return this.children.inorderTraversal(((r,i)=>{n[r]=i.fold_(Rn(e,r),t)})),t(e,this.value,n)}findOnPath(e,t){return this.findOnPath_(e,Cn(),t)}findOnPath_(e,t,n){const r=!!this.value&&n(t,this.value);if(r)return r;if(On(e))return null;{const r=En(e),i=this.children.get(r);return i?i.findOnPath_(Sn(e),Rn(t,r),n):null}}foreachOnPath(e,t){return this.foreachOnPath_(e,Cn(),t)}foreachOnPath_(e,t,n){if(On(e))return this;{this.value&&n(t,this.value);const r=En(e),i=this.children.get(r);return i?i.foreachOnPath_(Sn(e),Rn(t,r),n):new Jr(null)}}foreach(e){this.foreach_(Cn(),e)}foreach_(e,t){this.children.inorderTraversal(((n,r)=>{r.foreach_(Rn(e,n),t)})),this.value&&t(e,this.value)}foreachChild(e){this.children.inorderTraversal(((t,n)=>{n.value&&e(t,n.value)}))}}class Xr{constructor(e){this.writeTree_=e}static empty(){return new Xr(new Jr(null))}}function Zr(e,t,n){if(On(t))return new Xr(new Jr(n));{const r=e.writeTree_.findRootMostValueAndPath(t);if(null!=r){const i=r.path;let s=r.value;const o=An(i,t);return s=s.updateChild(o,n),new Xr(e.writeTree_.set(i,s))}{const r=new Jr(n),i=e.writeTree_.setTree(t,r);return new Xr(i)}}}function ei(e,t,n){let r=e;return Wt(n,((e,n)=>{r=Zr(r,Rn(t,e),n)})),r}function ti(e,t){if(On(t))return Xr.empty();{const n=e.writeTree_.setTree(t,new Jr(null));return new Xr(n)}}function ni(e,t){return null!=ri(e,t)}function ri(e,t){const n=e.writeTree_.findRootMostValueAndPath(t);return null!=n?e.writeTree_.get(n.path).getChild(An(n.path,t)):null}function ii(e){const t=[],n=e.writeTree_.value;return null!=n?n.isLeafNode()||n.forEachChild(sr,((e,n)=>{t.push(new zn(e,n))})):e.writeTree_.children.inorderTraversal(((e,n)=>{null!=n.value&&t.push(new zn(e,n.value))})),t}function si(e,t){if(On(t))return e;{const n=ri(e,t);return new Xr(null!=n?new Jr(n):e.writeTree_.subtree(t))}}function oi(e){return e.writeTree_.isEmpty()}function ai(e,t){return ci(Cn(),e.writeTree_,t)}function ci(e,t,r){if(null!=t.value)return r.updateChild(e,t.value);{let i=null;return t.children.inorderTraversal(((t,s)=>{".priority"===t?(n(null!==s.value,"Priority writes must always be leaf nodes"),i=s.value):r=ci(Rn(e,t),s,r)})),r.getChild(e).isEmpty()||null===i||(r=r.updateChild(Rn(e,".priority"),i)),r}}function ui(e,t){return Ii(t,e)}function li(e,t){const r=e.allWrites.findIndex((e=>e.writeId===t));n(r>=0,"removeWrite called with nonexistent writeId.");const i=e.allWrites[r];e.allWrites.splice(r,1);let s=i.visible,o=!1,a=e.allWrites.length-1;for(;s&&a>=0;){const t=e.allWrites[a];t.visible&&(a>=r&&hi(t,i.path)?s=!1:Mn(i.path,t.path)&&(o=!0)),a--}if(s){if(o)return function(e){e.visibleWrites=pi(e.allWrites,di,Cn()),e.allWrites.length>0?e.lastWriteId=e.allWrites[e.allWrites.length-1].writeId:e.lastWriteId=-1}(e),!0;if(i.snap)e.visibleWrites=ti(e.visibleWrites,i.path);else{Wt(i.children,(t=>{e.visibleWrites=ti(e.visibleWrites,Rn(i.path,t))}))}return!0}return!1}function hi(e,t){if(e.snap)return Mn(e.path,t);for(const n in e.children)if(e.children.hasOwnProperty(n)&&Mn(Rn(e.path,n),t))return!0;return!1}function di(e){return e.visible}function pi(e,t,n){let i=Xr.empty();for(let s=0;s<e.length;++s){const o=e[s];if(t(o)){const e=o.path;let t;if(o.snap)Mn(n,e)?(t=An(n,e),i=Zr(i,t,o.snap)):Mn(e,n)&&(t=An(e,n),i=Zr(i,Cn(),o.snap.getChild(t)));else{if(!o.children)throw r("WriteRecord should have .snap or .children");if(Mn(n,e))t=An(n,e),i=ei(i,t,o.children);else if(Mn(e,n))if(t=An(e,n),On(t))i=ei(i,Cn(),o.children);else{const e=P(o.children,En(t));if(e){const n=e.getChild(Sn(t));i=Zr(i,Cn(),n)}}}}}return i}function fi(e,t,n,r,i){if(r||i){const s=si(e.visibleWrites,t);if(!i&&oi(s))return n;if(i||null!=n||ni(s,Cn())){const s=function(e){return(e.visible||i)&&(!r||!~r.indexOf(e.writeId))&&(Mn(e.path,t)||Mn(t,e.path))};return ai(pi(e.allWrites,s,t),n||pr.EMPTY_NODE)}return null}{const r=ri(e.visibleWrites,t);if(null!=r)return r;{const r=si(e.visibleWrites,t);if(oi(r))return n;if(null!=n||ni(r,Cn())){return ai(r,n||pr.EMPTY_NODE)}return null}}}function mi(e,t,n,r){return fi(e.writeTree,e.treePath,t,n,r)}function gi(e,t){return function(e,t,n){let r=pr.EMPTY_NODE;const i=ri(e.visibleWrites,t);if(i)return i.isLeafNode()||i.forEachChild(sr,((e,t)=>{r=r.updateImmediateChild(e,t)})),r;if(n){const i=si(e.visibleWrites,t);return n.forEachChild(sr,((e,t)=>{const n=ai(si(i,new In(e)),t);r=r.updateImmediateChild(e,n)})),ii(i).forEach((e=>{r=r.updateImmediateChild(e.name,e.node)})),r}return ii(si(e.visibleWrites,t)).forEach((e=>{r=r.updateImmediateChild(e.name,e.node)})),r}(e.writeTree,e.treePath,t)}function _i(e,t,r,i){return function(e,t,r,i,s){n(i||s,"Either existingEventSnap or existingServerSnap must exist");const o=Rn(t,r);if(ni(e.visibleWrites,o))return null;{const t=si(e.visibleWrites,o);return oi(t)?s.getChild(r):ai(t,s.getChild(r))}}(e.writeTree,e.treePath,t,r,i)}function yi(e,t){return function(e,t){return ri(e.visibleWrites,t)}(e.writeTree,Rn(e.treePath,t))}function vi(e,t,n,r,i,s){return function(e,t,n,r,i,s,o){let a;const c=si(e.visibleWrites,t),u=ri(c,Cn());if(null!=u)a=u;else{if(null==n)return[];a=ai(c,n)}if(a=a.withIndex(o),a.isEmpty()||a.isLeafNode())return[];{const e=[],t=o.getCompare(),n=s?a.getReverseIteratorFrom(r,o):a.getIteratorFrom(r,o);let c=n.getNext();for(;c&&e.length<i;)0!==t(c,r)&&e.push(c),c=n.getNext();return e}}(e.writeTree,e.treePath,t,n,r,i,s)}function wi(e,t,n){return function(e,t,n,r){const i=Rn(t,n),s=ri(e.visibleWrites,i);if(null!=s)return s;if(r.isCompleteForChild(n))return ai(si(e.visibleWrites,i),r.getNode().getImmediateChild(n));return null}(e.writeTree,e.treePath,t,n)}function bi(e,t){return Ii(Rn(e.treePath,t),e.writeTree)}function Ii(e,t){return{treePath:e,writeTree:t}}class Ci{constructor(){this.changeMap=new Map}trackChildChange(e){const t=e.type,i=e.childName;n("child_added"===t||"child_changed"===t||"child_removed"===t,"Only child changes supported for tracking"),n(".priority"!==i,"Only non-priority child changes can be tracked.");const s=this.changeMap.get(i);if(s){const n=s.type;if("child_added"===t&&"child_removed"===n)this.changeMap.set(i,Ir(i,e.snapshotNode,s.snapshotNode));else if("child_removed"===t&&"child_added"===n)this.changeMap.delete(i);else if("child_removed"===t&&"child_changed"===n)this.changeMap.set(i,br(i,s.oldSnap));else if("child_changed"===t&&"child_added"===n)this.changeMap.set(i,wr(i,e.snapshotNode));else{if("child_changed"!==t||"child_changed"!==n)throw r("Illegal combination of changes: "+e+" occurred after "+s);this.changeMap.set(i,Ir(i,e.snapshotNode,s.oldSnap))}}else this.changeMap.set(i,e)}getChanges(){return Array.from(this.changeMap.values())}}const Ei=new class{getCompleteChild(e){return null}getChildAfterChild(e,t,n){return null}};class Ti{constructor(e,t,n=null){this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=n}getCompleteChild(e){const t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);{const t=null!=this.optCompleteServerCache_?new zr(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return wi(this.writes_,e,t)}}getChildAfterChild(e,t,n){const r=null!=this.optCompleteServerCache_?this.optCompleteServerCache_:Gr(this.viewCache_),i=vi(this.writes_,r,t,1,n,e);return 0===i.length?null:i[0]}}function Si(e,t,i,s,o){const a=new Ci;let c,u;if(i.type===Lr.OVERWRITE){const r=i;r.source.fromUser?c=Pi(e,t,r.path,r.snap,s,o,a):(n(r.source.fromServer,"Unknown source."),u=r.source.tagged||t.serverCache.isFiltered()&&!On(r.path),c=Ni(e,t,r.path,r.snap,s,o,u,a))}else if(i.type===Lr.MERGE){const r=i;r.source.fromUser?c=function(e,t,n,r,i,s,o){let a=t;return r.foreach(((r,c)=>{const u=Rn(n,r);Ri(t,En(u))&&(a=Pi(e,a,u,c,i,s,o))})),r.foreach(((r,c)=>{const u=Rn(n,r);Ri(t,En(u))||(a=Pi(e,a,u,c,i,s,o))})),a}(e,t,r.path,r.children,s,o,a):(n(r.source.fromServer,"Unknown source."),u=r.source.tagged||t.serverCache.isFiltered(),c=Ai(e,t,r.path,r.children,s,o,u,a))}else if(i.type===Lr.ACK_USER_WRITE){const r=i;c=r.revert?function(e,t,r,i,s,o){let a;if(null!=yi(i,r))return t;{const c=new Ti(i,t,s),u=t.eventCache.getNode();let l;if(On(r)||".priority"===En(r)){let r;if(t.serverCache.isFullyInitialized())r=mi(i,Gr(t));else{const e=t.serverCache.getNode();n(e instanceof pr,"serverChildren would be complete if leaf node"),r=gi(i,e)}l=e.filter.updateFullNode(u,r,o)}else{const n=En(r);let s=wi(i,n,t.serverCache);null==s&&t.serverCache.isCompleteForChild(n)&&(s=u.getImmediateChild(n)),l=null!=s?e.filter.updateChild(u,n,s,Sn(r),c,o):t.eventCache.getNode().hasChild(n)?e.filter.updateChild(u,n,pr.EMPTY_NODE,Sn(r),c,o):u,l.isEmpty()&&t.serverCache.isFullyInitialized()&&(a=mi(i,Gr(t)),a.isLeafNode()&&(l=e.filter.updateFullNode(l,a,o)))}return a=t.serverCache.isFullyInitialized()||null!=yi(i,Cn()),Hr(t,l,a,e.filter.filtersNodes())}}(e,t,r.path,s,o,a):function(e,t,n,r,i,s,o){if(null!=yi(i,n))return t;const a=t.serverCache.isFiltered(),c=t.serverCache;if(null!=r.value){if(On(n)&&c.isFullyInitialized()||c.isCompleteForPath(n))return Ni(e,t,n,c.getNode().getChild(n),i,s,a,o);if(On(n)){let r=new Jr(null);return c.getNode().forEachChild(Hn,((e,t)=>{r=r.set(new In(e),t)})),Ai(e,t,n,r,i,s,a,o)}return t}{let u=new Jr(null);return r.foreach(((e,t)=>{const r=Rn(n,e);c.isCompleteForPath(r)&&(u=u.set(e,c.getNode().getChild(r)))})),Ai(e,t,n,u,i,s,a,o)}}(e,t,r.path,r.affectedTree,s,o,a)}else{if(i.type!==Lr.LISTEN_COMPLETE)throw r("Unknown operation type: "+i.type);c=function(e,t,n,r,i){const s=t.serverCache,o=Kr(t,s.getNode(),s.isFullyInitialized()||On(n),s.isFiltered());return ki(e,o,n,r,Ei,i)}(e,t,i.path,s,a)}const l=a.getChanges();return function(e,t,n){const r=t.eventCache;if(r.isFullyInitialized()){const i=r.getNode().isLeafNode()||r.getNode().isEmpty(),s=Qr(e);(n.length>0||!e.eventCache.isFullyInitialized()||i&&!r.getNode().equals(s)||!r.getNode().getPriority().equals(s.getPriority()))&&n.push(vr(Qr(t)))}}(t,c,l),{viewCache:c,changes:l}}function ki(e,t,r,i,s,o){const a=t.eventCache;if(null!=yi(i,r))return t;{let c,u;if(On(r))if(n(t.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),t.serverCache.isFiltered()){const n=Gr(t),r=gi(i,n instanceof pr?n:pr.EMPTY_NODE);c=e.filter.updateFullNode(t.eventCache.getNode(),r,o)}else{const n=mi(i,Gr(t));c=e.filter.updateFullNode(t.eventCache.getNode(),n,o)}else{const l=En(r);if(".priority"===l){n(1===Tn(r),"Can't have a priority with additional path components");const s=a.getNode();u=t.serverCache.getNode();const o=_i(i,r,s,u);c=null!=o?e.filter.updatePriority(s,o):a.getNode()}else{const n=Sn(r);let h;if(a.isCompleteForChild(l)){u=t.serverCache.getNode();const e=_i(i,r,a.getNode(),u);h=null!=e?a.getNode().getImmediateChild(l).updateChild(n,e):a.getNode().getImmediateChild(l)}else h=wi(i,l,t.serverCache);c=null!=h?e.filter.updateChild(a.getNode(),l,h,n,s,o):a.getNode()}}return Hr(t,c,a.isFullyInitialized()||On(r),e.filter.filtersNodes())}}function Ni(e,t,n,r,i,s,o,a){const c=t.serverCache;let u;const l=o?e.filter:e.filter.getIndexedFilter();if(On(n))u=l.updateFullNode(c.getNode(),r,null);else if(l.filtersNodes()&&!c.isFiltered()){const e=c.getNode().updateChild(n,r);u=l.updateFullNode(c.getNode(),e,null)}else{const e=En(n);if(!c.isCompleteForPath(n)&&Tn(n)>1)return t;const i=Sn(n),s=c.getNode().getImmediateChild(e).updateChild(i,r);u=".priority"===e?l.updatePriority(c.getNode(),s):l.updateChild(c.getNode(),e,s,i,Ei,null)}const h=Kr(t,u,c.isFullyInitialized()||On(n),l.filtersNodes());return ki(e,h,n,i,new Ti(i,h,s),a)}function Pi(e,t,n,r,i,s,o){const a=t.eventCache;let c,u;const l=new Ti(i,t,s);if(On(n))u=e.filter.updateFullNode(t.eventCache.getNode(),r,o),c=Hr(t,u,!0,e.filter.filtersNodes());else{const i=En(n);if(".priority"===i)u=e.filter.updatePriority(t.eventCache.getNode(),r),c=Hr(t,u,a.isFullyInitialized(),a.isFiltered());else{const s=Sn(n),u=a.getNode().getImmediateChild(i);let h;if(On(s))h=r;else{const e=l.getCompleteChild(i);h=null!=e?".priority"===kn(s)&&e.getChild(Pn(s)).isEmpty()?e:e.updateChild(s,r):pr.EMPTY_NODE}if(u.equals(h))c=t;else{c=Hr(t,e.filter.updateChild(a.getNode(),i,h,s,l,o),a.isFullyInitialized(),e.filter.filtersNodes())}}}return c}function Ri(e,t){return e.eventCache.isCompleteForChild(t)}function Oi(e,t,n){return n.foreach(((e,n)=>{t=t.updateChild(e,n)})),t}function Ai(e,t,n,r,i,s,o,a){if(t.serverCache.getNode().isEmpty()&&!t.serverCache.isFullyInitialized())return t;let c,u=t;c=On(n)?r:new Jr(null).setTree(n,r);const l=t.serverCache.getNode();return c.children.inorderTraversal(((n,r)=>{if(l.hasChild(n)){const c=Oi(0,t.serverCache.getNode().getImmediateChild(n),r);u=Ni(e,u,new In(n),c,i,s,o,a)}})),c.children.inorderTraversal(((n,r)=>{const c=!t.serverCache.isCompleteForChild(n)&&null===r.value;if(!l.hasChild(n)&&!c){const c=Oi(0,t.serverCache.getNode().getImmediateChild(n),r);u=Ni(e,u,new In(n),c,i,s,o,a)}})),u}class Di{constructor(e,t){this.query_=e,this.eventRegistrations_=[];const n=this.query_._queryParams,r=new Cr(n.getIndex()),i=(s=n).loadsAllData()?new Cr(s.getIndex()):s.hasLimit()?new Tr(s):new Er(s);var s;this.processor_=function(e){return{filter:e}}(i);const o=t.serverCache,a=t.eventCache,c=r.updateFullNode(pr.EMPTY_NODE,o.getNode(),null),u=i.updateFullNode(pr.EMPTY_NODE,a.getNode(),null),l=new zr(c,o.isFullyInitialized(),r.filtersNodes()),h=new zr(u,a.isFullyInitialized(),i.filtersNodes());this.viewCache_=Br(h,l),this.eventGenerator_=new Wr(this.query_)}get query(){return this.query_}}function xi(e,t){const n=Gr(e.viewCache_);return n&&(e.query._queryParams.loadsAllData()||!On(t)&&!n.getImmediateChild(En(t)).isEmpty())?n.getChild(t):null}function Mi(e){return 0===e.eventRegistrations_.length}function Li(e,t,r){const i=[];if(r){n(null==t,"A cancel should cancel all event registrations.");const s=e.query._path;e.eventRegistrations_.forEach((e=>{const t=e.createCancelEvent(r,s);t&&i.push(t)}))}if(t){let n=[];for(let r=0;r<e.eventRegistrations_.length;++r){const i=e.eventRegistrations_[r];if(i.matches(t)){if(t.hasAnyCallback()){n=n.concat(e.eventRegistrations_.slice(r+1));break}}else n.push(i)}e.eventRegistrations_=n}else e.eventRegistrations_=[];return i}function qi(e,t,r,i){t.type===Lr.MERGE&&null!==t.source.queryId&&(n(Gr(e.viewCache_),"We should always have a full cache before handling merges"),n(Qr(e.viewCache_),"Missing event cache, even though we have a server cache"));const s=e.viewCache_,o=Si(e.processor_,s,t,r,i);var a,c;return a=e.processor_,c=o.viewCache,n(c.eventCache.getNode().isIndexed(a.filter.getIndex()),"Event snap not indexed"),n(c.serverCache.getNode().isIndexed(a.filter.getIndex()),"Server snap not indexed"),n(o.viewCache.serverCache.isFullyInitialized()||!s.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),e.viewCache_=o.viewCache,ji(e,o.changes,o.viewCache.eventCache.getNode(),null)}function ji(e,t,n,r){const i=r?[r]:e.eventRegistrations_;return function(e,t,n,r){const i=[],s=[];return t.forEach((t=>{var n;"child_changed"===t.type&&e.index_.indexedValueChanged(t.oldSnap,t.snapshotNode)&&s.push((n=t.childName,{type:"child_moved",snapshotNode:t.snapshotNode,childName:n}))})),$r(e,i,"child_removed",t,r,n),$r(e,i,"child_added",t,r,n),$r(e,i,"child_moved",s,r,n),$r(e,i,"child_changed",t,r,n),$r(e,i,"value",t,r,n),i}(e.eventGenerator_,t,n,i)}let Fi,Ui;class Vi{constructor(){this.views=new Map}}function zi(e,t,r,i){const s=t.source.queryId;if(null!==s){const o=e.views.get(s);return n(null!=o,"SyncTree gave us an op for an invalid query."),qi(o,t,r,i)}{let n=[];for(const s of e.views.values())n=n.concat(qi(s,t,r,i));return n}}function Wi(e,t,n,r,i){const s=t._queryIdentifier,o=e.views.get(s);if(!o){let e=mi(n,i?r:null),s=!1;e?s=!0:r instanceof pr?(e=gi(n,r),s=!1):(e=pr.EMPTY_NODE,s=!1);const o=Br(new zr(e,s,!1),new zr(r,i,!1));return new Di(t,o)}return o}function $i(e,t,n,r,i,s){const o=Wi(e,t,r,i,s);return e.views.has(t._queryIdentifier)||e.views.set(t._queryIdentifier,o),function(e,t){e.eventRegistrations_.push(t)}(o,n),function(e,t){const n=e.viewCache_.eventCache,r=[];n.getNode().isLeafNode()||n.getNode().forEachChild(sr,((e,t)=>{r.push(wr(e,t))}));return n.isFullyInitialized()&&r.push(vr(n.getNode())),ji(e,r,n.getNode(),t)}(o,n)}function Bi(e,t,r,i){const s=t._queryIdentifier,o=[];let a=[];const c=Yi(e);if("default"===s)for(const[t,n]of e.views.entries())a=a.concat(Li(n,r,i)),Mi(n)&&(e.views.delete(t),n.query._queryParams.loadsAllData()||o.push(n.query));else{const t=e.views.get(s);t&&(a=a.concat(Li(t,r,i)),Mi(t)&&(e.views.delete(s),t.query._queryParams.loadsAllData()||o.push(t.query)))}return c&&!Yi(e)&&o.push(new(n(Fi,"Reference.ts has not been loaded"),Fi)(t._repo,t._path)),{removed:o,events:a}}function Hi(e){const t=[];for(const n of e.views.values())n.query._queryParams.loadsAllData()||t.push(n);return t}function Ki(e,t){let n=null;for(const r of e.views.values())n=n||xi(r,t);return n}function Qi(e,t){if(t._queryParams.loadsAllData())return Ji(e);{const n=t._queryIdentifier;return e.views.get(n)}}function Gi(e,t){return null!=Qi(e,t)}function Yi(e){return null!=Ji(e)}function Ji(e){for(const t of e.views.values())if(t.query._queryParams.loadsAllData())return t;return null}let Xi=1;class Zi{constructor(e){this.listenProvider_=e,this.syncPointTree_=new Jr(null),this.pendingWriteTree_={visibleWrites:Xr.empty(),allWrites:[],lastWriteId:-1},this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function es(e,t,r,i,s){return function(e,t,r,i,s){n(i>e.lastWriteId,"Stacking an older write on top of newer ones"),void 0===s&&(s=!0),e.allWrites.push({path:t,snap:r,writeId:i,visible:s}),s&&(e.visibleWrites=Zr(e.visibleWrites,t,r)),e.lastWriteId=i}(e.pendingWriteTree_,t,r,i,s),s?us(e,new Ur({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},t,r)):[]}function ts(e,t,r,i){!function(e,t,r,i){n(i>e.lastWriteId,"Stacking an older merge on top of newer ones"),e.allWrites.push({path:t,children:r,writeId:i,visible:!0}),e.visibleWrites=ei(e.visibleWrites,t,r),e.lastWriteId=i}(e.pendingWriteTree_,t,r,i);const s=Jr.fromObject(r);return us(e,new Vr({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},t,s))}function ns(e,t,n=!1){const r=function(e,t){for(let n=0;n<e.allWrites.length;n++){const r=e.allWrites[n];if(r.writeId===t)return r}return null}(e.pendingWriteTree_,t);if(li(e.pendingWriteTree_,t)){let t=new Jr(null);return null!=r.snap?t=t.set(Cn(),!0):Wt(r.children,(e=>{t=t.set(new In(e),!0)})),us(e,new jr(r.path,t,n))}return[]}function rs(e,t,n){return us(e,new Ur({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t,n))}function is(e,t,n,r,i=!1){const s=t._path,o=e.syncPointTree_.get(s);let a=[];if(o&&("default"===t._queryIdentifier||Gi(o,t))){const c=Bi(o,t,n,r);0===o.views.size&&(e.syncPointTree_=e.syncPointTree_.remove(s));const u=c.removed;if(a=c.events,!i){const n=-1!==u.findIndex((e=>e._queryParams.loadsAllData())),i=e.syncPointTree_.findOnPath(s,((e,t)=>Yi(t)));if(n&&!i){const t=e.syncPointTree_.subtree(s);if(!t.isEmpty()){const n=function(e){return e.fold(((e,t,n)=>{if(t&&Yi(t)){return[Ji(t)]}{let e=[];return t&&(e=Hi(t)),Wt(n,((t,n)=>{e=e.concat(n)})),e}}))}(t);for(let t=0;t<n.length;++t){const r=n[t],i=r.query,s=ds(e,r);e.listenProvider_.startListening(ys(i),ps(e,i),s.hashFn,s.onComplete)}}}if(!i&&u.length>0&&!r)if(n){const n=null;e.listenProvider_.stopListening(ys(t),n)}else u.forEach((t=>{const n=e.queryToTagMap.get(fs(t));e.listenProvider_.stopListening(ys(t),n)}))}!function(e,t){for(let n=0;n<t.length;++n){const r=t[n];if(!r._queryParams.loadsAllData()){const t=fs(r),n=e.queryToTagMap.get(t);e.queryToTagMap.delete(t),e.tagToQueryMap.delete(n)}}}(e,u)}return a}function ss(e,t,n,r){const i=ms(e,r);if(null!=i){const r=gs(i),s=r.path,o=r.queryId,a=An(s,t);return _s(e,s,new Ur(qr(o),a,n))}return[]}function os(e,t,r,i=!1){const s=t._path;let o=null,a=!1;e.syncPointTree_.foreachOnPath(s,((e,t)=>{const n=An(e,s);o=o||Ki(t,n),a=a||Yi(t)}));let c,u=e.syncPointTree_.get(s);if(u?(a=a||Yi(u),o=o||Ki(u,Cn())):(u=new Vi,e.syncPointTree_=e.syncPointTree_.set(s,u)),null!=o)c=!0;else{c=!1,o=pr.EMPTY_NODE;e.syncPointTree_.subtree(s).foreachChild(((e,t)=>{const n=Ki(t,Cn());n&&(o=o.updateImmediateChild(e,n))}))}const l=Gi(u,t);if(!l&&!t._queryParams.loadsAllData()){const r=fs(t);n(!e.queryToTagMap.has(r),"View does not exist, but we have a tag");const i=Xi++;e.queryToTagMap.set(r,i),e.tagToQueryMap.set(i,r)}let h=$i(u,t,r,ui(e.pendingWriteTree_,s),o,c);if(!l&&!a&&!i){const r=Qi(u,t);h=h.concat(function(e,t,r){const i=t._path,s=ps(e,t),o=ds(e,r),a=e.listenProvider_.startListening(ys(t),s,o.hashFn,o.onComplete),c=e.syncPointTree_.subtree(i);if(s)n(!Yi(c.value),"If we're adding a query, it shouldn't be shadowed");else{const t=c.fold(((e,t,n)=>{if(!On(e)&&t&&Yi(t))return[Ji(t).query];{let e=[];return t&&(e=e.concat(Hi(t).map((e=>e.query)))),Wt(n,((t,n)=>{e=e.concat(n)})),e}}));for(let n=0;n<t.length;++n){const r=t[n];e.listenProvider_.stopListening(ys(r),ps(e,r))}}return a}(e,t,r))}return h}function as(e,t,n){const r=e.pendingWriteTree_,i=e.syncPointTree_.findOnPath(t,((e,n)=>{const r=Ki(n,An(e,t));if(r)return r}));return fi(r,t,i,n,!0)}function cs(e,t){const n=t._path;let r=null;e.syncPointTree_.foreachOnPath(n,((e,t)=>{const i=An(e,n);r=r||Ki(t,i)}));let i=e.syncPointTree_.get(n);i?r=r||Ki(i,Cn()):(i=new Vi,e.syncPointTree_=e.syncPointTree_.set(n,i));const s=null!=r,o=s?new zr(r,!0,!1):null;return function(e){return Qr(e.viewCache_)}(Wi(i,t,ui(e.pendingWriteTree_,t._path),s?o.getNode():pr.EMPTY_NODE,s))}function us(e,t){return ls(t,e.syncPointTree_,null,ui(e.pendingWriteTree_,Cn()))}function ls(e,t,n,r){if(On(e.path))return hs(e,t,n,r);{const i=t.get(Cn());null==n&&null!=i&&(n=Ki(i,Cn()));let s=[];const o=En(e.path),a=e.operationForChild(o),c=t.children.get(o);if(c&&a){const e=n?n.getImmediateChild(o):null,t=bi(r,o);s=s.concat(ls(a,c,e,t))}return i&&(s=s.concat(zi(i,e,r,n))),s}}function hs(e,t,n,r){const i=t.get(Cn());null==n&&null!=i&&(n=Ki(i,Cn()));let s=[];return t.children.inorderTraversal(((t,i)=>{const o=n?n.getImmediateChild(t):null,a=bi(r,t),c=e.operationForChild(t);c&&(s=s.concat(hs(c,i,o,a)))})),i&&(s=s.concat(zi(i,e,r,n))),s}function ds(e,t){const n=t.query,r=ps(e,n);return{hashFn:()=>{const e=function(e){return e.viewCache_.serverCache.getNode()}(t)||pr.EMPTY_NODE;return e.hash()},onComplete:t=>{if("ok"===t)return r?function(e,t,n){const r=ms(e,n);if(r){const n=gs(r),i=n.path,s=n.queryId,o=An(i,t);return _s(e,i,new Fr(qr(s),o))}return[]}(e,n._path,r):function(e,t){return us(e,new Fr({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t))}(e,n._path);{const r=function(e,t){let n="Unknown Error";"too_big"===e?n="The data requested exceeds the maximum size that can be accessed with a single request.":"permission_denied"===e?n="Client doesn't have permission to access the desired data.":"unavailable"===e&&(n="The service is unavailable");const r=new Error(e+" at "+t._path.toString()+": "+n);return r.code=e.toUpperCase(),r}(t,n);return is(e,n,null,r)}}}}function ps(e,t){const n=fs(t);return e.queryToTagMap.get(n)}function fs(e){return e._path.toString()+"$"+e._queryIdentifier}function ms(e,t){return e.tagToQueryMap.get(t)}function gs(e){const t=e.indexOf("$");return n(-1!==t&&t<e.length-1,"Bad queryKey."),{queryId:e.substr(t+1),path:new In(e.substr(0,t))}}function _s(e,t,r){const i=e.syncPointTree_.get(t);n(i,"Missing sync point for query tag that we're tracking");return zi(i,r,ui(e.pendingWriteTree_,t),null)}function ys(e){return e._queryParams.loadsAllData()&&!e._queryParams.isDefault()?new(n(Ui,"Reference.ts has not been loaded"),Ui)(e._repo,e._path):e}class vs{constructor(e){this.node_=e}getImmediateChild(e){const t=this.node_.getImmediateChild(e);return new vs(t)}node(){return this.node_}}class ws{constructor(e,t){this.syncTree_=e,this.path_=t}getImmediateChild(e){const t=Rn(this.path_,e);return new ws(this.syncTree_,t)}node(){return as(this.syncTree_,this.path_)}}const bs=function(e){return(e=e||{}).timestamp=e.timestamp||(new Date).getTime(),e},Is=function(e,t,r){return e&&"object"==typeof e?(n(".sv"in e,"Unexpected leaf node or priority contents"),"string"==typeof e[".sv"]?Cs(e[".sv"],t,r):"object"==typeof e[".sv"]?Es(e[".sv"],t):void n(!1,"Unexpected server value: "+JSON.stringify(e,null,2))):e},Cs=function(e,t,r){if("timestamp"===e)return r.timestamp;n(!1,"Unexpected server value: "+e)},Es=function(e,t,r){e.hasOwnProperty("increment")||n(!1,"Unexpected server value: "+JSON.stringify(e,null,2));const i=e.increment;"number"!=typeof i&&n(!1,"Unexpected increment value: "+i);const s=t.node();if(n(null!=s,"Expected ChildrenNode.EMPTY_NODE for nulls"),!s.isLeafNode())return i;const o=s.getValue();return"number"!=typeof o?i:o+i},Ts=function(e,t,n,r){return ks(t,new ws(n,e),r)},Ss=function(e,t,n){return ks(e,new vs(t),n)};function ks(e,t,n){const r=e.getPriority().val(),i=Is(r,t.getImmediateChild(".priority"),n);let s;if(e.isLeafNode()){const r=e,s=Is(r.getValue(),t,n);return s!==r.getValue()||i!==r.getPriority().val()?new ir(s,gr(i)):e}{const r=e;return s=r,i!==r.getPriority().val()&&(s=s.updatePriority(new ir(i))),r.forEachChild(sr,((e,r)=>{const i=ks(r,t.getImmediateChild(e),n);i!==r&&(s=s.updateImmediateChild(e,i))})),s}}class Ns{constructor(e="",t=null,n={children:{},childCount:0}){this.name=e,this.parent=t,this.node=n}}function Ps(e,t){let n=t instanceof In?t:new In(t),r=e,i=En(n);for(;null!==i;){const e=P(r.node.children,i)||{children:{},childCount:0};r=new Ns(i,r,e),n=Sn(n),i=En(n)}return r}function Rs(e){return e.node.value}function Os(e,t){e.node.value=t,Ls(e)}function As(e){return e.node.childCount>0}function Ds(e,t){Wt(e.node.children,((n,r)=>{t(new Ns(n,e,r))}))}function xs(e,t,n,r){n&&!r&&t(e),Ds(e,(e=>{xs(e,t,!0,r)})),n&&r&&t(e)}function Ms(e){return new In(null===e.parent?e.name:Ms(e.parent)+"/"+e.name)}function Ls(e){null!==e.parent&&function(e,t,n){const r=function(e){return void 0===Rs(e)&&!As(e)}(n),i=N(e.node.children,t);r&&i?(delete e.node.children[t],e.node.childCount--,Ls(e)):r||i||(e.node.children[t]=n.node,e.node.childCount++,Ls(e))}(e.parent,e.name,e)}const qs=/[\[\].#$\/\u0000-\u001F\u007F]/,js=/[\[\].#$\u0000-\u001F\u007F]/,Fs=10485760,Us=function(e){return"string"==typeof e&&0!==e.length&&!qs.test(e)},Vs=function(e){return"string"==typeof e&&0!==e.length&&!js.test(e)},zs=function(e,t,n){const r=n instanceof In?new Ln(n,e):n;if(void 0===t)throw new Error(e+"contains undefined "+jn(r));if("function"==typeof t)throw new Error(e+"contains a function "+jn(r)+" with contents = "+t.toString());if(Mt(t))throw new Error(e+"contains "+t.toString()+" "+jn(r));if("string"==typeof t&&t.length>Fs/3&&F(t)>Fs)throw new Error(e+"contains a string greater than "+Fs+" utf8 bytes "+jn(r)+" ('"+t.substring(0,50)+"...')");if(t&&"object"==typeof t){let n=!1,i=!1;if(Wt(t,((t,s)=>{if(".value"===t)n=!0;else if(".priority"!==t&&".sv"!==t&&(i=!0,!Us(t)))throw new Error(e+" contains an invalid key ("+t+") "+jn(r)+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');!function(e,t){e.parts_.length>0&&(e.byteLength_+=1),e.parts_.push(t),e.byteLength_+=F(t),qn(e)}(r,t),zs(e,s,r),function(e){const t=e.parts_.pop();e.byteLength_-=F(t),e.parts_.length>0&&(e.byteLength_-=1)}(r)})),n&&i)throw new Error(e+' contains ".value" child '+jn(r)+" in addition to actual children.")}},Ws=function(e,t,n,r){const i=j(e,"values");if(!t||"object"!=typeof t||Array.isArray(t))throw new Error(i+" must be an object containing the children to replace.");const s=[];Wt(t,((e,t)=>{const r=new In(e);if(zs(i,t,Rn(n,r)),".priority"===kn(r)&&!(null===(o=t)||"string"==typeof o||"number"==typeof o&&!Mt(o)||o&&"object"==typeof o&&N(o,".sv")))throw new Error(i+"contains an invalid value for '"+r.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");var o;s.push(r)})),function(e,t){let n,r;for(n=0;n<t.length;n++){r=t[n];const i=Nn(r);for(let t=0;t<i.length;t++)if(".priority"===i[t]&&t===i.length-1);else if(!Us(i[t]))throw new Error(e+"contains an invalid key ("+i[t]+") in path "+r.toString()+'. Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"')}t.sort(Dn);let i=null;for(n=0;n<t.length;n++){if(r=t[n],null!==i&&Mn(i,r))throw new Error(e+"contains a path "+i.toString()+" that is ancestor of another path "+r.toString());i=r}}(i,s)},$s=function(e,t,n,r){if(!Vs(n))throw new Error(j(e,t)+'was an invalid path = "'+n+'". Paths must be non-empty strings and can\'t contain ".", "#", "$", "[", or "]"')},Bs=function(e,t,n,r){n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),$s(e,t,n)},Hs=function(e,t){const n=t.path.toString();if("string"!=typeof t.repoInfo.host||0===t.repoInfo.host.length||!Us(t.repoInfo.namespace)&&"localhost"!==t.repoInfo.host.split(":")[0]||0!==n.length&&!function(e){return e&&(e=e.replace(/^\/*\.info(\/|$)/,"/")),Vs(e)}(n))throw new Error(j(e,"url")+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".')};class Ks{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function Qs(e,t){let n=null;for(let r=0;r<t.length;r++){const i=t[r],s=i.getPath();null===n||xn(s,n.path)||(e.eventLists_.push(n),n=null),null===n&&(n={events:[],path:s}),n.events.push(i)}n&&e.eventLists_.push(n)}function Gs(e,t,n){Qs(e,n),function(e,t){e.recursionDepth_++;let n=!0;for(let r=0;r<e.eventLists_.length;r++){const i=e.eventLists_[r];if(i){t(i.path)?(Ys(e.eventLists_[r]),e.eventLists_[r]=null):n=!1}}n&&(e.eventLists_=[]);e.recursionDepth_--}(e,(e=>Mn(e,t)||Mn(t,e)))}function Ys(e){for(let t=0;t<e.events.length;t++){const n=e.events[t];if(null!==n){e.events[t]=null;const r=n.getEventRunner();Nt&&Rt("event: "+n.toString()),Kt(r)}}}const Js="repo_interrupt",Xs=25;class Zs{constructor(e,t,n,r){this.repoInfo_=e,this.forceRestClient_=t,this.authTokenProvider_=n,this.appCheckProvider_=r,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new Ks,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=Or(),this.transactionQueueTree_=new Ns,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function eo(e,t,n){if(e.stats_=cn(e.repoInfo_),e.forceRestClient_||("object"==typeof window&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0)e.server_=new Pr(e.repoInfo_,((t,n,r,i)=>{ro(e,t,n,r,i)}),e.authTokenProvider_,e.appCheckProvider_),setTimeout((()=>io(e,!0)),0);else{if(null!=n){if("object"!=typeof n)throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{S(n)}catch(e){throw new Error("Invalid authOverride provided: "+e)}}e.persistentConnection_=new Vn(e.repoInfo_,t,((t,n,r,i)=>{ro(e,t,n,r,i)}),(t=>{io(e,t)}),(t=>{!function(e,t){Wt(t,((t,n)=>{so(e,t,n)}))}(e,t)}),e.authTokenProvider_,e.appCheckProvider_,n),e.server_=e.persistentConnection_}e.authTokenProvider_.addTokenChangeListener((t=>{e.server_.refreshAuthToken(t)})),e.appCheckProvider_.addTokenChangeListener((t=>{e.server_.refreshAppCheckToken(t.token)})),e.statsReporter_=function(e,t){const n=e.toString();return an[n]||(an[n]=t()),an[n]}(e.repoInfo_,(()=>new Mr(e.stats_,e.server_))),e.infoData_=new Rr,e.infoSyncTree_=new Zi({startListening:(t,n,r,i)=>{let s=[];const o=e.infoData_.getNode(t._path);return o.isEmpty()||(s=rs(e.infoSyncTree_,t._path,o),setTimeout((()=>{i("ok")}),0)),s},stopListening:()=>{}}),so(e,"connected",!1),e.serverSyncTree_=new Zi({startListening:(t,n,r,i)=>(e.server_.listen(t,r,n,((n,r)=>{const s=i(n,r);Gs(e.eventQueue_,t._path,s)})),[]),stopListening:(t,n)=>{e.server_.unlisten(t,n)}})}function to(e){const t=e.infoData_.getNode(new In(".info/serverTimeOffset")).val()||0;return(new Date).getTime()+t}function no(e){return bs({timestamp:to(e)})}function ro(e,t,n,r,i){e.dataUpdateCount++;const s=new In(t);n=e.interceptServerDataCallback_?e.interceptServerDataCallback_(t,n):n;let o=[];if(i)if(r){const t=O(n,(e=>gr(e)));o=function(e,t,n,r){const i=ms(e,r);if(i){const r=gs(i),s=r.path,o=r.queryId,a=An(s,t),c=Jr.fromObject(n);return _s(e,s,new Vr(qr(o),a,c))}return[]}(e.serverSyncTree_,s,t,i)}else{const t=gr(n);o=ss(e.serverSyncTree_,s,t,i)}else if(r){const t=O(n,(e=>gr(e)));o=function(e,t,n){const r=Jr.fromObject(n);return us(e,new Vr({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t,r))}(e.serverSyncTree_,s,t)}else{const t=gr(n);o=rs(e.serverSyncTree_,s,t)}let a=s;o.length>0&&(a=ho(e,s)),Gs(e.eventQueue_,a,o)}function io(e,t){so(e,"connected",t),!1===t&&function(e){ao(e,"onDisconnectEvents");const t=no(e),n=Or();Dr(e.onDisconnect_,Cn(),((r,i)=>{const s=Ts(r,i,e.serverSyncTree_,t);Ar(n,r,s)}));let r=[];Dr(n,Cn(),((t,n)=>{r=r.concat(rs(e.serverSyncTree_,t,n));const i=_o(e,t);ho(e,i)})),e.onDisconnect_=Or(),Gs(e.eventQueue_,Cn(),r)}(e)}function so(e,t,n){const r=new In("/.info/"+t),i=gr(n);e.infoData_.updateSnapshot(r,i);const s=rs(e.infoSyncTree_,r,i);Gs(e.eventQueue_,r,s)}function oo(e){return e.nextWriteId_++}function ao(e,...t){let n="";e.persistentConnection_&&(n=e.persistentConnection_.id+":"),Rt(n,...t)}function co(e,t,n,r){t&&Kt((()=>{if("ok"===n)t(null);else{const e=(n||"error").toUpperCase();let i=e;r&&(i+=": "+r);const s=new Error(i);s.code=e,t(s)}}))}function uo(e,t,n){return as(e.serverSyncTree_,t,n)||pr.EMPTY_NODE}function lo(e,t=e.transactionQueueTree_){if(t||go(e,t),Rs(t)){const r=fo(e,t);n(r.length>0,"Sending zero length transaction queue");r.every((e=>0===e.status))&&function(e,t,r){const i=r.map((e=>e.currentWriteId)),s=uo(e,t,i);let o=s;const a=s.hash();for(let e=0;e<r.length;e++){const i=r[e];n(0===i.status,"tryToSendTransactionQueue_: items in queue should all be run."),i.status=1,i.retryCount++;const s=An(t,i.path);o=o.updateChild(s,i.currentOutputSnapshotRaw)}const c=o.val(!0),u=t;e.server_.put(u.toString(),c,(n=>{ao(e,"transaction put response",{path:u.toString(),status:n});let i=[];if("ok"===n){const n=[];for(let t=0;t<r.length;t++)r[t].status=2,i=i.concat(ns(e.serverSyncTree_,r[t].currentWriteId)),r[t].onComplete&&n.push((()=>r[t].onComplete(null,!0,r[t].currentOutputSnapshotResolved))),r[t].unwatcher();go(e,Ps(e.transactionQueueTree_,t)),lo(e,e.transactionQueueTree_),Gs(e.eventQueue_,t,i);for(let e=0;e<n.length;e++)Kt(n[e])}else{if("datastale"===n)for(let e=0;e<r.length;e++)3===r[e].status?r[e].status=4:r[e].status=0;else{xt("transaction at "+u.toString()+" failed: "+n);for(let e=0;e<r.length;e++)r[e].status=4,r[e].abortReason=n}ho(e,t)}}),a)}(e,Ms(t),r)}else As(t)&&Ds(t,(t=>{lo(e,t)}))}function ho(e,t){const r=po(e,t),i=Ms(r);return function(e,t,r){if(0===t.length)return;const i=[];let s=[];const o=t.filter((e=>0===e.status)),a=o.map((e=>e.currentWriteId));for(let o=0;o<t.length;o++){const u=t[o],l=An(r,u.path);let h,d=!1;if(n(null!==l,"rerunTransactionsUnderNode_: relativePath should not be null."),4===u.status)d=!0,h=u.abortReason,s=s.concat(ns(e.serverSyncTree_,u.currentWriteId,!0));else if(0===u.status)if(u.retryCount>=Xs)d=!0,h="maxretry",s=s.concat(ns(e.serverSyncTree_,u.currentWriteId,!0));else{const n=uo(e,u.path,a);u.currentInputSnapshot=n;const r=t[o].update(n.val());if(void 0!==r){zs("transaction failed: Data returned ",r,u.path);let t=gr(r);"object"==typeof r&&null!=r&&N(r,".priority")||(t=t.updatePriority(n.getPriority()));const i=u.currentWriteId,o=no(e),c=Ss(t,n,o);u.currentOutputSnapshotRaw=t,u.currentOutputSnapshotResolved=c,u.currentWriteId=oo(e),a.splice(a.indexOf(i),1),s=s.concat(es(e.serverSyncTree_,u.path,c,u.currentWriteId,u.applyLocally)),s=s.concat(ns(e.serverSyncTree_,i,!0))}else d=!0,h="nodata",s=s.concat(ns(e.serverSyncTree_,u.currentWriteId,!0))}Gs(e.eventQueue_,r,s),s=[],d&&(t[o].status=2,c=t[o].unwatcher,setTimeout(c,Math.floor(0)),t[o].onComplete&&("nodata"===h?i.push((()=>t[o].onComplete(null,!1,t[o].currentInputSnapshot))):i.push((()=>t[o].onComplete(new Error(h),!1,null)))))}var c;go(e,e.transactionQueueTree_);for(let e=0;e<i.length;e++)Kt(i[e]);lo(e,e.transactionQueueTree_)}(e,fo(e,r),i),i}function po(e,t){let n,r=e.transactionQueueTree_;for(n=En(t);null!==n&&void 0===Rs(r);)r=Ps(r,n),n=En(t=Sn(t));return r}function fo(e,t){const n=[];return mo(e,t,n),n.sort(((e,t)=>e.order-t.order)),n}function mo(e,t,n){const r=Rs(t);if(r)for(let e=0;e<r.length;e++)n.push(r[e]);Ds(t,(t=>{mo(e,t,n)}))}function go(e,t){const n=Rs(t);if(n){let e=0;for(let t=0;t<n.length;t++)2!==n[t].status&&(n[e]=n[t],e++);n.length=e,Os(t,n.length>0?n:void 0)}Ds(t,(t=>{go(e,t)}))}function _o(e,t){const n=Ms(po(e,t)),r=Ps(e.transactionQueueTree_,t);return function(e,t){let n=e.parent;for(;null!==n;){if(t(n))return!0;n=n.parent}}(r,(t=>{yo(e,t)})),yo(e,r),xs(r,(t=>{yo(e,t)})),n}function yo(e,t){const r=Rs(t);if(r){const i=[];let s=[],o=-1;for(let t=0;t<r.length;t++)3===r[t].status||(1===r[t].status?(n(o===t-1,"All SENT items should be at beginning of queue."),o=t,r[t].status=3,r[t].abortReason="set"):(n(0===r[t].status,"Unexpected transaction status in abort"),r[t].unwatcher(),s=s.concat(ns(e.serverSyncTree_,r[t].currentWriteId,!0)),r[t].onComplete&&i.push(r[t].onComplete.bind(null,new Error("set"),!1,null))));-1===o?Os(t,void 0):r.length=o+1,Gs(e.eventQueue_,Ms(t),s);for(let e=0;e<i.length;e++)Kt(i[e])}}const vo=function(e,t){const n=wo(e),r=n.namespace;"firebase.com"===n.domain&&Dt(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),r&&"undefined"!==r||"localhost"===n.domain||Dt("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||"undefined"!=typeof window&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&xt("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().");const i="ws"===n.scheme||"wss"===n.scheme;return{repoInfo:new nn(n.host,n.secure,r,i,t,"",r!==n.subdomain),path:new In(n.pathString)}},wo=function(e){let t="",n="",r="",i="",s="",o=!0,a="https",c=443;if("string"==typeof e){let u=e.indexOf("//");u>=0&&(a=e.substring(0,u-1),e=e.substring(u+2));let l=e.indexOf("/");-1===l&&(l=e.length);let h=e.indexOf("?");-1===h&&(h=e.length),t=e.substring(0,Math.min(l,h)),l<h&&(i=function(e){let t="";const n=e.split("/");for(let e=0;e<n.length;e++)if(n[e].length>0){let r=n[e];try{r=decodeURIComponent(r.replace(/\+/g," "))}catch(e){}t+="/"+r}return t}(e.substring(l,h)));const d=function(e){const t={};"?"===e.charAt(0)&&(e=e.substring(1));for(const n of e.split("&")){if(0===n.length)continue;const r=n.split("=");2===r.length?t[decodeURIComponent(r[0])]=decodeURIComponent(r[1]):xt(`Invalid query segment '${n}' in query '${e}'`)}return t}(e.substring(Math.min(e.length,h)));u=t.indexOf(":"),u>=0?(o="https"===a||"wss"===a,c=parseInt(t.substring(u+1),10)):u=t.length;const p=t.slice(0,u);if("localhost"===p.toLowerCase())n="localhost";else if(p.split(".").length<=2)n=p;else{const e=t.indexOf(".");r=t.substring(0,e).toLowerCase(),n=t.substring(e+1),s=r}"ns"in d&&(s=d.ns)}return{host:t,port:c,domain:n,subdomain:r,secure:o,scheme:a,pathString:i,namespace:s}};class bo{constructor(e,t,n,r){this.eventType=e,this.eventRegistration=t,this.snapshot=n,this.prevName=r}getPath(){const e=this.snapshot.ref;return"value"===this.eventType?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+S(this.snapshot.exportVal())}}class Io{constructor(e,t,n){this.eventRegistration=e,this.error=t,this.path=n}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}class Co{constructor(e,t){this.snapshotCallback=e,this.cancelCallback=t}onValue(e,t){this.snapshotCallback.call(null,e,t)}onCancel(e){return n(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||void 0!==this.snapshotCallback.userCallback&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}}class Eo{constructor(e,t,n,r){this._repo=e,this._path=t,this._queryParams=n,this._orderByCalled=r}get key(){return On(this._path)?null:kn(this._path)}get ref(){return new To(this._repo,this._path)}get _queryIdentifier(){const e=Nr(this._queryParams),t=Vt(e);return"{}"===t?"default":t}get _queryObject(){return Nr(this._queryParams)}isEqual(e){if(!((e=U(e))instanceof Eo))return!1;const t=this._repo===e._repo,n=xn(this._path,e._path),r=this._queryIdentifier===e._queryIdentifier;return t&&n&&r}toJSON(){return this.toString()}toString(){return this._repo.toString()+function(e){let t="";for(let n=e.pieceNum_;n<e.pieces_.length;n++)""!==e.pieces_[n]&&(t+="/"+encodeURIComponent(String(e.pieces_[n])));return t||"/"}(this._path)}}class To extends Eo{constructor(e,t){super(e,t,new Sr,!1)}get parent(){const e=Pn(this._path);return null===e?null:new To(this._repo,e)}get root(){let e=this;for(;null!==e.parent;)e=e.parent;return e}}class So{constructor(e,t,n){this._node=e,this.ref=t,this._index=n}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){const t=new In(e),n=No(this.ref,e);return new So(this._node.getChild(t),n,sr)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){if(this._node.isLeafNode())return!1;return!!this._node.forEachChild(this._index,((t,n)=>e(new So(n,No(this.ref,t),sr))))}hasChild(e){const t=new In(e);return!this._node.getChild(t).isEmpty()}hasChildren(){return!this._node.isLeafNode()&&!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function ko(e,t){return(e=U(e))._checkNotDeleted("ref"),void 0!==t?No(e._root,t):e._root}function No(e,t){return null===En((e=U(e))._path)?Bs("child","path",t):$s("child","path",t),new To(e._repo,Rn(e._path,t))}function Po(e,t){Ws("update",t,e._path);const n=new _;return function(e,t,n,r){ao(e,"update",{path:t.toString(),value:n});let i=!0;const s=no(e),o={};if(Wt(n,((n,r)=>{i=!1,o[n]=Ts(Rn(t,n),gr(r),e.serverSyncTree_,s)})),i)Rt("update() called with empty data.  Don't do anything."),co(0,r,"ok",void 0);else{const i=oo(e),s=ts(e.serverSyncTree_,t,o,i);Qs(e.eventQueue_,s),e.server_.merge(t.toString(),n,((n,s)=>{const o="ok"===n;o||xt("update at "+t+" failed: "+n);const a=ns(e.serverSyncTree_,i,!o),c=a.length>0?ho(e,t):t;Gs(e.eventQueue_,c,a),co(0,r,n,s)})),Wt(n,(n=>{const r=_o(e,Rn(t,n));ho(e,r)})),Gs(e.eventQueue_,t,[])}}(e._repo,e._path,t,n.wrapCallback((()=>{}))),n.promise}function Ro(e){e=U(e);const t=new Co((()=>{})),n=new Oo(t);return function(e,t,n){const r=cs(e.serverSyncTree_,t);return null!=r?Promise.resolve(r):e.server_.get(t).then((r=>{const i=gr(r).withIndex(t._queryParams.getIndex());let s;if(os(e.serverSyncTree_,t,n,!0),t._queryParams.loadsAllData())s=rs(e.serverSyncTree_,t._path,i);else{const n=ps(e.serverSyncTree_,t);s=ss(e.serverSyncTree_,t._path,i,n)}return Gs(e.eventQueue_,t._path,s),is(e.serverSyncTree_,t,n,null,!0),i}),(n=>(ao(e,"get for query "+S(t)+" failed: "+n),Promise.reject(new Error(n)))))}(e._repo,e,n).then((t=>new So(t,new To(e._repo,e._path),e._queryParams.getIndex())))}class Oo{constructor(e){this.callbackContext=e}respondsTo(e){return"value"===e}createEvent(e,t){const n=t._queryParams.getIndex();return new bo("value",this,new So(e.snapshotNode,new To(t._repo,t._path),n))}getEventRunner(e){return"cancel"===e.getEventType()?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new Io(this,e,t):null}matches(e){return e instanceof Oo&&(!e.callbackContext||!this.callbackContext||e.callbackContext.matches(this.callbackContext))}hasAnyCallback(){return null!==this.callbackContext}}!function(e){n(!Fi,"__referenceConstructor has already been defined"),Fi=e}(To),function(e){n(!Ui,"__referenceConstructor has already been defined"),Ui=e}(To);const Ao="FIREBASE_DATABASE_EMULATOR_HOST",Do={};let xo=!1;function Mo(e,t,n,r,i){let s=r||e.options.databaseURL;void 0===s&&(e.options.projectId||Dt("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),Rt("Using default host for project ",e.options.projectId),s=`${e.options.projectId}-default-rtdb.firebaseio.com`);let o,a=vo(s,i),c=a.repoInfo;"undefined"!=typeof process&&process.env&&(o=process.env[Ao]),o?(s=`http://${o}?ns=${c.namespace}`,a=vo(s,i),c=a.repoInfo):a.repoInfo.secure;const u=new Yt(e.name,e.options,t);Hs("Invalid Firebase Database URL",a),On(a.path)||Dt("Database URL must point to the root of a Firebase Database (not including a child path).");const l=function(e,t,n,r){let i=Do[t.name];i||(i={},Do[t.name]=i);let s=i[e.toURLString()];s&&Dt("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call.");return s=new Zs(e,xo,n,r),i[e.toURLString()]=s,s}(c,e,u,new Gt(e.name,n));return new qo(l,e)}function Lo(e,t){const n=Do[t];n&&n[e.key]===e||Dt(`Database ${t}(${e.repoInfo_}) has already been deleted.`),function(e){e.persistentConnection_&&e.persistentConnection_.interrupt(Js)}(e),delete n[e.key]}class qo{constructor(e,t){this._repoInternal=e,this.app=t,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(eo(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new To(this._repo,Cn())),this._rootInternal}_delete(){return null!==this._rootInternal&&(Lo(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){null===this._rootInternal&&Dt("Cannot call "+e+" on a deleted database.")}}function jo(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}function Fo(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}Vn.prototype.simpleListen=function(e,t){this.sendRequest("q",{p:e},t)},Vn.prototype.echo=function(e,t){this.sendRequest("echo",{d:e},t)},function(e){!function(e){yt=e}(et),Ge(new V("database",((e,{instanceIdentifier:t})=>Mo(e.getProvider("app").getImmediate(),e.getProvider("auth-internal"),e.getProvider("app-check-internal"),t)),"PUBLIC").setMultipleInstances(!0)),rt(gt,_t,e),rt(gt,_t,"esm2017")}(),"function"==typeof SuppressedError&&SuppressedError;const Uo=Fo,Vo=new C("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),zo=new Y("@firebase/auth");function Wo(e,...t){zo.logLevel<=B.ERROR&&zo.error(`Auth (${et}): ${e}`,...t)}function $o(e,...t){throw Qo(e,...t)}function Bo(e,...t){return Qo(e,...t)}function Ho(e,t,n){const r=Object.assign(Object.assign({},Uo()),{[t]:n});return new C("auth","Firebase",r).create(t,{appName:e.name})}function Ko(e){return Ho(e,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Qo(e,...t){if("string"!=typeof e){const n=t[0],r=[...t.slice(1)];return r[0]&&(r[0].appName=e.name),e._errorFactory.create(n,...r)}return Vo.create(e,...t)}function Go(e,t,...n){if(!e)throw Qo(t,...n)}function Yo(e){const t="INTERNAL ASSERTION FAILED: "+e;throw Wo(t),new Error(t)}function Jo(e,t){e||Yo(t)}function Xo(){var e;return"undefined"!=typeof self&&(null===(e=self.location)||void 0===e?void 0:e.href)||""}function Zo(){var e;return"undefined"!=typeof self&&(null===(e=self.location)||void 0===e?void 0:e.protocol)||null}function ea(){return"undefined"==typeof navigator||!navigator||!("onLine"in navigator)||"boolean"!=typeof navigator.onLine||"http:"!==Zo()&&"https:"!==Zo()&&!function(){const e="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof e&&void 0!==e.id}()&&!("connection"in navigator)||navigator.onLine}class ta{constructor(e,t){this.shortDelay=e,this.longDelay=t,Jo(t>e,"Short delay should be less than long delay!"),this.isMobile=v()||w()}get(){return ea()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function na(e,t){Jo(e.emulator,"Emulator should always be set here");const{url:n}=e.emulator;return t?`${n}${t.startsWith("/")?t.slice(1):t}`:n}class ra{static initialize(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!=typeof self&&"fetch"in self?self.fetch:"undefined"!=typeof globalThis&&globalThis.fetch?globalThis.fetch:"undefined"!=typeof fetch?fetch:void Yo("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!=typeof self&&"Headers"in self?self.Headers:"undefined"!=typeof globalThis&&globalThis.Headers?globalThis.Headers:"undefined"!=typeof Headers?Headers:void Yo("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!=typeof self&&"Response"in self?self.Response:"undefined"!=typeof globalThis&&globalThis.Response?globalThis.Response:"undefined"!=typeof Response?Response:void Yo("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const ia={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},sa=new ta(3e4,6e4);function oa(e,t){return e.tenantId&&!t.tenantId?Object.assign(Object.assign({},t),{tenantId:e.tenantId}):t}async function aa(e,t,n,r,i={}){return ca(e,i,(async()=>{let i={},s={};r&&("GET"===t?s=r:i={body:JSON.stringify(r)});const o=x(Object.assign({key:e.config.apiKey},s)).slice(1),a=await e._getAdditionalHeaders();return a["Content-Type"]="application/json",e.languageCode&&(a["X-Firebase-Locale"]=e.languageCode),ra.fetch()(ua(e,e.config.apiHost,n,o),Object.assign({method:t,headers:a,referrerPolicy:"no-referrer"},i))}))}async function ca(e,t,n){e._canInitEmulator=!1;const r=Object.assign(Object.assign({},ia),t);try{const t=new la(e),i=await Promise.race([n(),t.promise]);t.clearNetworkTimeout();const s=await i.json();if("needConfirmation"in s)throw ha(e,"account-exists-with-different-credential",s);if(i.ok&&!("errorMessage"in s))return s;{const t=i.ok?s.errorMessage:s.error.message,[n,o]=t.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===n)throw ha(e,"credential-already-in-use",s);if("EMAIL_EXISTS"===n)throw ha(e,"email-already-in-use",s);if("USER_DISABLED"===n)throw ha(e,"user-disabled",s);const a=r[n]||n.toLowerCase().replace(/[_\s]+/g,"-");if(o)throw Ho(e,a,o);$o(e,a)}}catch(t){if(t instanceof I)throw t;$o(e,"network-request-failed",{message:String(t)})}}function ua(e,t,n,r){const i=`${t}${n}?${r}`;return e.config.emulator?na(e.config,i):`${e.config.apiScheme}://${i}`}class la{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise(((e,t)=>{this.timer=setTimeout((()=>t(Bo(this.auth,"network-request-failed"))),sa.get())}))}clearNetworkTimeout(){clearTimeout(this.timer)}}function ha(e,t,n){const r={appName:e.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const i=Bo(e,t,r);return i.customData._tokenResponse=n,i}async function da(e,t){return aa(e,"POST","/v1/accounts:lookup",t)}function pa(e){if(e)try{const t=new Date(Number(e));if(!isNaN(t.getTime()))return t.toUTCString()}catch(e){}}function fa(e){return 1e3*Number(e)}function ma(e){const[t,n,r]=e.split(".");if(void 0===t||void 0===n||void 0===r)return Wo("JWT malformed, contained fewer than 3 sections"),null;try{const e=u(n);return e?JSON.parse(e):(Wo("Failed to decode base64 JWT payload"),null)}catch(e){return Wo("Caught error parsing JWT payload as JSON",null==e?void 0:e.toString()),null}}function ga(e){const t=ma(e);return Go(t,"internal-error"),Go(void 0!==t.exp,"internal-error"),Go(void 0!==t.iat,"internal-error"),Number(t.exp)-Number(t.iat)}async function _a(e,t,n=!1){if(n)return t;try{return await t}catch(t){throw t instanceof I&&function({code:e}){return"auth/user-disabled"===e||"auth/user-token-expired"===e}(t)&&e.auth.currentUser===e&&await e.auth.signOut(),t}}class ya{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const e=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),e}{this.errorBackoff=3e4;const e=(null!==(t=this.user.stsTokenManager.expirationTime)&&void 0!==t?t:0)-Date.now()-3e5;return Math.max(0,e)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout((async()=>{await this.iteration()}),t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){return void("auth/network-request-failed"===(null==e?void 0:e.code)&&this.schedule(!0))}this.schedule()}}class va{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=pa(this.lastLoginAt),this.creationTime=pa(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function wa(e){var t;const n=e.auth,r=await e.getIdToken(),i=await _a(e,da(n,{idToken:r}));Go(null==i?void 0:i.users.length,n,"internal-error");const s=i.users[0];e._notifyReloadListener(s);const o=(null===(t=s.providerUserInfo)||void 0===t?void 0:t.length)?ba(s.providerUserInfo):[],a=function(e,t){const n=e.filter((e=>!t.some((t=>t.providerId===e.providerId))));return[...n,...t]}(e.providerData,o),c=e.isAnonymous,u=!(e.email&&s.passwordHash||(null==a?void 0:a.length)),l=!!c&&u,h={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new va(s.createdAt,s.lastLoginAt),isAnonymous:l};Object.assign(e,h)}function ba(e){return e.map((e=>{var{providerId:t}=e,n=jo(e,["providerId"]);return{providerId:t,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}}))}class Ia{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Go(e.idToken,"internal-error"),Go(void 0!==e.idToken,"internal-error"),Go(void 0!==e.refreshToken,"internal-error");const t="expiresIn"in e&&void 0!==e.expiresIn?Number(e.expiresIn):ga(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){Go(0!==e.length,"internal-error");const t=ga(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return t||!this.accessToken||this.isExpired?(Go(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null):this.accessToken}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:n,refreshToken:r,expiresIn:i}=await async function(e,t){const n=await ca(e,{},(async()=>{const n=x({grant_type:"refresh_token",refresh_token:t}).slice(1),{tokenApiHost:r,apiKey:i}=e.config,s=ua(e,r,"/v1/token",`key=${i}`),o=await e._getAdditionalHeaders();return o["Content-Type"]="application/x-www-form-urlencoded",ra.fetch()(s,{method:"POST",headers:o,body:n})}));return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}(e,t);this.updateTokensAndExpiration(n,r,Number(i))}updateTokensAndExpiration(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+1e3*n}static fromJSON(e,t){const{refreshToken:n,accessToken:r,expirationTime:i}=t,s=new Ia;return n&&(Go("string"==typeof n,"internal-error",{appName:e}),s.refreshToken=n),r&&(Go("string"==typeof r,"internal-error",{appName:e}),s.accessToken=r),i&&(Go("number"==typeof i,"internal-error",{appName:e}),s.expirationTime=i),s}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Ia,this.toJSON())}_performRefresh(){return Yo("not implemented")}}function Ca(e,t){Go("string"==typeof e||void 0===e,"internal-error",{appName:t})}class Ea{constructor(e){var{uid:t,auth:n,stsTokenManager:r}=e,i=jo(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new ya(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=n,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new va(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const t=await _a(this,this.stsTokenManager.getToken(this.auth,e));return Go(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return async function(e,t=!1){const n=U(e),r=await n.getIdToken(t),i=ma(r);Go(i&&i.exp&&i.auth_time&&i.iat,n.auth,"internal-error");const s="object"==typeof i.firebase?i.firebase:void 0,o=null==s?void 0:s.sign_in_provider;return{claims:i,token:r,authTime:pa(fa(i.auth_time)),issuedAtTime:pa(fa(i.iat)),expirationTime:pa(fa(i.exp)),signInProvider:o||null,signInSecondFactor:(null==s?void 0:s.sign_in_second_factor)||null}}(this,e)}reload(){return async function(e){const t=U(e);await wa(t),await t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)}(this)}_assign(e){this!==e&&(Go(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map((e=>Object.assign({},e))),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new Ea(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){Go(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),t&&await wa(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Je(this.auth.app))return Promise.reject(Ko(this.auth));const e=await this.getIdToken();return await _a(this,async function(e,t){return aa(e,"POST","/v1/accounts:delete",t)}(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map((e=>Object.assign({},e))),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var n,r,i,s,o,a,c,u;const l=null!==(n=t.displayName)&&void 0!==n?n:void 0,h=null!==(r=t.email)&&void 0!==r?r:void 0,d=null!==(i=t.phoneNumber)&&void 0!==i?i:void 0,p=null!==(s=t.photoURL)&&void 0!==s?s:void 0,f=null!==(o=t.tenantId)&&void 0!==o?o:void 0,m=null!==(a=t._redirectEventId)&&void 0!==a?a:void 0,g=null!==(c=t.createdAt)&&void 0!==c?c:void 0,_=null!==(u=t.lastLoginAt)&&void 0!==u?u:void 0,{uid:y,emailVerified:v,isAnonymous:w,providerData:b,stsTokenManager:I}=t;Go(y&&I,e,"internal-error");const C=Ia.fromJSON(this.name,I);Go("string"==typeof y,e,"internal-error"),Ca(l,e.name),Ca(h,e.name),Go("boolean"==typeof v,e,"internal-error"),Go("boolean"==typeof w,e,"internal-error"),Ca(d,e.name),Ca(p,e.name),Ca(f,e.name),Ca(m,e.name),Ca(g,e.name),Ca(_,e.name);const E=new Ea({uid:y,auth:e,email:h,emailVerified:v,displayName:l,isAnonymous:w,photoURL:p,phoneNumber:d,tenantId:f,stsTokenManager:C,createdAt:g,lastLoginAt:_});return b&&Array.isArray(b)&&(E.providerData=b.map((e=>Object.assign({},e)))),m&&(E._redirectEventId=m),E}static async _fromIdTokenResponse(e,t,n=!1){const r=new Ia;r.updateFromServerResponse(t);const i=new Ea({uid:t.localId,auth:e,stsTokenManager:r,isAnonymous:n});return await wa(i),i}static async _fromGetAccountInfoResponse(e,t,n){const r=t.users[0];Go(void 0!==r.localId,"internal-error");const i=void 0!==r.providerUserInfo?ba(r.providerUserInfo):[],s=!(r.email&&r.passwordHash||(null==i?void 0:i.length)),o=new Ia;o.updateFromIdToken(n);const a=new Ea({uid:r.localId,auth:e,stsTokenManager:o,isAnonymous:s}),c={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:i,metadata:new va(r.createdAt,r.lastLoginAt),isAnonymous:!(r.email&&r.passwordHash||(null==i?void 0:i.length))};return Object.assign(a,c),a}}const Ta=new Map;function Sa(e){Jo(e instanceof Function,"Expected a class definition");let t=Ta.get(e);return t?(Jo(t instanceof e,"Instance stored in cache mismatched with class"),t):(t=new e,Ta.set(e,t),t)}class ka{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return void 0===t?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}ka.type="NONE";const Na=ka;function Pa(e,t,n){return`firebase:${e}:${t}:${n}`}class Ra{constructor(e,t,n){this.persistence=e,this.auth=t,this.userKey=n;const{config:r,name:i}=this.auth;this.fullUserKey=Pa(this.userKey,r.apiKey,i),this.fullPersistenceKey=Pa("persistence",r.apiKey,i),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?Ea._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();return await this.removeCurrentUser(),this.persistence=e,t?this.setCurrentUser(t):void 0}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,n="authUser"){if(!t.length)return new Ra(Sa(Na),e,n);const r=(await Promise.all(t.map((async e=>{if(await e._isAvailable())return e})))).filter((e=>e));let i=r[0]||Sa(Na);const s=Pa(n,e.config.apiKey,e.name);let o=null;for(const n of t)try{const t=await n._get(s);if(t){const r=Ea._fromJSON(e,t);n!==i&&(o=r),i=n;break}}catch(e){}const a=r.filter((e=>e._shouldAllowMigration));return i._shouldAllowMigration&&a.length?(i=a[0],o&&await i._set(s,o.toJSON()),await Promise.all(t.map((async e=>{if(e!==i)try{await e._remove(s)}catch(e){}}))),new Ra(i,e,n)):new Ra(i,e,n)}}function Oa(e){const t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(Ma(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(Aa(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(qa(t))return"Blackberry";if(ja(t))return"Webos";if(Da(t))return"Safari";if((t.includes("chrome/")||xa(t))&&!t.includes("edge/"))return"Chrome";if(La(t))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=e.match(t);if(2===(null==n?void 0:n.length))return n[1]}return"Other"}function Aa(e=y()){return/firefox\//i.test(e)}function Da(e=y()){const t=e.toLowerCase();return t.includes("safari/")&&!t.includes("chrome/")&&!t.includes("crios/")&&!t.includes("android")}function xa(e=y()){return/crios\//i.test(e)}function Ma(e=y()){return/iemobile/i.test(e)}function La(e=y()){return/android/i.test(e)}function qa(e=y()){return/blackberry/i.test(e)}function ja(e=y()){return/webos/i.test(e)}function Fa(e=y()){return/iphone|ipad|ipod/i.test(e)||/macintosh/i.test(e)&&/mobile/i.test(e)}function Ua(){return function(){const e=y();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}()&&10===document.documentMode}function Va(e=y()){return Fa(e)||La(e)||ja(e)||qa(e)||/windows phone/i.test(e)||Ma(e)}function za(e,t=[]){let n;switch(e){case"Browser":n=Oa(y());break;case"Worker":n=`${Oa(y())}-${e}`;break;default:n=e}const r=t.length?t.join(","):"FirebaseCore-web";return`${n}/JsCore/${et}/${r}`}class Wa{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const n=t=>new Promise(((n,r)=>{try{n(e(t))}catch(e){r(e)}}));n.onAbort=t,this.queue.push(n);const r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const n of this.queue)await n(e),n.onAbort&&t.push(n.onAbort)}catch(e){t.reverse();for(const e of t)try{e()}catch(e){}throw this.auth._errorFactory.create("login-blocked",{originalMessage:null==e?void 0:e.message})}}}class $a{constructor(e){var t,n,r,i;const s=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=null!==(t=s.minPasswordLength)&&void 0!==t?t:6,s.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=s.maxPasswordLength),void 0!==s.containsLowercaseCharacter&&(this.customStrengthOptions.containsLowercaseLetter=s.containsLowercaseCharacter),void 0!==s.containsUppercaseCharacter&&(this.customStrengthOptions.containsUppercaseLetter=s.containsUppercaseCharacter),void 0!==s.containsNumericCharacter&&(this.customStrengthOptions.containsNumericCharacter=s.containsNumericCharacter),void 0!==s.containsNonAlphanumericCharacter&&(this.customStrengthOptions.containsNonAlphanumericCharacter=s.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,"ENFORCEMENT_STATE_UNSPECIFIED"===this.enforcementState&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=null!==(r=null===(n=e.allowedNonAlphanumericCharacters)||void 0===n?void 0:n.join(""))&&void 0!==r?r:"",this.forceUpgradeOnSignin=null!==(i=e.forceUpgradeOnSignin)&&void 0!==i&&i,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,n,r,i,s,o;const a={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,a),this.validatePasswordCharacterOptions(e,a),a.isValid&&(a.isValid=null===(t=a.meetsMinPasswordLength)||void 0===t||t),a.isValid&&(a.isValid=null===(n=a.meetsMaxPasswordLength)||void 0===n||n),a.isValid&&(a.isValid=null===(r=a.containsLowercaseLetter)||void 0===r||r),a.isValid&&(a.isValid=null===(i=a.containsUppercaseLetter)||void 0===i||i),a.isValid&&(a.isValid=null===(s=a.containsNumericCharacter)||void 0===s||s),a.isValid&&(a.isValid=null===(o=a.containsNonAlphanumericCharacter)||void 0===o||o),a}validatePasswordLengthOptions(e,t){const n=this.customStrengthOptions.minPasswordLength,r=this.customStrengthOptions.maxPasswordLength;n&&(t.meetsMinPasswordLength=e.length>=n),r&&(t.meetsMaxPasswordLength=e.length<=r)}validatePasswordCharacterOptions(e,t){let n;this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);for(let r=0;r<e.length;r++)n=e.charAt(r),this.updatePasswordCharacterOptionsStatuses(t,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,t,n,r,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=r)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}class Ba{constructor(e,t,n,r){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=n,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Ka(this),this.idTokenSubscription=new Ka(this),this.beforeStateQueue=new Wa(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Vo,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=r.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Sa(t)),this._initializationPromise=this.queue((async()=>{var n,r;if(!this._deleted&&(this.persistenceManager=await Ra.create(this,e),!this._deleted)){if(null===(n=this._popupRedirectResolver)||void 0===n?void 0:n._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch(e){}await this.initializeCurrentUser(t),this.lastNotifiedUid=(null===(r=this.currentUser)||void 0===r?void 0:r.uid)||null,this._deleted||(this._isInitialized=!0)}})),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();return this.currentUser||e?this.currentUser&&e&&this.currentUser.uid===e.uid?(this._currentUser._assign(e),void await this.currentUser.getIdToken()):void await this._updateCurrentUser(e,!0):void 0}async initializeCurrentUserFromIdToken(e){try{const t=await da(this,{idToken:e}),n=await Ea._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(n)}catch(e){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",e),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var t;if(Je(this.app)){const e=this.app.settings.authIdToken;return e?new Promise((t=>{setTimeout((()=>this.initializeCurrentUserFromIdToken(e).then(t,t)))})):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let r=n,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const n=null===(t=this.redirectUser)||void 0===t?void 0:t._redirectEventId,s=null==r?void 0:r._redirectEventId,o=await this.tryRedirectSignIn(e);n&&n!==s||!(null==o?void 0:o.user)||(r=o.user,i=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(r)}catch(e){r=n,this._popupRedirectResolver._overrideRedirectResult(this,(()=>Promise.reject(e)))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return Go(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch(e){await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await wa(e)}catch(e){if("auth/network-request-failed"!==(null==e?void 0:e.code))return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=function(){if("undefined"==typeof navigator)return null;const e=navigator;return e.languages&&e.languages[0]||e.language||null}()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Je(this.app))return Promise.reject(Ko(this));const t=e?U(e):null;return t&&Go(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&Go(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue((async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()}))}async signOut(){return Je(this.app)?Promise.reject(Ko(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Je(this.app)?Promise.reject(Ko(this)):this.queue((async()=>{await this.assertedPersistence.setPersistence(Sa(e))}))}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return null===this.tenantId?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await async function(e,t={}){return aa(e,"GET","/v2/passwordPolicy",oa(e,t))}(this),t=new $a(e);null===this.tenantId?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new C("auth","Firebase",e())}onAuthStateChanged(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}authStateReady(){return new Promise(((e,t)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged((()=>{n(),e()}),t)}}))}async revokeAccessToken(e){if(this.currentUser){const t={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:await this.currentUser.getIdToken()};null!=this.tenantId&&(t.tenantId=this.tenantId),await async function(e,t){return aa(e,"POST","/v2/accounts:revokeToken",oa(e,t))}(this,t)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(e=this._currentUser)||void 0===e?void 0:e.toJSON()}}async _setRedirectUser(e,t){const n=await this.getOrInitRedirectPersistenceManager(t);return null===e?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Sa(e)||this._popupRedirectResolver;Go(t,this,"argument-error"),this.redirectPersistenceManager=await Ra.create(this,[Sa(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,n;return this._isInitialized&&await this.queue((async()=>{})),(null===(t=this._currentUser)||void 0===t?void 0:t._redirectEventId)===e?this._currentUser:(null===(n=this.redirectUser)||void 0===n?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue((async()=>this.directlySetCurrentUser(e)))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=null!==(t=null===(e=this.currentUser)||void 0===e?void 0:e.uid)&&void 0!==t?t:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,n,r){if(this._deleted)return()=>{};const i="function"==typeof t?t:t.next.bind(t);let s=!1;const o=this._isInitialized?Promise.resolve():this._initializationPromise;if(Go(o,this,"internal-error"),o.then((()=>{s||i(this.currentUser)})),"function"==typeof t){const i=e.addObserver(t,n,r);return()=>{s=!0,i()}}{const n=e.addObserver(t);return()=>{s=!0,n()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Go(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){e&&!this.frameworks.includes(e)&&(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=za(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const n=await(null===(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getHeartbeatsHeader());n&&(t["X-Firebase-Client"]=n);const r=await this._getAppCheckToken();return r&&(t["X-Firebase-AppCheck"]=r),t}async _getAppCheckToken(){var e;const t=await(null===(e=this.appCheckServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getToken());return(null==t?void 0:t.error)&&function(e,...t){zo.logLevel<=B.WARN&&zo.warn(`Auth (${et}): ${e}`,...t)}(`Error while retrieving App Check token: ${t.error}`),null==t?void 0:t.token}}function Ha(e){return U(e)}class Ka{constructor(e){this.auth=e,this.observer=null,this.addObserver=function(e,t){const n=new L(e,t);return n.subscribe.bind(n)}((e=>this.observer=e))}get next(){return Go(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let Qa={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function Ga(e,t,n){const r=Ha(e);Go(r._canInitEmulator,r,"emulator-config-failed"),Go(/^https?:\/\//.test(t),r,"invalid-emulator-scheme");const i=Ya(t),{host:s,port:o}=function(e){const t=Ya(e),n=/(\/\/)?([^?#/]+)/.exec(e.substr(t.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const e=i[1];return{host:e,port:Ja(r.substr(e.length+1))}}{const[e,t]=r.split(":");return{host:e,port:Ja(t)}}}(t),a=null===o?"":`:${o}`;r.config.emulator={url:`${i}//${s}${a}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:s,port:o,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:!1})}),function(){function e(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}"undefined"!=typeof console&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials.");"undefined"!=typeof window&&"undefined"!=typeof document&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",e):e())}()}function Ya(e){const t=e.indexOf(":");return t<0?"":e.substr(0,t+1)}function Ja(e){if(!e)return null;const t=Number(e);return isNaN(t)?null:t}class Xa{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Yo("not implemented")}_getIdTokenResponse(e){return Yo("not implemented")}_linkToIdToken(e,t){return Yo("not implemented")}_getReauthenticationResolver(e){return Yo("not implemented")}}async function Za(e,t){return async function(e,t,n,r,i={}){const s=await aa(e,t,n,r,i);return"mfaPendingCredential"in s&&$o(e,"multi-factor-auth-required",{_serverResponse:s}),s}(e,"POST","/v1/accounts:signInWithIdp",oa(e,t))}class ec extends Xa{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new ec(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):$o("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t="string"==typeof e?JSON.parse(e):e,{providerId:n,signInMethod:r}=t,i=jo(t,["providerId","signInMethod"]);if(!n||!r)return null;const s=new ec(n,r);return s.idToken=i.idToken||void 0,s.accessToken=i.accessToken||void 0,s.secret=i.secret,s.nonce=i.nonce,s.pendingToken=i.pendingToken||null,s}_getIdTokenResponse(e){return Za(e,this.buildRequest())}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,Za(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Za(e,t)}buildRequest(){const e={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=x(t)}return e}}class tc{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class nc extends tc{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class rc extends nc{constructor(){super("facebook.com")}static credential(e){return ec._fromParams({providerId:rc.PROVIDER_ID,signInMethod:rc.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return rc.credentialFromTaggedObject(e)}static credentialFromError(e){return rc.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e))return null;if(!e.oauthAccessToken)return null;try{return rc.credential(e.oauthAccessToken)}catch(e){return null}}}rc.FACEBOOK_SIGN_IN_METHOD="facebook.com",rc.PROVIDER_ID="facebook.com";class ic extends nc{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return ec._fromParams({providerId:ic.PROVIDER_ID,signInMethod:ic.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return ic.credentialFromTaggedObject(e)}static credentialFromError(e){return ic.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:n}=e;if(!t&&!n)return null;try{return ic.credential(t,n)}catch(e){return null}}}ic.GOOGLE_SIGN_IN_METHOD="google.com",ic.PROVIDER_ID="google.com";class sc extends nc{constructor(){super("github.com")}static credential(e){return ec._fromParams({providerId:sc.PROVIDER_ID,signInMethod:sc.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return sc.credentialFromTaggedObject(e)}static credentialFromError(e){return sc.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e))return null;if(!e.oauthAccessToken)return null;try{return sc.credential(e.oauthAccessToken)}catch(e){return null}}}sc.GITHUB_SIGN_IN_METHOD="github.com",sc.PROVIDER_ID="github.com";class oc extends nc{constructor(){super("twitter.com")}static credential(e,t){return ec._fromParams({providerId:oc.PROVIDER_ID,signInMethod:oc.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return oc.credentialFromTaggedObject(e)}static credentialFromError(e){return oc.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:n}=e;if(!t||!n)return null;try{return oc.credential(t,n)}catch(e){return null}}}oc.TWITTER_SIGN_IN_METHOD="twitter.com",oc.PROVIDER_ID="twitter.com";class ac{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,n,r=!1){const i=await Ea._fromIdTokenResponse(e,n,r),s=cc(n);return new ac({user:i,providerId:s,_tokenResponse:n,operationType:t})}static async _forOperation(e,t,n){await e._updateTokensIfNecessary(n,!0);const r=cc(n);return new ac({user:e,providerId:r,_tokenResponse:n,operationType:t})}}function cc(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}class uc extends I{constructor(e,t,n,r){var i;super(t.code,t.message),this.operationType=n,this.user=r,Object.setPrototypeOf(this,uc.prototype),this.customData={appName:e.name,tenantId:null!==(i=e.tenantId)&&void 0!==i?i:void 0,_serverResponse:t.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,t,n,r){return new uc(e,t,n,r)}}function lc(e,t,n,r){return("reauthenticate"===t?n._getReauthenticationResolver(e):n._getIdTokenResponse(e)).catch((n=>{if("auth/multi-factor-auth-required"===n.code)throw uc._fromErrorAndOperation(e,n,t,r);throw n}))}const hc="__sak";class dc{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(hc,"1"),this.storage.removeItem(hc),Promise.resolve(!0)):Promise.resolve(!1)}catch(e){return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}class pc extends dc{constructor(){super((()=>window.localStorage),"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=Va(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const n=this.storage.getItem(t),r=this.localCache[t];n!==r&&e(t,r,n)}}onStorageEvent(e,t=!1){if(!e.key)return void this.forAllChangedKeys(((e,t,n)=>{this.notifyListeners(e,n)}));const n=e.key;t?this.detachListener():this.stopPolling();const r=()=>{const e=this.storage.getItem(n);(t||this.localCache[n]!==e)&&this.notifyListeners(n,e)},i=this.storage.getItem(n);Ua()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(r,10):r()}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const e of Array.from(n))e(t?JSON.parse(t):t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((()=>{this.forAllChangedKeys(((e,t,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:n}),!0)}))}),1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}pc.type="LOCAL";const fc=pc;class mc extends dc{constructor(){super((()=>window.sessionStorage),"SESSION")}_addListener(e,t){}_removeListener(e,t){}}mc.type="SESSION";const gc=mc;class _c{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find((t=>t.isListeningto(e)));if(t)return t;const n=new _c(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:n,eventType:r,data:i}=t.data,s=this.handlersMap[r];if(!(null==s?void 0:s.size))return;t.ports[0].postMessage({status:"ack",eventId:n,eventType:r});const o=Array.from(s).map((async e=>e(t.origin,i))),a=await function(e){return Promise.all(e.map((async e=>{try{return{fulfilled:!0,value:await e}}catch(e){return{fulfilled:!1,reason:e}}})))}(o);t.ports[0].postMessage({status:"done",eventId:n,eventType:r,response:a})}_subscribe(e,t){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),t&&0!==this.handlersMap[e].size||delete this.handlersMap[e],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}function yc(e="",t=10){let n="";for(let e=0;e<t;e++)n+=Math.floor(10*Math.random());return e+n}_c.receivers=[];class vc{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,n=50){const r="undefined"!=typeof MessageChannel?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let i,s;return new Promise(((o,a)=>{const c=yc("",20);r.port1.start();const u=setTimeout((()=>{a(new Error("unsupported_event"))}),n);s={messageChannel:r,onMessage(e){const t=e;if(t.data.eventId===c)switch(t.data.status){case"ack":clearTimeout(u),i=setTimeout((()=>{a(new Error("timeout"))}),3e3);break;case"done":clearTimeout(i),o(t.data.response);break;default:clearTimeout(u),clearTimeout(i),a(new Error("invalid_response"))}}},this.handlers.add(s),r.port1.addEventListener("message",s.onMessage),this.target.postMessage({eventType:e,eventId:c,data:t},[r.port2])})).finally((()=>{s&&this.removeMessageHandler(s)}))}}function wc(){return window}function bc(){return void 0!==wc().WorkerGlobalScope&&"function"==typeof wc().importScripts}const Ic="firebaseLocalStorageDb",Cc="firebaseLocalStorage",Ec="fbase_key";class Tc{constructor(e){this.request=e}toPromise(){return new Promise(((e,t)=>{this.request.addEventListener("success",(()=>{e(this.request.result)})),this.request.addEventListener("error",(()=>{t(this.request.error)}))}))}}function Sc(e,t){return e.transaction([Cc],t?"readwrite":"readonly").objectStore(Cc)}function kc(){const e=indexedDB.open(Ic,1);return new Promise(((t,n)=>{e.addEventListener("error",(()=>{n(e.error)})),e.addEventListener("upgradeneeded",(()=>{const t=e.result;try{t.createObjectStore(Cc,{keyPath:Ec})}catch(e){n(e)}})),e.addEventListener("success",(async()=>{const n=e.result;n.objectStoreNames.contains(Cc)?t(n):(n.close(),await function(){const e=indexedDB.deleteDatabase(Ic);return new Tc(e).toPromise()}(),t(await kc()))}))}))}async function Nc(e,t,n){const r=Sc(e,!0).put({[Ec]:t,value:n});return new Tc(r).toPromise()}function Pc(e,t){const n=Sc(e,!0).delete(t);return new Tc(n).toPromise()}class Rc{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then((()=>{}),(()=>{}))}async _openDb(){return this.db||(this.db=await kc()),this.db}async _withRetries(e){let t=0;for(;;)try{const t=await this._openDb();return await e(t)}catch(e){if(t++>3)throw e;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return bc()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=_c._getInstance(bc()?self:null),this.receiver._subscribe("keyChanged",(async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)}))),this.receiver._subscribe("ping",(async(e,t)=>["keyChanged"]))}async initializeSender(){var e,t;if(this.activeServiceWorker=await async function(){if(!(null===navigator||void 0===navigator?void 0:navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch(e){return null}}(),!this.activeServiceWorker)return;this.sender=new vc(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&(null===(e=n[0])||void 0===e?void 0:e.fulfilled)&&(null===(t=n[0])||void 0===t?void 0:t.value.includes("keyChanged"))&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){var t;if(this.sender&&this.activeServiceWorker&&((null===(t=null===navigator||void 0===navigator?void 0:navigator.serviceWorker)||void 0===t?void 0:t.controller)||null)===this.activeServiceWorker)try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch(t){}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await kc();return await Nc(e,hc,"1"),await Pc(e,hc),!0}catch(e){}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite((async()=>(await this._withRetries((n=>Nc(n,e,t))),this.localCache[e]=t,this.notifyServiceWorker(e))))}async _get(e){const t=await this._withRetries((t=>async function(e,t){const n=Sc(e,!1).get(t),r=await new Tc(n).toPromise();return void 0===r?null:r.value}(t,e)));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite((async()=>(await this._withRetries((t=>Pc(t,e))),delete this.localCache[e],this.notifyServiceWorker(e))))}async _poll(){const e=await this._withRetries((e=>{const t=Sc(e,!1).getAll();return new Tc(t).toPromise()}));if(!e)return[];if(0!==this.pendingWrites)return[];const t=[],n=new Set;if(0!==e.length)for(const{fbase_key:r,value:i}of e)n.add(r),JSON.stringify(this.localCache[r])!==JSON.stringify(i)&&(this.notifyListeners(r,i),t.push(r));for(const e of Object.keys(this.localCache))this.localCache[e]&&!n.has(e)&&(this.notifyListeners(e,null),t.push(e));return t}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const e of Array.from(n))e(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((async()=>this._poll()),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&this.stopPolling()}}Rc.type="LOCAL";const Oc=Rc;new ta(3e4,6e4);class Ac extends Xa{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Za(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Za(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Za(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function Dc(e){return async function(e,t,n=!1){if(Je(e.app))return Promise.reject(Ko(e));const r="signIn",i=await lc(e,r,t),s=await ac._fromIdTokenResponse(e,r,i);return n||await e._updateCurrentUser(s.user),s}(e.auth,new Ac(e),e.bypassAuthState)}function xc(e){const{auth:t,user:n}=e;return Go(n,t,"internal-error"),async function(e,t,n=!1){const{auth:r}=e;if(Je(r.app))return Promise.reject(Ko(r));const i="reauthenticate";try{const s=await _a(e,lc(r,i,t,e),n);Go(s.idToken,r,"internal-error");const o=ma(s.idToken);Go(o,r,"internal-error");const{sub:a}=o;return Go(e.uid===a,r,"user-mismatch"),ac._forOperation(e,i,s)}catch(e){throw"auth/user-not-found"===(null==e?void 0:e.code)&&$o(r,"user-mismatch"),e}}(n,new Ac(e),e.bypassAuthState)}async function Mc(e){const{auth:t,user:n}=e;return Go(n,t,"internal-error"),async function(e,t,n=!1){const r=await _a(e,t._linkToIdToken(e.auth,await e.getIdToken()),n);return ac._forOperation(e,"link",r)}(n,new Ac(e),e.bypassAuthState)}class Lc{constructor(e,t,n,r,i=!1){this.auth=e,this.resolver=n,this.user=r,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise((async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(e){this.reject(e)}}))}async onAuthEvent(e){const{urlResponse:t,sessionId:n,postBody:r,tenantId:i,error:s,type:o}=e;if(s)return void this.reject(s);const a={auth:this.auth,requestUri:t,sessionId:n,tenantId:i||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(a))}catch(e){this.reject(e)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Dc;case"linkViaPopup":case"linkViaRedirect":return Mc;case"reauthViaPopup":case"reauthViaRedirect":return xc;default:$o(this.auth,"internal-error")}}resolve(e){Jo(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Jo(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const qc=new ta(2e3,1e4);class jc extends Lc{constructor(e,t,n,r,i){super(e,t,r,i),this.provider=n,this.authWindow=null,this.pollId=null,jc.currentPopupAction&&jc.currentPopupAction.cancel(),jc.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Go(e,this.auth,"internal-error"),e}async onExecution(){Jo(1===this.filter.length,"Popup operations only handle one event");const e=yc();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch((e=>{this.reject(e)})),this.resolver._isIframeWebStorageSupported(this.auth,(e=>{e||this.reject(Bo(this.auth,"web-storage-unsupported"))})),this.pollUserCancellation()}get eventId(){var e;return(null===(e=this.authWindow)||void 0===e?void 0:e.associatedEvent)||null}cancel(){this.reject(Bo(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,jc.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,n;(null===(n=null===(t=this.authWindow)||void 0===t?void 0:t.window)||void 0===n?void 0:n.closed)?this.pollId=window.setTimeout((()=>{this.pollId=null,this.reject(Bo(this.auth,"popup-closed-by-user"))}),8e3):this.pollId=window.setTimeout(e,qc.get())};e()}}jc.currentPopupAction=null;const Fc="pendingRedirect",Uc=new Map;class Vc extends Lc{constructor(e,t,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,n),this.eventId=null}async execute(){let e=Uc.get(this.auth._key());if(!e){try{const t=await async function(e,t){const n=function(e){return Pa(Fc,e.config.apiKey,e.name)}(t),r=function(e){return Sa(e._redirectPersistence)}(e);if(!await r._isAvailable())return!1;const i="true"===await r._get(n);return await r._remove(n),i}(this.resolver,this.auth),n=t?await super.execute():null;e=()=>Promise.resolve(n)}catch(t){e=()=>Promise.reject(t)}Uc.set(this.auth._key(),e)}return this.bypassAuthState||Uc.set(this.auth._key(),(()=>Promise.resolve(null))),e()}async onAuthEvent(e){if("signInViaRedirect"===e.type)return super.onAuthEvent(e);if("unknown"!==e.type){if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}else this.resolve(null)}async onExecution(){}cleanUp(){}}function zc(e,t){Uc.set(e._key(),t)}async function Wc(e,t,n=!1){if(Je(e.app))return Promise.reject(Ko(e));const r=Ha(e),i=function(e,t){return t?Sa(t):(Go(e._popupRedirectResolver,e,"argument-error"),e._popupRedirectResolver)}(r,t),s=new Vc(r,i,n),o=await s.execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,t)),o}class $c{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach((n=>{this.isEventForConsumer(e,n)&&(t=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))})),this.hasHandledPotentialRedirect||!function(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Hc(e);default:return!1}}(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var n;if(e.error&&!Hc(e)){const r=(null===(n=e.error.code)||void 0===n?void 0:n.split("auth/")[1])||"internal-error";t.onError(Bo(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const n=null===t.eventId||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(Bc(e))}saveEventToCache(e){this.cachedEventUids.add(Bc(e)),this.lastProcessedEventTime=Date.now()}}function Bc(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter((e=>e)).join("-")}function Hc({type:e,error:t}){return"unknown"===e&&"auth/no-auth-event"===(null==t?void 0:t.code)}const Kc=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Qc=/^https?/;async function Gc(e){if(e.config.emulator)return;const{authorizedDomains:t}=await async function(e,t={}){return aa(e,"GET","/v1/projects",t)}(e);for(const e of t)try{if(Yc(e))return}catch(e){}$o(e,"unauthorized-domain")}function Yc(e){const t=Xo(),{protocol:n,hostname:r}=new URL(t);if(e.startsWith("chrome-extension://")){const i=new URL(e);return""===i.hostname&&""===r?"chrome-extension:"===n&&e.replace("chrome-extension://","")===t.replace("chrome-extension://",""):"chrome-extension:"===n&&i.hostname===r}if(!Qc.test(n))return!1;if(Kc.test(e))return r===e;const i=e.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}const Jc=new ta(3e4,6e4);function Xc(){const e=wc().___jsl;if(null==e?void 0:e.H)for(const t of Object.keys(e.H))if(e.H[t].r=e.H[t].r||[],e.H[t].L=e.H[t].L||[],e.H[t].r=[...e.H[t].L],e.CP)for(let t=0;t<e.CP.length;t++)e.CP[t]=null}function Zc(e){return new Promise(((t,n)=>{var r,i,s,o;function a(){Xc(),gapi.load("gapi.iframes",{callback:()=>{t(gapi.iframes.getContext())},ontimeout:()=>{Xc(),n(Bo(e,"network-request-failed"))},timeout:Jc.get()})}if(null===(i=null===(r=wc().gapi)||void 0===r?void 0:r.iframes)||void 0===i?void 0:i.Iframe)t(gapi.iframes.getContext());else{if(!(null===(s=wc().gapi)||void 0===s?void 0:s.load)){const t=`__${"iframefcb"}${Math.floor(1e6*Math.random())}`;return wc()[t]=()=>{gapi.load?a():n(Bo(e,"network-request-failed"))},(o=`${Qa.gapiScript}?onload=${t}`,Qa.loadJS(o)).catch((e=>n(e)))}a()}})).catch((e=>{throw eu=null,e}))}let eu=null;const tu=new ta(5e3,15e3),nu="__/auth/iframe",ru="emulator/auth/iframe",iu={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},su=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function ou(e){const t=e.config;Go(t.authDomain,e,"auth-domain-config-required");const n=t.emulator?na(t,ru):`https://${e.config.authDomain}/${nu}`,r={apiKey:t.apiKey,appName:e.name,v:et},i=su.get(e.config.apiHost);i&&(r.eid=i);const s=e._getFrameworks();return s.length&&(r.fw=s.join(",")),`${n}?${x(r).slice(1)}`}async function au(e){const t=await function(e){return eu=eu||Zc(e),eu}(e),n=wc().gapi;return Go(n,e,"internal-error"),t.open({where:document.body,url:ou(e),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:iu,dontclear:!0},(t=>new Promise((async(n,r)=>{await t.restyle({setHideOnLeave:!1});const i=Bo(e,"network-request-failed"),s=wc().setTimeout((()=>{r(i)}),tu.get());function o(){wc().clearTimeout(s),n(t)}t.ping(o).then(o,(()=>{r(i)}))}))))}const cu={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class uu{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch(e){}}}function lu(e,t,n,r=500,i=600){const s=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let a="";const c=Object.assign(Object.assign({},cu),{width:r.toString(),height:i.toString(),top:s,left:o}),u=y().toLowerCase();n&&(a=xa(u)?"_blank":n),Aa(u)&&(t=t||"http://localhost",c.scrollbars="yes");const l=Object.entries(c).reduce(((e,[t,n])=>`${e}${t}=${n},`),"");if(function(e=y()){var t;return Fa(e)&&!!(null===(t=window.navigator)||void 0===t?void 0:t.standalone)}(u)&&"_self"!==a)return function(e,t){const n=document.createElement("a");n.href=e,n.target=t;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}(t||"",a),new uu(null);const h=window.open(t||"",a,l);Go(h,e,"popup-blocked");try{h.focus()}catch(e){}return new uu(h)}const hu="__/auth/handler",du="emulator/auth/handler",pu=encodeURIComponent("fac");async function fu(e,t,n,r,i,s){Go(e.config.authDomain,e,"auth-domain-config-required"),Go(e.config.apiKey,e,"invalid-api-key");const o={apiKey:e.config.apiKey,appName:e.name,authType:n,redirectUrl:r,v:et,eventId:i};if(t instanceof tc){t.setDefaultLanguage(e.languageCode),o.providerId=t.providerId||"",R(t.getCustomParameters())||(o.customParameters=JSON.stringify(t.getCustomParameters()));for(const[e,t]of Object.entries({}))o[e]=t}if(t instanceof nc){const e=t.getScopes().filter((e=>""!==e));e.length>0&&(o.scopes=e.join(","))}e.tenantId&&(o.tid=e.tenantId);const a=o;for(const e of Object.keys(a))void 0===a[e]&&delete a[e];const c=await e._getAppCheckToken(),u=c?`#${pu}=${encodeURIComponent(c)}`:"";return`${function({config:e}){if(!e.emulator)return`https://${e.authDomain}/${hu}`;return na(e,du)}(e)}?${x(a).slice(1)}${u}`}const mu="webStorageSupport";const gu=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=gc,this._completeRedirectFn=Wc,this._overrideRedirectResult=zc}async _openPopup(e,t,n,r){var i;Jo(null===(i=this.eventManagers[e._key()])||void 0===i?void 0:i.manager,"_initialize() not called before _openPopup()");return lu(e,await fu(e,t,n,Xo(),r),yc())}async _openRedirect(e,t,n,r){await this._originValidation(e);return function(e){wc().location.href=e}(await fu(e,t,n,Xo(),r)),new Promise((()=>{}))}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:e,promise:n}=this.eventManagers[t];return e?Promise.resolve(e):(Jo(n,"If manager is not set, promise should be"),n)}const n=this.initAndGetManager(e);return this.eventManagers[t]={promise:n},n.catch((()=>{delete this.eventManagers[t]})),n}async initAndGetManager(e){const t=await au(e),n=new $c(e);return t.register("authEvent",(t=>{Go(null==t?void 0:t.authEvent,e,"invalid-auth-event");return{status:n.onEvent(t.authEvent)?"ACK":"ERROR"}}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=t,n}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(mu,{type:mu},(n=>{var r;const i=null===(r=null==n?void 0:n[0])||void 0===r?void 0:r[mu];void 0!==i&&t(!!i),$o(e,"internal-error")}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=Gc(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return Va()||Da()||Fa()}};var _u="@firebase/auth",yu="1.7.7";class vu{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),(null===(e=this.auth.currentUser)||void 0===e?void 0:e.uid)||null}async getToken(e){if(this.assertAuthConfigured(),await this.auth._initializationPromise,!this.auth.currentUser)return null;return{accessToken:await this.auth.currentUser.getIdToken(e)}}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged((t=>{e((null==t?void 0:t.stsTokenManager.accessToken)||null)}));this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Go(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}const wu=g("authIdTokenMaxAge")||300;let bu=null;var Iu,Cu;function Eu(){return Eu=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Eu.apply(this,arguments)}function Tu(e,t){if(null==e)return{};var n,r,i={},s=Object.keys(e);for(r=0;r<s.length;r++)n=s[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}Iu={loadJS:e=>new Promise(((t,n)=>{const r=document.createElement("script");var i,s;r.setAttribute("src",e),r.onload=t,r.onerror=e=>{const t=Bo("internal-error");t.customData=e,n(t)},r.type="text/javascript",r.charset="UTF-8",(null!==(s=null===(i=document.getElementsByTagName("head"))||void 0===i?void 0:i[0])&&void 0!==s?s:document).appendChild(r)})),gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="},Qa=Iu,Cu="Browser",Ge(new V("auth",((e,{options:t})=>{const n=e.getProvider("app").getImmediate(),r=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:s,authDomain:o}=n.options;Go(s&&!s.includes(":"),"invalid-api-key",{appName:n.name});const a={apiKey:s,authDomain:o,clientPlatform:Cu,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:za(Cu)},c=new Ba(n,r,i,a);return function(e,t){const n=(null==t?void 0:t.persistence)||[],r=(Array.isArray(n)?n:[n]).map(Sa);(null==t?void 0:t.errorMap)&&e._updateErrorMap(t.errorMap),e._initializeWithPersistence(r,null==t?void 0:t.popupRedirectResolver)}(c,t),c}),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback(((e,t,n)=>{e.getProvider("auth-internal").initialize()}))),Ge(new V("auth-internal",(e=>(e=>new vu(e))(Ha(e.getProvider("auth").getImmediate()))),"PRIVATE").setInstantiationMode("EXPLICIT")),rt(_u,yu,function(e){switch(e){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}(Cu)),rt(_u,yu,"esm2017");var Su=Nu((function(e){return"string"==typeof e?e:null})),ku=function(e){return null!=e};function Nu(e){return function(t){return ku(e(t))}}var Pu=function(e){return Object.keys(e).reduce((function(t,n){var r,i=e[n];return Eu({},t,ku(i)?((r={})[n]=i,r):{})}),{})};function Ru(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=t.length-1;return function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];for(var s=t[0].apply(this,n),o=1;o<=r;o++)s=t[o].call(this,s);return s}}var Ou,Au,Du=Nu((function(e){return ku(e)&&"object"==typeof e&&!Array.isArray(e)?e:null})),xu=Nu((function(e){return Array.isArray(e)&&e.every(Su)&&e.length>0?e:null})),Mu=Nu((function(e){return Du(e)&&"errors"in e&&xu(e.errors)?{errors:e.errors}:null})),Lu=function(e){this.message=e},qu=function(e){if(function(e){var t=e.headers.get("content-type");return ku(t)&&/application\/[^+]*[+]?(json);?.*/.test(t)}(e))return e.json().catch((function(e){throw new Lu("unable to parse JSON response.")}));throw new Lu("expected JSON response from server.")},ju=function(e){return function(t){return(t.ok?e({response:t}).then((function(e){return{type:"success",status:t.status,response:e,originalResponse:t}})):qu(t).then((function(e){return Eu({type:"error",status:t.status},function(e){return Mu(e)?{errors:e.errors,source:"api"}:{errors:["Responded with a status code outside the 2xx range, and the response body is not recognisable."],source:"decoding"}}(e),{originalResponse:t})}))).catch((function(e){if(e instanceof Lu)return{type:"error",source:"decoding",status:t.status,originalResponse:t,errors:[e.message]};throw e}))}},Fu=function(){return function(e){var t=e.response;return qu(t)}},Uu=function(e){var t=e.pathname,n=e.query;return function(e){var r=new URL(e);return function(e){return function(t){"/"===t.pathname?t.pathname=e:t.pathname+=e}}(t)(r),function(e){return function(t){Object.keys(e).forEach((function(n){return t.searchParams.set(n,e[n].toString())}))}}(n)(r),r.toString()}},Vu=function(e){return function(t,n){void 0===n&&(n={});var r=e(t),i=r.headers,s=r.query;return Eu({},Tu(r,["headers","query"]),n,{query:s,headers:Eu({},i,n.headers)})}},zu=function(e){return e},Wu=function(e){var t=e.accessKey,n=e.apiVersion,r=void 0===n?"v1":n,i=e.apiUrl,s=void 0===i?"https://api.unsplash.com":i,o=e.headers,a=e.fetch,c=Tu(e,["accessKey","apiVersion","apiUrl","headers","fetch"]);return function(e){var n=e.handleResponse;return Ru(e.handleRequest,(function(e){var i=e.pathname,u=e.query,l=e.method,h=void 0===l?"GET":l,d=e.headers,p=e.body,f=e.signal,m=Uu({pathname:i,query:u})(s),g=Eu({method:h,headers:Eu({},o,d,{"Accept-Version":r},ku(t)?{Authorization:"Client-ID "+t}:{}),body:p,signal:f},c);return(null!=a?a:fetch)(m,g).then(ju(n))}))}},$u="x-total",Bu=function(e){var t=e.headers.get($u);if(ku(t)){var n=parseInt(t);if(Number.isInteger(n))return n;throw new Lu("expected "+$u+" header to be valid integer.")}throw new Lu("expected "+$u+" header to exist.")},Hu=function(){return function(e){var t=e.response;return Fu()({response:t}).then((function(e){return{results:e,total:Bu(t)}}))}},Ku=function(e){return ku(e)?{collections:e.join()}:{}},Qu=function(e){return ku(e)?{topics:e.join()}:{}},Gu=function(e){var t=e.page,n=e.perPage,r=e.orderBy;return Pu({per_page:n,order_by:r,page:t})},Yu="/collections",Ju=function(){var e=function(e){var t=e.collectionId;return Yu+"/"+t+"/photos"};return{getPathname:e,handleRequest:Vu((function(t){var n=t.collectionId,r=t.orientation,i=Tu(t,["collectionId","orientation"]);return{pathname:e({collectionId:n}),query:Pu(Eu({},Gu(i),{orientation:r}))}})),handleResponse:Hu()}}(),Xu=function(){var e=function(e){var t=e.collectionId;return Yu+"/"+t};return{getPathname:e,handleRequest:Vu((function(t){var n=t.collectionId;return{pathname:e({collectionId:n}),query:{}}})),handleResponse:Fu()}}(),Zu=function(){var e=function(){return Yu};return{getPathname:e,handleRequest:Vu((function(t){return void 0===t&&(t={}),{pathname:e(),query:Gu(t)}})),handleResponse:Hu()}}(),el=function(){var e=function(e){var t=e.collectionId;return Yu+"/"+t+"/related"};return{getPathname:e,handleRequest:Vu((function(t){var n=t.collectionId;return{pathname:e({collectionId:n}),query:{}}})),handleResponse:Fu()}}(),tl="/photos",nl=function(){return{getPathname:function(e){return tl},handleRequest:Vu((function(e){return void 0===e&&(e={}),{pathname:tl,query:Pu(Gu(e))}})),handleResponse:Hu()}}(),rl=function(){var e=function(e){var t=e.photoId;return tl+"/"+t};return{getPathname:e,handleRequest:Vu((function(t){var n=t.photoId;return{pathname:e({photoId:n}),query:{}}})),handleResponse:Fu()}}(),il=function(){var e=function(e){var t=e.photoId;return tl+"/"+t+"/statistics"};return{getPathname:e,handleRequest:Vu((function(t){var n=t.photoId;return{pathname:e({photoId:n}),query:{}}})),handleResponse:Fu()}}(),sl=function(){var e=function(){return tl+"/random"};return{getPathname:e,handleRequest:Vu((function(t){var n=void 0===t?{}:t,r=n.collectionIds,i=n.contentFilter,s=n.topicIds,o=Tu(n,["collectionIds","contentFilter","topicIds"]);return{pathname:e(),query:Pu(Eu({},o,{content_filter:i},Ku(r),Qu(s))),headers:{"cache-control":"no-cache"}}})),handleResponse:Fu()}}(),ol={handleRequest:Vu((function(e){var t=function(e){var t=new URL(e),n=t.pathname,r=function(e){var t={};return e.forEach((function(e,n){t[n]=e})),t}(t.searchParams);return{query:r,pathname:"/"===n?void 0:n}}(e.downloadLocation),n=t.pathname,r=t.query;if(!ku(n))throw new Error("Could not parse pathname from url.");return{pathname:n,query:Pu(r)}})),handleResponse:Fu()},al="/search",cl=function(){var e=function(){return al+"/photos"};return{getPathname:function(t){return e()},handleRequest:Vu((function(t){var n=t.query,r=t.page,i=t.perPage,s=t.orderBy,o=t.collectionIds,a=t.lang,c=t.contentFilter,u=Tu(t,["query","page","perPage","orderBy","collectionIds","lang","contentFilter"]);return{pathname:e(),query:Pu(Eu({query:n,content_filter:c,lang:a,order_by:s},Gu({page:r,perPage:i}),Ku(o),u))}})),handleResponse:Fu()}}(),ul=function(){var e=function(){return al+"/collections"};return{getPathname:function(t){return e()},handleRequest:Vu((function(t){var n=t.query,r=Tu(t,["query"]);return{pathname:e(),query:Eu({query:n},Gu(r))}})),handleResponse:Fu()}}(),ll=function(){var e=function(){return al+"/users"};return{getPathname:function(t){return e()},handleRequest:Vu((function(t){var n=t.query,r=Tu(t,["query"]);return{pathname:e(),query:Eu({query:n},Gu(r))}})),handleResponse:Fu()}}(),hl="/users",dl=function(){var e=function(e){var t=e.username;return hl+"/"+t};return{getPathname:e,handleRequest:Vu((function(t){var n=t.username;return{pathname:e({username:n}),query:{}}})),handleResponse:Fu()}}(),pl=function(){var e=function(e){var t=e.username;return hl+"/"+t+"/photos"};return{getPathname:e,handleRequest:Vu((function(t){var n=t.username,r=t.stats,i=t.orientation,s=Tu(t,["username","stats","orientation"]);return{pathname:e({username:n}),query:Pu(Eu({},Gu(s),{orientation:i,stats:r}))}})),handleResponse:Hu()}}(),fl=function(){var e=function(e){var t=e.username;return hl+"/"+t+"/likes"};return{getPathname:e,handleRequest:Vu((function(t){var n=t.username,r=t.orientation,i=Tu(t,["username","orientation"]);return{pathname:e({username:n}),query:Pu(Eu({},Gu(i),{orientation:r}))}})),handleResponse:Hu()}}(),ml=function(){var e=function(e){var t=e.username;return hl+"/"+t+"/collections"};return{getPathname:e,handleRequest:Vu((function(t){var n=t.username,r=Tu(t,["username"]);return{pathname:e({username:n}),query:Gu(r)}})),handleResponse:Hu()}}(),gl="/topics",_l=function(e){var t=e.topicIdOrSlug;return gl+"/"+t},yl=zu({getPathname:_l,handleRequest:function(e){var t=e.page,n=e.perPage,r=e.orderBy,i=e.topicIdsOrSlugs;return{pathname:gl,query:Pu(Eu({},Gu({page:t,perPage:n}),{ids:null==i?void 0:i.join(","),order_by:r}))}},handleResponse:Hu()}),vl=zu({getPathname:_l,handleRequest:function(e){var t=e.topicIdOrSlug;return{pathname:_l({topicIdOrSlug:t}),query:{}}},handleResponse:Fu()}),wl=function(){var e=Ru(_l,(function(e){return e+"/photos"}));return{getPathname:e,handleRequest:function(t){var n=t.topicIdOrSlug,r=t.orientation,i=Tu(t,["topicIdOrSlug","orientation"]);return{pathname:e({topicIdOrSlug:n}),query:Pu(Eu({},Gu(i),{orientation:r}))}},handleResponse:Hu()}}();!function(e){e.Afrikaans="af",e.Amharic="am",e.Arabic="ar",e.Azerbaijani="az",e.Belarusian="be",e.Bulgarian="bg",e.Bengali="bn",e.Bosnian="bs",e.Catalan="ca",e.Cebuano="ceb",e.Corsican="co",e.Czech="cs",e.Welsh="cy",e.Danish="da",e.German="de",e.Greek="el",e.English="en",e.Esperanto="eo",e.Spanish="es",e.Estonian="et",e.Basque="eu",e.Persian="fa",e.Finnish="fi",e.French="fr",e.Frisian="fy",e.Irish="ga",e.ScotsGaelic="gd",e.Galician="gl",e.Gujarati="gu",e.Hausa="ha",e.Hawaiian="haw",e.Hindi="hi",e.Hmong="hmn",e.Croatian="hr",e.HaitianCreole="ht",e.Hungarian="hu",e.Armenian="hy",e.Indonesian="id",e.Igbo="ig",e.Icelandic="is",e.Italian="it",e.Hebrew="iw",e.Japanese="ja",e.Javanese="jw",e.Georgian="ka",e.Kazakh="kk",e.Khmer="km",e.Kannada="kn",e.Korean="ko",e.Kurdish="ku",e.Kyrgyz="ky",e.Latin="la",e.Luxembourgish="lb",e.Lao="lo",e.Lithuanian="lt",e.Latvian="lv",e.Malagasy="mg",e.Maori="mi",e.Macedonian="mk",e.Malayalam="ml",e.Mongolian="mn",e.Marathi="mr",e.Malay="ms",e.Maltese="mt",e.Myanmar="my",e.Nepali="ne",e.Dutch="nl",e.Norwegian="no",e.Nyanja="ny",e.Oriya="or",e.Punjabi="pa",e.Polish="pl",e.Pashto="ps",e.Portuguese="pt",e.Romanian="ro",e.Russian="ru",e.Kinyarwanda="rw",e.Sindhi="sd",e.Sinhala="si",e.Slovak="sk",e.Slovenian="sl",e.Samoan="sm",e.Shona="sn",e.Somali="so",e.Albanian="sq",e.Serbian="sr",e.Sesotho="st",e.Sundanese="su",e.Swedish="sv",e.Swahili="sw",e.Tamil="ta",e.Telugu="te",e.Tajik="tg",e.Thai="th",e.Turkmen="tk",e.Filipino="tl",e.Turkish="tr",e.Tatar="tt",e.Uighur="ug",e.Ukrainian="uk",e.Urdu="ur",e.Uzbek="uz",e.Vietnamese="vi",e.Xhosa="xh",e.Yiddish="yi",e.Yoruba="yo",e.ChineseSimplified="zh",e.ChineseTraditional="zh-TW",e.Zulu="zu"}(Ou||(Ou={})),function(e){e.LATEST="latest",e.POPULAR="popular",e.VIEWS="views",e.DOWNLOADS="downloads",e.OLDEST="oldest"}(Au||(Au={}));var bl=Ru(Wu,(function(e){return{photos:{get:e(rl),list:e(nl),getStats:e(il),getRandom:e(sl),trackDownload:e(ol)},users:{getPhotos:e(pl),getCollections:e(ml),getLikes:e(fl),get:e(dl)},search:{getCollections:e(ul),getPhotos:e(cl),getUsers:e(ll)},collections:{getPhotos:e(Ju),get:e(Xu),list:e(Zu),getRelated:e(el)},topics:{list:e(yl),get:e(vl),getPhotos:e(wl)}}}));const Il={apiKey:"AIzaSyDUamZR2aXuP2rFG1AFpb1Ni8aZA5uhSj4",authDomain:"fincalculations.firebaseapp.com",databaseURL:"https://fincalculations.firebaseio.com",projectId:"fincalculations",storageBucket:"fincalculations.appspot.com",messagingSenderId:"892270777573",appId:"1:892270777573:web:bdc13e9b47334b4319700c",accessKey:"NhcRJz0lTzcxiZusH5ss4Up8-hBz5DTED3UE8rLCjbo"};function Cl(e){return`Minified Redux error #${e}; visit https://redux.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var El=(()=>"function"==typeof Symbol&&Symbol.observable||"@@observable")(),Tl=()=>Math.random().toString(36).substring(7).split("").join("."),Sl={INIT:`@@redux/INIT${Tl()}`,REPLACE:`@@redux/REPLACE${Tl()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${Tl()}`};function kl(e){if("object"!=typeof e||null===e)return!1;let t=e;for(;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t||null===Object.getPrototypeOf(e)}function Nl(e){if(void 0===e)return"undefined";if(null===e)return"null";const t=typeof e;switch(t){case"boolean":case"string":case"number":case"symbol":case"function":return t}if(Array.isArray(e))return"array";if(function(e){return e instanceof Date||"function"==typeof e.toDateString&&"function"==typeof e.getDate&&"function"==typeof e.setDate}(e))return"date";if(function(e){return e instanceof Error||"string"==typeof e.message&&e.constructor&&"number"==typeof e.constructor.stackTraceLimit}(e))return"error";const n=function(e){return"function"==typeof e.constructor?e.constructor.name:null}(e);switch(n){case"Symbol":case"Promise":case"WeakMap":case"WeakSet":case"Map":case"Set":return n}return Object.prototype.toString.call(e).slice(8,-1).toLowerCase().replace(/\s/g,"")}function Pl(e){let t=typeof e;return"production"!==process.env.NODE_ENV&&(t=Nl(e)),t}function Rl(e,t,n){if("function"!=typeof e)throw new Error("production"===process.env.NODE_ENV?Cl(2):`Expected the root reducer to be a function. Instead, received: '${Pl(e)}'`);if("function"==typeof t&&"function"==typeof n||"function"==typeof n&&"function"==typeof arguments[3])throw new Error("production"===process.env.NODE_ENV?Cl(0):"It looks like you are passing several store enhancers to createStore(). This is not supported. Instead, compose them together to a single function. See https://redux.js.org/tutorials/fundamentals/part-4-store#creating-a-store-with-enhancers for an example.");if("function"==typeof t&&void 0===n&&(n=t,t=void 0),void 0!==n){if("function"!=typeof n)throw new Error("production"===process.env.NODE_ENV?Cl(1):`Expected the enhancer to be a function. Instead, received: '${Pl(n)}'`);return n(Rl)(e,t)}let r=e,i=t,s=new Map,o=s,a=0,c=!1;function u(){o===s&&(o=new Map,s.forEach(((e,t)=>{o.set(t,e)})))}function l(){if(c)throw new Error("production"===process.env.NODE_ENV?Cl(3):"You may not call store.getState() while the reducer is executing. The reducer has already received the state as an argument. Pass it down from the top reducer instead of reading it from the store.");return i}function h(e){if("function"!=typeof e)throw new Error("production"===process.env.NODE_ENV?Cl(4):`Expected the listener to be a function. Instead, received: '${Pl(e)}'`);if(c)throw new Error("production"===process.env.NODE_ENV?Cl(5):"You may not call store.subscribe() while the reducer is executing. If you would like to be notified after the store has been updated, subscribe from a component and invoke store.getState() in the callback to access the latest state. See https://redux.js.org/api/store#subscribelistener for more details.");let t=!0;u();const n=a++;return o.set(n,e),function(){if(t){if(c)throw new Error("production"===process.env.NODE_ENV?Cl(6):"You may not unsubscribe from a store listener while the reducer is executing. See https://redux.js.org/api/store#subscribelistener for more details.");t=!1,u(),o.delete(n),s=null}}}function d(e){if(!kl(e))throw new Error("production"===process.env.NODE_ENV?Cl(7):`Actions must be plain objects. Instead, the actual type was: '${Pl(e)}'. You may need to add middleware to your store setup to handle dispatching other values, such as 'redux-thunk' to handle dispatching functions. See https://redux.js.org/tutorials/fundamentals/part-4-store#middleware and https://redux.js.org/tutorials/fundamentals/part-6-async-logic#using-the-redux-thunk-middleware for examples.`);if(void 0===e.type)throw new Error("production"===process.env.NODE_ENV?Cl(8):'Actions may not have an undefined "type" property. You may have misspelled an action type string constant.');if("string"!=typeof e.type)throw new Error("production"===process.env.NODE_ENV?Cl(17):`Action "type" property must be a string. Instead, the actual type was: '${Pl(e.type)}'. Value was: '${e.type}' (stringified)`);if(c)throw new Error("production"===process.env.NODE_ENV?Cl(9):"Reducers may not dispatch actions.");try{c=!0,i=r(i,e)}finally{c=!1}return(s=o).forEach((e=>{e()})),e}d({type:Sl.INIT});return{dispatch:d,subscribe:h,getState:l,replaceReducer:function(e){if("function"!=typeof e)throw new Error("production"===process.env.NODE_ENV?Cl(10):`Expected the nextReducer to be a function. Instead, received: '${Pl(e)}`);r=e,d({type:Sl.REPLACE})},[El]:function(){const e=h;return{subscribe(t){if("object"!=typeof t||null===t)throw new Error("production"===process.env.NODE_ENV?Cl(11):`Expected the observer to be an object. Instead, received: '${Pl(t)}'`);function n(){const e=t;e.next&&e.next(l())}n();return{unsubscribe:e(n)}},[El](){return this}}}}}function Ol(e){"undefined"!=typeof console&&"function"==typeof console.error&&console.error(e);try{throw new Error(e)}catch(e){}}function Al(e){const t=Object.keys(e),n={};for(let r=0;r<t.length;r++){const i=t[r];"production"!==process.env.NODE_ENV&&void 0===e[i]&&Ol(`No reducer provided for key "${i}"`),"function"==typeof e[i]&&(n[i]=e[i])}const r=Object.keys(n);let i,s;"production"!==process.env.NODE_ENV&&(i={});try{!function(e){Object.keys(e).forEach((t=>{const n=e[t];if(void 0===n(void 0,{type:Sl.INIT}))throw new Error("production"===process.env.NODE_ENV?Cl(12):`The slice reducer for key "${t}" returned undefined during initialization. If the state passed to the reducer is undefined, you must explicitly return the initial state. The initial state may not be undefined. If you don't want to set a value for this reducer, you can use null instead of undefined.`);if(void 0===n(void 0,{type:Sl.PROBE_UNKNOWN_ACTION()}))throw new Error("production"===process.env.NODE_ENV?Cl(13):`The slice reducer for key "${t}" returned undefined when probed with a random type. Don't try to handle '${Sl.INIT}' or other actions in "redux/*" namespace. They are considered private. Instead, you must return the current state for any unknown actions, unless it is undefined, in which case you must return the initial state, regardless of the action type. The initial state may not be undefined, but can be null.`)}))}(n)}catch(e){s=e}return function(e={},t){if(s)throw s;if("production"!==process.env.NODE_ENV){const r=function(e,t,n,r){const i=Object.keys(t),s=n&&n.type===Sl.INIT?"preloadedState argument passed to createStore":"previous state received by the reducer";if(0===i.length)return"Store does not have a valid reducer. Make sure the argument passed to combineReducers is an object whose values are reducers.";if(!kl(e))return`The ${s} has unexpected type of "${Pl(e)}". Expected argument to be an object with the following keys: "${i.join('", "')}"`;const o=Object.keys(e).filter((e=>!t.hasOwnProperty(e)&&!r[e]));return o.forEach((e=>{r[e]=!0})),n&&n.type===Sl.REPLACE?void 0:o.length>0?`Unexpected ${o.length>1?"keys":"key"} "${o.join('", "')}" found in ${s}. Expected to find one of the known reducer keys instead: "${i.join('", "')}". Unexpected keys will be ignored.`:void 0}(e,n,t,i);r&&Ol(r)}let o=!1;const a={};for(let i=0;i<r.length;i++){const s=r[i],c=n[s],u=e[s],l=c(u,t);if(void 0===l){const e=t&&t.type;throw new Error("production"===process.env.NODE_ENV?Cl(14):`When called with an action of type ${e?`"${String(e)}"`:"(unknown type)"}, the slice reducer for key "${s}" returned undefined. To ignore an action, you must explicitly return the previous state. If you want this reducer to hold no value, you can return null instead of undefined.`)}a[s]=l,o=o||l!==u}return o=o||r.length!==Object.keys(e).length,o?a:e}}function Dl(...e){return 0===e.length?e=>e:1===e.length?e[0]:e.reduce(((e,t)=>(...n)=>e(t(...n))))}function xl(e){return kl(e)&&"type"in e&&"string"==typeof e.type}var Ml=Symbol.for("immer-nothing"),Ll=Symbol.for("immer-draftable"),ql=Symbol.for("immer-state"),jl="production"!==process.env.NODE_ENV?[function(e){return`The plugin for '${e}' has not been loaded into Immer. To enable the plugin, import and call \`enable${e}()\` when initializing your application.`},function(e){return`produce can only be called on things that are draftable: plain objects, arrays, Map, Set or classes that are marked with '[immerable]: true'. Got '${e}'`},"This object has been frozen and should not be mutated",function(e){return"Cannot use a proxy that has been revoked. Did you pass an object from inside an immer function to an async process? "+e},"An immer producer returned a new value *and* modified its draft. Either return a new value *or* modify the draft.","Immer forbids circular references","The first or second argument to `produce` must be a function","The third argument to `produce` must be a function or undefined","First argument to `createDraft` must be a plain object, an array, or an immerable object","First argument to `finishDraft` must be a draft returned by `createDraft`",function(e){return`'current' expects a draft, got: ${e}`},"Object.defineProperty() cannot be used on an Immer draft","Object.setPrototypeOf() cannot be used on an Immer draft","Immer only supports deleting array indices","Immer only supports setting array indices and the 'length' property",function(e){return`'original' expects a draft, got: ${e}`}]:[];function Fl(e,...t){if("production"!==process.env.NODE_ENV){const n=jl[e],r="function"==typeof n?n.apply(null,t):n;throw new Error(`[Immer] ${r}`)}throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var Ul=Object.getPrototypeOf;function Vl(e){return!!e&&!!e[ql]}function zl(e){return!!e&&($l(e)||Array.isArray(e)||!!e[Ll]||!!e.constructor?.[Ll]||Yl(e)||Jl(e))}var Wl=Object.prototype.constructor.toString();function $l(e){if(!e||"object"!=typeof e)return!1;const t=Ul(e);if(null===t)return!0;const n=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return n===Object||"function"==typeof n&&Function.toString.call(n)===Wl}function Bl(e,t){0===Hl(e)?Reflect.ownKeys(e).forEach((n=>{t(n,e[n],e)})):e.forEach(((n,r)=>t(r,n,e)))}function Hl(e){const t=e[ql];return t?t.type_:Array.isArray(e)?1:Yl(e)?2:Jl(e)?3:0}function Kl(e,t){return 2===Hl(e)?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function Ql(e,t){return 2===Hl(e)?e.get(t):e[t]}function Gl(e,t,n){const r=Hl(e);2===r?e.set(t,n):3===r?e.add(n):e[t]=n}function Yl(e){return e instanceof Map}function Jl(e){return e instanceof Set}function Xl(e){return e.copy_||e.base_}function Zl(e,t){if(Yl(e))return new Map(e);if(Jl(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);const n=$l(e);if(!0===t||"class_only"===t&&!n){const t=Object.getOwnPropertyDescriptors(e);delete t[ql];let n=Reflect.ownKeys(t);for(let r=0;r<n.length;r++){const i=n[r],s=t[i];!1===s.writable&&(s.writable=!0,s.configurable=!0),(s.get||s.set)&&(t[i]={configurable:!0,writable:!0,enumerable:s.enumerable,value:e[i]})}return Object.create(Ul(e),t)}{const t=Ul(e);if(null!==t&&n)return{...e};const r=Object.create(t);return Object.assign(r,e)}}function eh(e,t=!1){return nh(e)||Vl(e)||!zl(e)||(Hl(e)>1&&(e.set=e.add=e.clear=e.delete=th),Object.freeze(e),t&&Object.entries(e).forEach((([e,t])=>eh(t,!0)))),e}function th(){Fl(2)}function nh(e){return Object.isFrozen(e)}var rh,ih={};function sh(e){const t=ih[e];return t||Fl(0,e),t}function oh(){return rh}function ah(e,t){t&&(sh("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function ch(e){uh(e),e.drafts_.forEach(hh),e.drafts_=null}function uh(e){e===rh&&(rh=e.parent_)}function lh(e){return rh={drafts_:[],parent_:rh,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function hh(e){const t=e[ql];0===t.type_||1===t.type_?t.revoke_():t.revoked_=!0}function dh(e,t){t.unfinalizedDrafts_=t.drafts_.length;const n=t.drafts_[0];return void 0!==e&&e!==n?(n[ql].modified_&&(ch(t),Fl(4)),zl(e)&&(e=ph(t,e),t.parent_||mh(t,e)),t.patches_&&sh("Patches").generateReplacementPatches_(n[ql].base_,e,t.patches_,t.inversePatches_)):e=ph(t,n,[]),ch(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==Ml?e:void 0}function ph(e,t,n){if(nh(t))return t;const r=t[ql];if(!r)return Bl(t,((i,s)=>fh(e,r,t,i,s,n))),t;if(r.scope_!==e)return t;if(!r.modified_)return mh(e,r.base_,!0),r.base_;if(!r.finalized_){r.finalized_=!0,r.scope_.unfinalizedDrafts_--;const t=r.copy_;let i=t,s=!1;3===r.type_&&(i=new Set(t),t.clear(),s=!0),Bl(i,((i,o)=>fh(e,r,t,i,o,n,s))),mh(e,t,!1),n&&e.patches_&&sh("Patches").generatePatches_(r,n,e.patches_,e.inversePatches_)}return r.copy_}function fh(e,t,n,r,i,s,o){if("production"!==process.env.NODE_ENV&&i===n&&Fl(5),Vl(i)){const o=ph(e,i,s&&t&&3!==t.type_&&!Kl(t.assigned_,r)?s.concat(r):void 0);if(Gl(n,r,o),!Vl(o))return;e.canAutoFreeze_=!1}else o&&n.add(i);if(zl(i)&&!nh(i)){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1)return;ph(e,i),t&&t.scope_.parent_||"symbol"==typeof r||!Object.prototype.propertyIsEnumerable.call(n,r)||mh(e,i)}}function mh(e,t,n=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&eh(t,n)}var gh={get(e,t){if(t===ql)return e;const n=Xl(e);if(!Kl(n,t))return function(e,t,n){const r=vh(t,n);return r?"value"in r?r.value:r.get?.call(e.draft_):void 0}(e,n,t);const r=n[t];return e.finalized_||!zl(r)?r:r===yh(e.base_,t)?(bh(e),e.copy_[t]=Ih(r,e)):r},has:(e,t)=>t in Xl(e),ownKeys:e=>Reflect.ownKeys(Xl(e)),set(e,t,n){const r=vh(Xl(e),t);if(r?.set)return r.set.call(e.draft_,n),!0;if(!e.modified_){const r=yh(Xl(e),t),o=r?.[ql];if(o&&o.base_===n)return e.copy_[t]=n,e.assigned_[t]=!1,!0;if(((i=n)===(s=r)?0!==i||1/i==1/s:i!=i&&s!=s)&&(void 0!==n||Kl(e.base_,t)))return!0;bh(e),wh(e)}var i,s;return e.copy_[t]===n&&(void 0!==n||t in e.copy_)||Number.isNaN(n)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=n,e.assigned_[t]=!0),!0},deleteProperty:(e,t)=>(void 0!==yh(e.base_,t)||t in e.base_?(e.assigned_[t]=!1,bh(e),wh(e)):delete e.assigned_[t],e.copy_&&delete e.copy_[t],!0),getOwnPropertyDescriptor(e,t){const n=Xl(e),r=Reflect.getOwnPropertyDescriptor(n,t);return r?{writable:!0,configurable:1!==e.type_||"length"!==t,enumerable:r.enumerable,value:n[t]}:r},defineProperty(){Fl(11)},getPrototypeOf:e=>Ul(e.base_),setPrototypeOf(){Fl(12)}},_h={};function yh(e,t){const n=e[ql];return(n?Xl(n):e)[t]}function vh(e,t){if(!(t in e))return;let n=Ul(e);for(;n;){const e=Object.getOwnPropertyDescriptor(n,t);if(e)return e;n=Ul(n)}}function wh(e){e.modified_||(e.modified_=!0,e.parent_&&wh(e.parent_))}function bh(e){e.copy_||(e.copy_=Zl(e.base_,e.scope_.immer_.useStrictShallowCopy_))}Bl(gh,((e,t)=>{_h[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}})),_h.deleteProperty=function(e,t){return"production"!==process.env.NODE_ENV&&isNaN(parseInt(t))&&Fl(13),_h.set.call(this,e,t,void 0)},_h.set=function(e,t,n){return"production"!==process.env.NODE_ENV&&"length"!==t&&isNaN(parseInt(t))&&Fl(14),gh.set.call(this,e[0],t,n,e[0])};function Ih(e,t){const n=Yl(e)?sh("MapSet").proxyMap_(e,t):Jl(e)?sh("MapSet").proxySet_(e,t):function(e,t){const n=Array.isArray(e),r={type_:n?1:0,scope_:t?t.scope_:oh(),modified_:!1,finalized_:!1,assigned_:{},parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1};let i=r,s=gh;n&&(i=[r],s=_h);const{revoke:o,proxy:a}=Proxy.revocable(i,s);return r.draft_=a,r.revoke_=o,a}(e,t);return(t?t.scope_:oh()).drafts_.push(n),n}function Ch(e){if(!zl(e)||nh(e))return e;const t=e[ql];let n;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,n=Zl(e,t.scope_.immer_.useStrictShallowCopy_)}else n=Zl(e,!0);return Bl(n,((e,t)=>{Gl(n,e,Ch(t))})),t&&(t.finalized_=!1),n}function Eh(){"production"!==process.env.NODE_ENV&&jl.push('Sets cannot have "replace" patches.',(function(e){return"Unsupported patch operation: "+e}),(function(e){return"Cannot apply patch, path doesn't resolve: "+e}),"Patching reserved attributes like __proto__, prototype and constructor is not allowed");const e="replace",t="add",n="remove";function r(e){if(!zl(e))return e;if(Array.isArray(e))return e.map(r);if(Yl(e))return new Map(Array.from(e.entries()).map((([e,t])=>[e,r(t)])));if(Jl(e))return new Set(Array.from(e).map(r));const t=Object.create(Ul(e));for(const n in e)t[n]=r(e[n]);return Kl(e,Ll)&&(t[Ll]=e[Ll]),t}function i(e){return Vl(e)?r(e):e}var s,o;o={applyPatches_:function(i,s){return s.forEach((s=>{const{path:o,op:a}=s;let c=i;for(let e=0;e<o.length-1;e++){const t=Hl(c);let n=o[e];"string"!=typeof n&&"number"!=typeof n&&(n=""+n),0!==t&&1!==t||"__proto__"!==n&&"constructor"!==n||Fl(19),"function"==typeof c&&"prototype"===n&&Fl(19),c=Ql(c,n),"object"!=typeof c&&Fl(18,o.join("/"))}const u=Hl(c),l=r(s.value),h=o[o.length-1];switch(a){case e:switch(u){case 2:return c.set(h,l);case 3:Fl(16);default:return c[h]=l}case t:switch(u){case 1:return"-"===h?c.push(l):c.splice(h,0,l);case 2:return c.set(h,l);case 3:return c.add(l);default:return c[h]=l}case n:switch(u){case 1:return c.splice(h,1);case 2:return c.delete(h);case 3:return c.delete(s.value);default:return delete c[h]}default:Fl(17,a)}})),i},generatePatches_:function(r,s,o,a){switch(r.type_){case 0:case 2:return function(r,s,o,a){const{base_:c,copy_:u}=r;Bl(r.assigned_,((r,l)=>{const h=Ql(c,r),d=Ql(u,r),p=l?Kl(c,r)?e:t:n;if(h===d&&p===e)return;const f=s.concat(r);o.push(p===n?{op:p,path:f}:{op:p,path:f,value:d}),a.push(p===t?{op:n,path:f}:p===n?{op:t,path:f,value:i(h)}:{op:e,path:f,value:i(h)})}))}(r,s,o,a);case 1:return function(r,s,o,a){let{base_:c,assigned_:u}=r,l=r.copy_;l.length<c.length&&([c,l]=[l,c],[o,a]=[a,o]);for(let t=0;t<c.length;t++)if(u[t]&&l[t]!==c[t]){const n=s.concat([t]);o.push({op:e,path:n,value:i(l[t])}),a.push({op:e,path:n,value:i(c[t])})}for(let e=c.length;e<l.length;e++){const n=s.concat([e]);o.push({op:t,path:n,value:i(l[e])})}for(let e=l.length-1;c.length<=e;--e){const t=s.concat([e]);a.push({op:n,path:t})}}(r,s,o,a);case 3:return function(e,r,i,s){let{base_:o,copy_:a}=e,c=0;o.forEach((e=>{if(!a.has(e)){const o=r.concat([c]);i.push({op:n,path:o,value:e}),s.unshift({op:t,path:o,value:e})}c++})),c=0,a.forEach((e=>{if(!o.has(e)){const o=r.concat([c]);i.push({op:t,path:o,value:e}),s.unshift({op:n,path:o,value:e})}c++}))}(r,s,o,a)}},generateReplacementPatches_:function(t,n,r,i){r.push({op:e,path:[],value:n===Ml?void 0:n}),i.push({op:e,path:[],value:t})}},ih[s="Patches"]||(ih[s]=o)}var Th=new class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(e,t,n)=>{if("function"==typeof e&&"function"!=typeof t){const n=t;t=e;const r=this;return function(e=n,...i){return r.produce(e,(e=>t.call(this,e,...i)))}}let r;if("function"!=typeof t&&Fl(6),void 0!==n&&"function"!=typeof n&&Fl(7),zl(e)){const i=lh(this),s=Ih(e,void 0);let o=!0;try{r=t(s),o=!1}finally{o?ch(i):uh(i)}return ah(i,n),dh(r,i)}if(!e||"object"!=typeof e){if(r=t(e),void 0===r&&(r=e),r===Ml&&(r=void 0),this.autoFreeze_&&eh(r,!0),n){const t=[],i=[];sh("Patches").generateReplacementPatches_(e,r,t,i),n(t,i)}return r}Fl(1,e)},this.produceWithPatches=(e,t)=>{if("function"==typeof e)return(t,...n)=>this.produceWithPatches(t,(t=>e(t,...n)));let n,r;const i=this.produce(e,t,((e,t)=>{n=e,r=t}));return[i,n,r]},"boolean"==typeof e?.autoFreeze&&this.setAutoFreeze(e.autoFreeze),"boolean"==typeof e?.useStrictShallowCopy&&this.setUseStrictShallowCopy(e.useStrictShallowCopy)}createDraft(e){zl(e)||Fl(8),Vl(e)&&(e=function(e){Vl(e)||Fl(10,e);return Ch(e)}(e));const t=lh(this),n=Ih(e,void 0);return n[ql].isManual_=!0,uh(t),n}finishDraft(e,t){const n=e&&e[ql];n&&n.isManual_||Fl(9);const{scope_:r}=n;return ah(r,t),dh(void 0,r)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}applyPatches(e,t){let n;for(n=t.length-1;n>=0;n--){const r=t[n];if(0===r.path.length&&"replace"===r.op){e=r.value;break}}n>-1&&(t=t.slice(n+1));const r=sh("Patches").applyPatches_;return Vl(e)?r(e,t):this.produce(e,(e=>r(e,t)))}},Sh=Th.produce,kh=Th.produceWithPatches.bind(Th);Th.setAutoFreeze.bind(Th),Th.setUseStrictShallowCopy.bind(Th);var Nh=Th.applyPatches.bind(Th);Th.createDraft.bind(Th),Th.finishDraft.bind(Th);var Ph=(e,t,n)=>{if(1===t.length&&t[0]===n){let t=!1;try{const n={};e(n)===n&&(t=!0)}catch{}if(t){let e;try{throw new Error}catch(t){({stack:e}=t)}console.warn("The result function returned its own inputs without modification. e.g\n`createSelector([state => state.todos], todos => todos)`\nThis could lead to inefficient memoization and unnecessary re-renders.\nEnsure transformation logic is in the result function, and extraction logic is in the input selectors.",{stack:e})}}},Rh=(e,t,n)=>{const{memoize:r,memoizeOptions:i}=t,{inputSelectorResults:s,inputSelectorResultsCopy:o}=e,a=r((()=>({})),...i);if(!(a.apply(null,s)===a.apply(null,o))){let e;try{throw new Error}catch(t){({stack:e}=t)}console.warn("An input selector returned a different result when passed same arguments.\nThis means your output selector will likely run more frequently than intended.\nAvoid returning a new reference inside your input selector, e.g.\n`createSelector([state => state.todos.map(todo => todo.id)], todoIds => todoIds.length)`",{arguments:n,firstInputs:s,secondInputs:o,stack:e})}},Oh={inputStabilityCheck:"once",identityFunctionCheck:"once"};var Ah=e=>Array.isArray(e)?e:[e];function Dh(e){const t=Array.isArray(e[0])?e[0]:e;return function(e,t="expected all items to be functions, instead received the following types: "){if(!e.every((e=>"function"==typeof e))){const n=e.map((e=>"function"==typeof e?`function ${e.name||"unnamed"}()`:typeof e)).join(", ");throw new TypeError(`${t}[${n}]`)}}(t,"createSelector expects all input-selectors to be functions, but received the following types: "),t}function xh(e,t){const n=[],{length:r}=e;for(let i=0;i<r;i++)n.push(e[i].apply(null,t));return n}var Mh="undefined"!=typeof WeakRef?WeakRef:class{constructor(e){this.value=e}deref(){return this.value}},Lh=0,qh=1;function jh(){return{s:Lh,v:void 0,o:null,p:null}}function Fh(e,t={}){let n=jh();const{resultEqualityCheck:r}=t;let i,s=0;function o(){let t=n;const{length:o}=arguments;for(let e=0,n=o;e<n;e++){const n=arguments[e];if("function"==typeof n||"object"==typeof n&&null!==n){let e=t.o;null===e&&(t.o=e=new WeakMap);const r=e.get(n);void 0===r?(t=jh(),e.set(n,t)):t=r}else{let e=t.p;null===e&&(t.p=e=new Map);const r=e.get(n);void 0===r?(t=jh(),e.set(n,t)):t=r}}const a=t;let c;if(t.s===qh)c=t.v;else if(c=e.apply(null,arguments),s++,r){const e=i?.deref?.()??i;null!=e&&r(e,c)&&(c=e,0!==s&&s--);i="object"==typeof c&&null!==c||"function"==typeof c?new Mh(c):c}return a.s=qh,a.v=c,c}return o.clearCache=()=>{n=jh(),o.resetResultsCount()},o.resultsCount=()=>s,o.resetResultsCount=()=>{s=0},o}function Uh(e,...t){const n="function"==typeof e?{memoize:e,memoizeOptions:t}:e,r=(...e)=>{let t,r=0,i=0,s={},o=e.pop();"object"==typeof o&&(s=o,o=e.pop()),function(e,t="expected a function, instead received "+typeof e){if("function"!=typeof e)throw new TypeError(t)}(o,`createSelector expects an output function after the inputs, but received: [${typeof o}]`);const a={...n,...s},{memoize:c,memoizeOptions:u=[],argsMemoize:l=Fh,argsMemoizeOptions:h=[],devModeChecks:d={}}=a,p=Ah(u),f=Ah(h),m=Dh(e),g=c((function(){return r++,o.apply(null,arguments)}),...p);let _=!0;const y=l((function(){i++;const e=xh(m,arguments);if(t=g.apply(null,e),"production"!==process.env.NODE_ENV){const{identityFunctionCheck:n,inputStabilityCheck:r}=((e,t)=>{const{identityFunctionCheck:n,inputStabilityCheck:r}={...Oh,...t};return{identityFunctionCheck:{shouldRun:"always"===n||"once"===n&&e,run:Ph},inputStabilityCheck:{shouldRun:"always"===r||"once"===r&&e,run:Rh}}})(_,d);if(n.shouldRun&&n.run(o,e,t),r.shouldRun){const t=xh(m,arguments);r.run({inputSelectorResults:e,inputSelectorResultsCopy:t},{memoize:c,memoizeOptions:p},arguments)}_&&(_=!1)}return t}),...f);return Object.assign(y,{resultFunc:o,memoizedResultFunc:g,dependencies:m,dependencyRecomputations:()=>i,resetDependencyRecomputations:()=>{i=0},lastResult:()=>t,recomputations:()=>r,resetRecomputations:()=>{r=0},memoize:c,argsMemoize:l})};return Object.assign(r,{withTypes:()=>r}),r}var Vh=Uh(Fh),zh=Object.assign(((e,t=Vh)=>{!function(e,t="expected an object, instead received "+typeof e){if("object"!=typeof e)throw new TypeError(t)}(e,"createStructuredSelector expects first argument to be an object where each property is a selector, instead received a "+typeof e);const n=Object.keys(e);return t(n.map((t=>e[t])),((...e)=>e.reduce(((e,t,r)=>(e[n[r]]=t,e)),{})))}),{withTypes:()=>zh});function Wh(e){return({dispatch:t,getState:n})=>r=>i=>"function"==typeof i?i(t,n,e):r(i)}var $h=Wh(),Bh=Wh,Hh="undefined"!=typeof window&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(0!==arguments.length)return"object"==typeof arguments[0]?Dl:Dl.apply(null,arguments)},Kh=e=>e&&"function"==typeof e.match;function Qh(e,t){function n(...n){if(t){let r=t(...n);if(!r)throw new Error("production"===process.env.NODE_ENV?jd(0):"prepareAction did not return an object");return{type:e,payload:r.payload,..."meta"in r&&{meta:r.meta},..."error"in r&&{error:r.error}}}return{type:e,payload:n[0]}}return n.toString=()=>`${e}`,n.type=e,n.match=t=>xl(t)&&t.type===e,n}function Gh(e){return"function"==typeof e&&"type"in e&&Kh(e)}function Yh(e,t){let n=0;return{measureTime(e){const t=Date.now();try{return e()}finally{const e=Date.now();n+=e-t}},warnIfExceeded(){n>e&&console.warn(`${t} took ${n}ms, which is more than the warning threshold of ${e}ms. \nIf your state or actions are very large, you may want to disable the middleware as it might cause too much of a slowdown in development mode. See https://redux-toolkit.js.org/api/getDefaultMiddleware for instructions.\nIt is disabled in production builds, so you don't need to worry about that.`)}}}var Jh=class e extends Array{constructor(...t){super(...t),Object.setPrototypeOf(this,e.prototype)}static get[Symbol.species](){return e}concat(...e){return super.concat.apply(this,e)}prepend(...t){return 1===t.length&&Array.isArray(t[0])?new e(...t[0].concat(this)):new e(...t.concat(this))}};function Xh(e){return zl(e)?Sh(e,(()=>{})):e}function Zh(e,t,n){if(e.has(t)){let r=e.get(t);return n.update&&(r=n.update(r,t,e),e.set(t,r)),r}if(!n.insert)throw new Error("production"===process.env.NODE_ENV?jd(10):"No insert provided for key not already in map");const r=n.insert(t,e);return e.set(t,r),r}function ed(e){return"object"!=typeof e||null==e||Object.isFrozen(e)}function td(e,t,n){const r=nd(e,t,n);return{detectMutations:()=>rd(e,t,r,n)}}function nd(e,t=[],n,r="",i=new Set){const s={value:n};if(!e(n)&&!i.has(n)){i.add(n),s.children={};for(const i in n){const o=r?r+"."+i:i;t.length&&-1!==t.indexOf(o)||(s.children[i]=nd(e,t,n[i],o))}}return s}function rd(e,t=[],n,r,i=!1,s=""){const o=n?n.value:void 0,a=o===r;if(i&&!a&&!Number.isNaN(r))return{wasMutated:!0,path:s};if(e(o)||e(r))return{wasMutated:!1};const c={};for(let e in n.children)c[e]=!0;for(let e in r)c[e]=!0;const u=t.length>0;for(let i in c){const o=s?s+"."+i:i;if(u){if(t.some((e=>e instanceof RegExp?e.test(o):o===e)))continue}const c=rd(e,t,n.children[i],r[i],a,o);if(c.wasMutated)return c}return{wasMutated:!1}}function id(e){const t=typeof e;return null==e||"string"===t||"boolean"===t||"number"===t||Array.isArray(e)||kl(e)}function sd(e,t="",n=id,r,i=[],s){let o;if(!n(e))return{keyPath:t||"<root>",value:e};if("object"!=typeof e||null===e)return!1;if(s?.has(e))return!1;const a=null!=r?r(e):Object.entries(e),c=i.length>0;for(const[e,u]of a){const a=t?t+"."+e:e;if(c){if(i.some((e=>e instanceof RegExp?e.test(a):a===e)))continue}if(!n(u))return{keyPath:a,value:u};if("object"==typeof u&&(o=sd(u,a,n,r,i,s),o))return o}return s&&od(e)&&s.add(e),!1}function od(e){if(!Object.isFrozen(e))return!1;for(const t of Object.values(e))if("object"==typeof t&&null!==t&&!od(t))return!1;return!0}function ad(e){return"boolean"==typeof e}var cd=()=>function(e){const{thunk:t=!0,immutableCheck:n=!0,serializableCheck:r=!0,actionCreatorCheck:i=!0}=e??{};let s=new Jh;if(t&&(ad(t)?s.push($h):s.push(Bh(t.extraArgument))),"production"!==process.env.NODE_ENV){if(n){let e={};ad(n)||(e=n),s.unshift(function(e={}){if("production"===process.env.NODE_ENV)return()=>e=>t=>e(t);{let t=function(e,t,r,i){return JSON.stringify(e,n(t,i),r)},n=function(e,t){let n=[],r=[];return t||(t=function(e,t){return n[0]===t?"[Circular ~]":"[Circular ~."+r.slice(0,n.indexOf(t)).join(".")+"]"}),function(i,s){if(n.length>0){var o=n.indexOf(this);~o?n.splice(o+1):n.push(this),~o?r.splice(o,1/0,i):r.push(i),~n.indexOf(s)&&(s=t.call(this,i,s))}else n.push(s);return null==e?s:e.call(this,i,s)}},{isImmutable:r=ed,ignoredPaths:i,warnAfter:s=32}=e;const o=td.bind(null,r,i);return({getState:e})=>{let n,r=e(),i=o(r);return a=>c=>{const u=Yh(s,"ImmutableStateInvariantMiddleware");u.measureTime((()=>{if(r=e(),n=i.detectMutations(),i=o(r),n.wasMutated)throw new Error("production"===process.env.NODE_ENV?jd(19):`A state mutation was detected between dispatches, in the path '${n.path||""}'.  This may cause incorrect behavior. (https://redux.js.org/style-guide/style-guide#do-not-mutate-state)`)}));const l=a(c);return u.measureTime((()=>{if(r=e(),n=i.detectMutations(),i=o(r),n.wasMutated)throw new Error("production"===process.env.NODE_ENV?jd(20):`A state mutation was detected inside a dispatch, in the path: ${n.path||""}. Take a look at the reducer(s) handling the action ${t(c)}. (https://redux.js.org/style-guide/style-guide#do-not-mutate-state)`)})),u.warnIfExceeded(),l}}}}(e))}if(r){let e={};ad(r)||(e=r),s.push(function(e={}){if("production"===process.env.NODE_ENV)return()=>e=>t=>e(t);{const{isSerializable:t=id,getEntries:n,ignoredActions:r=[],ignoredActionPaths:i=["meta.arg","meta.baseQueryMeta"],ignoredPaths:s=[],warnAfter:o=32,ignoreState:a=!1,ignoreActions:c=!1,disableCache:u=!1}=e,l=!u&&WeakSet?new WeakSet:void 0;return e=>u=>h=>{if(!xl(h))return u(h);const d=u(h),p=Yh(o,"SerializableStateInvariantMiddleware");return c||r.length&&-1!==r.indexOf(h.type)||p.measureTime((()=>{const e=sd(h,"",t,n,i,l);if(e){const{keyPath:t,value:n}=e;console.error(`A non-serializable value was detected in an action, in the path: \`${t}\`. Value:`,n,"\nTake a look at the logic that dispatched this action: ",h,"\n(See https://redux.js.org/faq/actions#why-should-type-be-a-string-or-at-least-serializable-why-should-my-action-types-be-constants)","\n(To allow non-serializable values see: https://redux-toolkit.js.org/usage/usage-guide#working-with-non-serializable-data)")}})),a||(p.measureTime((()=>{const r=sd(e.getState(),"",t,n,s,l);if(r){const{keyPath:e,value:t}=r;console.error(`A non-serializable value was detected in the state, in the path: \`${e}\`. Value:`,t,`\nTake a look at the reducer(s) handling this action type: ${h.type}.\n(See https://redux.js.org/faq/organizing-state#can-i-put-functions-promises-or-other-non-serializable-items-in-my-store-state)`)}})),p.warnIfExceeded()),d}}}(e))}if(i){let e={};ad(i)||(e=i),s.unshift(function(e={}){if("production"===process.env.NODE_ENV)return()=>e=>t=>e(t);const{isActionCreator:t=Gh}=e;return()=>e=>n=>(t(n)&&console.warn(function(e){const t=e?`${e}`.split("/"):[],n=t[t.length-1]||"actionCreator";return`Detected an action creator with type "${e||"unknown"}" being dispatched. \nMake sure you're calling the action creator before dispatching, i.e. \`dispatch(${n}())\` instead of \`dispatch(${n})\`. This is necessary even if the action has no payload.`}(n.type)),e(n))}(e))}}return s},ud="RTK_autoBatch",ld=()=>e=>({payload:e,meta:{[ud]:!0}}),hd=e=>t=>{setTimeout(t,e)},dd="undefined"!=typeof window&&window.requestAnimationFrame?window.requestAnimationFrame:hd(10),pd=e=>function(t){const{autoBatch:n=!0}=t??{};let r=new Jh(e);return n&&r.push(((e={type:"raf"})=>t=>(...n)=>{const r=t(...n);let i=!0,s=!1,o=!1;const a=new Set,c="tick"===e.type?queueMicrotask:"raf"===e.type?dd:"callback"===e.type?e.queueNotification:hd(e.timeout),u=()=>{o=!1,s&&(s=!1,a.forEach((e=>e())))};return Object.assign({},r,{subscribe(e){const t=r.subscribe((()=>i&&e()));return a.add(e),()=>{t(),a.delete(e)}},dispatch(e){try{return i=!e?.meta?.[ud],s=!i,s&&(o||(o=!0,c(u))),r.dispatch(e)}finally{i=!0}}})})("object"==typeof n?n:void 0)),r};function fd(e){const t={},n=[];let r;const i={addCase(e,s){if("production"!==process.env.NODE_ENV){if(n.length>0)throw new Error("production"===process.env.NODE_ENV?jd(26):"`builder.addCase` should only be called before calling `builder.addMatcher`");if(r)throw new Error("production"===process.env.NODE_ENV?jd(27):"`builder.addCase` should only be called before calling `builder.addDefaultCase`")}const o="string"==typeof e?e:e.type;if(!o)throw new Error("production"===process.env.NODE_ENV?jd(28):"`builder.addCase` cannot be called with an empty action type");if(o in t)throw new Error("production"===process.env.NODE_ENV?jd(29):`\`builder.addCase\` cannot be called with two reducers for the same action type '${o}'`);return t[o]=s,i},addMatcher(e,t){if("production"!==process.env.NODE_ENV&&r)throw new Error("production"===process.env.NODE_ENV?jd(30):"`builder.addMatcher` should only be called before calling `builder.addDefaultCase`");return n.push({matcher:e,reducer:t}),i},addDefaultCase(e){if("production"!==process.env.NODE_ENV&&r)throw new Error("production"===process.env.NODE_ENV?jd(31):"`builder.addDefaultCase` can only be called once");return r=e,i}};return e(i),[t,n,r]}var md=(e,t)=>Kh(e)?e.match(t):e(t);function gd(...e){return t=>e.some((e=>md(e,t)))}function _d(...e){return t=>e.every((e=>md(e,t)))}function yd(e,t){if(!e||!e.meta)return!1;const n="string"==typeof e.meta.requestId,r=t.indexOf(e.meta.requestStatus)>-1;return n&&r}function vd(e){return"function"==typeof e[0]&&"pending"in e[0]&&"fulfilled"in e[0]&&"rejected"in e[0]}function wd(...e){return 0===e.length?e=>yd(e,["pending"]):vd(e)?gd(...e.map((e=>e.pending))):wd()(e[0])}function bd(...e){return 0===e.length?e=>yd(e,["rejected"]):vd(e)?gd(...e.map((e=>e.rejected))):bd()(e[0])}function Id(...e){const t=e=>e&&e.meta&&e.meta.rejectedWithValue;return 0===e.length||vd(e)?_d(bd(...e),t):Id()(e[0])}function Cd(...e){return 0===e.length?e=>yd(e,["fulfilled"]):vd(e)?gd(...e.map((e=>e.fulfilled))):Cd()(e[0])}function Ed(...e){return 0===e.length?e=>yd(e,["pending","fulfilled","rejected"]):vd(e)?gd(...e.flatMap((e=>[e.pending,e.rejected,e.fulfilled]))):Ed()(e[0])}var Td=(e=21)=>{let t="",n=e;for(;n--;)t+="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW"[64*Math.random()|0];return t},Sd=["name","message","stack","code"],kd=class{constructor(e,t){this.payload=e,this.meta=t}_type},Nd=class{constructor(e,t){this.payload=e,this.meta=t}_type},Pd=e=>{if("object"==typeof e&&null!==e){const t={};for(const n of Sd)"string"==typeof e[n]&&(t[n]=e[n]);return t}return{message:String(e)}},Rd=(()=>{function e(e,t,n){const r=Qh(e+"/fulfilled",((e,t,n,r)=>({payload:e,meta:{...r||{},arg:n,requestId:t,requestStatus:"fulfilled"}}))),i=Qh(e+"/pending",((e,t,n)=>({payload:void 0,meta:{...n||{},arg:t,requestId:e,requestStatus:"pending"}}))),s=Qh(e+"/rejected",((e,t,r,i,s)=>({payload:i,error:(n&&n.serializeError||Pd)(e||"Rejected"),meta:{...s||{},arg:r,requestId:t,rejectedWithValue:!!i,requestStatus:"rejected",aborted:"AbortError"===e?.name,condition:"ConditionError"===e?.name}})));return Object.assign((function(e){return(o,a,c)=>{const u=n?.idGenerator?n.idGenerator(e):Td(),l=new AbortController;let h,d;function p(e){d=e,l.abort()}const f=async function(){let f;try{let s=n?.condition?.(e,{getState:a,extra:c});if(null!==(m=s)&&"object"==typeof m&&"function"==typeof m.then&&(s=await s),!1===s||l.signal.aborted)throw{name:"ConditionError",message:"Aborted due to condition callback returning false."};const g=new Promise(((e,t)=>{h=()=>{t({name:"AbortError",message:d||"Aborted"})},l.signal.addEventListener("abort",h)}));o(i(u,e,n?.getPendingMeta?.({requestId:u,arg:e},{getState:a,extra:c}))),f=await Promise.race([g,Promise.resolve(t(e,{dispatch:o,getState:a,extra:c,requestId:u,signal:l.signal,abort:p,rejectWithValue:(e,t)=>new kd(e,t),fulfillWithValue:(e,t)=>new Nd(e,t)})).then((t=>{if(t instanceof kd)throw t;return t instanceof Nd?r(t.payload,u,e,t.meta):r(t,u,e)}))])}catch(t){f=t instanceof kd?s(null,u,e,t.payload,t.meta):s(t,u,e)}finally{h&&l.signal.removeEventListener("abort",h)}var m;return n&&!n.dispatchConditionRejection&&s.match(f)&&f.meta.condition||o(f),f}();return Object.assign(f,{abort:p,requestId:u,arg:e,unwrap:()=>f.then(Od)})}}),{pending:i,rejected:s,fulfilled:r,settled:gd(s,r),typePrefix:e})}return e.withTypes=()=>e,e})();function Od(e){if(e.meta&&e.meta.rejectedWithValue)throw e.payload;if(e.error)throw e.error;return e.payload}var Ad=Symbol.for("rtk-slice-createasyncthunk");function Dd(e,t){return`${e}/${t}`}function xd({creators:e}={}){const t=e?.asyncThunk?.[Ad];return function(e){const{name:n,reducerPath:r=n}=e;if(!n)throw new Error("production"===process.env.NODE_ENV?jd(11):"`name` is a required option for createSlice");"undefined"!=typeof process&&"development"===process.env.NODE_ENV&&void 0===e.initialState&&console.error("You must provide an `initialState` value that is not `undefined`. You may have misspelled `initialState`");const i=("function"==typeof e.reducers?e.reducers(function(){function e(e,t){return{_reducerDefinitionType:"asyncThunk",payloadCreator:e,...t}}return e.withTypes=()=>e,{reducer:e=>Object.assign({[e.name]:(...t)=>e(...t)}[e.name],{_reducerDefinitionType:"reducer"}),preparedReducer:(e,t)=>({_reducerDefinitionType:"reducerWithPrepare",prepare:e,reducer:t}),asyncThunk:e}}()):e.reducers)||{},s=Object.keys(i),o={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},a={addCase(e,t){const n="string"==typeof e?e:e.type;if(!n)throw new Error("production"===process.env.NODE_ENV?jd(12):"`context.addCase` cannot be called with an empty action type");if(n in o.sliceCaseReducersByType)throw new Error("production"===process.env.NODE_ENV?jd(13):"`context.addCase` cannot be called with two reducers for the same action type: "+n);return o.sliceCaseReducersByType[n]=t,a},addMatcher:(e,t)=>(o.sliceMatchers.push({matcher:e,reducer:t}),a),exposeAction:(e,t)=>(o.actionCreators[e]=t,a),exposeCaseReducer:(e,t)=>(o.sliceCaseReducersByName[e]=t,a)};function c(){if("production"!==process.env.NODE_ENV&&"object"==typeof e.extraReducers)throw new Error("production"===process.env.NODE_ENV?jd(14):"The object notation for `createSlice.extraReducers` has been removed. Please use the 'builder callback' notation instead: https://redux-toolkit.js.org/api/createSlice");const[t={},n=[],r]="function"==typeof e.extraReducers?fd(e.extraReducers):[e.extraReducers],i={...t,...o.sliceCaseReducersByType};return function(e,t){if("production"!==process.env.NODE_ENV&&"object"==typeof t)throw new Error("production"===process.env.NODE_ENV?jd(8):"The object notation for `createReducer` has been removed. Please use the 'builder callback' notation instead: https://redux-toolkit.js.org/api/createReducer");let n,[r,i,s]=fd(t);if("function"==typeof e)n=()=>Xh(e());else{const t=Xh(e);n=()=>t}function o(e=n(),t){let o=[r[t.type],...i.filter((({matcher:e})=>e(t))).map((({reducer:e})=>e))];return 0===o.filter((e=>!!e)).length&&(o=[s]),o.reduce(((e,n)=>{if(n){if(Vl(e)){const r=n(e,t);return void 0===r?e:r}if(zl(e))return Sh(e,(e=>n(e,t)));{const r=n(e,t);if(void 0===r){if(null===e)return e;throw new Error("production"===process.env.NODE_ENV?jd(9):"A case reducer on a non-draftable value must not return undefined")}return r}}return e}),e)}return o.getInitialState=n,o}(e.initialState,(e=>{for(let t in i)e.addCase(t,i[t]);for(let t of o.sliceMatchers)e.addMatcher(t.matcher,t.reducer);for(let t of n)e.addMatcher(t.matcher,t.reducer);r&&e.addDefaultCase(r)}))}s.forEach((r=>{const s=i[r],o={reducerName:r,type:Dd(n,r),createNotation:"function"==typeof e.reducers};!function(e){return"asyncThunk"===e._reducerDefinitionType}(s)?function({type:e,reducerName:t,createNotation:n},r,i){let s,o;if("reducer"in r){if(n&&!function(e){return"reducerWithPrepare"===e._reducerDefinitionType}(r))throw new Error("production"===process.env.NODE_ENV?jd(17):"Please use the `create.preparedReducer` notation for prepared action creators with the `create` notation.");s=r.reducer,o=r.prepare}else s=r;i.addCase(e,s).exposeCaseReducer(t,s).exposeAction(t,o?Qh(e,o):Qh(e))}(o,s,a):function({type:e,reducerName:t},n,r,i){if(!i)throw new Error("production"===process.env.NODE_ENV?jd(18):"Cannot use `create.asyncThunk` in the built-in `createSlice`. Use `buildCreateSlice({ creators: { asyncThunk: asyncThunkCreator } })` to create a customised version of `createSlice`.");const{payloadCreator:s,fulfilled:o,pending:a,rejected:c,settled:u,options:l}=n,h=i(e,s,l);r.exposeAction(t,h),o&&r.addCase(h.fulfilled,o);a&&r.addCase(h.pending,a);c&&r.addCase(h.rejected,c);u&&r.addMatcher(h.settled,u);r.exposeCaseReducer(t,{fulfilled:o||qd,pending:a||qd,rejected:c||qd,settled:u||qd})}(o,s,a,t)}));const u=e=>e,l=new Map;let h;function d(e,t){return h||(h=c()),h(e,t)}function p(){return h||(h=c()),h.getInitialState()}function f(t,n=!1){function r(e){let r=e[t];if(void 0===r)if(n)r=p();else if("production"!==process.env.NODE_ENV)throw new Error("production"===process.env.NODE_ENV?jd(15):"selectSlice returned undefined for an uninjected slice reducer");return r}function i(t=u){const r=Zh(l,n,{insert:()=>new WeakMap});return Zh(r,t,{insert:()=>{const r={};for(const[i,s]of Object.entries(e.selectors??{}))r[i]=Md(s,t,p,n);return r}})}return{reducerPath:t,getSelectors:i,get selectors(){return i(r)},selectSlice:r}}const m={name:n,reducer:d,actions:o.actionCreators,caseReducers:o.sliceCaseReducersByName,getInitialState:p,...f(r),injectInto(e,{reducerPath:t,...n}={}){const i=t??r;return e.inject({reducerPath:i,reducer:d},n),{...m,...f(i,!0)}}};return m}}function Md(e,t,n,r){function i(i,...s){let o=t(i);if(void 0===o)if(r)o=n();else if("production"!==process.env.NODE_ENV)throw new Error("production"===process.env.NODE_ENV?jd(16):"selectState returned undefined for an uninjected slice reducer");return e(o,...s)}return i.unwrapped=e,i}var Ld=xd();function qd(){}function jd(e){return`Minified Redux Toolkit error #${e}; visit https://redux-toolkit.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var Fd=kl;function Ud(e,t){if(e===t||!(Fd(e)&&Fd(t)||Array.isArray(e)&&Array.isArray(t)))return t;const n=Object.keys(t),r=Object.keys(e);let i=n.length===r.length;const s=Array.isArray(t)?[]:{};for(const r of n)s[r]=Ud(e[r],t[r]),i&&(i=e[r]===s[r]);return i?e:s}function Vd(e){let t=0;for(const n in e)t++;return t}var zd=e=>[].concat(...e);function Wd(e){return null!=e}var $d=class{constructor(e,t=void 0){this.value=e,this.meta=t}},Bd=Qh("__rtkq/focused"),Hd=Qh("__rtkq/unfocused"),Kd=Qh("__rtkq/online"),Qd=Qh("__rtkq/offline"),Gd=!1;function Yd(e){return"query"===e.type}function Jd(e,t,n,r,i,s){return"function"==typeof e?e(t,n,r,i).map(Xd).map(s):Array.isArray(e)?e.map(Xd).map(s):[]}function Xd(e){return"string"==typeof e?{type:e}:e}var Zd=Symbol("forceQueryFn"),ep=e=>"function"==typeof e[Zd];function tp(e){return e}function np(e,t,n,r){return Jd(n[e.meta.arg.endpointName][t],Cd(e)?e.payload:void 0,Id(e)?e.payload:void 0,e.meta.arg.originalArgs,"baseQueryMeta"in e.meta?e.meta.baseQueryMeta:void 0,r)}function rp(e,t,n){const r=e[t];r&&n(r)}function ip(e){return("arg"in e?e.arg.fixedCacheKey:e.fixedCacheKey)??e.requestId}function sp(e,t,n){const r=e[ip(t)];r&&n(r)}var op={};function ap({reducerPath:e,queryThunk:t,mutationThunk:n,context:{endpointDefinitions:r,apiUid:i,extractRehydrationInfo:s,hasRehydrationInfo:o},assertTagType:a,config:c}){const u=Qh(`${e}/resetApiState`),l=Ld({name:`${e}/queries`,initialState:op,reducers:{removeQueryResult:{reducer(e,{payload:{queryCacheKey:t}}){delete e[t]},prepare:ld()},queryResultPatched:{reducer(e,{payload:{queryCacheKey:t,patches:n}}){rp(e,t,(e=>{e.data=Nh(e.data,n.concat())}))},prepare:ld()}},extraReducers(e){e.addCase(t.pending,((e,{meta:t,meta:{arg:n}})=>{const r=ep(n);e[n.queryCacheKey]??={status:"uninitialized",endpointName:n.endpointName},rp(e,n.queryCacheKey,(e=>{e.status="pending",e.requestId=r&&e.requestId?e.requestId:t.requestId,void 0!==n.originalArgs&&(e.originalArgs=n.originalArgs),e.startedTimeStamp=t.startedTimeStamp}))})).addCase(t.fulfilled,((e,{meta:t,payload:n})=>{rp(e,t.arg.queryCacheKey,(e=>{if(e.requestId!==t.requestId&&!ep(t.arg))return;const{merge:i}=r[t.arg.endpointName];if(e.status="fulfilled",i)if(void 0!==e.data){const{fulfilledTimeStamp:r,arg:s,baseQueryMeta:o,requestId:a}=t;let c=Sh(e.data,(e=>i(e,n,{arg:s.originalArgs,baseQueryMeta:o,fulfilledTimeStamp:r,requestId:a})));e.data=c}else e.data=n;else e.data=r[t.arg.endpointName].structuralSharing??1?Ud(Vl(e.data)?(Vl(s=e.data)||Fl(15,s),s[ql].base_):e.data,n):n;var s;delete e.error,e.fulfilledTimeStamp=t.fulfilledTimeStamp}))})).addCase(t.rejected,((e,{meta:{condition:t,arg:n,requestId:r},error:i,payload:s})=>{rp(e,n.queryCacheKey,(e=>{if(t);else{if(e.requestId!==r)return;e.status="rejected",e.error=s??i}}))})).addMatcher(o,((e,t)=>{const{queries:n}=s(t);for(const[t,r]of Object.entries(n))"fulfilled"!==r?.status&&"rejected"!==r?.status||(e[t]=r)}))}}),h=Ld({name:`${e}/mutations`,initialState:op,reducers:{removeMutationResult:{reducer(e,{payload:t}){const n=ip(t);n in e&&delete e[n]},prepare:ld()}},extraReducers(e){e.addCase(n.pending,((e,{meta:t,meta:{requestId:n,arg:r,startedTimeStamp:i}})=>{r.track&&(e[ip(t)]={requestId:n,status:"pending",endpointName:r.endpointName,startedTimeStamp:i})})).addCase(n.fulfilled,((e,{payload:t,meta:n})=>{n.arg.track&&sp(e,n,(e=>{e.requestId===n.requestId&&(e.status="fulfilled",e.data=t,e.fulfilledTimeStamp=n.fulfilledTimeStamp)}))})).addCase(n.rejected,((e,{payload:t,error:n,meta:r})=>{r.arg.track&&sp(e,r,(e=>{e.requestId===r.requestId&&(e.status="rejected",e.error=t??n)}))})).addMatcher(o,((e,t)=>{const{mutations:n}=s(t);for(const[t,r]of Object.entries(n))"fulfilled"!==r?.status&&"rejected"!==r?.status||t===r?.requestId||(e[t]=r)}))}}),d=Ld({name:`${e}/invalidation`,initialState:op,reducers:{updateProvidedBy:{reducer(e,t){const{queryCacheKey:n,providedTags:r}=t.payload;for(const t of Object.values(e))for(const e of Object.values(t)){const t=e.indexOf(n);-1!==t&&e.splice(t,1)}for(const{type:t,id:i}of r){const r=(e[t]??={})[i||"__internal_without_id"]??=[];r.includes(n)||r.push(n)}},prepare:ld()}},extraReducers(e){e.addCase(l.actions.removeQueryResult,((e,{payload:{queryCacheKey:t}})=>{for(const n of Object.values(e))for(const e of Object.values(n)){const n=e.indexOf(t);-1!==n&&e.splice(n,1)}})).addMatcher(o,((e,t)=>{const{provided:n}=s(t);for(const[t,r]of Object.entries(n))for(const[n,i]of Object.entries(r)){const r=(e[t]??={})[n||"__internal_without_id"]??=[];for(const e of i){r.includes(e)||r.push(e)}}})).addMatcher(gd(Cd(t),Id(t)),((e,t)=>{const n=np(t,"providesTags",r,a),{queryCacheKey:i}=t.meta.arg;d.caseReducers.updateProvidedBy(e,d.actions.updateProvidedBy({queryCacheKey:i,providedTags:n}))}))}}),p=Ld({name:`${e}/subscriptions`,initialState:op,reducers:{updateSubscriptionOptions(e,t){},unsubscribeQueryResult(e,t){},internal_getRTKQSubscriptions(){}}}),f=Ld({name:`${e}/internalSubscriptions`,initialState:op,reducers:{subscriptionsUpdated:{reducer:(e,t)=>Nh(e,t.payload),prepare:ld()}}}),m=Ld({name:`${e}/config`,initialState:{online:"undefined"==typeof navigator||void 0===navigator.onLine||navigator.onLine,focused:"undefined"==typeof document||"hidden"!==document.visibilityState,middlewareRegistered:!1,...c},reducers:{middlewareRegistered(e,{payload:t}){e.middlewareRegistered="conflict"!==e.middlewareRegistered&&i===t||"conflict"}},extraReducers:e=>{e.addCase(Kd,(e=>{e.online=!0})).addCase(Qd,(e=>{e.online=!1})).addCase(Bd,(e=>{e.focused=!0})).addCase(Hd,(e=>{e.focused=!1})).addMatcher(o,(e=>({...e})))}}),g=Al({queries:l.reducer,mutations:h.reducer,provided:d.reducer,subscriptions:f.reducer,config:m.reducer});return{reducer:(e,t)=>g(u.match(t)?void 0:e,t),actions:{...m.actions,...l.actions,...p.actions,...f.actions,...h.actions,...d.actions,resetApiState:u}}}var cp=Symbol.for("RTKQ/skipToken"),up={status:"uninitialized"},lp=Sh(up,(()=>{})),hp=Sh(up,(()=>{}));var dp=WeakMap?new WeakMap:void 0,pp=({endpointName:e,queryArgs:t})=>{let n="";const r=dp?.get(t);if("string"==typeof r)n=r;else{const e=JSON.stringify(t,((e,t)=>t=kl(t="bigint"==typeof t?{$bigint:t.toString()}:t)?Object.keys(t).sort().reduce(((e,n)=>(e[n]=t[n],e)),{}):t));kl(t)&&dp?.set(t,e),n=e}return`${e}(${n})`};function fp(...e){return function(t){const n=Fh((e=>t.extractRehydrationInfo?.(e,{reducerPath:t.reducerPath??"api"}))),r={reducerPath:"api",keepUnusedDataFor:60,refetchOnMountOrArgChange:!1,refetchOnFocus:!1,refetchOnReconnect:!1,invalidationBehavior:"delayed",...t,extractRehydrationInfo:n,serializeQueryArgs(e){let n=pp;if("serializeQueryArgs"in e.endpointDefinition){const t=e.endpointDefinition.serializeQueryArgs;n=e=>{const n=t(e);return"string"==typeof n?n:pp({...e,queryArgs:n})}}else t.serializeQueryArgs&&(n=t.serializeQueryArgs);return n(e)},tagTypes:[...t.tagTypes||[]]},i={endpointDefinitions:{},batch(e){e()},apiUid:Td(),extractRehydrationInfo:n,hasRehydrationInfo:Fh((e=>null!=n(e)))},s={injectEndpoints:function(e){const t=e.endpoints({query:e=>({...e,type:"query"}),mutation:e=>({...e,type:"mutation"})});for(const[n,r]of Object.entries(t))if(!0!==e.overrideExisting&&n in i.endpointDefinitions){if("throw"===e.overrideExisting)throw new Error("production"===process.env.NODE_ENV?jd(39):`called \`injectEndpoints\` to override already-existing endpointName ${n} without specifying \`overrideExisting: true\``);"undefined"!=typeof process&&"development"===process.env.NODE_ENV&&console.error(`called \`injectEndpoints\` to override already-existing endpointName ${n} without specifying \`overrideExisting: true\``)}else{i.endpointDefinitions[n]=r;for(const e of o)e.injectEndpoint(n,r)}return s},enhanceEndpoints({addTagTypes:e,endpoints:t}){if(e)for(const t of e)r.tagTypes.includes(t)||r.tagTypes.push(t);if(t)for(const[e,n]of Object.entries(t))"function"==typeof n?n(i.endpointDefinitions[e]):Object.assign(i.endpointDefinitions[e]||{},n);return s}},o=e.map((e=>e.init(s,r,i)));return s.injectEndpoints({endpoints:t.endpoints})}}function mp(e,...t){return Object.assign(e,...t)}var gp=({api:e,queryThunk:t,internalState:n})=>{const r=`${e.reducerPath}/subscriptions`;let i=null,s=null;const{updateSubscriptionOptions:o,unsubscribeQueryResult:a}=e.internalActions,c=()=>n.currentSubscriptions,u={getSubscriptions:c,getSubscriptionCount:e=>Vd(c()[e]??{}),isRequestSubscribed:(e,t)=>{const n=c();return!!n?.[e]?.[t]}};return(c,l)=>{if(i||(i=JSON.parse(JSON.stringify(n.currentSubscriptions))),e.util.resetApiState.match(c))return i=n.currentSubscriptions={},s=null,[!0,!1];if(e.internalActions.internal_getRTKQSubscriptions.match(c))return[!1,u];const h=((n,r)=>{if(o.match(r)){const{queryCacheKey:e,requestId:t,options:i}=r.payload;return n?.[e]?.[t]&&(n[e][t]=i),!0}if(a.match(r)){const{queryCacheKey:e,requestId:t}=r.payload;return n[e]&&delete n[e][t],!0}if(e.internalActions.removeQueryResult.match(r))return delete n[r.payload.queryCacheKey],!0;if(t.pending.match(r)){const{meta:{arg:e,requestId:t}}=r,i=n[e.queryCacheKey]??={};return i[`${t}_running`]={},e.subscribe&&(i[t]=e.subscriptionOptions??i[t]??{}),!0}let i=!1;if(t.fulfilled.match(r)||t.rejected.match(r)){const e=n[r.meta.arg.queryCacheKey]||{},t=`${r.meta.requestId}_running`;i||=!!e[t],delete e[t]}if(t.rejected.match(r)){const{meta:{condition:e,arg:t,requestId:s}}=r;if(e&&t.subscribe){const e=n[t.queryCacheKey]??={};e[s]=t.subscriptionOptions??e[s]??{},i=!0}}return i})(n.currentSubscriptions,c);let d=!0;if(h){s||(s=setTimeout((()=>{const t=JSON.parse(JSON.stringify(n.currentSubscriptions)),[,r]=kh(i,(()=>t));l.next(e.internalActions.subscriptionsUpdated(r)),i=t,s=null}),500));const o="string"==typeof c.type&&!!c.type.startsWith(r),a=t.rejected.match(c)&&c.meta.condition&&!!c.meta.arg.subscribe;d=!o&&!a}return[d,!1]}};var _p=({reducerPath:e,api:t,queryThunk:n,context:r,internalState:i})=>{const{removeQueryResult:s,unsubscribeQueryResult:o}=t.internalActions,a=gd(o.match,n.fulfilled,n.rejected);function c(e){const t=i.currentSubscriptions[e];return!!t&&!function(e){for(const t in e)return!1;return!0}(t)}const u={};function l(e,t,n,i){const o=r.endpointDefinitions[t],a=o?.keepUnusedDataFor??i.keepUnusedDataFor;if(a===1/0)return;const l=Math.max(0,Math.min(a,2147482.647));if(!c(e)){const t=u[e];t&&clearTimeout(t),u[e]=setTimeout((()=>{c(e)||n.dispatch(s({queryCacheKey:e})),delete u[e]}),1e3*l)}}return(n,i,s)=>{if(a(n)){const t=i.getState()[e],{queryCacheKey:r}=o.match(n)?n.payload:n.meta.arg;l(r,t.queries[r]?.endpointName,i,t.config)}if(t.util.resetApiState.match(n))for(const[e,t]of Object.entries(u))t&&clearTimeout(t),delete u[e];if(r.hasRehydrationInfo(n)){const t=i.getState()[e],{queries:s}=r.extractRehydrationInfo(n);for(const[e,n]of Object.entries(s))l(e,n?.endpointName,i,t.config)}}},yp=new Error("Promise never resolved before cacheEntryRemoved."),vp=({api:e,reducerPath:t,context:n,queryThunk:r,mutationThunk:i,internalState:s})=>{const o=Ed(r),a=Ed(i),c=Cd(r,i),u={};function l(t,r,i,s,o){const a=n.endpointDefinitions[t],c=a?.onCacheEntryAdded;if(!c)return;const l={},h=new Promise((e=>{l.cacheEntryRemoved=e})),d=Promise.race([new Promise((e=>{l.valueResolved=e})),h.then((()=>{throw yp}))]);d.catch((()=>{})),u[i]=l;const p=e.endpoints[t].select("query"===a.type?r:i),f=s.dispatch(((e,t,n)=>n)),m={...s,getCacheEntry:()=>p(s.getState()),requestId:o,extra:f,updateCachedData:"query"===a.type?n=>s.dispatch(e.util.updateQueryData(t,r,n)):void 0,cacheDataLoaded:d,cacheEntryRemoved:h},g=c(r,m);Promise.resolve(g).catch((e=>{if(e!==yp)throw e}))}return(n,s,h)=>{const d=function(t){if(o(t))return t.meta.arg.queryCacheKey;if(a(t))return t.meta.arg.fixedCacheKey??t.meta.requestId;return e.internalActions.removeQueryResult.match(t)?t.payload.queryCacheKey:e.internalActions.removeMutationResult.match(t)?ip(t.payload):""}(n);if(r.pending.match(n)){const e=h[t].queries[d],r=s.getState()[t].queries[d];!e&&r&&l(n.meta.arg.endpointName,n.meta.arg.originalArgs,d,s,n.meta.requestId)}else if(i.pending.match(n)){s.getState()[t].mutations[d]&&l(n.meta.arg.endpointName,n.meta.arg.originalArgs,d,s,n.meta.requestId)}else if(c(n)){const e=u[d];e?.valueResolved&&(e.valueResolved({data:n.payload,meta:n.meta.baseQueryMeta}),delete e.valueResolved)}else if(e.internalActions.removeQueryResult.match(n)||e.internalActions.removeMutationResult.match(n)){const e=u[d];e&&(delete u[d],e.cacheEntryRemoved())}else if(e.util.resetApiState.match(n))for(const[e,t]of Object.entries(u))delete u[e],t.cacheEntryRemoved()}},wp=({api:e,context:{apiUid:t},reducerPath:n})=>(r,i)=>{e.util.resetApiState.match(r)&&i.dispatch(e.internalActions.middlewareRegistered(t)),"undefined"!=typeof process&&"development"===process.env.NODE_ENV&&e.internalActions.middlewareRegistered.match(r)&&r.payload===t&&"conflict"===i.getState()[n]?.config?.middlewareRegistered&&console.warn(`There is a mismatch between slice and middleware for the reducerPath "${n}".\nYou can only have one api per reducer path, this will lead to crashes in various situations!${"api"===n?"\nIf you have multiple apis, you *have* to specify the reducerPath option when using createApi!":""}`)},bp=({reducerPath:e,context:t,context:{endpointDefinitions:n},mutationThunk:r,queryThunk:i,api:s,assertTagType:o,refetchQuery:a,internalState:c})=>{const{removeQueryResult:u}=s.internalActions,l=gd(Cd(r),Id(r)),h=gd(Cd(r,i),bd(r,i));let d=[];function p(n,r){const i=r.getState(),o=i[e];if(d.push(...n),"delayed"===o.config.invalidationBehavior&&function(e){for(const t in e.queries)if("pending"===e.queries[t]?.status)return!0;for(const t in e.mutations)if("pending"===e.mutations[t]?.status)return!0;return!1}(o))return;const l=d;if(d=[],0===l.length)return;const h=s.util.selectInvalidatedBy(i,l);t.batch((()=>{const e=Array.from(h.values());for(const{queryCacheKey:t}of e){const e=o.queries[t],n=c.currentSubscriptions[t]??{};e&&(0===Vd(n)?r.dispatch(u({queryCacheKey:t})):"uninitialized"!==e.status&&r.dispatch(a(e,t)))}}))}return(e,t)=>{l(e)?p(np(e,"invalidatesTags",n,o),t):h(e)?p([],t):s.util.invalidateTags.match(e)&&p(Jd(e.payload,void 0,void 0,void 0,void 0,o),t)}},Ip=({reducerPath:e,queryThunk:t,api:n,refetchQuery:r,internalState:i})=>{const s={};function o({queryCacheKey:t},n){const a=n.getState()[e],c=a.queries[t],l=i.currentSubscriptions[t];if(!c||"uninitialized"===c.status)return;const{lowestPollingInterval:h,skipPollingIfUnfocused:d}=u(l);if(!Number.isFinite(h))return;const p=s[t];p?.timeout&&(clearTimeout(p.timeout),p.timeout=void 0);const f=Date.now()+h;s[t]={nextPollTimestamp:f,pollingInterval:h,timeout:setTimeout((()=>{!a.config.focused&&d||n.dispatch(r(c,t)),o({queryCacheKey:t},n)}),h)}}function a({queryCacheKey:t},n){const r=n.getState()[e].queries[t],a=i.currentSubscriptions[t];if(!r||"uninitialized"===r.status)return;const{lowestPollingInterval:l}=u(a);if(!Number.isFinite(l))return void c(t);const h=s[t],d=Date.now()+l;(!h||d<h.nextPollTimestamp)&&o({queryCacheKey:t},n)}function c(e){const t=s[e];t?.timeout&&clearTimeout(t.timeout),delete s[e]}function u(e={}){let t=!1,n=Number.POSITIVE_INFINITY;for(let r in e)e[r].pollingInterval&&(n=Math.min(e[r].pollingInterval,n),t=e[r].skipPollingIfUnfocused||t);return{lowestPollingInterval:n,skipPollingIfUnfocused:t}}return(e,r)=>{(n.internalActions.updateSubscriptionOptions.match(e)||n.internalActions.unsubscribeQueryResult.match(e))&&a(e.payload,r),(t.pending.match(e)||t.rejected.match(e)&&e.meta.condition)&&a(e.meta.arg,r),(t.fulfilled.match(e)||t.rejected.match(e)&&!e.meta.condition)&&o(e.meta.arg,r),n.util.resetApiState.match(e)&&function(){for(const e of Object.keys(s))c(e)}()}},Cp=({api:e,context:t,queryThunk:n,mutationThunk:r})=>{const i=wd(n,r),s=bd(n,r),o=Cd(n,r),a={};return(n,r)=>{if(i(n)){const{requestId:i,arg:{endpointName:s,originalArgs:o}}=n.meta,c=t.endpointDefinitions[s],u=c?.onQueryStarted;if(u){const t={},n=new Promise(((e,n)=>{t.resolve=e,t.reject=n}));n.catch((()=>{})),a[i]=t;const l=e.endpoints[s].select("query"===c.type?o:i),h=r.dispatch(((e,t,n)=>n)),d={...r,getCacheEntry:()=>l(r.getState()),requestId:i,extra:h,updateCachedData:"query"===c.type?t=>r.dispatch(e.util.updateQueryData(s,o,t)):void 0,queryFulfilled:n};u(o,d)}}else if(o(n)){const{requestId:e,baseQueryMeta:t}=n.meta;a[e]?.resolve({data:n.payload,meta:t}),delete a[e]}else if(s(n)){const{requestId:e,rejectedWithValue:t,baseQueryMeta:r}=n.meta;a[e]?.reject({error:n.payload??n.error,isUnhandledError:!t,meta:r}),delete a[e]}}};function Ep(e){const{reducerPath:t,queryThunk:n,api:r,context:i}=e,{apiUid:s}=i,o={invalidateTags:Qh(`${t}/invalidateTags`)},a=e=>e.type.startsWith(`${t}/`),c=[wp,_p,bp,Ip,vp,Cp];return{middleware:n=>{let o=!1;const l={...e,internalState:{currentSubscriptions:{}},refetchQuery:u,isThisApiSliceAction:a},h=c.map((e=>e(l))),d=gp(l),p=(({reducerPath:e,context:t,api:n,refetchQuery:r,internalState:i})=>{const{removeQueryResult:s}=n.internalActions;function o(n,o){const a=n.getState()[e],c=a.queries,u=i.currentSubscriptions;t.batch((()=>{for(const e of Object.keys(u)){const t=c[e],i=u[e];i&&t&&((Object.values(i).some((e=>!0===e[o]))||Object.values(i).every((e=>void 0===e[o]))&&a.config[o])&&(0===Vd(i)?n.dispatch(s({queryCacheKey:e})):"uninitialized"!==t.status&&n.dispatch(r(t,e))))}}))}return(e,t)=>{Bd.match(e)&&o(t,"refetchOnFocus"),Kd.match(e)&&o(t,"refetchOnReconnect")}})(l);return e=>c=>{if(!xl(c))return e(c);o||(o=!0,n.dispatch(r.internalActions.middlewareRegistered(s)));const u={...n,next:e},l=n.getState(),[f,m]=d(c,u,l);let g;if(g=f?e(c):m,n.getState()[t]&&(p(c,u,l),a(c)||i.hasRehydrationInfo(c)))for(const e of h)e(c,u,l);return g}},actions:o};function u(e,t,r={}){return n({type:"query",endpointName:e.endpointName,originalArgs:e.originalArgs,subscribe:!1,forceRefetch:!0,queryCacheKey:t,...r})}}var Tp=Symbol(),Sp=fp((({createSelector:e=Vh}={})=>({name:Tp,init(t,{baseQuery:n,tagTypes:r,reducerPath:i,serializeQueryArgs:s,keepUnusedDataFor:o,refetchOnMountOrArgChange:a,refetchOnFocus:c,refetchOnReconnect:u,invalidationBehavior:l},h){Eh();const d=e=>("undefined"!=typeof process&&"development"===process.env.NODE_ENV&&(r.includes(e.type)||console.error(`Tag type '${e.type}' was used, but not specified in \`tagTypes\`!`)),e);Object.assign(t,{reducerPath:i,endpoints:{},internalActions:{onOnline:Kd,onOffline:Qd,onFocus:Bd,onFocusLost:Hd},util:{}});const{queryThunk:p,mutationThunk:f,patchQueryData:m,updateQueryData:g,upsertQueryData:_,prefetch:y,buildMatchThunkActions:v}=function({reducerPath:e,baseQuery:t,context:{endpointDefinitions:n},serializeQueryArgs:r,api:i,assertTagType:s}){const o=async(e,{signal:r,abort:i,rejectWithValue:s,fulfillWithValue:o,dispatch:c,getState:u,extra:l})=>{const h=n[e.endpointName];try{let n,s=tp;const d={signal:r,abort:i,dispatch:c,getState:u,extra:l,endpoint:e.endpointName,type:e.type,forced:"query"===e.type?a(e,u()):void 0},p="query"===e.type?e[Zd]:void 0;if(p?n=p():h.query?(n=await t(h.query(e.originalArgs),d,h.extraOptions),h.transformResponse&&(s=h.transformResponse)):n=await h.queryFn(e.originalArgs,d,h.extraOptions,(e=>t(e,d,h.extraOptions))),"undefined"!=typeof process&&"development"===process.env.NODE_ENV){const t=h.query?"`baseQuery`":"`queryFn`";let r;if(n){if("object"!=typeof n)r=`${t} did not return an object.`;else if(n.error&&n.data)r=`${t} returned an object containing both \`error\` and \`result\`.`;else if(void 0===n.error&&void 0===n.data)r=`${t} returned an object containing neither a valid \`error\` and \`result\`. At least one of them should not be \`undefined\``;else for(const e of Object.keys(n))if("error"!==e&&"data"!==e&&"meta"!==e){r=`The object returned by ${t} has the unknown property ${e}.`;break}}else r=`${t} did not return anything.`;r&&console.error(`Error encountered handling the endpoint ${e.endpointName}.\n              ${r}\n              It needs to return an object with either the shape \`{ data: <value> }\` or \`{ error: <value> }\` that may contain an optional \`meta\` property.\n              Object returned was:`,n)}if(n.error)throw new $d(n.error,n.meta);return o(await s(n.data,n.meta,e.originalArgs),{fulfilledTimeStamp:Date.now(),baseQueryMeta:n.meta,[ud]:!0})}catch(t){let n=t;if(n instanceof $d){let t=tp;h.query&&h.transformErrorResponse&&(t=h.transformErrorResponse);try{return s(await t(n.value,n.meta,e.originalArgs),{baseQueryMeta:n.meta,[ud]:!0})}catch(e){n=e}}throw"undefined"!=typeof process&&"production"!==process.env.NODE_ENV?console.error(`An unhandled error occurred processing a request for the endpoint "${e.endpointName}".\nIn the case of an unhandled error, no tags will be "provided" or "invalidated".`,n):console.error(n),n}};function a(t,n){const r=n[e]?.queries?.[t.queryCacheKey],i=n[e]?.config.refetchOnMountOrArgChange,s=r?.fulfilledTimeStamp,o=t.forceRefetch??(t.subscribe&&i);return!!o&&(!0===o||(Number(new Date)-Number(s))/1e3>=o)}const c=Rd(`${e}/executeQuery`,o,{getPendingMeta:()=>({startedTimeStamp:Date.now(),[ud]:!0}),condition(t,{getState:r}){const i=r(),s=i[e]?.queries?.[t.queryCacheKey],o=s?.fulfilledTimeStamp,c=t.originalArgs,u=s?.originalArgs,l=n[t.endpointName];return!(!ep(t)&&("pending"===s?.status||!a(t,i)&&(!Yd(l)||!l?.forceRefetch?.({currentArg:c,previousArg:u,endpointState:s,state:i}))&&o))},dispatchConditionRejection:!0}),u=Rd(`${e}/executeMutation`,o,{getPendingMeta:()=>({startedTimeStamp:Date.now(),[ud]:!0})});function l(e){return t=>t?.meta?.arg?.endpointName===e}return{queryThunk:c,mutationThunk:u,prefetch:(e,t,n)=>(r,s)=>{const o=(e=>"force"in e)(n)&&n.force,a=(e=>"ifOlderThan"in e)(n)&&n.ifOlderThan,c=(n=!0)=>{const r={forceRefetch:n,isPrefetch:!0};return i.endpoints[e].initiate(t,r)},u=i.endpoints[e].select(t)(s());if(o)r(c());else if(a){const e=u?.fulfilledTimeStamp;if(!e)return void r(c());(Number(new Date)-Number(new Date(e)))/1e3>=a&&r(c())}else r(c(!1))},updateQueryData:(e,t,n,r=!0)=>(s,o)=>{const a=i.endpoints[e].select(t)(o()),c={patches:[],inversePatches:[],undo:()=>s(i.util.patchQueryData(e,t,c.inversePatches,r))};if("uninitialized"===a.status)return c;let u;if("data"in a)if(zl(a.data)){const[e,t,r]=kh(a.data,n);c.patches.push(...t),c.inversePatches.push(...r),u=e}else u=n(a.data),c.patches.push({op:"replace",path:[],value:u}),c.inversePatches.push({op:"replace",path:[],value:a.data});return 0===c.patches.length||s(i.util.patchQueryData(e,t,c.patches,r)),c},upsertQueryData:(e,t,n)=>r=>r(i.endpoints[e].initiate(t,{subscribe:!1,forceRefetch:!0,[Zd]:()=>({data:n})})),patchQueryData:(e,t,o,a)=>(c,u)=>{const l=n[e],h=r({queryArgs:t,endpointDefinition:l,endpointName:e});if(c(i.internalActions.queryResultPatched({queryCacheKey:h,patches:o})),!a)return;const d=i.endpoints[e].select(t)(u()),p=Jd(l.providesTags,d.data,void 0,t,{},s);c(i.internalActions.updateProvidedBy({queryCacheKey:h,providedTags:p}))},buildMatchThunkActions:function(e,t){return{matchPending:_d(wd(e),l(t)),matchFulfilled:_d(Cd(e),l(t)),matchRejected:_d(bd(e),l(t))}}}}({baseQuery:n,reducerPath:i,context:h,api:t,serializeQueryArgs:s,assertTagType:d}),{reducer:w,actions:b}=ap({context:h,queryThunk:p,mutationThunk:f,reducerPath:i,assertTagType:d,config:{refetchOnFocus:c,refetchOnReconnect:u,refetchOnMountOrArgChange:a,keepUnusedDataFor:o,reducerPath:i,invalidationBehavior:l}});mp(t.util,{patchQueryData:m,updateQueryData:g,upsertQueryData:_,prefetch:y,resetApiState:b.resetApiState}),mp(t.internalActions,b);const{middleware:I,actions:C}=Ep({reducerPath:i,context:h,queryThunk:p,mutationThunk:f,api:t,assertTagType:d});mp(t.util,C),mp(t,{reducer:w,middleware:I});const{buildQuerySelector:E,buildMutationSelector:T,selectInvalidatedBy:S,selectCachedArgsForQuery:k}=function({serializeQueryArgs:e,reducerPath:t,createSelector:n}){const r=e=>lp,i=e=>hp;return{buildQuerySelector:function(t,i){return a=>{const c=e({queryArgs:a,endpointDefinition:i,endpointName:t});return n(a===cp?r:e=>o(e)?.queries?.[c]??lp,s)}},buildMutationSelector:function(){return e=>{let t;return t="object"==typeof e?ip(e)??cp:e,n(t===cp?i:e=>o(e)?.mutations?.[t]??hp,s)}},selectInvalidatedBy:function(e,n){const r=e[t],i=new Set;for(const e of n.map(Xd)){const t=r.provided[e.type];if(!t)continue;let n=(void 0!==e.id?t[e.id]:zd(Object.values(t)))??[];for(const e of n)i.add(e)}return zd(Array.from(i.values()).map((e=>{const t=r.queries[e];return t?[{queryCacheKey:e,endpointName:t.endpointName,originalArgs:t.originalArgs}]:[]})))},selectCachedArgsForQuery:function(e,n){return Object.values(e[t].queries).filter((e=>e?.endpointName===n&&"uninitialized"!==e.status)).map((e=>e.originalArgs))}};function s(e){return{...e,...(t=e.status,{status:t,isUninitialized:"uninitialized"===t,isLoading:"pending"===t,isSuccess:"fulfilled"===t,isError:"rejected"===t})};var t}function o(e){const n=e[t];if("production"!==process.env.NODE_ENV&&!n){if(o.triggered)return n;o.triggered=!0,console.error(`Error: No data found at \`state.${t}\`. Did you forget to add the reducer to the store?`)}return n}}({serializeQueryArgs:s,reducerPath:i,createSelector:e});mp(t.util,{selectInvalidatedBy:S,selectCachedArgsForQuery:k});const{buildInitiateQuery:N,buildInitiateMutation:P,getRunningMutationThunk:R,getRunningMutationsThunk:O,getRunningQueriesThunk:A,getRunningQueryThunk:D}=function({serializeQueryArgs:e,queryThunk:t,mutationThunk:n,api:r,context:i}){const s=new Map,o=new Map,{unsubscribeQueryResult:a,removeMutationResult:c,updateSubscriptionOptions:u}=r.internalActions;return{buildInitiateQuery:function(n,i){const o=(c,{subscribe:h=!0,forceRefetch:d,subscriptionOptions:p,[Zd]:f,...m}={})=>(g,_)=>{const y=e({queryArgs:c,endpointDefinition:i,endpointName:n}),v=t({...m,type:"query",subscribe:h,forceRefetch:d,subscriptionOptions:p,endpointName:n,originalArgs:c,queryCacheKey:y,[Zd]:f}),w=r.endpoints[n].select(c),b=g(v),I=w(_());l(g);const{requestId:C,abort:E}=b,T=I.requestId!==C,S=s.get(g)?.[y],k=()=>w(_()),N=Object.assign(f?b.then(k):T&&!S?Promise.resolve(I):Promise.all([S,b]).then(k),{arg:c,requestId:C,subscriptionOptions:p,queryCacheKey:y,abort:E,async unwrap(){const e=await N;if(e.isError)throw e.error;return e.data},refetch:()=>g(o(c,{subscribe:!1,forceRefetch:!0})),unsubscribe(){h&&g(a({queryCacheKey:y,requestId:C}))},updateSubscriptionOptions(e){N.subscriptionOptions=e,g(u({endpointName:n,requestId:C,queryCacheKey:y,options:e}))}});if(!S&&!T&&!f){const e=s.get(g)||{};e[y]=N,s.set(g,e),N.then((()=>{delete e[y],Vd(e)||s.delete(g)}))}return N};return o},buildInitiateMutation:function(e){return(t,{track:r=!0,fixedCacheKey:i}={})=>(s,a)=>{const u=n({type:"mutation",endpointName:e,originalArgs:t,track:r,fixedCacheKey:i}),h=s(u);l(s);const{requestId:d,abort:p,unwrap:f}=h,m=(g=e=>({error:e}),h.unwrap().then((e=>({data:e}))).catch(g));var g;const _=Object.assign(m,{arg:h.arg,requestId:d,abort:p,unwrap:f,reset:()=>{s(c({requestId:d,fixedCacheKey:i}))}}),y=o.get(s)||{};return o.set(s,y),y[d]=_,_.then((()=>{delete y[d],Vd(y)||o.delete(s)})),i&&(y[i]=_,_.then((()=>{y[i]===_&&(delete y[i],Vd(y)||o.delete(s))}))),_}},getRunningQueryThunk:function(t,n){return r=>{const o=i.endpointDefinitions[t],a=e({queryArgs:n,endpointDefinition:o,endpointName:t});return s.get(r)?.[a]}},getRunningMutationThunk:function(e,t){return e=>o.get(e)?.[t]},getRunningQueriesThunk:function(){return e=>Object.values(s.get(e)||{}).filter(Wd)},getRunningMutationsThunk:function(){return e=>Object.values(o.get(e)||{}).filter(Wd)}};function l(e){if("production"!==process.env.NODE_ENV){if(l.triggered)return;const t=e(r.internalActions.internal_getRTKQSubscriptions());if(l.triggered=!0,"object"!=typeof t||"string"==typeof t?.type)throw new Error("production"===process.env.NODE_ENV?jd(34):`Warning: Middleware for RTK-Query API at reducerPath "${r.reducerPath}" has not been added to the store.\nYou must add the middleware for RTK-Query to function correctly!`)}}}({queryThunk:p,mutationThunk:f,api:t,serializeQueryArgs:s,context:h});return mp(t.util,{getRunningMutationThunk:R,getRunningMutationsThunk:O,getRunningQueryThunk:D,getRunningQueriesThunk:A}),{name:Tp,injectEndpoint(e,n){const r=t;r.endpoints[e]??={},Yd(n)?mp(r.endpoints[e],{name:e,select:E(e,n),initiate:N(e,n)},v(p,e)):"mutation"===n.type&&mp(r.endpoints[e],{name:e,select:T(),initiate:P(e)},v(f,e))}}}}))());const kp=document.getElementById("selecteddate"),Np=bl({accessKey:Il.accessKey});tt(Il);const Pp=function(e=nt()){const t=Ye(e,"auth");if(t.isInitialized())return t.getImmediate();const n=function(e,t){const n=Ye(e,"auth");if(n.isInitialized()){const e=n.getImmediate();if(A(n.getOptions(),null!=t?t:{}))return e;$o(e,"already-initialized")}return n.initialize({options:t})}(e,{popupRedirectResolver:gu,persistence:[Oc,fc,gc]}),r=g("authTokenSyncURL");if(r&&"boolean"==typeof isSecureContext&&isSecureContext){const e=new URL(r,location.origin);if(location.origin===e.origin){const t=(i=e.toString(),async e=>{const t=e&&await e.getIdTokenResult(),n=t&&((new Date).getTime()-Date.parse(t.issuedAtTime))/1e3;if(n&&n>wu)return;const r=null==t?void 0:t.token;bu!==r&&(bu=r,await fetch(i,{method:r?"POST":"DELETE",headers:r?{Authorization:`Bearer ${r}`}:{}}))});!function(e,t,n){U(e).beforeAuthStateChanged(t,n)}(n,t,(()=>t(n.currentUser))),function(e,t,n,r){U(e).onIdTokenChanged(t,n,r)}(n,(e=>t(e)))}}var i;const s=f("auth");return s&&Ga(n,`http://${s}`),n}(),Rp=function(e=nt(),t){const n=Ye(e,"database").getImmediate({identifier:t});if(!n._instanceStarted){const e=(e=>{const t=f(e);if(!t)return;const n=t.lastIndexOf(":");if(n<=0||n+1===t.length)throw new Error(`Invalid host ${t} with no separate hostname and port!`);const r=parseInt(t.substring(n+1),10);return"["===t[0]?[t.substring(1,n-1),r]:[t.substring(0,n),r]})("database");e&&function(e,t,n,r={}){e=U(e),e._checkNotDeleted("useEmulator"),e._instanceStarted&&Dt("Cannot call useEmulator() after instance has already been initialized.");const i=e._repoInternal;let s;if(i.repoInfo_.nodeAdmin)r.mockUserToken&&Dt('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),s=new Jt(Jt.OWNER);else if(r.mockUserToken){const t="string"==typeof r.mockUserToken?r.mockUserToken:function(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n=t||"demo-project",r=e.iat||0,i=e.sub||e.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const s=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:r,exp:r+3600,auth_time:r,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},e);return[c(JSON.stringify({alg:"none",type:"JWT"})),c(JSON.stringify(s)),""].join(".")}(r.mockUserToken,e.app.options.projectId);s=new Jt(t)}!function(e,t,n,r){e.repoInfo_=new nn(`${t}:${n}`,!1,e.repoInfo_.namespace,e.repoInfo_.webSocketOnly,e.repoInfo_.nodeAdmin,e.repoInfo_.persistenceKey,e.repoInfo_.includeNamespaceInQueryParams,!0),r&&(e.authTokenProvider_=r)}(i,t,n,s)}(n,...e)}return n}();async function Op({url:e="crafts/temp_gmail_com/posts/-Ml6DEjYhdnjuW6HiHB7",type:t="array"}){try{let n=await Ro(ko(Rp,e));if(n.exists()){let e=n.val();return"array"===t?Object.keys(e).map((t=>e[t])):e}return"array"===t?[]:null}catch(e){return console.log(e),"array"===t?[]:{}}}async function Ap(e={temp:"temp"}){try{return await Po(ko(Rp),e),e}catch(e){return console.error(e),e}}const Dp=Sp({reducerPath:"api",tagTypes:["QuizesCases","UnsplashImageFromCollection"],baseQuery:function(){throw new Error("production"===process.env.NODE_ENV?jd(33):"When using `fakeBaseQuery`, all queries & mutations must use the `queryFn` definition syntax.")},endpoints:e=>({fetchUsersByDate:e.query({async queryFn(e){try{let t=await Op({url:"/currentDay/"+e+"/posts",type:"array"});const n=await Op({url:"/currentDay/"+e+"/cases",type:"array"});return{data:[...t,...n]}}catch(e){return console.log(e),{data:[],error:e}}},providesTags:(e,t,n)=>[{type:"QuizesCases",id:n}]}),addOpenAvatar:e.mutation({async queryFn(e){try{await Ap({updates:{["openavatars/"+e.id]:e}})}catch(e){return console.log(e),{error:e}}return{data:e}},invalidatesTags:["OpenAvatar"]}),fetchUnsplashImagesFromCollection:e.query({async queryFn({collectionId:e="aH98dheb50M",perPage:t=30}){try{const n=await async function({collectionId:e="aH98dheb50M",perPage:t=30}){let n=await Np.collections.getPhotos({collectionId:e,page:1,perPage:t}),r=Math.ceil(n.response.total/30),i=[];return await Promise.all(new Array(r).fill(0).map(((t,n)=>Np.collections.getPhotos({collectionId:e,page:n+1,perPage:30})))).then((e=>{e.forEach((e=>{e.response.results.forEach((e=>{i.push(e)}))}))})),i.filter((e=>!e.description?.includes("krain")&&!e.alt_description?.includes("krain"))).sort((({likes:e},{likes:t})=>t-e))}({collectionId:e,perPage:t});return{data:n.map((e=>({...e,orientation:"landscape"})))}}catch(e){return console.log(e),{error:e}}},providesTags:["UnsplashImageFromCollection"]}),fetchUsersByDate:e.query({async queryFn(e){try{let t=await Op({url:"/currentDay/"+e+"/posts",type:"array"});const n=await Op({url:"/currentDay/"+e+"/cases",type:"array"});return{data:[...t,...n]}}catch(e){return console.log(e),{data:[],error:e}}},providesTags:(e,t,n)=>[{type:"QuizesCases",id:n}]}),updateUserNotes:e.mutation({async queryFn({base:e="openavatars",updates:t={temp_google_com:{id:"temp_google_com",avatarUrl:"https://images.unsplash.com/photo-1438761681033-6461ffad8d80?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&ixid=M3wxODU2NzR8MHwxfGNvbGxlY3Rpb258MjB8YUg5OGRoZWI1ME18fHx8fDJ8fDE3MDAxMzYxMjN8&ixlib=rb-4.0.3&q=80&w=200",user:"Ha Ha"}}}){let n={};Object.keys(t).forEach((r=>{n[e+"/"+r]=t[r]}));try{await Ap(n)}catch(e){return console.log(e),{error:e}}return{updates:n}},invalidatesTags:["Note"]})})}),xp=function(e){const t=cd(),{reducer:n,middleware:r,devTools:i=!0,preloadedState:s,enhancers:o}=e||{};let a,c;if("function"==typeof n)a=n;else{if(!kl(n))throw new Error("production"===process.env.NODE_ENV?jd(1):"`reducer` is a required argument, and must be a function or an object of functions that can be passed to combineReducers");a=Al(n)}if("production"!==process.env.NODE_ENV&&r&&"function"!=typeof r)throw new Error("production"===process.env.NODE_ENV?jd(2):"`middleware` field must be a callback");if("function"==typeof r){if(c=r(t),"production"!==process.env.NODE_ENV&&!Array.isArray(c))throw new Error("production"===process.env.NODE_ENV?jd(3):"when using a middleware builder function, an array of middleware must be returned")}else c=t();if("production"!==process.env.NODE_ENV&&c.some((e=>"function"!=typeof e)))throw new Error("production"===process.env.NODE_ENV?jd(4):"each middleware provided to configureStore must be a function");let u=Dl;i&&(u=Hh({trace:"production"!==process.env.NODE_ENV,..."object"==typeof i&&i}));const l=function(...e){return t=>(n,r)=>{const i=t(n,r);let s=()=>{throw new Error("production"===process.env.NODE_ENV?Cl(15):"Dispatching while constructing your middleware is not allowed. Other middleware would not be applied to this dispatch.")};const o={getState:i.getState,dispatch:(e,...t)=>s(e,...t)},a=e.map((e=>e(o)));return s=Dl(...a)(i.dispatch),{...i,dispatch:s}}}(...c),h=pd(l);if("production"!==process.env.NODE_ENV&&o&&"function"!=typeof o)throw new Error("production"===process.env.NODE_ENV?jd(5):"`enhancers` field must be a callback");let d="function"==typeof o?o(h):h();if("production"!==process.env.NODE_ENV&&!Array.isArray(d))throw new Error("production"===process.env.NODE_ENV?jd(6):"`enhancers` callback must return an array");if("production"!==process.env.NODE_ENV&&d.some((e=>"function"!=typeof e)))throw new Error("production"===process.env.NODE_ENV?jd(7):"each enhancer provided to configureStore must be a function");return"production"!==process.env.NODE_ENV&&c.length&&!d.includes(l)&&console.error("middlewares were provided, but middleware enhancer was not included in final enhancers - make sure to call `getDefaultEnhancers`"),Rl(a,s,u(...d))}({reducer:{[Dp.reducerPath]:Dp.reducer},middleware:e=>e().concat(Dp.middleware)});var Mp;let Lp,qp;async function jp(e){let t=document.getElementById("selectStudent").value,n=e.target.id,r=document.getElementById("opengroup").value,i=document.getElementById("name").value,s={["openavatars/"+t]:{user:i,id:t,group:r,avatarUrl:n},["opengroups/"+r+"/"+t]:{id:t,email:t,user:i,avatarUrl:n}};console.log(s),xp.dispatch(Dp.endpoints.updateUserNotes.initiate({base:"/",updates:s})).then((()=>console.log("Saved"))),console.log(document.getElementById("selectStudent").value),console.log(document.getElementById("name").value),console.log(document.getElementById("opengroup").value),console.log(e.target.id);let o=await(a=2e3,new Promise((e=>setTimeout(e(),a))));var a;console.log("Avatar Saved "+o)}Mp=xp.dispatch,function(){const e=()=>Mp(Bd()),t=()=>Mp(Kd()),n=()=>Mp(Qd()),r=()=>{"visible"===window.document.visibilityState?e():Mp(Hd())};Gd||"undefined"!=typeof window&&window.addEventListener&&(window.addEventListener("visibilitychange",r,!1),window.addEventListener("focus",e,!1),window.addEventListener("online",t,!1),window.addEventListener("offline",n,!1),Gd=!0)}(),kp.addEventListener("change",(async function(e){e.preventDefault();var t=new Date(e.target.value);let n=new Intl.DateTimeFormat("en",{weekday:"short",year:"numeric",month:"short",day:"numeric"}).format(new Date(t.getFullYear(),t.getMonth(),t.getDate())).replace(/[^a-zA-Z0-9]/g,"_");console.log(n),qp=await xp.dispatch(Dp.endpoints.fetchUsersByDate.initiate(n));let r=[...new Set(qp.data.map((e=>e?.email)))].map((e=>e.replace(/[^a-zA-Z0-9]/g,"_")));console.log(r);for(var i=document.getElementById("selectStudent"),s=0;s<r.length;s++){var o=r[s],a=document.createElement("option");a.textContent=o,a.value=r[s],i.appendChild(a)}}),!1),Pp.onAuthStateChanged((e=>{e?console.log("Good Auth"):console.log("Not auth")})),async function(){Lp=await xp.dispatch(Dp.endpoints.fetchUnsplashImagesFromCollection.initiate({collectionId:"aH98dheb50M",perPage:30})),document.getElementById("freeavatars").innerHTML=Lp.data.map((e=>`\n          <div class="col-12 col-sm-4 col-md-3 col-lg-2">\n        <div class="card m-1">\n        <div class="card-body">\n           <div class="class-text">\n            <img src=${e.urls.thumb}\n                data-bs-toggle="tooltip" data-bs-html="true" \n                alt=${e.urls.thumb}\n                id=${e.urls.thumb}\n                class="avatar"\n            >\n            </div>\n        </div>\n    </div>\n    </div>`)).join("");for(var e=document.getElementsByClassName("avatar"),t=0;t<e.length;t++)e[t].addEventListener("click",(e=>{jp(e).then((()=>console.log("Saved")))}),!1);return!0}().then((()=>{})),xp.subscribe((()=>{}))}();
