<!DOCTYPE html>
<html lang="ru">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Информатика и базы данных</title>
    <!-- Bootstrap 4 CSS -->
    <link rel="stylesheet" href="../dist/original.css">
    <style>
        .code-block {
            background-color: #f8f9fa;
            padding: 1rem;
            border-radius: 0.25rem;
            border-left: 4px solid #007bff;
            font-family: 'Courier New', monospace;
            margin: 1rem 0;
            overflow-x: auto;
            font-size: 0.9em;
        }


        .exercise {
            background-color: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 1rem;
            margin: 1rem 0;
            border-radius: 0.25rem;
        }

        .sql-keyword {
            color: #d73a49;
            font-weight: bold;
        }

        .sql-comment {
            color: #6a737d;
            font-style: italic;
        }
    </style>
    <script src="https://cdn.jsdelivr.net/npm/hot-formula-parser@4.0.0/dist/formula-parser.min.js"></script>
    <script src="./quizesSets.js"></script>
</head>

<body data-api="AIzaSyDUamZR2aXuP2rFG1AFpb1Ni8aZA5uhSj4" data-base="fincalculations"
    data-app="1:892270777573:web:bdc13e9b47334b4319700c">
    <!-- Навигационная панель -->
    <nav class="navbar navbar-expand-lg navbar-light bg-light">
        <a target="_blank" class="navbar-brand" href="/">Econolabs</a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="navbarSupportedContent">
            <ul class="navbar-nav mr-auto">
                <li class="nav-item">
                    <a class="nav-link" href="#"><span class="sr-only"></span></a>
                </li>

            </ul>
            <form class="form-inline my-2 my-lg-0">
                <a href="https://vk.com/dmglvn">
                    <img loading="lazy" src="https://sun9-37.userapi.com/c317630/v317630439/76a0/Bz6QTfBog0I.jpg?ava=1"
                        alt="" style="
                width: 40px;
                height: 40px;
                border-radius: 50%;
                filter: grayscale(100%);
                object-fit: cover;
              " />
                </a>
            </form>
        </div>
    </nav>

    <div class="container mt-5"></div>
    <div class="row justify-content-center">
        <div class="col-12">


            <div class="card mx-auto" style="max-width: 800px; margin: 10px">
                <img src="../h1title.jpg" class="card-img-top" alt="База данных">
                <div class="card-body">
                    <h3>Введение</h3>
                    <div class="row">
                        <div class="col-12">
                            <h1 class="text-center mb-4">Пособие по информатике и базам данных</h1>
                            <p class="lead text-center">Содержание</p>

                            <!-- Блок с целями обучения -->
                            <div class="alert alert-primary">
                                <ul>
                                    <li>Роль и место информационных технологий в современном обществе</li>
                                    <li>Операционная система – основа работы современных технических средств обработки
                                        информации</li>
                                    <li>Информационные технологии работы с графической информацией</li>
                                    <li>Информационные технологии работы с текстовыми документами</li>
                                    <li>Информационные технологии расчетов с использованием электронных таблиц</li>
                                    <li>Поиск в базах данных. ИПС «Консультант-Плюс»</li>
                                    <li>Локальные и глобальные сети. Представление об Интернете, принцип работы,
                                        протокол IP. Виды проводного и беспроводного подключения к Интернету</li>
                                    <li>Безопасность информационных технологий </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>


            <!-- Карточка 1: Основы криптографии -->
            <div class="card mx-auto" style="max-width: 800px; margin: 10px">
                <img src="../h1title17.jpg" class="card-img-top" alt="Криптография">
                <div class="card-body">
                    <h3>Основы криптографии</h3>
                    <p class="card-text">Криптография - наука о методах обеспечения конфиденциальности, целостности и
                        аутентичности информации.</p>

                    <div class="code-block">
                        <span class="sql-keyword"># Основные понятия:</span><br>
                        - Симметричное шифрование: один ключ<br>
                        - Асимметричное шифрование: пара ключей<br>
                        - Хеш-функции: необратимое преобразование<br>
                        - Цифровая подпись: аутентификация + целостность
                    </div>

                    <div class="row">
                        <div class="col-md-6">
                            <p><strong>Типы шифрования:</strong></p>
                            <ul>
                                <li><strong>Симметричное:</strong> AES, DES, Blowfish</li>
                                <li><strong>Асимметричное:</strong> RSA, ECC, ElGamal</li>
                                <li><strong>Хеш-функции:</strong> SHA-256, MD5, bcrypt</li>
                                <li><strong>Гибридные системы:</strong> SSL/TLS</li>
                            </ul>
                        </div>
                        <div class="col-md-6">
                            <p><strong>Ключевые свойства:</strong></p>
                            <ul>
                                <li><strong>Конфиденциальность:</strong> защита от прочтения</li>
                                <li><strong>Целостность:</strong> защита от изменений</li>
                                <li><strong>Аутентичность:</strong> подтверждение авторства</li>
                                <li><strong>Неотказуемость:</strong> невозможность отказа от действий</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Карточка 2: Симметричное vs Асимметричное шифрование -->
            <div class="card mx-auto" style="max-width: 800px; margin: 10px">
                <img src="../h1title16.jpg" class="card-img-top" alt="Типы шифрования">
                <div class="card-body">
                    <h3>Симметричное vs Асимметричное шифрование</h3>
                    <p class="card-text">Сравнение двух основных подходов к шифрованию данных.</p>

                    <div class="code-block">
                        <span class="sql-keyword">Симметричное:</span> Шифр.текст = encrypt(Открытый_текст, Ключ)<br>
                        <span class="sql-keyword">Асимметричное:</span> Шифр.текст = encrypt(Открытый_текст,
                        Публичный_ключ)
                    </div>

                    <div class="row">
                        <div class="col-md-6">
                            <p><strong>Симметричное шифрование:</strong></p>
                            <ul>
                                <li>✅ Высокая скорость</li>
                                <li>✅ Простота реализации</li>
                                <li>❌ Проблема обмена ключами</li>
                                <li>❌ N×(N-1)/2 ключей для N пользователей</li>
                                <li><strong>Примеры:</strong> AES, DES, 3DES</li>
                            </ul>
                        </div>
                        <div class="col-md-6">
                            <p><strong>Асимметричное шифрование:</strong></p>
                            <ul>
                                <li>✅ Решение проблемы обмена ключами</li>
                                <li>✅ Поддержка цифровых подписей</li>
                                <li>❌ Низкая скорость</li>
                                <li>❌ Требует длинные ключи</li>
                                <li><strong>Примеры:</strong> RSA, ECC, ElGamal</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Карточка 3: Открытые и закрытые ключи -->
            <div class="card mx-auto" style="max-width: 800px; margin: 10px">
                <img src="../h1title15.jpg" class="card-img-top" alt="Ключи шифрования">
                <div class="card-body">
                    <h3>Открытые и закрытые ключи</h3>
                    <p class="card-text">Основы асимметричной криптографии - работа с парами ключей.</p>

                    <div class="code-block">
                        <span class="sql-comment"># Генерация пары ключей:</span><br>
                        Закрытый_ключ = случайное_большое_число()<br>
                        Открытый_ключ = функция(Закрытый_ключ)<br>
                        <span class="sql-comment"># Математически связаны, но нельзя вычислить один из другого</span>
                    </div>

                    <div class="row">
                        <div class="col-md-6">
                            <p><strong>Открытый ключ (Public Key):</strong></p>
                            <ul>
                                <li>Может свободно распространяться</li>
                                <li>Используется для ШИФРОВАНИЯ</li>
                                <li>Используется для ПРОВЕРКИ подписи</li>
                                <li>Хранится в сертификатах</li>
                                <li><em>"Ключ для отправки сообщений"</em></li>
                            </ul>
                        </div>
                        <div class="col-md-6">
                            <p><strong>Закрытый ключ (Private Key):</strong></p>
                            <ul>
                                <li>Должен храниться в секрете</li>
                                <li>Используется для ДЕШИФРОВАНИЯ</li>
                                <li>Используется для СОЗДАНИЯ подписи</li>
                                <li>Защищается паролем</li>
                                <li><em>"Ключ для чтения сообщений"</em></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Карточка 4: Цифровые подписи -->
            <div class="card mx-auto" style="max-width: 800px; margin: 10px">
                <img src="../h1title14.jpg" class="card-img-top" alt="Цифровые подписи">
                <div class="card-body">
                    <h3>Цифровые подписи</h3>
                    <p class="card-text">Электронный аналог собственной ручной подписи для обеспечения аутентичности и
                        целостности</p>

                    <div class="code-block">
                        <span class="sql-comment"># Процесс подписания:</span><br>
                        Хеш = hash(Сообщение)<br>
                        Подпись = encrypt(Хеш, Закрытый_ключ_отправителя)<br><br>
                        <span class="sql-comment"># Процесс проверки:</span><br>
                        Хеш_полученный = decrypt(Подпись, Открытый_ключ_отправителя)<br>
                        Хеш_вычисленный = hash(Сообщение)<br>
                        Проверка = (Хеш_полученный == Хеш_вычисленный)
                    </div>

                    <div class="row">
                        <div class="col-md-6">
                            <p><strong>Что обеспечивает:</strong></p>
                            <ul>
                                <li>✅ <strong>Аутентичность</strong> - подтверждение отправителя</li>
                                <li>✅ <strong>Целостность</strong> - данные не изменены</li>
                                <li>✅ <strong>Неотказуемость</strong> - нельзя отказаться от авторства</li>
                                <li>❌ <strong>Не обеспечивает</strong> конфиденциальность</li>
                            </ul>
                        </div>
                        <div class="col-md-6">
                            <p><strong>Области применения:</strong></p>
                            <ul>
                                <li>Электронные документы</li>
                                <li>Юридические соглашения</li>
                                <li>Обновления ПО (верификация)</li>
                                <li>Блокчейн транзакции</li>
                                <li>SSL/TLS сертификаты</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Карточка 5: Соль в криптографии -->
            <div class="card mx-auto" style="max-width: 800px; margin: 10px">
                <img src="../h1title13.jpg" class="card-img-top" alt="Криптографическая соль">
                <div class="card-body">
                    <h3>Соль (Salt) в криптографии</h3>
                    <p class="card-text">Случайные данные, добавляемые к паролю перед хешированием для защиты от атак.
                    </p>

                    <div class="code-block">
                        <span class="sql-comment"># Без соли (уязвимо):</span><br>
                        hash("password123") → "5e884898da28047151d0e..."<br><br>
                        <span class="sql-comment"># С солью (безопасно):</span><br>
                        salt = random_16_bytes()<br>
                        hash("password123" + salt) → "a3f5b7c9d1e3f5a7..."<br>
                        <span class="sql-comment"># Сохраняем: salt + ":" + hash</span>
                    </div>

                    <div class="row">
                        <div class="col-md-6">
                            <p><strong>Свойства хорошей соли:</strong></p>
                            <ul>
                                <li>Уникальная для каждого пароля</li>
                                <li>Достаточно длинная (16+ байт)</li>
                                <li>Генерируется криптографически безопасным ГСЧ</li>
                                <li>НЕ является секретной</li>
                                <li>Хранится вместе с хешем</li>
                            </ul>
                        </div>
                        <div class="col-md-6">
                            <p><strong>Защита от атак:</strong></p>
                            <ul>
                                <li>✅ Радужные таблицы</li>
                                <li>✅ Словарные атаки</li>
                                <li>✅ Атаки по предварительному вычислению</li>
                                <li>❌ Не защищает от bruteforce</li>
                                <li>❌ Не заменяет сложные пароли</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>



            <!-- Карточка 7: Гибридные криптосистемы -->
            <div class="card mx-auto" style="max-width: 800px; margin: 10px">
                <img src="../h1title11.jpg" class="card-img-top" alt="Гибридные системы">
                <div class="card-body">
                    <h3>Гибридные криптосистемы</h3>
                    <p class="card-text">Комбинирование симметричного и асимметричного шифрования для оптимальной
                        производительности и безопасности.</p>

                    <div class="code-block">
                        <span class="sql-comment"># Процесс гибридного шифрования:</span><br>
                        1. Генерация случайного симметричного ключа сессии<br>
                        2. Шифрование данных симметричным алгоритмом<br>
                        3. Шифрование ключа сессии асимметричным алгоритмом<br>
                        4. Отправка: {зашифрованные_данные, зашифрованный_ключ}
                    </div>

                    <div class="row">
                        <div class="col-md-6">
                            <p><strong>Преимущества:</strong></p>
                            <ul>
                                <li>✅ Скорость симметричного шифрования</li>
                                <li>✅ Безопасный обмен ключами</li>
                                <li>✅ Масштабируемость</li>
                                <li>✅ Поддержка сеансовых ключей</li>
                                <li>✅ Идеально для больших данных</li>
                            </ul>
                        </div>
                        <div class="col-md-6">
                            <p><strong>Примеры использования:</strong></p>
                            <ul>
                                <li>SSL/TLS (HTTPS)</li>
                                <li>PGP (Pretty Good Privacy)</li>
                                <li>VPN соединения</li>
                                <li>Зашифрованная почта</li>
                                <li>Файловые архиваторы</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Карточка 8: Хеш-функции -->
            <div class="card mx-auto" style="max-width: 800px; margin: 10px">
                <img src="../h1title11.jpg" class="card-img-top" alt="Хеш-функции">
                <div class="card-body">
                    <h3>Криптографические хеш-функции</h3>
                    <p class="card-text">Односторонние математические функции, преобразующие данные произвольной длины в
                        фиксированную строку.</p>

                    <div class="code-block">
                        <span class="sql-comment"># Свойства идеальной хеш-функции:</span><br>
                        - Детерминированность: одинаковый вход → одинаковый выход<br>
                        - Быстрое вычисление<br>
                        - Необратимость: нельзя восстановить вход<br>
                        - Устойчивость к коллизиям<br>
                        - Лавинный эффект: малые изменения → большие различия
                    </div>

                    <div class="row">
                        <div class="col-md-6">
                            <p><strong>Популярные алгоритмы:</strong></p>
                            <ul>
                                <li><strong>MD5:</strong> 128 бит (устарел)</li>
                                <li><strong>SHA-1:</strong> 160 бит (не рекомендуется)</li>
                                <li><strong>SHA-256:</strong> 256 бит (рекомендуется)</li>
                                <li><strong>SHA-3:</strong> новое поколение</li>
                                <li><strong>bcrypt:</strong> для паролей</li>
                            </ul>
                        </div>
                        <div class="col-md-6">
                            <p><strong>Применение:</strong></p>
                            <ul>
                                <li>Хранение паролей</li>
                                <li>Цифровые подписи</li>
                                <li>Контрольные суммы файлов</li>
                                <li>Блокчейн и криптовалюты</li>
                                <li>Верификация данных</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>



            <div class="card mx-auto" style="max-width: 800px; margin: 10px">
                <img src="../h1title.jpg" class="card-img-top" alt="База данных">
                <div class="card-body">
                    <h3>Блокчейн</h3>
                    <div class="row">
                        <div class="col-12">
                            <h1 class="text-center mb-4">Термины</h1>

                            <!-- Блок с целями обучения -->
                            <div class="alert alert-secondary">
                                <ul>
                                    <li>Блокчейн (Blockchain): Распределенная база данных, состоящая из цепочки блоков с
                                        криптографически защищенной информацией о транзакциях. </li>
                                    <li>Децентрализация: Отсутствие единого управляющего центра; сеть поддерживается
                                        множеством узлов, что повышает ее устойчивость и безопасность. </li>
                                    <li>Криптовалюта: Цифровая или виртуальная валюта, использующая криптографию для
                                        защиты транзакций и работы на технологии блокчейн</li>
                                    <li>Смарт-контракт (Smart Contract): Программа, которая автоматически выполняет
                                        условия договора при наступлении определенных событий. Она обеспечивает
                                        децентрализованное исполнение контрактов. </li>
                                    <li>Майнинг (Mining): Процесс проверки и добавления новых транзакций в блокчейн с
                                        помощью вычислений, за что майнеры получают вознаграждение в виде криптовалюты.
                                    </li>
                                    <li>Транзакция (Transaction): Запись о передаче активов или данных, которая
                                        проверяется и добавляется в блокчейн. </li>
                                    <li>Приватный ключ (Private Key): Секретный код, который дает доступ к средствам в
                                        кошельке и используется для подписания транзакций. Его нельзя никому показывать
                                    </li>
                                    <li>Публичный ключ (Public Key): Используется для создания адреса кошелька. Открыт
                                        для всех и необходим для получения криптовалют</li>
                                    <li>Кошелек (Wallet): Цифровое приложение или устройство, которое хранит приватный и
                                        публичный ключи, а также позволяет управлять криптовалютой</li>
                                    <li>Хэш (Hash): Уникальный цифровой отпечаток, созданный из блока данных. Каждый
                                        новый блок содержит хэш предыдущего, что связывает их в цепочку. </li>
                                    <li>Токен (Token): Цифровой актив, который работает на базе существующего блокчейна.
                                        Может представлять различные активы, такие как акции или валюта</li>
                                    <li>https://econolabs.github.io/blockchain/</li>

                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>


            <!-- Заглавное изображение -->

            <div class="card mx-auto" style="max-width: 800px; margin: 10px">
                <img src="../h1title.jpg" class="card-img-top" alt="База данных">
                <div class="card-body">
                    <h3>Базы данных Structured Query Language (SQL)</h3>
                    <div class="row">
                        <div class="col-12">
                            <h1 class="text-center mb-4">Базы данных на примере SQLite3 в Python</h1>
                            <p class="lead text-center">Практическое руководство для работы в Jupyter Lite</p>

                            <!-- Блок с целями обучения -->
                            <div class="alert alert-primary">
                                <h4>Цели занятия:</h4>
                                <ul>
                                    <li>Освоить основы работы с реляционными базами данных</li>
                                    <li>Научиться создавать и управлять базами данных в SQLite3</li>
                                    <li>Научиться работать с данными в Jupyter Lite</li>
                                    <li>https://econolabspython.github.io/jupyterlite/lab/index.html</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>




            <!-- Карточка 1: Введение в SQLite -->
            <div class="card mx-auto" style="max-width: 800px; margin: 10px">
                <img src="../h1title.jpg" class="card-img-top" alt="База данных">
                <div class="card-body">
                    <h3>Введение в SQLite</h3>
                    <p class="card-text">SQLite - это встраиваемая реляционная база данных, которая не требует
                        отдельного серверного процесса.</p>
                    <p class="card-text">Основные операции подключения и создания Structured Query Language базы данных.
                    </p>
                    <div class="code-block">
                        <span class="sql-keyword">import</span> sqlite3<br><br>

                        <span class="sql-comment"># Подключение к базе данных</span><br>
                        connection = sqlite3.connect(<span class="sql-keyword">'students.db'</span>)<br><br>

                        <span class="sql-comment"># Создание курсора для выполнения SQL-запросов</span><br>
                        cursor = connection.cursor()<br><br>

                        <span class="sql-comment"># Не забудьте закрыть соединение после работы</span><br>
                        <span class="sql-comment">connection.close()</span>
                    </div>
                    <div class="alert alert-warning">
                        <strong>Важно:</strong> Всегда закрывайте соединение после работы с базой данных.
                    </div>
                    <div class="row">
                        <div class="col-md-6">
                            <p><strong>Преимущества SQLite:</strong></p>
                            <ul>
                                <li>Не требует установки отдельного сервера</li>
                                <li>Вся база данных хранится в одном файле</li>
                                <li>Поддерживает стандартный SQL</li>
                                <li>Идеально для обучения и небольших проектов</li>
                            </ul>
                        </div>
                        <div class="col-md-6">
                            <p><strong>Применение</strong></p>
                            <ul>
                                <li>Анализ datasets</li>
                                <li>Хранение информации об источниках</li>
                                <li>Управление архивом</li>
                                <li>Структурирование исследовательских данных</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>


            <!-- Карточка 3: Создание таблиц -->
            <div class="card mx-auto" style="max-width: 800px; margin: 10px">
                <img src="../h1title2.jpg" class="card-img-top" alt="Таблицы">
                <div class="card-body">
                    <h3>Создание таблиц</h3>
                    <p class="card-text">Создание структуры базы данных с помощью SQL-запросов.</p>
                    <div class="code-block">
                        <span class="sql-comment"># Создание таблицы студентов - вставьте ПОСЛЕ создания cursor,<br>
                            # но ДО connection.close() </span><br>
                        create_table_query = <span class="sql-keyword">'''</span><br>
                        <span class="sql-keyword">CREATE TABLE</span> IF NOT EXISTS students (<br>
                        id INTEGER <span class="sql-keyword">PRIMARY KEY AUTOINCREMENT</span>,<br>
                        name TEXT <span class="sql-keyword">NOT NULL</span>,<br>
                        age INTEGER,<br>
                        grade TEXT<br>
                        );<br>
                        <span class="sql-keyword">'''</span><br><br>

                        cursor.execute(create_table_query)<br>
                        connection.commit()
                    </div>
                    <div class="row">
                        <div class="col-md-6">
                            <p><strong>Типы данных в SQLite:</strong></p>
                            <ul>
                                <li>INTEGER - целые числа</li>
                                <li>TEXT - текстовые данные</li>
                                <li>REAL - числа с плавающей точкой</li>
                                <li>BLOB - бинарные данные</li>
                                <li>NULL - пустое значение</li>
                            </ul>
                        </div>
                        <div class="col-md-6">
                            <p><strong>Ограничения (Constraints):</strong></p>
                            <ul>
                                <li>PRIMARY KEY - первичный ключ</li>
                                <li>NOT NULL - запрет пустых значений</li>
                                <li>UNIQUE - уникальные значения</li>
                                <li>DEFAULT - значение по умолчанию</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Карточка 4: Вставка данных -->
            <div class="card mx-auto" style="max-width: 800px; margin: 10px">
                <img src="../h1title3.jpg" class="card-img-top" alt="Вставка данных">
                <div class="card-body">
                    <h3>Вставка данных</h3>
                    <p class="card-text">Добавление записей в таблицу.</p>
                    <div class="code-block">
                        <span class="sql-comment"># Вставка одной записи</span><br>
                        insert_query = <span class="sql-keyword">"INSERT INTO students (name, age, grade) VALUES (?, ?,
                            ?)"</span><br>
                        student_data = (<span class="sql-keyword">'Иван Иванов'</span>, <span
                            class="sql-keyword">20</span>,
                        <span class="sql-keyword">'A'</span>)<br>
                        cursor.execute(insert_query, student_data)<br>
                        connection.commit()<br><br>

                        <span class="sql-comment"># Вставка нескольких записей</span><br>
                        students_list = [<br>
                        (<span class="sql-keyword">'Мария Петрова'</span>, <span class="sql-keyword">19</span>, <span
                            class="sql-keyword">'B'</span>),<br>
                        (<span class="sql-keyword">'Петр Сидоров'</span>, <span class="sql-keyword">21</span>, <span
                            class="sql-keyword">'A'</span>),<br>
                        (<span class="sql-keyword">'Анна Козлова'</span>, <span class="sql-keyword">20</span>, <span
                            class="sql-keyword">'C'</span>)<br>
                        ]<br>
                        cursor.executemany(insert_query, students_list)<br>
                        connection.commit()<br><br>
                    </div>
                    <div class="alert alert-info">
                        <strong>Безопасность:</strong> Всегда используйте параметризованные запросы для предотвращения
                        SQL-инъекций.
                    </div>

                    <div class="code-block">
                        <span class="sql-comment"># Выбор ВСЕХ записей ДО connection.close() </span><br>
                        cursor.execute(<span class="sql-keyword">"SELECT * FROM students"</span>)<br>
                        all_students = cursor.fetchall()<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;print(type(all_students))<br><br>

                        <span class="sql-comment"># Вывод результатов</span><br>
                        <span class="sql-keyword">for</span> student <span class="sql-keyword">in</span>
                        all_students:<br>
                        print(<span class="sql-keyword">f"ID: {student[0]}, Имя: {student[1]},
                            Возраст: {student[2]}, Оценка: {student[3]}"</span>)
                        <br>
                    </div>
                </div>
            </div>

            <!-- Карточка 5: Выборка данных -->
            <div class="card mx-auto" style="max-width: 800px; margin: 10px">
                <img src="../h1title5.jpg" class="card-img-top" alt="Поиск данных">
                <div class="card-body">
                    <h3>Выборка данных</h3>

                    <div class="alert alert-success">
                        <h4>При извлечении данных слова и символы в SQL-запросах записываются последовательно в
                            определённом порядке</h4>
                        <ul>
                            <li>1. SELECT — указывает столбцы таблицы, которые нужно выбрать</li>
                            <li>2. FROM — указывает название таблицы, в которой находятся эти столбцы</li>
                            <li>3. JOIN — объединяет несколько таблиц</li>
                            <li>4. WHERE — фильтрует строки до выполнения группировки</li>
                            <li>5. GROUP BY — группирует строки по указанным столбцам</li>
                            <li>6. HAVING — фильтрует получившиеся после группировки группы</li>
                            <li>7. ORDER BY — сортирует результат запроса</li>
                            <li>8. LIMIT — ограничивает количество возвращаемых строк</li>
                        </ul>
                    </div>








                    <div class="code-block">
                        <span class="sql-comment"># Выбор всех записей</span><br>
                        cursor.execute(<span class="sql-keyword">"SELECT * FROM students"</span>)<br>
                        all_students = cursor.fetchall()<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;print(type(all_students))<br><br>

                        <span class="sql-comment"># Вывод результатов</span><br>
                        <span class="sql-keyword">for</span> student <span class="sql-keyword">in</span>
                        all_students:<br>
                        print(<span class="sql-keyword">f"ID: {student[0]}, Имя: {student[1]},
                            Возраст: {student[2]}, Оценка: {student[3]}"</span>)
                        <br>
                        <br>
                        <span class="sql-comment"># Выбор с условием</span><br>
                        cursor.execute(<span class="sql-keyword">"SELECT * FROM students WHERE age > ?"</span>, (<span
                            class="sql-keyword">19</span>,))<br>
                        adult_students = cursor.fetchall()<br>
                        <span class="sql-comment"># Сделайте самостоятельно вывод результатов</span><br><br>

                        <span class="sql-comment"># Выбор одной записи</span><br>
                        cursor.execute(<span class="sql-keyword">"SELECT * FROM students WHERE name = ?"</span>, (<span
                            class="sql-keyword">'Иван Иванов'</span>,))<br>
                        one_student = cursor.fetchone()<br>
                        print(type(student))<br>
                        <span class="sql-comment"># Display the result</span><br>
                        print("First Student:")<br>
                        print(student) <br>
                        <br>

                        <span class="sql-comment"># Выбор конкретных полей</span><br>
                        cursor.execute(<span class="sql-keyword">"SELECT name, grade FROM students WHERE age BETWEEN 18
                            AND
                            20"</span>)<br>
                        specific_fields = cursor.fetchall()<br>
                        <span class="sql-comment"># Сделайте самостоятельно вывод результатов</span><br><br>

                        <span class="sql-comment"># Выбор уникальных значений</span><br>
                        cursor.execute(<span class="sql-keyword">"SELECT DISTINCT grade FROM students"</span>)<br>
                        unique_grades = cursor.fetchall()<br><br>
                        <span class="sql-comment"># Сделайте самостоятельно вывод результатов</span><br><br>


                    </div>
                </div>
            </div>

            <!-- Карточка 7: Обновление данных -->
            <div class="card mx-auto" style="max-width: 800px; margin: 10px">
                <img src="../h1title7.jpg" class="card-img-top" alt="Обновление данных">
                <div class="card-body">
                    <h3>Обновление данных</h3>
                    <p class="card-text">Изменение существующих записей в таблице.</p>
                    <div class="code-block">
                        <span class="sql-comment"># Обновление оценки студента</span><br>
                        update_query = <span class="sql-keyword">"UPDATE students SET grade = ? WHERE name =
                            ?"</span><br>
                        cursor.execute(update_query, (<span class="sql-keyword">'A+'</span>, <span
                            class="sql-keyword">'Мария Петрова'</span>))<br>
                        connection.commit()<br><br>

                        <span class="sql-comment"># Обновление возраста всех студентов</span><br>
                        cursor.execute(<span class="sql-keyword">"UPDATE students SET age = age + 1"</span>)<br>
                        connection.commit()<br><br>

                        <span class="sql-comment"># Обновление нескольких полей</span><br>
                        cursor.execute(<span class="sql-keyword">'''</span><br>
                        <span class="sql-keyword">UPDATE</span> students <br>
                        <span class="sql-keyword">SET</span> grade = <span class="sql-keyword">?</span>, age = <span
                            class="sql-keyword">?</span><br>
                        <span class="sql-keyword">WHERE</span> id = <span class="sql-keyword">?</span><br>
                        <span class="sql-keyword">'''</span>, (<span class="sql-keyword">'B+'</span>, <span
                            class="sql-keyword">23</span>, <span class="sql-keyword">5</span>))<br>
                        connection.commit()<br><br>

                        print(<span class="sql-keyword">f"Количество обновленных строк: {cursor.rowcount}"</span>)
                    </div>
                </div>
            </div>




            <!-- Карточка 5: Выборка данных -->
            <div class="card mx-auto" style="max-width: 800px; margin: 10px">
                <img src="../h1title17.jpg" class="card-img-top" alt="Поиск данных">
                <div class="card-body">
                    <h3>Генератор данных</h3>

                    <div class="alert alert-primary">
                        <h4>Faker</h4>
                        Позволяет разделить процессы сбора и анализа данных<br><br>
                        fake.random_element(["M", "F"])<br>
                        fake.name()<br>
                        fake.random_int(min=18, max=25)<br>
                        fake.email()<br>
                        fake.company<br>
                        fake.job()<br>
                        fake.date_this_year().isoformat()<br>
                        fake.boolean(chance_of_getting_true=80)<br>
                        fake.date_of_birth()<br>
                        fake.sentence<br>
                        fake.sentences<br>
                        ...<br>
                        https://gist.github.com/digitalashes/185133cd833d78cbc74e9090e10b57d2<br>
                    </div>

                    <div class="code-block">
                        <span class="sql-keyword">import</span> piplite<br><br>

                        <span class="sql-keyword">await</span> piplite.install(<span
                            class="sql-string">"faker"</span>)<br>
                        <span class="sql-keyword">from</span> faker <span class="sql-keyword">import</span>
                        Faker<br><br>

                        <span class="sql-comment"># Initialize Faker</span><br>
                        fake_eng = Faker(<span class="sql-string">'en_US'</span>) <span class="sql-comment"># US
                            English</span><br>
                        fake_ru = Faker(<span class="sql-string">'ru_RU'</span>) <span class="sql-comment">#
                            Russian</span><br><br>

                        print(fake_eng.name())<br>
                        print(fake_eng.text())<br>
                        print(fake_eng.random_element([<span class="sql-string">"M"</span>, <span
                            class="sql-string">"F"</span>]))<br><br>

                        print(fake_ru.name())<br>
                        print(fake_ru.text())<br><br>

                        <span class="sql-comment"># Added Faker methods</span><br>
                        print(fake_eng.random_int(min=<span class="sql-number">18</span>, max=<span
                            class="sql-number">25</span>))<br>
                        print(fake_eng.email())<br>
                        print(fake_eng.company())<br>
                        print(fake_eng.job())<br>
                        print(fake_eng.date_this_year().isoformat())<br>
                        print(fake_eng.boolean(chance_of_getting_true=<span class="sql-number">80</span>))<br>
                        print(fake_eng.date_of_birth())<br>
                        print(fake_eng.sentence())<br>
                        print(fake_eng.sentences())<br>
                    </div>

                    <div class="code-block">
                        <span class="sql-comment"># Insert a record into the Students table</span><br>
                        insert_query = <span class="sql-string">'''</span><br>
                        <span class="sql-keyword">INSERT INTO</span> students (name, age, grade)<br>
                        <span class="sql-keyword">VALUES</span> (?, ?, ?);<br>
                        <span class="sql-string">'''</span><br>
                        students_data = [<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;(<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fake_ru.name(),<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fake_ru.random_int(min=<span
                            class="sql-number">18</span>, max=<span class="sql-number">25</span>),<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fake_ru.random_element([<span
                            class="sql-string">"A"</span>, <span class="sql-string">"B"</span>, <span
                            class="sql-string">"C"</span>, <span class="sql-string">"D"</span>])<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;)<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;<span class="sql-keyword">for</span> _ <span
                            class="sql-keyword">in</span> range(<span class="sql-number">5</span>)]<br><br>

                        <span class="sql-comment"># Execute the query for multiple records</span><br>
                        cursor.executemany(insert_query, students_data)<br><br>

                        <span class="sql-comment"># Commit the changes</span><br>
                        connection.commit()<br>
                    </div>
                </div>
            </div>

            <!-- Карточка 6: Расширенные операции SELECT -->
            <div class="card mx-auto" style="max-width: 800px; margin: 10px">
                <img src="../h1title6.jpg" class="card-img-top" alt="Расширенный поиск">
                <div class="card-body">
                    <h3>Расширенные операции SELECT</h3>
                    <p class="card-text">Сортировка, группировка и агрегатные функции.</p>
                    <div class="code-block">

                        <span class="sql-comment"># Удаление всех записей из таблицы (осторожно!) -<br>
                            вставьте код ДО добавления данных</span><br>
                        <span class="sql-comment"># cursor.execute("DELETE FROM students")</span><br>
                        <span class="sql-comment"># connection.commit()</span>
                    </div>
                    <div class="alert alert-danger">
                        <strong>Внимание:</strong> Операция DELETE необратима. Всегда проверяйте условие WHERE.
                    </div>

                    <div class="code-block">
                        <span class="sql-comment"># Сортировка по возрасту (по возрастанию)</span><br>
                        cursor.execute(<span class="sql-keyword">"SELECT * FROM students ORDER BY age ASC"</span>)<br>
                        sorted_students = cursor.fetchall()<br><br>

                        <span class="sql-comment"># Сортировка по оценке (по убыванию) и имени</span><br>
                        cursor.execute(<span class="sql-keyword">"SELECT * FROM students ORDER BY grade DESC, name
                            ASC"</span>)<br>
                        complex_sorted = cursor.fetchall()<br><br>

                        <span class="sql-comment"># Группировка и агрегатные функции</span><br>
                        cursor.execute(<span class="sql-keyword">'''</span><br>
                        <span class="sql-keyword">SELECT</span> grade, <span class="sql-keyword">COUNT</span>(*) as
                        count,
                        <span class="sql-keyword">AVG</span>(age) as avg_age<br>
                        <span class="sql-keyword">FROM</span> students <br>
                        <span class="sql-keyword">GROUP BY</span> grade<br>
                        <span class="sql-keyword">HAVING COUNT</span>(*) > 1<br>
                        <span class="sql-keyword">'''</span>)<br>
                        grouped_data = cursor.fetchall()<br><br>

                        <span class="sql-comment"># Ограничение количества результатов</span><br>
                        cursor.execute(<span class="sql-keyword">"SELECT * FROM students LIMIT 5"</span>)<br>
                        limited_results = cursor.fetchall()<br><br>

                        <span class="sql-comment"># Пропуск первых N записей</span><br>
                        cursor.execute(<span class="sql-keyword">"SELECT * FROM students LIMIT 5 OFFSET 2"</span>)<br>
                        offset_results = cursor.fetchall()<br><br>

                        <span class="sql-comment"># Поиск по шаблону (LIKE)</span><br>
                        cursor.execute(<span class="sql-keyword">"SELECT * FROM students WHERE name LIKE
                            'И%'"</span>)<br>
                        pattern_results = cursor.fetchall()
                    </div>

                </div>
                <p class="m-5"><strong>Агрегатные функции:</strong> COUNT(), SUM(), AVG(), MIN(), MAX()</p>
            </div>

            <!-- Карточка 8: Удаление данных -->
            <div class="card mx-auto" style="max-width: 800px; margin: 10px">
                <img src="../h1title8.jpg" class="card-img-top" alt="Удаление данных">
                <div class="card-body">
                    <h3>Простейшая визуализация: pandas и matplotlib</h3>

                    <div class="alert alert-primary" role="alert">
                        Pandas — это библиотека Python для обработки и анализа структурированных данных, ее название
                        происходит от «panel data» («панельные данные»).<br>
                        Панельными данными называют информацию, полученную в результате исследований и структурированную
                        в виде таблиц
                    </div>

                    <div class="alert alert-secondary" role="alert">
                        Pandas Series (серия) — это одномерный массив.<br>
                        Визуально он похож на пронумерованный список: слева в колонке находятся индексы элементов, а
                        справа — сами элементы
                    </div>


                    <div class="alert alert-success" role="alert">
                        Pandas DataFrame — это двумерный массив, похожий на таблицу/лист Excel (кстати, данные из
                        табличных файлов Excel можно читать с помощью команды pandas.read_excel('file.xls')).<br>
                        В нем можно проводить такие же манипуляции с данными: объединять в группы, сортировать по
                        определенному признаку, производить вычисления.<br>
                        Как любая таблица, датафрейм состоит из столбцов и строк, причем столбцами будут уже известные
                        объекты — Series.
                    </div>

                    <div class="code-block">
                        <span class="sql-comment"># Чтение данных из CSV файла</span><br>
                        df = pd.read_csv(<span class="sql-keyword">'filename.csv'</span>)<br>
                        df = pd.read_csv(<span class="sql-keyword">'filename.csv'</span>, encoding=<span
                            class="sql-keyword">'utf-8'</span>, sep=<span class="sql-keyword">','</span>)<br><br>

                        <span class="sql-comment"># Чтение данных из Excel файла</span><br>
                        df = pd.read_excel(<span class="sql-keyword">'filename.xlsx'</span>)<br>
                        df = pd.read_excel(<span class="sql-keyword">'filename.xlsx'</span>, sheet_name=<span
                            class="sql-keyword">'Sheet1'</span>)<br><br>

                        <span class="sql-comment"># Чтение данных из SQL базы данных</span><br>
                        import sqlite3<br>
                        connection = sqlite3.connect(<span class="sql-keyword">'database.db'</span>)<br>
                        df = pd.read_sql(<span class="sql-keyword">'SELECT * FROM table_name'</span>, connection)<br>
                        df = pd.read_sql_query(<span class="sql-keyword">'SELECT * FROM table_name'</span>,
                        connection)<br><br>
                    </div>

                    <div class="alert alert-primary" role="alert">
                        Дата-аналитики составляют наглядные графики с помощью Pandas и библиотеки Matplotlib
                    </div>


                    <div class="code-block">
                        import matplotlib.pyplot as plt<br><br>

                        <span class="sql-comment"># Линейный график</span><br>
                        x = [<span class="sql-keyword">1, 2, 3, 4, 5</span>]<br>
                        y = [<span class="sql-keyword">2, 4, 1, 5, 3</span>]<br>
                        plt.plot(x, y)<br>
                        plt.title(<span class="sql-keyword">'Пример линейного графика'</span>)<br>
                        plt.xlabel(<span class="sql-keyword">'Время'</span>)<br>
                        plt.ylabel(<span class="sql-keyword">'Значения'</span>)<br>
                        plt.grid(<span class="sql-keyword">True</span>)<br>
                        plt.show()<br><br>

                        <span class="sql-comment"># Столбчатая диаграмма</span><br>
                        categories = [<span class="sql-keyword">'A', 'B', 'C', 'D'</span>]<br>
                        values = [<span class="sql-keyword">15, 23, 18, 30</span>]<br>
                        plt.bar(categories, values)<br>
                        plt.title(<span class="sql-keyword">'Продажи по категориям'</span>)<br>
                        plt.xticks(rotation=<span class="sql-keyword">45</span>)<br>
                        plt.show()<br><br>

                        <span class="sql-comment"># Круговая диаграмма</span><br>
                        sizes = [<span class="sql-keyword">35, 25, 20, 20</span>]<br>
                        labels = [<span class="sql-keyword">'Python', 'Java', 'C++', 'Другие'</span>]<br>
                        plt.pie(sizes, labels=labels, autopct=<span class="sql-keyword">'%1.1f%%'</span>)<br>
                        plt.title(<span class="sql-keyword">'Распределение языков'</span>)<br>
                        plt.show()<br><br>

                        <span class="sql-comment"># Гистограмма</span><br>
                        data = [<span class="sql-keyword">1, 2, 2, 3, 3, 3, 4, 4, 5</span>]<br>
                        plt.hist(data, bins=<span class="sql-keyword">5</span>)<br>
                        plt.title(<span class="sql-keyword">'Распределение данных'</span>)<br>
                        plt.xlabel(<span class="sql-keyword">'Значения'</span>)<br>
                        plt.ylabel(<span class="sql-keyword">'Частота'</span>)<br>
                        plt.show()<br><br>

                        <span class="sql-comment"># Точечная диаграмма</span><br>
                        x = [<span class="sql-keyword">1, 2, 3, 4, 5, 6</span>]<br>
                        y = [<span class="sql-keyword">2, 4, 1, 5, 3, 6</span>]<br>
                        plt.scatter(x, y)<br>
                        plt.title(<span class="sql-keyword">'Точечный график'</span>)<br>
                        plt.show()<br><br>
                    </div>


                    <div class="alert alert-primary" role="alert">
                        Seaborn — это библиотека Python для статистической визуализации данных, построенная поверх
                        Matplotlib.<br>
                        Она упрощает создание сложных и привлекательных графиков, таких как коробчатые диаграммы,
                        тепловые карты и диаграммы рассеяния, с помощью высокоуровневого интерфейса.<br>
                        Seaborn тесно интегрируется с библиотекой Pandas, что позволяет напрямую визуализировать данные
                        из фреймов данных
                    </div>



                </div>
            </div>



            <!-- Карточка 7: Обновление данных -->
            <div class="card mx-auto" style="max-width: 800px; margin: 10px">
                <img src="../h1title11.jpg" class="card-img-top" alt="Обновление данных">
                <div class="card-body">
                    <h3>Комплексный пример Имитация статистического исследования</h3>



                    <p class="card-text">numpy, pandas, matplotlib</p>

                    <div class="code-block">
                        <span class="sql-keyword">import</span> pandas <span class="sql-keyword">as</span> pd<br>
                        <span class="sql-keyword">import</span> matplotlib.pyplot <span class="sql-keyword">as</span>
                        plt<br>
                        <span class="sql-keyword">import</span> numpy <span class="sql-keyword">as</span> np<br>
                        <span class="sql-keyword">import</span> random<br>
                        <span class="sql-keyword">import</span> micropip<br><br>

                        <span class="sql-comment"># Установка зависимостей</span><br>
                        <span class="sql-keyword">await</span> micropip.install(<span
                            class="sql-string">"faker"</span>)<br>
                        <span class="sql-keyword">await</span> micropip.install(<span
                            class="sql-string">"openpyxl"</span>)<br><br>

                        <span class="sql-keyword">from</span> faker <span class="sql-keyword">import</span>
                        Faker<br><br>

                        <span class="sql-comment"># Инициализация Faker</span><br>
                        fake = Faker(<span class="sql-string">'ru_RU'</span>)<br><br>

                        <span class="sql-comment"># Генерация данных для исследования роста</span><br>
                        np.random.seed(<span class="sql-number">42</span>)<br>
                        random.seed(<span class="sql-number">42</span>)<br><br>

                        <span class="sql-comment"># Создаем датафрейм с данными</span><br>
                        n_records = <span class="sql-number">1000</span><br>
                        data = []<br><br>

                        <span class="sql-keyword">for</span> i <span class="sql-keyword">in</span> range(n_records):<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;gender = random.choice([<span class="sql-string">'male'</span>, <span
                            class="sql-string">'female'</span>])<br><br>

                        &nbsp;&nbsp;&nbsp;&nbsp;<span class="sql-keyword">if</span> gender == <span
                            class="sql-string">'male'</span>:<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;first_name = fake.first_name_male()<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;height = np.random.normal(<span
                            class="sql-number">177.2</span>, <span class="sql-number">7</span>)<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;<span class="sql-keyword">else</span>:<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;first_name = fake.first_name_female()<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;height = np.random.normal(<span
                            class="sql-number">164.5</span>, <span class="sql-number">6</span>)<br><br>

                        &nbsp;&nbsp;&nbsp;&nbsp;height = max(<span class="sql-number">150</span>, min(<span
                            class="sql-number">210</span>, height))<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;age = random.randint(<span class="sql-number">18</span>, <span
                            class="sql-number">65</span>)<br><br>

                        &nbsp;&nbsp;&nbsp;&nbsp;<span class="sql-keyword">if</span> age &lt; <span
                            class="sql-number">25</span>:<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;height += random.uniform(<span
                            class="sql-number">0</span>, <span class="sql-number">2</span>)<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;<span class="sql-keyword">elif</span> age &gt; <span
                            class="sql-number">55</span>:<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;height -= random.uniform(<span
                            class="sql-number">0</span>, <span class="sql-number">2</span>)<br><br>

                        &nbsp;&nbsp;&nbsp;&nbsp;data.append({<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sql-string">'id'</span>: i + <span
                            class="sql-number">1</span>,<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sql-string">'first_name'</span>:
                        first_name,<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sql-string">'last_name'</span>:
                        fake.last_name(),<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sql-string">'age'</span>: age,<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sql-string">'gender'</span>:
                        gender.capitalize(),<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sql-string">'height'</span>:
                        round(height, <span class="sql-number">1</span>),<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sql-string">'city'</span>:
                        fake.city()<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;})<br><br>

                        <span class="sql-comment"># Создаем DataFrame</span><br>
                        df_height = pd.DataFrame(data)<br><br>

                        <span class="sql-comment"># Просмотр сгенерированных данных</span><br>
                        print(<span class="sql-string">"Размер данных:"</span>, df_height.shape)<br>
                        print(<span class="sql-string">"\nПервые 5 строк:"</span>)<br>
                        print(df_height.head())<br><br>

                        <span class="sql-comment"># Основные статистики</span><br>
                        print(<span class="sql-string">"\nОсновные статистики по росту:"</span>)<br>
                        print(df_height[<span class="sql-string">'height'</span>].describe())<br><br>

                        <span class="sql-comment"># Статистика по полу</span><br>
                        print(<span class="sql-string">"\nСредний рост по полу:"</span>)<br>
                        height_by_gender = df_height.groupby(<span class="sql-string">'gender'</span>)[<span
                            class="sql-string">'height'</span>].agg([<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;<span class="sql-string">'count'</span>, <span
                            class="sql-string">'mean'</span>, <span class="sql-string">'std'</span>, <span
                            class="sql-string">'min'</span>, <span class="sql-string">'max'</span><br>
                        ]).round(<span class="sql-number">1</span>)<br>
                        print(height_by_gender)<br><br>

                        <span class="sql-comment"># Запись данных в Excel файл</span><br>
                        output_file = <span class="sql-string">'height_research_russia.xlsx'</span><br><br>

                        <span class="sql-keyword">with</span> pd.ExcelWriter(output_file, engine=<span
                            class="sql-string">'openpyxl'</span>) <span class="sql-keyword">as</span> writer:<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;df_height.to_excel(writer, sheet_name=<span
                            class="sql-string">'Height_Data'</span>, index=<span class="sql-keyword">False</span>)<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;summary_stats = df_height.groupby(<span
                            class="sql-string">'gender'</span>).agg({<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sql-string">'height'</span>: [<span
                            class="sql-string">'mean'</span>, <span class="sql-string">'std'</span>, <span
                            class="sql-string">'min'</span>, <span class="sql-string">'max'</span>],<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sql-string">'age'</span>: <span
                            class="sql-string">'mean'</span><br>
                        &nbsp;&nbsp;&nbsp;&nbsp;}).round(<span class="sql-number">1</span>)<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;summary_stats.to_excel(writer, sheet_name=<span
                            class="sql-string">'Summary_Statistics'</span>)<br><br>

                        print(<span class="sql-string">f"\n✅ Данные успешно записаны в файл: {output_file}"</span>)<br>

                        <span class="sql-comment"># Визуализация результатов</span><br>
                        plt.figure(figsize=(<span class="sql-number">12</span>, <span
                            class="sql-number">8</span>))<br><br>

                        plt.subplot(<span class="sql-number">2</span>, <span class="sql-number">2</span>, <span
                            class="sql-number">1</span>)<br>
                        <span class="sql-keyword">for</span> gender <span class="sql-keyword">in</span> [<span
                            class="sql-string">'Male'</span>, <span class="sql-string">'Female'</span>]:<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;plt.hist(df_height[df_height[<span class="sql-string">'gender'</span>]
                        == gender][<span class="sql-string">'height'</span>], <br>
                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;alpha=<span
                            class="sql-number">0.7</span>, label=gender, bins=<span class="sql-number">20</span>)<br>
                        plt.xlabel(<span class="sql-string">'Рост (см)'</span>)<br>
                        plt.ylabel(<span class="sql-string">'Количество'</span>)<br>
                        plt.title(<span class="sql-string">'Распределение роста по полу'</span>)<br>
                        plt.legend()<br><br>

                        plt.subplot(<span class="sql-number">2</span>, <span class="sql-number">2</span>, <span
                            class="sql-number">2</span>)<br>
                        gender_data = [df_height[df_height[<span class="sql-string">'gender'</span>] == <span
                            class="sql-string">'Male'</span>][<span class="sql-string">'height'</span>],<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;df_height[df_height[<span
                            class="sql-string">'gender'</span>] == <span class="sql-string">'Female'</span>][<span
                            class="sql-string">'height'</span>]]<br>
                        plt.boxplot(gender_data, labels=[<span class="sql-string">'Мужчины'</span>, <span
                            class="sql-string">'Женщины'</span>])<br>
                        plt.ylabel(<span class="sql-string">'Рост (см)'</span>)<br>
                        plt.title(<span class="sql-string">'Боксплот распределения роста'</span>)<br><br>

                        plt.tight_layout()<br>
                        plt.show()<br>
                    </div>

                </div>
            </div>


            <!-- Карточка 7: Обновление данных -->
            <div class="card mx-auto" style="max-width: 800px; margin: 10px">
                <img src="../h1title17.jpg" class="card-img-top" alt="Обновление данных">
                <div class="card-body">
                    <h3>Комплексный пример. Исследование базы данных с неизвестной структурой</h3>



                    <p class="card-text">numpy, pandas, matplotlib</p>

                    <div class="code-block">
                        <span class="sql-keyword">import</span> pandas <span class="sql-keyword">as</span> pd<br>
                        <span class="sql-keyword">import</span> matplotlib.pyplot <span class="sql-keyword">as</span>
                        plt<br>
                        <span class="sql-keyword">import</span> numpy <span class="sql-keyword">as</span> np<br>
                        <span class="sql-keyword">import</span> micropip<br><br>

                        <span class="sql-comment"># Установка зависимостей</span><br>
                        <span class="sql-keyword">await</span> micropip.install(<span
                            class="sql-string">"xlrd"</span>)<br><br>

                        <span class="sql-comment"># Чтение данных из Excel файла</span><br>
                        <span class="sql-keyword">try</span>:<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;df = pd.read_excel(<span
                            class="sql-string">'data/default_of_credit_card_clients__courseware_version_1_21_19.xls'</span>,
                        engine=<span class="sql-string">'xlrd'</span>)<br>
                        <span class="sql-keyword">except</span> Exception <span class="sql-keyword">as</span> e:<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;print(<span class="sql-string">f"Ошибка при чтении файла:
                            {e}"</span>)<br><br>

                        <span class="sql-comment"># Просмотр основных информации о данных</span><br>
                        print(<span class="sql-string">"Размер данных:"</span>, df.shape)<br>
                        print(<span class="sql-string">"\nПервые 5 строк:"</span>)<br>
                        print(df.head())<br><br>

                        <span class="sql-comment"># Проверка пропущенных значений</span><br>
                        print(<span class="sql-string">"\nПропущенные значения:"</span>)<br>
                        print(df.isnull().sum())<br><br>

                        <span class="sql-comment"># Целевая переменная - default payment next month</span><br>
                        target_column = <span class="sql-string">'default payment next month'</span><br>
                        print(<span class="sql-string">f"\nРаспределение целевой переменной
                            ({target_column}):"</span>)<br>
                        print(df[target_column].value_counts(normalize=<span class="sql-keyword">True</span>))<br><br>

                        <span class="sql-comment"># Визуализация распределения целевой переменной</span><br>
                        plt.figure(figsize=(<span class="sql-keyword">8</span>, <span class="sql-keyword">6</span>))<br>
                        df[target_column].value_counts().plot(kind=<span class="sql-string">'bar'</span>)<br>
                        plt.title(<span class="sql-string">'Распределение дефолта по клиентам'</span>)<br>
                        plt.xlabel(<span class="sql-string">'Дефолт (0-нет, 1-да)'</span>)<br>
                        plt.ylabel(<span class="sql-string">'Количество клиентов'</span>)<br>
                        plt.xticks(rotation=<span class="sql-keyword">0</span>)<br>
                        plt.show()<br><br>

                        <span class="sql-comment"># Анализ демографических характеристик</span><br>
                        print(<span class="sql-string">"\n=== ДЕМОГРАФИЧЕСКИЙ АНАЛИЗ ==="</span>)<br><br>

                        <span class="sql-comment"># Пол (SEX: 1-муж, 2-жен)</span><br>
                        print(<span class="sql-string">"\nРаспределение по полу:"</span>)<br>
                        print(df[<span class="sql-string">'SEX'</span>].value_counts())<br><br>

                        <span class="sql-comment"># Образование (EDUCATION: 1-аспирант, 2-университет, 3-школа,
                            4-другое)</span><br>
                        print(<span class="sql-string">"\nРаспределение по образованию:"</span>)<br>
                        print(df[<span class="sql-string">'EDUCATION'</span>].value_counts().sort_index())<br><br>

                        <span class="sql-comment"># Анализ кредитного лимита</span><br>
                        print(<span class="sql-string">f"\nСтатистики по кредитному лимиту:"</span>)<br>
                        print(<span class="sql-string">f"Средний лимит: {df['LIMIT_BAL'].mean():.0f}"</span>)<br>
                        print(<span class="sql-string">f"Медианный лимит:
                            {df['LIMIT_BAL'].median():.0f}"</span>)<br><br>

                        <span class="sql-comment"># Визуализация кредитного лимита</span><br>
                        plt.figure(figsize=(<span class="sql-keyword">12</span>, <span
                            class="sql-keyword">5</span>))<br><br>

                        plt.subplot(<span class="sql-keyword">1</span>, <span class="sql-keyword">2</span>, <span
                            class="sql-keyword">1</span>)<br>
                        plt.hist(df[<span class="sql-string">'LIMIT_BAL'</span>], bins=<span
                            class="sql-keyword">50</span>, edgecolor=<span class="sql-string">'black'</span>,
                        alpha=<span class="sql-keyword">0.7</span>)<br>
                        plt.title(<span class="sql-string">'Распределение кредитного лимита'</span>)<br>
                        plt.xlabel(<span class="sql-string">'Лимит баланса'</span>)<br>
                        plt.ylabel(<span class="sql-string">'Частота'</span>)<br><br>

                        plt.subplot(<span class="sql-keyword">1</span>, <span class="sql-keyword">2</span>, <span
                            class="sql-keyword">2</span>)<br>
                        df.groupby(target_column)[<span class="sql-string">'LIMIT_BAL'</span>].mean().plot(kind=<span
                            class="sql-string">'bar'</span>)<br>
                        plt.title(<span class="sql-string">'Средний лимит по дефолту'</span>)<br>
                        plt.xlabel(<span class="sql-string">'Дефолт'</span>)<br>
                        plt.ylabel(<span class="sql-string">'Средний лимит'</span>)<br>
                        plt.xticks(rotation=<span class="sql-keyword">0</span>)<br><br>

                        plt.tight_layout()<br>
                        plt.show()<br><br>

                        <span class="sql-comment"># Анализ платежного поведения</span><br>
                        pay_columns = [<span class="sql-string">f'PAY_{i}'</span> <span class="sql-keyword">for</span> i
                        <span class="sql-keyword">in</span> range(<span class="sql-keyword">1</span>, <span
                            class="sql-keyword">7</span>)]<br>
                        print(<span class="sql-string">f"\n=== АНАЛИЗ ПЛАТЕЖНОГО ПОВЕДЕНИЯ ==="</span>)<br><br>

                        <span class="sql-comment"># Преобразуем PAY_1 в числовой формат если нужно</span><br>
                        <span class="sql-keyword">if</span> df[<span class="sql-string">'PAY_1'</span>].dtype == <span
                            class="sql-string">'object'</span>:<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;df[<span class="sql-string">'PAY_1'</span>] = pd.to_numeric(df[<span
                            class="sql-string">'PAY_1'</span>], errors=<span class="sql-string">'coerce'</span>)<br><br>

                        <span class="sql-comment"># Корреляционный анализ с целевой переменной</span><br>
                        print(<span class="sql-string">f"\n=== КОРРЕЛЯЦИЯ С ЦЕЛЕВОЙ ПЕРЕМЕННОЙ ==="</span>)<br>
                        numeric_columns = df.select_dtypes(include=[np.number]).columns<br><br>

                        <span class="sql-comment"># Убираем ID и саму целевую переменную из анализа
                            корреляции</span><br>
                        cols_to_exclude = [<span class="sql-string">'ID'</span>, target_column]<br>
                        analysis_columns = [col <span class="sql-keyword">for</span> col <span
                            class="sql-keyword">in</span> numeric_columns <span class="sql-keyword">if</span> col <span
                            class="sql-keyword">not in</span> cols_to_exclude]<br><br>

                        correlations = []<br>
                        <span class="sql-keyword">for</span> col <span class="sql-keyword">in</span>
                        analysis_columns:<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;corr = df[col].corr(df[target_column])<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;correlations.append((col, corr))<br><br>

                        <span class="sql-comment"># Сортируем по абсолютному значению корреляции</span><br>
                        correlations.sort(key=<span class="sql-keyword">lambda</span> x: abs(x[<span
                            class="sql-keyword">1</span>]), reverse=<span class="sql-keyword">True</span>)<br><br>

                        print(<span class="sql-string">"Топ-10 признаков по корреляции с дефолтом:"</span>)<br>
                        <span class="sql-keyword">for</span> col, corr <span class="sql-keyword">in</span>
                        correlations[:<span class="sql-keyword">10</span>]:<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;print(<span class="sql-string">f"{col}: {corr:.3f}"</span>)<br><br>

                        <span class="sql-comment"># Визуализация возраста</span><br>
                        plt.figure(figsize=(<span class="sql-keyword">12</span>, <span
                            class="sql-keyword">5</span>))<br><br>

                        plt.subplot(<span class="sql-keyword">1</span>, <span class="sql-keyword">2</span>, <span
                            class="sql-keyword">1</span>)<br>
                        plt.hist(df[<span class="sql-string">'AGE'</span>], bins=<span class="sql-keyword">30</span>,
                        edgecolor=<span class="sql-string">'black'</span>, alpha=<span
                            class="sql-keyword">0.7</span>)<br>
                        plt.title(<span class="sql-string">'Распределение возраста клиентов'</span>)<br>
                        plt.xlabel(<span class="sql-string">'Возраст'</span>)<br>
                        plt.ylabel(<span class="sql-string">'Количество клиентов'</span>)<br><br>

                        plt.subplot(<span class="sql-keyword">1</span>, <span class="sql-keyword">2</span>, <span
                            class="sql-keyword">2</span>)<br>
                        df.groupby(target_column)[<span class="sql-string">'AGE'</span>].mean().plot(kind=<span
                            class="sql-string">'bar'</span>)<br>
                        plt.title(<span class="sql-string">'Средний возраст по дефолту'</span>)<br>
                        plt.xlabel(<span class="sql-string">'Дефолт'</span>)<br>
                        plt.ylabel(<span class="sql-string">'Средний возраст'</span>)<br>
                        plt.xticks(rotation=<span class="sql-keyword">0</span>)<br><br>

                        plt.tight_layout()<br>
                        plt.show()<br><br>

                        <span class="sql-comment"># Анализ дефолта по категориям</span><br>
                        print(<span class="sql-string">f"\n=== АНАЛИЗ ДЕФОЛТА ПО КАТЕГОРИЯМ ==="</span>)<br>
                        categorical_cols = [<span class="sql-string">'SEX'</span>, <span
                            class="sql-string">'EDUCATION'</span>, <span class="sql-string">'MARRIAGE'</span>]<br><br>

                        <span class="sql-keyword">for</span> col <span class="sql-keyword">in</span>
                        categorical_cols:<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;<span class="sql-keyword">if</span> col <span
                            class="sql-keyword">in</span> df.columns:<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;default_rate =
                        df.groupby(col)[target_column].mean()<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print(<span class="sql-string">f"\nУровень
                            дефолта по {col}:"</span>)<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sql-keyword">for</span> category,
                        rate <span class="sql-keyword">in</span> default_rate.items():<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print(<span
                            class="sql-string">f" Категория {category}: {rate:.3f} ({rate*100:.1f}%)"</span>)<br>
                    </div>

                </div>
            </div>


            <!-- Карточка 7: Обновление данных -->
            <div class="card mx-auto" style="max-width: 800px; margin: 10px">
                <img src="../h1title7.jpg" class="card-img-top" alt="Обновление данных">
                <div class="card-body">
                    <h3>Комплексный пример Анализ оценок студентов</h3>

                    <div class="alert alert-danger" role="alert">
                        В JupyterLite используем виртуальную базу данных в памяти, чтобы не зависала от операций чтения
                        и записи в файл!<br>
                        Это создаёт временную базу данных, которая существует, пока программа выполняется, и все данные
                        ТЕРЯЮТСЯ после её завершения.<br>
                    </div>

                    <p class="card-text">sqlite3, faker, pandas, seaborn, matplotlib</p>
                    <div class="code-block">
                        <span class="sql-keyword">import</span> piplite<br>
                        <span class="sql-keyword">import</span> micropip<br><br>

                        <span class="sql-comment"># Установка зависимостей</span><br>
                        <span class="sql-keyword">await</span> micropip.install(<span
                            class="sql-string">"faker"</span>)<br>
                        <span class="sql-keyword">await</span> micropip.install(<span
                            class="sql-string">"seaborn"</span>)<br><br>

                        <span class="sql-comment"># Теперь импортируем все остальное</span><br>
                        <span class="sql-keyword">import</span> sqlite3<br>
                        <span class="sql-keyword">import</span> matplotlib.pyplot <span class="sql-keyword">as</span>
                        plt<br>
                        <span class="sql-keyword">import</span> pandas <span class="sql-keyword">as</span> pd<br>
                        <span class="sql-keyword">from</span> faker <span class="sql-keyword">import</span> Faker<br>
                        <span class="sql-keyword">import</span> seaborn <span class="sql-keyword">as</span> sns<br><br>

                        <span class="sql-comment"># Инициализация Faker</span><br>
                        fake_eng = Faker(<span class="sql-string">'en_US'</span>)<br>
                        fake_ru = Faker(<span class="sql-string">'ru_RU'</span>)<br><br>

                        print(<span class="sql-string">"Все пакеты успешно загружены!"</span>)<br><br>

                        <span class="sql-comment"># Подключение к базе данных</span><br>
                        <span class="sql-comment"># connection = sqlite3.connect(<span
                                class="sql-string">'students.db'</span>) ИЛИ</span>
                        <br>
                        connection = sqlite3.connect(':memory:')<br><br>

                        <span class="sql-comment"># Создание курсора для выполнения SQL-запросов</span><br>
                        cursor = connection.cursor()<br><br>

                        create_table_query = <span class="sql-string">'''</span><br>
                        <span class="sql-keyword">CREATE TABLE IF NOT EXISTS</span> students (<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;id <span class="sql-keyword">INTEGER PRIMARY KEY
                            AUTOINCREMENT</span>,<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;name <span class="sql-keyword">TEXT NOT NULL</span>,<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;age <span class="sql-keyword">INTEGER</span>,<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;grade <span class="sql-keyword">TEXT</span><br>
                        );<br>
                        <span class="sql-string">'''</span><br>
                        cursor.execute(create_table_query)<br>
                        connection.commit()<br><br>

                        cursor.execute(<span class="sql-string">"DELETE FROM students"</span>)<br>
                        connection.commit()<br><br>


                        <span class="sql-comment"># Insert a record into the Students table</span><br>
                        insert_query = <span class="sql-string">'''</span><br>
                        <span class="sql-keyword">INSERT INTO</span> students (name, age, grade)<br>
                        <span class="sql-keyword">VALUES</span> (?, ?, ?);<br>
                        <span class="sql-string">'''</span><br>
                        students_data = [<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;(<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fake_ru.name(),<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fake_ru.random_int(min=<span
                            class="sql-number">18</span>, max=<span class="sql-number">25</span>),<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fake_ru.random_element([<span
                            class="sql-string">"A"</span>, <span class="sql-string">"B"</span>, <span
                            class="sql-string">"C"</span>, <span class="sql-string">"D"</span>])<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;)<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;<span class="sql-keyword">for</span> _ <span
                            class="sql-keyword">in</span> range(<span class="sql-number">25</span>)]<br><br>

                        <span class="sql-comment"># Execute the query for multiple records</span><br>
                        cursor.executemany(insert_query, students_data)<br><br>

                        <span class="sql-comment"># Commit the changes</span><br>
                        connection.commit()<br><br>

                        <span class="sql-comment"># Print confirmation message</span><br>
                        print(<span class="sql-string">"Fake student records inserted successfully!"</span>)<br><br>

                        <span class="sql-comment"># Выбор всех записей</span><br>
                        cursor.execute(<span class="sql-string">"SELECT * FROM students"</span>)<br>
                        all_students = cursor.fetchall()<br><br>

                        <span class="sql-comment"># Вывод результатов</span><br>
                        <span class="sql-keyword">for</span> student <span class="sql-keyword">in</span>
                        all_students:<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;print(<span class="sql-string">f"ID: {student[0]}, Имя: {student[1]},
                            Возраст: {student[2]}, Оценка: {student[3]}"</span>)<br><br>

                        <span class="sql-comment"># Преобразуем данные в DataFrame</span><br>
                        df = pd.DataFrame(all_students, columns=[<span class="sql-string">'id'</span>, <span
                            class="sql-string">'name'</span>, <span class="sql-string">'age'</span>, <span
                            class="sql-string">'grade'</span>])<br>
                        df[<span class="sql-string">'grade'</span>] = pd.Categorical(df[<span
                            class="sql-string">'grade'</span>], categories=[<span class="sql-string">'A'</span>, <span
                            class="sql-string">'B'</span>, <span class="sql-string">'C'</span>, <span
                            class="sql-string">'D'</span>])<br><br>

                        <span class="sql-comment"># Создаем subplot</span><br>
                        fig, axes = plt.subplots(<span class="sql-number">2</span>, <span class="sql-number">2</span>,
                        figsize=(<span class="sql-number">15</span>, <span class="sql-number">12</span>))<br><br>

                        <span class="sql-comment"># 1. Распределение возрастов</span><br>
                        sns.histplot(data=df, x=<span class="sql-string">'age'</span>, bins=<span
                            class="sql-number">8</span>, ax=axes[<span class="sql-number">0</span>,<span
                            class="sql-number">0</span>])<br>
                        axes[<span class="sql-number">0</span>,<span class="sql-number">0</span>].set_title(<span
                            class="sql-string">'Распределение возрастов студентов'</span>)<br><br>

                        <span class="sql-comment"># 2. Распределение оценок</span><br>
                        sns.countplot(data=df, x=<span class="sql-string">'grade'</span>, ax=axes[<span
                            class="sql-number">0</span>,<span class="sql-number">1</span>])<br>
                        axes[<span class="sql-number">0</span>,<span class="sql-number">1</span>].set_title(<span
                            class="sql-string">'Распределение оценок'</span>)<br><br>

                        <span class="sql-comment"># 3. Boxplot возрастов по оценкам</span><br>
                        sns.boxplot(data=df, x=<span class="sql-string">'grade'</span>, y=<span
                            class="sql-string">'age'</span>, ax=axes[<span class="sql-number">1</span>,<span
                            class="sql-number">0</span>])<br>
                        axes[<span class="sql-number">1</span>,<span class="sql-number">0</span>].set_title(<span
                            class="sql-string">'Возрастное распределение по оценкам'</span>)<br><br>

                        <span class="sql-comment"># 4. Violin plot</span><br>
                        sns.violinplot(data=df, y=<span class="sql-string">'age'</span>, ax=axes[<span
                            class="sql-number">1</span>,<span class="sql-number">1</span>])<br>
                        axes[<span class="sql-number">1</span>,<span class="sql-number">1</span>].set_title(<span
                            class="sql-string">'Распределение возрастов'</span>)<br><br>

                        plt.tight_layout()<br>
                        plt.show()<br><br>

                        <span class="sql-comment"># Не забудьте закрыть соединение после работы</span><br>
                        connection.close()<br>
                    </div>
                </div>
            </div>


            <!-- Карточка 7: Обновление данных -->
            <div class="card mx-auto" style="max-width: 800px; margin: 10px">
                <img src="../h1title16.jpg" class="card-img-top" alt="Обновление данных">
                <div class="card-body">
                    <h3>Комплексный пример Анализ эффективности рекламной кампании</h3>

                    <div class="alert alert-danger" role="alert">
                        Код генерирует реалистичные данные для анализа эффективности рекламной кампании и
                        записывает их в Excel файл с несколькими листами:<br>

                        Содержание данных:<br>

                        Основные метрики: клики, показы, конверсии, стоимость, доход<br>

                        Каналы: CPC, SEO, SMM, Email<br>

                        Демография: возраст, пол, регион, устройство<br>

                        Аналитика: CTR, ROI, conversion rate<br>

                        Excel файл содержит:<br>

                        Raw_Data - исходные данные<br>

                        Channel_Summary - сводка по каналам<br>

                        Demographic_Analysis - анализ по демографии<br>
                    </div>

                    <p class="card-text">sqlite3, faker, pandas, seaborn, matplotlib, numpy</p>


                    <div class="code-block">
                        <span class="sql-keyword">import</span> pandas <span class="sql-keyword">as</span> pd<br>
                        <span class="sql-keyword">import</span> matplotlib.pyplot <span class="sql-keyword">as</span>
                        plt<br>
                        <span class="sql-keyword">import</span> numpy <span class="sql-keyword">as</span> np<br>
                        <span class="sql-keyword">from</span> datetime <span class="sql-keyword">import</span> datetime,
                        timedelta<br>
                        <span class="sql-keyword">import</span> random<br><br>

                        <span class="sql-keyword">import</span> micropip<br>
                        <span class="sql-comment"># Установка зависимостей</span><br>
                        <span class="sql-keyword">await</span> micropip.install(<span
                            class="sql-string">"faker"</span>)<br>
                        <span class="sql-keyword">await</span> micropip.install(<span
                            class="sql-string">"openpyxl"</span>)<br><br>

                        <span class="sql-keyword">from</span> faker <span class="sql-keyword">import</span>
                        Faker<br><br>

                        <span class="sql-comment"># Инициализация Faker</span><br>
                        fake = Faker(<span class="sql-string">'ru_RU'</span>)<br><br>

                        <span class="sql-comment"># Генерация данных для анализа эффективности рекламной
                            кампании</span><br>
                        np.random.seed(<span class="sql-keyword">42</span>)<br>
                        random.seed(<span class="sql-keyword">42</span>)<br><br>

                        <span class="sql-comment"># Создаем датафрейм с данными</span><br>
                        n_records = <span class="sql-keyword">1000</span><br>
                        data = []<br><br>

                        <span class="sql-keyword">for</span> i <span class="sql-keyword">in</span> range(n_records):<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;campaign_id = random.choice([<span class="sql-string">'CPC_001'</span>,
                        <span class="sql-string">'CPC_002'</span>, <span class="sql-string">'SEO_001'</span>, <span
                            class="sql-string">'SMM_001'</span>, <span class="sql-string">'Email_001'</span>])<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;channel = campaign_id.split(<span class="sql-string">'_'</span>)[<span
                            class="sql-keyword">0</span>]<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;date = fake.date_between(start_date=<span
                            class="sql-string">'-30d'</span>, end_date=<span class="sql-string">'today'</span>)<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;clicks = np.random.poisson(<span class="sql-keyword">50</span>)<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;impressions = clicks + np.random.randint(<span
                            class="sql-keyword">100</span>, <span class="sql-keyword">500</span>)<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;ctr = clicks / impressions<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;conversions = np.random.binomial(clicks, <span
                            class="sql-keyword">0.03</span>)<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;conversion_rate = conversions / clicks <span
                            class="sql-keyword">if</span> clicks > <span class="sql-keyword">0</span> <span
                            class="sql-keyword">else</span> <span class="sql-keyword">0</span><br>
                        &nbsp;&nbsp;&nbsp;&nbsp;cost = clicks * random.uniform(<span class="sql-keyword">0.5</span>,
                        <span class="sql-keyword">2.5</span>)<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;revenue = conversions * random.uniform(<span
                            class="sql-keyword">50</span>, <span class="sql-keyword">200</span>)<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;roi = (revenue - cost) / cost <span class="sql-keyword">if</span> cost >
                        <span class="sql-keyword">0</span> <span class="sql-keyword">else</span> <span
                            class="sql-keyword">0</span><br>
                        &nbsp;&nbsp;&nbsp;&nbsp;device = random.choice([<span class="sql-string">'Mobile'</span>, <span
                            class="sql-string">'Desktop'</span>, <span class="sql-string">'Tablet'</span>])<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;region = fake.region()<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;age_group = random.choice([<span class="sql-string">'18-24'</span>,
                        <span class="sql-string">'25-34'</span>, <span class="sql-string">'35-44'</span>, <span
                            class="sql-string">'45-54'</span>, <span class="sql-string">'55+'</span>])<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;gender = random.choice([<span class="sql-string">'Male'</span>, <span
                            class="sql-string">'Female'</span>])<br><br>

                        &nbsp;&nbsp;&nbsp;&nbsp;data.append({<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sql-string">'campaign_id'</span>:
                        campaign_id,<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sql-string">'channel'</span>:
                        channel,<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sql-string">'date'</span>:
                        date,<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sql-string">'clicks'</span>:
                        clicks,<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sql-string">'impressions'</span>:
                        impressions,<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sql-string">'ctr'</span>:
                        round(ctr, <span class="sql-keyword">4</span>),<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sql-string">'conversions'</span>:
                        conversions,<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span
                            class="sql-string">'conversion_rate'</span>: round(conversion_rate, <span
                            class="sql-keyword">4</span>),<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sql-string">'cost'</span>:
                        round(cost, <span class="sql-keyword">2</span>),<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sql-string">'revenue'</span>:
                        round(revenue, <span class="sql-keyword">2</span>),<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sql-string">'roi'</span>:
                        round(roi, <span class="sql-keyword">4</span>),<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sql-string">'device'</span>:
                        device,<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sql-string">'region'</span>:
                        region,<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sql-string">'age_group'</span>:
                        age_group,<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sql-string">'gender'</span>:
                        gender<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;})<br><br>

                        <span class="sql-comment"># Создаем DataFrame</span><br>
                        df_ads = pd.DataFrame(data)<br><br>

                        <span class="sql-comment"># Просмотр сгенерированных данных</span><br>
                        print(<span class="sql-string">"Размер данных рекламной кампании:"</span>, df_ads.shape)<br>
                        print(<span class="sql-string">"\nПервые 5 строк:"</span>)<br>
                        print(df_ads.head())<br><br>

                        print(<span class="sql-string">"\nОсновные статистики:"</span>)<br>
                        print(df_ads.describe())<br><br>

                        <span class="sql-comment"># Анализ эффективности по каналам</span><br>
                        print(<span class="sql-string">"\n=== АНАЛИЗ ЭФФЕКТИВНОСТИ ПО КАНАЛАМ ==="</span>)<br>
                        channel_stats = df_ads.groupby(<span class="sql-string">'channel'</span>).agg({<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;<span class="sql-string">'clicks'</span>: <span
                            class="sql-string">'sum'</span>,<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;<span class="sql-string">'conversions'</span>: <span
                            class="sql-string">'sum'</span>,<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;<span class="sql-string">'cost'</span>: <span
                            class="sql-string">'sum'</span>,<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;<span class="sql-string">'revenue'</span>: <span
                            class="sql-string">'sum'</span>,<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;<span class="sql-string">'ctr'</span>: <span
                            class="sql-string">'mean'</span>,<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;<span class="sql-string">'conversion_rate'</span>: <span
                            class="sql-string">'mean'</span><br>
                        &nbsp;&nbsp;&nbsp;&nbsp;}).round(<span class="sql-keyword">2</span>)<br><br>

                        channel_stats[<span class="sql-string">'roi_total'</span>] = (channel_stats[<span
                            class="sql-string">'revenue'</span>] - channel_stats[<span
                            class="sql-string">'cost'</span>]) / channel_stats[<span
                            class="sql-string">'cost'</span>]<br>
                        print(channel_stats)<br><br>

                        <span class="sql-comment"># Запись данных в Excel файл</span><br>
                        output_file = <span class="sql-string">'ad_campaign_analysis.xlsx'</span><br><br>

                        <span class="sql-keyword">with</span> pd.ExcelWriter(output_file, engine=<span
                            class="sql-string">'openpyxl'</span>) <span class="sql-keyword">as</span> writer:<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;<span class="sql-comment"># Основные данные</span><br>
                        &nbsp;&nbsp;&nbsp;&nbsp;df_ads.to_excel(writer, sheet_name=<span
                            class="sql-string">'Raw_Data'</span>, index=<span class="sql-keyword">False</span>)<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;<span class="sql-comment"># Сводная таблица по каналам</span><br>
                        &nbsp;&nbsp;&nbsp;&nbsp;channel_summary = df_ads.groupby(<span
                            class="sql-string">'channel'</span>).agg({<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sql-string">'clicks'</span>: <span
                            class="sql-string">'sum'</span>,<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sql-string">'conversions'</span>:
                        <span class="sql-string">'sum'</span>,<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sql-string">'cost'</span>: <span
                            class="sql-string">'sum'</span>,<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sql-string">'revenue'</span>: <span
                            class="sql-string">'sum'</span><br>
                        &nbsp;&nbsp;&nbsp;&nbsp;}).reset_index()<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;channel_summary[<span class="sql-string">'profit'</span>] =
                        channel_summary[<span class="sql-string">'revenue'</span>] - channel_summary[<span
                            class="sql-string">'cost'</span>]<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;channel_summary[<span class="sql-string">'roi'</span>] =
                        (channel_summary[<span class="sql-string">'profit'</span>] / channel_summary[<span
                            class="sql-string">'cost'</span>]).round(<span class="sql-keyword">4</span>)<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;channel_summary.to_excel(writer, sheet_name=<span
                            class="sql-string">'Channel_Summary'</span>, index=<span
                            class="sql-keyword">False</span>)<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;<span class="sql-comment"># Анализ по демографии</span><br>
                        &nbsp;&nbsp;&nbsp;&nbsp;demo_analysis = df_ads.groupby([<span
                            class="sql-string">'age_group'</span>, <span class="sql-string">'gender'</span>]).agg({<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sql-string">'conversions'</span>:
                        <span class="sql-string">'sum'</span>,<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="sql-string">'clicks'</span>: <span
                            class="sql-string">'sum'</span>,<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span
                            class="sql-string">'conversion_rate'</span>: <span class="sql-string">'mean'</span><br>
                        &nbsp;&nbsp;&nbsp;&nbsp;}).round(<span class="sql-keyword">4</span>).reset_index()<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;demo_analysis.to_excel(writer, sheet_name=<span
                            class="sql-string">'Demographic_Analysis'</span>, index=<span
                            class="sql-keyword">False</span>)<br><br>

                        print(<span class="sql-string">f"\n✅ Данные успешно записаны в файл: {output_file}"</span>)<br>
                        print(<span class="sql-string">"Листы в файле:"</span>)<br>
                        print(<span class="sql-string">"- Raw_Data: исходные данные"</span>)<br>
                        print(<span class="sql-string">"- Channel_Summary: сводка по каналам"</span>)<br>
                        print(<span class="sql-string">"- Demographic_Analysis: анализ по демографии"</span>)<br><br>

                        <span class="sql-comment"># Визуализация результатов</span><br>
                        plt.figure(figsize=(<span class="sql-keyword">15</span>, <span
                            class="sql-keyword">10</span>))<br><br>

                        plt.subplot(<span class="sql-keyword">2</span>, <span class="sql-keyword">2</span>, <span
                            class="sql-keyword">1</span>)<br>
                        df_ads.groupby(<span class="sql-string">'channel'</span>)[<span
                            class="sql-string">'conversions'</span>].sum().plot(kind=<span
                            class="sql-string">'bar'</span>)<br>
                        plt.title(<span class="sql-string">'Конверсии по каналам'</span>)<br>
                        plt.ylabel(<span class="sql-string">'Количество конверсий'</span>)<br><br>

                        plt.subplot(<span class="sql-keyword">2</span>, <span class="sql-keyword">2</span>, <span
                            class="sql-keyword">2</span>)<br>
                        df_ads.groupby(<span class="sql-string">'channel'</span>)[<span
                            class="sql-string">'roi'</span>].mean().plot(kind=<span class="sql-string">'bar'</span>)<br>
                        plt.title(<span class="sql-string">'ROI по каналам'</span>)<br>
                        plt.ylabel(<span class="sql-string">'ROI'</span>)<br><br>

                        plt.subplot(<span class="sql-keyword">2</span>, <span class="sql-keyword">2</span>, <span
                            class="sql-keyword">3</span>)<br>
                        df_ads.groupby(<span class="sql-string">'device'</span>)[<span
                            class="sql-string">'conversions'</span>].sum().plot(kind=<span
                            class="sql-string">'pie'</span>, autopct=<span class="sql-string">'%1.1f%%'</span>)<br>
                        plt.title(<span class="sql-string">'Распределение конверсий по устройствам'</span>)<br><br>

                        plt.subplot(<span class="sql-keyword">2</span>, <span class="sql-keyword">2</span>, <span
                            class="sql-keyword">4</span>)<br>
                        df_ads.groupby(<span class="sql-string">'age_group'</span>)[<span
                            class="sql-string">'conversion_rate'</span>].mean().plot(kind=<span
                            class="sql-string">'bar'</span>)<br>
                        plt.title(<span class="sql-string">'Конверсия по возрастным группам'</span>)<br>
                        plt.ylabel(<span class="sql-string">'Conversion Rate'</span>)<br><br>

                        plt.tight_layout()<br>
                        plt.show()<br>
                    </div>
                </div>
            </div>


            <!-- Карточка 6: SQL JOIN операции -->
            <div class="card mx-auto" style="max-width: 800px; margin: 10px">
                <img src="../h1title12.jpg" class="card-img-top" alt="SQL JOIN операции">
                <div class="card-body">
                    <h3>Операции соединения таблиц в реляционных базах данных</h3>
                    <p class="card-text">
                        Реляционные базы данных нужны для структурированного и надежного хранения больших объемов данных
                        за счет их организации в виде таблиц со связями между ними. Они обеспечивают целостность данных,
                        предотвращая дублирование и ошибки, а также позволяют эффективно выполнять сложные запросы,
                        например, в банковских системах, управлении предприятием и онлайн-торговле.
                    </p>

                    <p class="card-text">
                        Связи между таблицами (первичные и внешние ключи) и ограничения (например, NOT NULL, UNIQUE)
                        гарантируют точность и согласованность данных, предотвращая потерю информации или ввод
                        некорректных значений.
                    </p>

                    <div class="alert alert-primary m-5" role="alert">
                        Первичный ключ — это идентификатор для каждой записи, например, ID покупателя в таблице
                        «Клиенты». Он гарантирует, что строки не повторяются. Внешний ключ — столбец или набор столбцов,
                        который ссылается на первичный ключ в другой таблице. Внешние ключи устанавливают связи между
                        таблицами и гарантируют целостность данных.
                    </div>


                    <p class="card-text">Использование нормализации уменьшает избыточность данных и снижает риск ошибок.
                    </p>


                    <div class="alert alert-dark m-5" role="alert">


                        MySQL — СУБД, полностью соответствующая стандартам SQL. Поддерживает транзакционную целостность,
                        защиту данных, репликацию и хранимые процедуры — заранее сохраненные на сервере наборы
                        SQL-команд для автоматизации операций. Преимущества MySQL в высокой производительности и
                        масштабируемости.<br><br>

                        PostgreSQL — мощная БД, которая работает с текстом, числами, форматами JSON, XML и уникальными
                        данными, например, геометрическими фигурами. Позволяет создавать собственные типы данных, что
                        делает ее еще более гибкой. <br><br>

                        SQLite встраивается в приложения, поэтому считается легкой и удобной для разных платформ,
                        включая браузеры Google Chrome и Mozilla Firefox. Но возможности этой БД ограничены: сложно
                        менять структуру таблиц, а также есть лимиты на количество столбцов (32 000) и объем базы (140
                        терабайт).<br><br>

                        Oracle Database эффективно обрабатывает большие объемы данных, поэтому ее часто выбирают для
                        сложных корпоративных задач. Разработчики ценят Oracle Database за удобство, инструменты, четкую
                        документацию, поддержку функций (JSON, длинные имена, списки) и интеграцию с облачными
                        сервисами. <br><br>

                        Microsoft SQL Server — популярная коммерческая СУБД с бесплатной версией Express для начинающих.
                        Поддерживает SQL, непроцедурные языки, нечувствительные к регистру команды и стандартные языки
                        для работы с БД.<br><br>
                    </div>

                    <img src="https://thecode.media/wp-content/uploads/2021/09/ssd1_iiw.png"
                        style="filter: grayscale(100%);" alt="...">

                    <div class="alert alert-primary">
                        <h4>ЧТО ДЕЛАЕТ ЭТОТ ЗАПРОС?</h4>
                        SELECT<br>
                        c.customer_name,<br>
                        COUNT(o.order_id) AS total_orders,<br>
                        SUM(o.order_total) AS total_spent<br>
                        FROM<br>
                        customers c<br>
                        JOIN<br>
                        orders o ON c.customer_id = o.customer_id<br>
                        WHERE<br>
                        c.country = 'USA' AND o.order_date >= '2024-01-01'<br>
                        GROUP BY<br>
                        c.customer_id, c.customer_name<br>
                        HAVING<br>
                        SUM(o.order_total) > 1000<br>
                        ORDER BY<br>
                        total_spent DESC<br>
                        LIMIT 10;<br>
                    </div>



                    <div class="code-block">
                        <span class="sql-keyword">SELECT</span> * <span class="sql-keyword">FROM</span> TableA A<br>
                        <span class="sql-keyword">LEFT JOIN</span> TableB B <span class="sql-keyword">ON</span> A.id =
                        B.a_id<br>
                        <span class="sql-keyword">WHERE</span> B.a_id <span class="sql-keyword">IS NULL</span>;
                    </div>

                    <div class="row">
                        <div class="col-md-6">
                            <p><strong>Типы JOIN:</strong></p>
                            <ul>
                                <li><strong>INNER JOIN:</strong> Только совпадающие строки</li>
                                <li><strong>LEFT JOIN:</strong> Все строки из левой таблицы</li>
                                <li><strong>RIGHT JOIN:</strong> Все строки из правой таблицы</li>
                                <li><strong>FULL OUTER JOIN:</strong> Все строки из обеих таблиц</li>
                                <li><strong>CROSS JOIN:</strong> Декартово произведение</li>
                            </ul>
                        </div>
                        <div class="col-md-6">
                            <p><strong>Практическое применение:</strong></p>
                            <ul>
                                <li>Поиск отсутствующих записей</li>
                                <li>Анализ связей между данными</li>
                                <li>Объединение информации из разных таблиц</li>
                                <li>Создание отчетов и аналитики</li>
                                <li>Очистка данных</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>


            <!-- Карточка 8: Удаление данных -->
            <div class="card mx-auto" style="max-width: 800px; margin: 10px">
                <img src="../h1title8.jpg" class="card-img-top" alt="Удаление данных">
                <div class="card-body">

                    <div class="alert alert-dark" role="alert">
                        В JupyterLite используем виртуальную базу данных в памяти, чтобы не зависала от операций чтения
                        и записи в файл!<br>
                        Это создаёт временную базу данных, которая существует, пока программа выполняется, и все данные
                        ТЕРЯЮТСЯ после её завершения.<br>
                    </div>

                    .

                    <h3>Связанные таблицы JOIN LEFT</h3>
                    <p class="card-text">JOIN LEFT - Ищем пациентов, у которых никогда не было сессий</p>

                    <div class="container-fluid">
                        <div class="row">
                            <div class="col-md-6">
                                <h6 class="text-primary">Таблица Пациенты:</h6>
                                <table class="table table-sm table-bordered">
                                    <thead class="thead-light">
                                        <tr>
                                            <th class="p-1">id</th>
                                            <th class="p-1">имя</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td class="p-1"><small>1</small></td>
                                            <td class="p-1"><small>Анна</small></td>
                                        </tr>
                                        <tr>
                                            <td class="p-1"><small>2</small></td>
                                            <td class="p-1"><small>Борис</small></td>
                                        </tr>
                                        <tr>
                                            <td class="p-1"><small>3</small></td>
                                            <td class="p-1"><small>Виктор</small></td>
                                        </tr>
                                        <tr>
                                            <td class="p-1"><small>4</small></td>
                                            <td class="p-1"><small>Дарья</small></td>
                                        </tr>
                                        <tr>
                                            <td class="p-1"><small>5</small></td>
                                            <td class="p-1"><small>Елена</small></td>
                                        </tr>
                                        <tr>
                                            <td class="p-1"><small>6</small></td>
                                            <td class="p-1"><small>Сергей</small></td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                            <div class="col-md-6">
                                <h6 class="text-primary">Таблица Сессии:</h6>
                                <table class="table table-sm table-bordered">
                                    <thead class="thead-light">
                                        <tr>
                                            <th class="p-1">id</th>
                                            <th class="p-1">patient_id</th>
                                            <th class="p-1">дата</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td class="p-1"><small>1</small></td>
                                            <td class="p-1"><small>1</small></td>
                                            <td class="p-1"><small>2024-01-10</small></td>
                                        </tr>
                                        <tr>
                                            <td class="p-1"><small>2</small></td>
                                            <td class="p-1"><small>1</small></td>
                                            <td class="p-1"><small>2024-01-17</small></td>
                                        </tr>
                                        <tr>
                                            <td class="p-1"><small>3</small></td>
                                            <td class="p-1"><small>3</small></td>
                                            <td class="p-1"><small>2024-01-15</small></td>
                                        </tr>
                                        <tr>
                                            <td class="p-1"><small>4</small></td>
                                            <td class="p-1"><small>5</small></td>
                                            <td class="p-1"><small>2024-01-20</small></td>
                                        </tr>
                                        <tr>
                                            <td class="p-1"><small>5</small></td>
                                            <td class="p-1"><small>NULL</small></td>
                                            <td class="p-1"><small>2024-01-18</small></td>
                                        </tr>
                                        <tr>
                                            <td class="p-1"><small>6</small></td>
                                            <td class="p-1"><small>8</small></td>
                                            <td class="p-1"><small>2024-01-22</small></td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                        <div class="alert alert-info mt-3">
                            <strong>SQL запрос:</strong>
                            <pre class="bg-light p-3 border rounded mt-2"><code>SELECT Пациенты.id 
FROM Пациенты 
LEFT JOIN Сессии ON Пациенты.id = Сессии.patient_id 
WHERE Сессии.patient_id IS NULL</code></pre>
                        </div>
                        <p class="text-muted mb-0">Какие id пациентов будут в результате?</p>
                    </div>

                    <div class="code-block">
                        <span class="sql-keyword">import</span> sqlite3<br>
                        <span class="sql-keyword">import</span> pandas <span class="sql-keyword">as</span> pd<br><br>

                        <span class="sql-comment"># В JupyterLite используем виртуальную базу данных в памяти</span><br>
                        connection = sqlite3.connect(<span class="sql-string">':memory:'</span>)<br>
                        cursor = connection.cursor()<br>
                        print(<span class="sql-string">"✅ Создана база данных в памяти"</span>)<br><br>

                        <span class="sql-comment"># Создаем чистые таблицы отдельно</span><br>
                        cursor.execute(<span class="sql-string">'CREATE TABLE Пациенты (id INTEGER PRIMARY KEY, имя
                            TEXT)'</span>)<br>
                        cursor.execute(<span class="sql-string">'CREATE TABLE Сессии (id INTEGER PRIMARY KEY, patient_id
                            INTEGER, дата TEXT)'</span>)<br><br>

                        <span class="sql-comment"># Вставляем данные</span><br>
                        patients_data = [<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;(<span class="sql-keyword">1</span>, <span
                            class="sql-string">'Анна'</span>),<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;(<span class="sql-keyword">2</span>, <span
                            class="sql-string">'Борис'</span>),<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;(<span class="sql-keyword">3</span>, <span
                            class="sql-string">'Виктор'</span>),<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;(<span class="sql-keyword">4</span>, <span
                            class="sql-string">'Дарья'</span>),<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;(<span class="sql-keyword">5</span>, <span
                            class="sql-string">'Елена'</span>),<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;(<span class="sql-keyword">6</span>, <span
                            class="sql-string">'Сергей'</span>)<br>
                        ]<br><br>

                        sessions_data = [<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;(<span class="sql-keyword">1</span>, <span class="sql-keyword">1</span>,
                        <span class="sql-string">'2024-01-10'</span>),<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;(<span class="sql-keyword">2</span>, <span class="sql-keyword">1</span>,
                        <span class="sql-string">'2024-01-17'</span>),<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;(<span class="sql-keyword">3</span>, <span class="sql-keyword">3</span>,
                        <span class="sql-string">'2024-01-15'</span>),<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;(<span class="sql-keyword">4</span>, <span class="sql-keyword">5</span>,
                        <span class="sql-string">'2024-01-20'</span>),<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;(<span class="sql-keyword">5</span>, <span
                            class="sql-keyword">None</span>, <span class="sql-string">'2024-01-18'</span>),<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;(<span class="sql-keyword">6</span>, <span class="sql-keyword">8</span>,
                        <span class="sql-string">'2024-01-22'</span>)<br>
                        ]<br><br>

                        cursor.executemany(<span class="sql-string">"INSERT INTO Пациенты VALUES (?, ?)"</span>,
                        patients_data)<br>
                        cursor.executemany(<span class="sql-string">"INSERT INTO Сессии VALUES (?, ?, ?)"</span>,
                        sessions_data)<br>
                        connection.commit()<br><br>

                        <span class="sql-comment"># Выполняем исходный запрос</span><br>
                        original_query = <span class="sql-string">"""<br>
                            SELECT Пациенты.id, Пациенты.имя<br>
                            FROM Пациенты<br>
                            LEFT JOIN Сессии ON Пациенты.id = Сессии.patient_id<br>
                            WHERE Сессии.patient_id IS NULL<br>
                            """</span><br><br>

                        cursor.execute(original_query)<br>
                        result = cursor.fetchall()<br>
                        print(<span class="sql-string">"\nРезультат запроса:"</span>)<br>
                        <span class="sql-keyword">for</span> row <span class="sql-keyword">in</span> result:<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;print(<span class="sql-string">f"ID: {row[0]}, Имя:
                            {row[1]}"</span>)<br><br>

                        <span class="sql-comment"># Закрытие соединения</span><br>
                        connection.close()<br>
                    </div>
                </div>
            </div>



            <div class="card mx-auto" style="max-width: 800px; margin: 10px">
                <img src="../h1title8.jpg" class="card-img-top" alt="Удаление данных">
                <div class="card-body">
                    <h3>Связанные таблицы JOIN RIGHT</h3>
                    <p class="card-text">RIGHT JOIN возвращает все записи из правой таблицы (Тесты_результаты)
                        и соответствующие записи из левой таблицы (Студенты)</p>

                    <div class="container-fluid">
                        <div class="row">
                            <div class="col-md-6">
                                <h6 class="text-success">Таблица Студенты:</h6>
                                <table class="table table-sm table-bordered">
                                    <thead class="thead-light">
                                        <tr>
                                            <th class="p-1">id</th>
                                            <th class="p-1">имя</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td class="p-1"><small>1</small></td>
                                            <td class="p-1"><small>Ольга</small></td>
                                        </tr>
                                        <tr>
                                            <td class="p-1"><small>2</small></td>
                                            <td class="p-1"><small>Иван</small></td>
                                        </tr>
                                        <tr>
                                            <td class="p-1"><small>3</small></td>
                                            <td class="p-1"><small>Мария</small></td>
                                        </tr>
                                        <tr>
                                            <td class="p-1"><small>4</small></td>
                                            <td class="p-1"><small>Алексей</small></td>
                                        </tr>
                                        <tr>
                                            <td class="p-1"><small>5</small></td>
                                            <td class="p-1"><small>Наталья</small></td>
                                        </tr>
                                        <tr>
                                            <td class="p-1"><small>6</small></td>
                                            <td class="p-1"><small>Дмитрий</small></td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                            <div class="col-md-6">
                                <h6 class="text-success">Таблица Тесты_результаты:</h6>
                                <table class="table table-sm table-bordered">
                                    <thead class="thead-light">
                                        <tr>
                                            <th class="p-1">id</th>
                                            <th class="p-1">student_id</th>
                                            <th class="p-1">тест</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td class="p-1"><small>1</small></td>
                                            <td class="p-1"><small>1</small></td>
                                            <td class="p-1"><small>MMPI</small></td>
                                        </tr>
                                        <tr>
                                            <td class="p-1"><small>2</small></td>
                                            <td class="p-1"><small>1</small></td>
                                            <td class="p-1"><small>16-факторов</small></td>
                                        </tr>
                                        <tr>
                                            <td class="p-1"><small>3</small></td>
                                            <td class="p-1"><small>2</small></td>
                                            <td class="p-1"><small>MMPI</small></td>
                                        </tr>
                                        <tr>
                                            <td class="p-1"><small>4</small></td>
                                            <td class="p-1"><small>4</small></td>
                                            <td class="p-1"><small>СМИЛ</small></td>
                                        </tr>
                                        <tr>
                                            <td class="p-1"><small>5</small></td>
                                            <td class="p-1"><small>NULL</small></td>
                                            <td class="p-1"><small>Айзенк</small></td>
                                        </tr>
                                        <tr>
                                            <td class="p-1"><small>6</small></td>
                                            <td class="p-1"><small>7</small></td>
                                            <td class="p-1"><small>Кеттелл</small></td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                        <div class="alert alert-warning mt-3">
                            <strong>SQL запрос:</strong>
                            <pre class="bg-light p-3 border rounded mt-2"><code>SELECT Тесты_результаты.id 
FROM Студенты 
RIGHT JOIN Тесты_результаты ON Студенты.id = Тесты_результаты.student_id 
WHERE Студенты.id IS NOT NULL</code></pre>
                        </div>
                        <p class="text-muted mb-0">Какие id из Тесты_результаты будут в результате?</p>
                    </div>



                    <div class="code-block">
                        <span class="sql-keyword">import</span> sqlite3<br>
                        <span class="sql-keyword">import</span> pandas <span class="sql-keyword">as</span> pd<br><br>

                        <span class="sql-comment"># Создаем базу данных в памяти</span><br>
                        connection = sqlite3.connect(<span class="sql-string">':memory:'</span>)<br>
                        cursor = connection.cursor()<br>
                        print(<span class="sql-string">"✅ Создана база данных в памяти"</span>)<br><br>

                        <span class="sql-comment"># Создаем таблицы</span><br>
                        cursor.execute(<span class="sql-string">'CREATE TABLE Студенты (id INTEGER PRIMARY KEY, имя
                            TEXT)'</span>)<br>
                        cursor.execute(<span class="sql-string">'CREATE TABLE Тесты_результаты (id INTEGER PRIMARY KEY,
                            student_id INTEGER, тест TEXT)'</span>)<br><br>

                        <span class="sql-comment"># Вставляем данные в таблицу Студенты</span><br>
                        students_data = [<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;(<span class="sql-keyword">1</span>, <span
                            class="sql-string">'Ольга'</span>),<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;(<span class="sql-keyword">2</span>, <span
                            class="sql-string">'Иван'</span>),<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;(<span class="sql-keyword">3</span>, <span
                            class="sql-string">'Мария'</span>),<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;(<span class="sql-keyword">4</span>, <span
                            class="sql-string">'Алексей'</span>),<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;(<span class="sql-keyword">5</span>, <span
                            class="sql-string">'Наталья'</span>),<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;(<span class="sql-keyword">6</span>, <span
                            class="sql-string">'Дмитрий'</span>)<br>
                        ]<br><br>

                        <span class="sql-comment"># Вставляем данные в таблицу Тесты_результаты</span><br>
                        tests_data = [<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;(<span class="sql-keyword">1</span>, <span class="sql-keyword">1</span>,
                        <span class="sql-string">'MMPI'</span>),<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;(<span class="sql-keyword">2</span>, <span class="sql-keyword">1</span>,
                        <span class="sql-string">'16-факторов'</span>),<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;(<span class="sql-keyword">3</span>, <span class="sql-keyword">2</span>,
                        <span class="sql-string">'MMPI'</span>),<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;(<span class="sql-keyword">4</span>, <span class="sql-keyword">4</span>,
                        <span class="sql-string">'СМИЛ'</span>),<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;(<span class="sql-keyword">5</span>, <span
                            class="sql-keyword">None</span>, <span class="sql-string">'Айзенк'</span>),<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;(<span class="sql-keyword">6</span>, <span class="sql-keyword">7</span>,
                        <span class="sql-string">'Кеттелл'</span>)<br>
                        ]<br><br>

                        cursor.executemany(<span class="sql-string">"INSERT INTO Студенты VALUES (?, ?)"</span>,
                        students_data)<br>
                        cursor.executemany(<span class="sql-string">"INSERT INTO Тесты_результаты VALUES (?, ?,
                            ?)"</span>, tests_data)<br>
                        connection.commit()<br><br>

                        <span class="sql-comment"># Выполняем SQL запрос</span><br>
                        query = <span class="sql-string">"""<br>
                            SELECT Тесты_результаты.id <br>
                            FROM Студенты <br>
                            RIGHT JOIN Тесты_результаты ON Студенты.id = Тесты_результаты.student_id <br>
                            WHERE Студенты.id IS NOT NULL<br>
                            """</span><br><br>

                        cursor.execute(query)<br>
                        result = cursor.fetchall()<br>
                        print(<span class="sql-string">"Результат запроса - id из Тесты_результаты:"</span>)<br>
                        <span class="sql-keyword">for</span> row <span class="sql-keyword">in</span> result:<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;print(<span class="sql-string">f"ID: {row[0]}"</span>)<br><br>

                        <span class="sql-comment"># Альтернативный вариант с pandas для наглядности</span><br>
                        print(<span class="sql-string">"\n📊 Полная информация о результате:"</span>)<br>
                        full_query = <span class="sql-string">"""<br>
                            SELECT Студенты.id as student_id, Студенты.имя, <br>
                            Тесты_результаты.id as test_id, Тесты_результаты.тест<br>
                            FROM Студенты <br>
                            RIGHT JOIN Тесты_результаты ON Студенты.id = Тесты_результаты.student_id <br>
                            WHERE Студенты.id IS NOT NULL<br>
                            """</span><br><br>

                        df = pd.read_sql_query(full_query, connection)<br>
                        print(df)<br><br>

                        <span class="sql-comment"># Закрытие соединения</span><br>
                        connection.close()<br>
                    </div>
                </div>
            </div>


            <div class="card mx-auto" style="max-width: 800px; margin: 10px">
                <img src="../h1title15.jpg" class="card-img-top" alt="Несколько таблиц">
                <div class="card-body">
                    <h3> Сгенереруйте Python код с Faker для всех тестов в нижней части страницы, содержащих SQL запрос
                        SELECT, JOIN </h3>
                    <p class="card-text">JOIN операции и связи между таблицами.</p>
                </div>
            </div>





            <!-- Карточка 9: Работа с несколькими таблицами -->
            <div class="card mx-auto" style="max-width: 800px; margin: 10px">
                <img src="../h1title9.jpg" class="card-img-top" alt="Несколько таблиц">
                <div class="card-body">
                    <h3>Работа с несколькими таблицами</h3>
                    <p class="card-text">JOIN операции и связи между таблицами.</p>
                    <div class="code-block">
                        <span class="sql-comment"># Создание связанных таблиц</span><br>
                        cursor.execute(<span class="sql-keyword">'''</span><br>
                        <span class="sql-keyword">CREATE TABLE</span> IF NOT EXISTS courses (<br>
                        id INTEGER <span class="sql-keyword">PRIMARY KEY</span>,<br>
                        course_name TEXT,<br>
                        instructor TEXT<br>
                        )<br>
                        <span class="sql-keyword">'''</span>)<br><br>

                        cursor.execute(<span class="sql-keyword">'''</span><br>
                        <span class="sql-keyword">CREATE TABLE</span> IF NOT EXISTS enrollments (<br>
                        student_id INTEGER,<br>
                        course_id INTEGER,<br>
                        enrollment_date TEXT,<br>
                        <span class="sql-keyword">FOREIGN KEY</span>(student_id) <span
                            class="sql-keyword">REFERENCES</span>
                        students(id),<br>
                        <span class="sql-keyword">FOREIGN KEY</span>(course_id) <span
                            class="sql-keyword">REFERENCES</span>
                        courses(id)<br>
                        )<br>
                        <span class="sql-keyword">'''</span>)<br><br>

                        <span class="sql-comment"># INNER JOIN - только совпадающие записи</span><br>
                        cursor.execute(<span class="sql-keyword">'''</span><br>
                        <span class="sql-keyword">SELECT</span> s.name, c.course_name, e.enrollment_date<br>
                        <span class="sql-keyword">FROM</span> students s<br>
                        <span class="sql-keyword">INNER JOIN</span> enrollments e <span class="sql-keyword">ON</span>
                        s.id =
                        e.student_id<br>
                        <span class="sql-keyword">INNER JOIN</span> courses c <span class="sql-keyword">ON</span>
                        e.course_id = c.id<br>
                        <span class="sql-keyword">'''</span>)<br>
                        join_results = cursor.fetchall()<br><br>

                        <span class="sql-comment"># LEFT JOIN - все записи из левой таблицы</span><br>
                        cursor.execute(<span class="sql-keyword">'''</span><br>
                        <span class="sql-keyword">SELECT</span> s.name, c.course_name<br>
                        <span class="sql-keyword">FROM</span> students s<br>
                        <span class="sql-keyword">LEFT JOIN</span> enrollments e <span class="sql-keyword">ON</span>
                        s.id =
                        e.student_id<br>
                        <span class="sql-keyword">LEFT JOIN</span> courses c <span class="sql-keyword">ON</span>
                        e.course_id
                        = c.id<br>
                        <span class="sql-keyword">'''</span>)<br>
                        left_join_results = cursor.fetchall()
                    </div>
                </div>
            </div>

            <!-- Карточка 10: Транзакции -->
            <div class="card mx-auto" style="max-width: 800px; margin: 10px">
                <img src="../h1title10.jpg" class="card-img-top" alt="Транзакции">
                <div class="card-body">
                    <h3>Транзакции</h3>
                    <p class="card-text">Обеспечение целостности данных при групповых операциях.</p>
                    <div class="code-block">
                        <span class="sql-comment"># Работа с транзакциями</span><br>
                        <span class="sql-keyword">try</span>:<br>
                        connection = sqlite3.connect(<span class="sql-keyword">'university.db'</span>)<br>
                        cursor = connection.cursor()<br>
                        <br>
                        <span class="sql-comment"># Начало транзакции</span><br>
                        cursor.execute(<span class="sql-keyword">"BEGIN TRANSACTION"</span>)<br>
                        <br>
                        <span class="sql-comment"># Несколько операций</span><br>
                        cursor.execute(<span class="sql-keyword">"INSERT INTO students (name, age)
                            VALUES (?, ?)"</span>, (<span class="sql-keyword">'Новый студент'</span>, <span
                            class="sql-keyword">20</span>))<br>
                        cursor.execute(<span class="sql-keyword">"UPDATE students SET grade = ?
                            WHERE name = ?"</span>, (<span class="sql-keyword">'A'</span>, <span
                            class="sql-keyword">'Старый
                            студент'</span>))<br>
                        <br>
                        <span class="sql-comment"># Подтверждение транзакции</span><br>
                        connection.commit()<br>
                        print(<span class="sql-keyword">"Транзакция успешно завершена"</span>)<br>
                        <br>
                        <span class="sql-keyword">except</span> Exception <span class="sql-keyword">as</span> e:<br>
                        <span class="sql-comment"># Откат транзакции при ошибке</span><br>
                        connection.rollback()<br>
                        print(<span class="sql-keyword">f"Ошибка: {e}. Транзакция
                            отменена."</span>)<br>
                        <br>
                        <span class="sql-keyword">finally</span>:<br>
                        connection.close()
                    </div>
                    <div class="alert alert-info">
                        <strong>ACID свойства транзакций:</strong> Atomicity (Атомарность), Consistency
                        (Согласованность),
                        Isolation (Изолированность), Durability (Долговечность).
                    </div>
                </div>
            </div>

            <!-- Карточка 11: Индексы и оптимизация -->
            <div class="card mx-auto" style="max-width: 800px; margin: 10px">
                <img src="../h1title11.jpg" class="card-img-top" alt="Индексы">
                <div class="card-body">
                    <h3>Индексы и оптимизация</h3>
                    <p class="card-text">Ускорение выполнения запросов с помощью индексов.</p>
                    <div class="code-block">
                        <span class="sql-comment"># Создание индекса для ускорения поиска по имени</span><br>
                        cursor.execute(<span class="sql-keyword">"CREATE INDEX IF NOT EXISTS idx_students_name ON
                            students
                            (name)"</span>)<br><br>

                        <span class="sql-comment"># Создание составного индекса</span><br>
                        cursor.execute(<span class="sql-keyword">"CREATE INDEX IF NOT EXISTS idx_students_grade_age ON
                            students (grade, age)"</span>)<br><br>

                        <span class="sql-comment"># Уникальный индекс</span><br>
                        cursor.execute(<span class="sql-keyword">"CREATE UNIQUE INDEX IF NOT EXISTS idx_students_email
                            ON
                            students (email)"</span>)<br><br>

                        <span class="sql-comment"># Просмотр всех индексов таблицы</span><br>
                        cursor.execute(<span class="sql-keyword">"SELECT name FROM sqlite_master WHERE type = 'index'
                            AND
                            tbl_name = 'students'"</span>)<br>
                        indexes = cursor.fetchall()<br>
                        <span class="sql-keyword">for</span> index <span class="sql-keyword">in</span> indexes:<br>
                        print(index[0])<br><br>

                        <span class="sql-comment"># Удаление индекса</span><br>
                        <span class="sql-comment"># cursor.execute("DROP INDEX IF EXISTS idx_students_name")</span>
                    </div>
                    <p><strong>Когда использовать индексы:</strong></p>
                    <ul>
                        <li>Частые поисковые запросы по полю</li>
                        <li>Большие таблицы (тысячи записей)</li>
                        <li>Поля, используемые в WHERE, JOIN, ORDER BY</li>
                    </ul>
                </div>
            </div>

        
            <!-- Карточка 15: Столбчатые диаграммы -->
            <div class="card mx-auto" style="max-width: 800px; margin: 10px">
                <img src="../h1title.jpg" class="card-img-top" alt="Столбчатые диаграммы">
                <div class="card-body">
                    <h3>Столбчатые диаграммы</h3>
                    <p class="card-text">Визуализация категориальных данных и сравнение величин.</p>
                    <div class="code-block">
                        <span class="sql-comment"># Количество статей по категориям</span><br>
                        conn = sqlite3.connect(<span class="sql-keyword">'journalism.db'</span>)<br>
                        query = <span class="sql-keyword">'''</span><br>
                        <span class="sql-keyword">SELECT</span> category, <span class="sql-keyword">COUNT</span>(*) as
                        count<br>
                        <span class="sql-keyword">FROM</span> articles<br>
                        <span class="sql-keyword">GROUP BY</span> category<br>
                        <span class="sql-keyword">ORDER BY</span> count <span class="sql-keyword">DESC</span><br>
                        <span class="sql-keyword">'''</span><br>
                        df_categories = pd.read_sql_query(query, conn)<br>
                        conn.close()<br><br>

                        <span class="sql-comment"># Построение столбчатой диаграммы</span><br>
                        plt.figure(figsize=(10, 6))<br>
                        plt.bar(df_categories[<span class="sql-keyword">'category'</span>], df_categories[<span
                            class="sql-keyword">'count'</span>])<br>
                        plt.title(<span class="sql-keyword">'Количество статей по категориям'</span>)<br>
                        plt.xlabel(<span class="sql-keyword">'Категории'</span>)<br>
                        plt.ylabel(<span class="sql-keyword">'Количество статей'</span>)<br>
                        plt.xticks(rotation=45)<br>
                        plt.tight_layout()<br>
                        plt.show()<br><br>

                        <span class="sql-comment"># Альтернатива с Seaborn</span><br>
                        plt.figure(figsize=(10, 6))<br>
                        sns.barplot(data=df_categories, x=<span class="sql-keyword">'category'</span>, y=<span
                            class="sql-keyword">'count'</span>)<br>
                        plt.title(<span class="sql-keyword">'Количество статей по категориям (Seaborn)'</span>)<br>
                        plt.xticks(rotation=45)<br>
                        plt.tight_layout()<br>
                        plt.show()
                    </div>
                    <p><strong>Применение в журналистике:</strong> сравнение количества публикаций по темам, анализ
                        активности авторов.</p>
                </div>
            </div>

            <!-- Карточка 16: Круговые диаграммы -->
            <div class="card mx-auto" style="max-width: 800px; margin: 10px">
                <img src="../h1title2.jpg" class="card-img-top" alt="Круговые диаграммы">
                <div class="card-body">
                    <h3>Круговые диаграммы</h3>
                    <p class="card-text">Визуализация пропорций и долей.</p>
                    <div class="code-block">
                        <span class="sql-comment"># Распределение статей по статусам</span><br>
                        conn = sqlite3.connect(<span class="sql-keyword">'journalism.db'</span>)<br>
                        query = <span class="sql-keyword">'''</span><br>
                        <span class="sql-keyword">SELECT</span> status, <span class="sql-keyword">COUNT</span>(*) as
                        count<br>
                        <span class="sql-keyword">FROM</span> articles<br>
                        <span class="sql-keyword">GROUP BY</span> status<br>
                        <span class="sql-keyword">'''</span><br>
                        df_status = pd.read_sql_query(query, conn)<br>
                        conn.close()<br><br>

                        <span class="sql-comment"># Круговая диаграмма</span><br>
                        plt.figure(figsize=(8, 8))<br>
                        plt.pie(df_status[<span class="sql-keyword">'count'</span>], <br>
                        labels=df_status[<span class="sql-keyword">'status'</span>], <br>
                        autopct=<span class="sql-keyword">'%1.1f%%'</span>,<br>
                        startangle=90,<br>
                        colors=[<span class="sql-keyword">'#ff9999'</span>, <span class="sql-keyword">'#66b3ff'</span>,
                        <span class="sql-keyword">'#99ff99'</span>])<br>
                        plt.title(<span class="sql-keyword">'Распределение статей по статусам'</span>)<br>
                        plt.axis(<span class="sql-keyword">'equal'</span>)<br>
                        plt.show()<br><br>

                        <span class="sql-comment"># Улучшенная версия с выносками</span><br>
                        plt.figure(figsize=(10, 8))<br>
                        patches, texts, autotexts = plt.pie(<br>
                        df_status[<span class="sql-keyword">'count'</span>], <br>
                        labels=df_status[<span class="sql-keyword">'status'</span>], <br>
                        autopct=<span class="sql-keyword">'%1.1f%%'</span>,<br>
                        shadow=True,<br>
                        explode=(0.1, 0, 0)<br>
                        )<br>
                        plt.title(<span class="sql-keyword">'Статусы статей с акцентом на опубликованные'</span>,
                        fontsize=14)<br>
                        plt.show()
                    </div>
                    <p><strong>Применение:</strong> распределение контента по типам, анализ долей тем в издании.</p>
                </div>
            </div>

            <!-- Карточка 17: Линейные графики -->
            <div class="card mx-auto" style="max-width: 800px; margin: 10px">
                <img src="../h1title3.jpg" class="card-img-top" alt="Линейные графики">
                <div class="card-body">
                    <h3>Линейные графики и временные ряды</h3>
                    <p class="card-text">Анализ тенденций и изменений во времени.</p>
                    <div class="code-block">
                        <span class="sql-comment"># Динамика публикаций по месяцам</span><br>
                        conn = sqlite3.connect(<span class="sql-keyword">'journalism.db'</span>)<br>
                        query = <span class="sql-keyword">'''</span><br>
                        <span class="sql-keyword">SELECT</span> <br>
                        strftime('%Y-%m', publication_date) as month,<br>
                        COUNT(*) as publications<br>
                        <span class="sql-keyword">FROM</span> articles <br>
                        <span class="sql-keyword">WHERE</span> publication_date IS NOT NULL<br>
                        <span class="sql-keyword">GROUP BY</span> strftime('%Y-%m', publication_date)<br>
                        <span class="sql-keyword">ORDER BY</span> month<br>
                        <span class="sql-keyword">'''</span><br>
                        df_timeline = pd.read_sql_query(query, conn)<br>
                        conn.close()<br><br>

                        <span class="sql-comment"># Линейный график</span><br>
                        plt.figure(figsize=(12, 6))<br>
                        plt.plot(df_timeline[<span class="sql-keyword">'month'</span>], df_timeline[<span
                            class="sql-keyword">'publications'</span>], <br>
                        marker=<span class="sql-keyword">'o'</span>, linewidth=2, markersize=6)<br>
                        plt.title(<span class="sql-keyword">'Динамика публикаций по месяцам'</span>, fontsize=14)<br>
                        plt.xlabel(<span class="sql-keyword">'Месяц'</span>)<br>
                        plt.ylabel(<span class="sql-keyword">'Количество публикаций'</span>)<br>
                        plt.xticks(rotation=45)<br>
                        plt.grid(True, alpha=0.3)<br>
                        plt.tight_layout()<br>
                        plt.show()<br><br>

                        <span class="sql-comment"># Несколько линий на одном графике</span><br>
                        query_categories = <span class="sql-keyword">'''</span><br>
                        <span class="sql-keyword">SELECT</span> <br>
                        strftime('%Y-%m', publication_date) as month,<br>
                        category,<br>
                        COUNT(*) as publications<br>
                        <span class="sql-keyword">FROM</span> articles <br>
                        <span class="sql-keyword">WHERE</span> publication_date IS NOT NULL<br>
                        AND category IN ('Политика', 'Спорт', 'Культура')<br>
                        <span class="sql-keyword">GROUP BY</span> strftime('%Y-%m', publication_date), category<br>
                        <span class="sql-keyword">ORDER BY</span> month, category<br>
                        <span class="sql-keyword">'''</span><br>
                        df_multi = pd.read_sql_query(query_categories, conn)<br>
                        <br>
                        <span class="sql-comment"># Pivot для многолинейного графика</span><br>
                        df_pivot = df_multi.pivot(index=<span class="sql-keyword">'month'</span>, columns=<span
                            class="sql-keyword">'category'</span>, values=<span
                            class="sql-keyword">'publications'</span>)<br>
                        <br>
                        plt.figure(figsize=(12, 6))<br>
                        <span class="sql-keyword">for</span> column <span class="sql-keyword">in</span>
                        df_pivot.columns:<br>
                        plt.plot(df_pivot.index, df_pivot[column], marker=<span class="sql-keyword">'o'</span>,
                        label=column)<br>
                        plt.title(<span class="sql-keyword">'Динамика публикаций по категориям'</span>, fontsize=14)<br>
                        plt.xlabel(<span class="sql-keyword">'Месяц'</span>)<br>
                        plt.ylabel(<span class="sql-keyword">'Количество публикаций'</span>)<br>
                        plt.legend()<br>
                        plt.xticks(rotation=45)<br>
                        plt.grid(True, alpha=0.3)<br>
                        plt.tight_layout()<br>
                        plt.show()
                    </div>
                </div>
            </div>

            <!-- Карточка 18: Гистограммы и распределения -->
            <div class="card mx-auto" style="max-width: 800px; margin: 10px">
                <img src="../h1title.jpg" class="card-img-top" alt="Гистограммы">
                <div class="card-body">
                    <h3>Гистограммы и анализ распределений</h3>
                    <p class="card-text">Анализ распределения числовых данных.</p>
                    <div class="code-block">
                        <span class="sql-comment"># Распределение просмотров статей</span><br>
                        conn = sqlite3.connect(<span class="sql-keyword">'journalism.db'</span>)<br>
                        query = <span class="sql-keyword">"SELECT views FROM articles WHERE views > 0"</span><br>
                        df_views = pd.read_sql_query(query, conn)<br>
                        conn.close()<br><br>

                        <span class="sql-comment"># Гистограмма</span><br>
                        plt.figure(figsize=(10, 6))<br>
                        plt.hist(df_views[<span class="sql-keyword">'views'</span>], bins=20, edgecolor=<span
                            class="sql-keyword">'black'</span>, alpha=0.7)<br>
                        plt.title(<span class="sql-keyword">'Распределение количества просмотров статей'</span>)<br>
                        plt.xlabel(<span class="sql-keyword">'Количество просмотров'</span>)<br>
                        plt.ylabel(<span class="sql-keyword">'Количество статей'</span>)<br>
                        plt.grid(True, alpha=0.3)<br>
                        plt.show()<br><br>

                        <span class="sql-comment"># Боксплот для анализа выбросов</span><br>
                        plt.figure(figsize=(8, 6))<br>
                        plt.boxplot(df_views[<span class="sql-keyword">'views'</span>])<br>
                        plt.title(<span class="sql-keyword">'Распределение просмотров (боксплот)'</span>)<br>
                        plt.ylabel(<span class="sql-keyword">'Просмотры'</span>)<br>
                        plt.show()<br><br>

                        <span class="sql-comment"># Сравнение распределений по категориям</span><br>
                        conn = sqlite3.connect(<span class="sql-keyword">'journalism.db'</span>)<br>
                        query_comparison = <span class="sql-keyword">'''</span><br>
                        <span class="sql-keyword">SELECT</span> category, views<br>
                        <span class="sql-keyword">FROM</span> articles <br>
                        <span class="sql-keyword">WHERE</span> views > 0 <br>
                        AND category IN ('Политика', 'Спорт', 'Культура')<br>
                        <span class="sql-keyword">'''</span><br>
                        df_comparison = pd.read_sql_query(query_comparison, conn)<br>
                        conn.close()<br><br>

                        plt.figure(figsize=(10, 6))<br>
                        categories = df_comparison[<span class="sql-keyword">'category'</span>].unique()<br>
                        <span class="sql-keyword">for</span> category <span class="sql-keyword">in</span>
                        categories:<br>
                        data = df_comparison[df_comparison[<span class="sql-keyword">'category'</span>] ==
                        category][<span class="sql-keyword">'views'</span>]<br>
                        plt.hist(data, bins=15, alpha=0.6, label=category)<br>
                        plt.title(<span class="sql-keyword">'Сравнение распределения просмотров по
                            категориям'</span>)<br>
                        plt.xlabel(<span class="sql-keyword">'Просмотры'</span>)<br>
                        plt.ylabel(<span class="sql-keyword">'Количество статей'</span>)<br>
                        plt.legend()<br>
                        plt.show()
                    </div>
                </div>
            </div>

            <!-- Карточка 19: Тепловые карты и корреляции -->
            <div class="card mx-auto" style="max-width: 800px; margin: 10px">
                <img src="../h1title2.jpg" class="card-img-top" alt="Тепловые карты">
                <div class="card-body">
                    <h3>Тепловые карты и анализ корреляций</h3>
                    <p class="card-text">Визуализация взаимосвязей между переменными.</p>
                    <div class="code-block">
                        <span class="sql-comment"># Анализ корреляций между метриками</span><br>
                        conn = sqlite3.connect(<span class="sql-keyword">'journalism.db'</span>)<br>
                        query_metrics = <span class="sql-keyword">'''</span><br>
                        <span class="sql-keyword">SELECT</span> <br>
                        views,<br>
                        LENGTH(content) as content_length,<br>
                        (julianday('now') - julianday(publication_date)) as
                        days_since_publication<br>
                        <span class="sql-keyword">FROM</span> articles <br>
                        <span class="sql-keyword">WHERE</span> views > 0 AND publication_date IS NOT NULL<br>
                        <span class="sql-keyword">'''</span><br>
                        df_metrics = pd.read_sql_query(query_metrics, conn)<br>
                        conn.close()<br><br>

                        <span class="sql-comment"># Матрица корреляций</span><br>
                        correlation_matrix = df_metrics.corr()<br>
                        <br>
                        <span class="sql-comment"># Тепловая карта корреляций</span><br>
                        plt.figure(figsize=(8, 6))<br>
                        sns.heatmap(correlation_matrix, <br>
                        annot=True, <br>
                        cmap=<span class="sql-keyword">'coolwarm'</span>, <br>
                        center=0,<br>
                        square=True)<br>
                        plt.title(<span class="sql-keyword">'Тепловая карта корреляций метрик статей'</span>)<br>
                        plt.tight_layout()<br>
                        plt.show()<br><br>

                        <span class="sql-comment"># Диаграмма рассеяния</span><br>
                        plt.figure(figsize=(10, 6))<br>
                        plt.scatter(df_metrics[<span class="sql-keyword">'content_length'</span>], <br>
                        df_metrics[<span class="sql-keyword">'views'</span>], <br>
                        alpha=0.6)<br>
                        plt.title(<span class="sql-keyword">'Зависимость просмотров от длины статьи'</span>)<br>
                        plt.xlabel(<span class="sql-keyword">'Длина контента (символы)'</span>)<br>
                        plt.ylabel(<span class="sql-keyword">'Просмотры'</span>)<br>
                        plt.grid(True, alpha=0.3)<br>
                        plt.show()
                    </div>
                </div>
            </div>

            <!-- Карточка 20: Комплексная дашборд-визуализация -->
            <div class="card mx-auto" style="max-width: 800px; margin: 10px">
                <img src="../h1title3.jpg" class="card-img-top" alt="Дашборд">
                <div class="card-body">
                    <h3>Комплексная визуализация: Дашборд</h3>
                    <p class="card-text">Создание комплексной панели визуализации данных из SQLite.</p>
                    <div class="code-block">
                        <span class="sql-keyword">import</span> sqlite3<br>
                        <span class="sql-keyword">import</span> matplotlib.pyplot <span class="sql-keyword">as</span>
                        plt<br>
                        <span class="sql-keyword">import</span> pandas <span class="sql-keyword">as</span> pd<br>
                        <span class="sql-keyword">import</span> seaborn <span class="sql-keyword">as</span> sns<br><br>

                        <span class="sql-comment"># Создание комплексного дашборда</span><br>
                        conn = sqlite3.connect(<span class="sql-keyword">'journalism.db'</span>)<br>
                        <br>
                        <span class="sql-comment"># 1. Статистика по авторам</span><br>
                        query_authors = <span class="sql-keyword">'''</span><br>
                        <span class="sql-keyword">SELECT</span> a.name, <span class="sql-keyword">COUNT</span>(ar.id) as
                        articles, <span class="sql-keyword">AVG</span>(ar.views) as avg_views<br>
                        <span class="sql-keyword">FROM</span> authors a<br>
                        <span class="sql-keyword">LEFT JOIN</span> articles ar <span class="sql-keyword">ON</span> a.id
                        =
                        ar.author_id<br>
                        <span class="sql-keyword">GROUP BY</span> a.id<br>
                        <span class="sql-keyword">ORDER BY</span> articles <span class="sql-keyword">DESC</span><br>
                        <span class="sql-keyword">LIMIT</span> 10<br>
                        <span class="sql-keyword">'''</span><br>
                        df_authors = pd.read_sql_query(query_authors, conn)<br>
                        <br>
                        <span class="sql-comment"># 2. Распределение по категориям</span><br>
                        query_categories = <span class="sql-keyword">'''</span><br>
                        <span class="sql-keyword">SELECT</span> category, <span class="sql-keyword">COUNT</span>(*) as
                        count<br>
                        <span class="sql-keyword">FROM</span> articles<br>
                        <span class="sql-keyword">GROUP BY</span> category<br>
                        <span class="sql-keyword">'''</span><br>
                        df_categories = pd.read_sql_query(query_categories, conn)<br>
                        <br>
                        <span class="sql-comment"># 3. Динамика публикаций</span><br>
                        query_timeline = <span class="sql-keyword">'''</span><br>
                        <span class="sql-keyword">SELECT</span> <br>
                        strftime('%Y-%m', publication_date) as month,<br>
                        COUNT(*) as publications<br>
                        <span class="sql-keyword">FROM</span> articles <br>
                        <span class="sql-keyword">WHERE</span> publication_date IS NOT NULL<br>
                        <span class="sql-keyword">GROUP BY</span> strftime('%Y-%m', publication_date)<br>
                        <span class="sql-keyword">ORDER BY</span> month<br>
                        <span class="sql-keyword">'''</span><br>
                        df_timeline = pd.read_sql_query(query_timeline, conn)<br>
                        conn.close()<br><br>

                        <span class="sql-comment"># Создание subplot дашборда</span><br>
                        fig, ((ax1, ax2), (ax3, ax4)) = plt.subplots(2, 2, figsize=(15, 10))<br>
                        <br>
                        <span class="sql-comment"># 1. Топ авторов</span><br>
                        ax1.barh(df_authors[<span class="sql-keyword">'name'</span>], df_authors[<span
                            class="sql-keyword">'articles'</span>])<br>
                        ax1.set_title(<span class="sql-keyword">'Топ авторов по количеству статей'</span>)<br>
                        ax1.set_xlabel(<span class="sql-keyword">'Количество статей'</span>)<br>
                        <br>
                        <span class="sql-comment"># 2. Круговая диаграмма категорий</span><br>
                        ax2.pie(df_categories[<span class="sql-keyword">'count'</span>], labels=df_categories[<span
                            class="sql-keyword">'category'</span>], autopct=<span
                            class="sql-keyword">'%1.1f%%'</span>)<br>
                        ax2.set_title(<span class="sql-keyword">'Распределение по категориям'</span>)<br>
                        <br>
                        <span class="sql-comment"># 3. Динамика публикаций</span><br>
                        ax3.plot(df_timeline[<span class="sql-keyword">'month'</span>], df_timeline[<span
                            class="sql-keyword">'publications'</span>], marker=<span class="sql-keyword">'o'</span>)<br>
                        ax3.set_title(<span class="sql-keyword">'Динамика публикаций'</span>)<br>
                        ax3.set_xticklabels(df_timeline[<span class="sql-keyword">'month'</span>], rotation=45)<br>
                        ax3.grid(True, alpha=0.3)<br>
                        <br>
                        <span class="sql-comment"># 4. Средние просмотры по авторам</span><br>
                        ax4.bar(df_authors[<span class="sql-keyword">'name'</span>], df_authors[<span
                            class="sql-keyword">'avg_views'</span>])<br>
                        ax4.set_title(<span class="sql-keyword">'Средние просмотры по авторам'</span>)<br>
                        ax4.set_xticklabels(df_authors[<span class="sql-keyword">'name'</span>], rotation=45)<br>
                        <br>
                        plt.tight_layout()<br>
                        plt.show()
                    </div>
                    <p><strong>Преимущества дашбордов:</strong> комплексный обзор данных, выявление трендов, удобство
                        для
                        принятия редакционных решений.</p>
                </div>
            </div>



            <!-- Карточка 18: Гистограммы и распределения -->
            <div class="card mx-auto" style="max-width: 800px; margin: 10px">
                <img src="../h1title.jpg" class="card-img-top" alt="Гистограммы">
                <div class="card-body">
                    <h3>Рекламная компания</h3>
                    <p class="card-text">Цель занятия: Познакомиться с практическим использованием SQLite (файл
                        <code>ad_data.db</code>) через Python + pandas. Научиться задавать SQL-запросы, делать базовую
                        аналитику и визуализации.
                    </p>
                    <div class="code-block">

                        <span class="sql-keyword">import</span> sqlite3<br>
                        <span class="sql-keyword">import</span> pandas <span class="sql-keyword">as</span> pd<br><br>

                        <span class="sql-comment"># Подключаемся к базе (путь относительно notebook)</span><br>
                        conn = sqlite3.connect(<span class="sql-keyword">"data/ad_data.db"</span>)<br><br>

                        <span class="sql-comment"># Проверим таблицы</span><br>
                        query = <span class="sql-keyword">"SELECT name FROM sqlite_master WHERE
                            type='table';"</span><br>
                        pd.read_sql_query(query, conn)<br><br>

                        <span class="sql-comment"># Первые 5 строк таблицы ads</span><br>
                        pd.read_sql_query(<span class="sql-keyword">"SELECT * FROM ads LIMIT 5;"</span>, conn)<br><br>

                        <span class="sql-comment"># 3. Подсчёт CTR (Click-Through Rate)</span><br>
                        query = <span class="sql-keyword">"""</span><br>
                        <span class="sql-keyword">SELECT</span> ad_type,<br>
                        &nbsp;&nbsp;&nbsp;<span class="sql-keyword">ROUND</span>(<span
                            class="sql-keyword">AVG</span>(1.0 *
                        clicks / impressions), 4) <span class="sql-keyword">AS</span> avg_ctr<br>
                        <span class="sql-keyword">FROM</span> ads<br>
                        <span class="sql-keyword">GROUP BY</span> ad_type<br>
                        <span class="sql-keyword">ORDER BY</span> avg_ctr <span class="sql-keyword">DESC</span>;<br>
                        <span class="sql-keyword">"""</span><br>
                        pd.read_sql_query(query, conn)<br><br>

                        <span class="sql-comment"># 4. Анализ по платформам</span><br>
                        query = <span class="sql-keyword">"""</span><br>
                        <span class="sql-keyword">SELECT</span> platform,<br>
                        &nbsp;&nbsp;&nbsp;<span class="sql-keyword">SUM</span>(impressions)
                        <span class="sql-keyword">AS</span> total_impressions,<br>
                        &nbsp;&nbsp;&nbsp;<span class="sql-keyword">SUM</span>(clicks) <span
                            class="sql-keyword">AS</span>
                        total_clicks,<br>
                        &nbsp;&nbsp;&nbsp;<span class="sql-keyword">ROUND</span>(1.0 * <span
                            class="sql-keyword">SUM</span>(clicks) / <span class="sql-keyword">SUM</span>(impressions),
                        4) <span class="sql-keyword">AS</span> ctr<br>
                        <span class="sql-keyword">FROM</span> ads<br>
                        <span class="sql-keyword">GROUP BY</span> platform<br>
                        <span class="sql-keyword">ORDER BY</span> ctr <span class="sql-keyword">DESC</span>;<br>
                        <span class="sql-keyword">"""</span><br>
                        pd.read_sql_query(query, conn)<br><br>

                        <span class="sql-comment"># 5. Средняя оценка (feedback) по платформам</span><br>
                        query = <span class="sql-keyword">"""</span><br>
                        <span class="sql-keyword">SELECT</span> a.platform,<br>
                        &nbsp;&nbsp;&nbsp;<span class="sql-keyword">ROUND</span>(<span
                            class="sql-keyword">AVG</span>(i.feedback_score), 2) <span class="sql-keyword">AS</span>
                        avg_feedback<br>
                        <span class="sql-keyword">FROM</span> interactions i<br>
                        <span class="sql-keyword">JOIN</span> ads a <span class="sql-keyword">ON</span> i.ad_id =
                        a.ad_id<br>
                        <span class="sql-keyword">GROUP BY</span> a.platform<br>
                        <span class="sql-keyword">ORDER BY</span> avg_feedback <span
                            class="sql-keyword">DESC</span>;<br>
                        <span class="sql-keyword">"""</span><br>
                        pd.read_sql_query(query, conn)<br><br>

                        <span class="sql-comment"># 6. CTR vs бюджет кампаний</span><br>
                        query = <span class="sql-keyword">"""</span><br>
                        <span class="sql-keyword">SELECT</span> c.brand,<br>
                        &nbsp;&nbsp;&nbsp;<span class="sql-keyword">ROUND</span>(<span
                            class="sql-keyword">AVG</span>(1.0 *
                        a.clicks / a.impressions), 4) <span class="sql-keyword">AS</span> avg_ctr,<br>
                        &nbsp;&nbsp;&nbsp;<span class="sql-keyword">ROUND</span>(<span
                            class="sql-keyword">AVG</span>(c.budget), 2) <span class="sql-keyword">AS</span>
                        avg_budget<br>
                        <span class="sql-keyword">FROM</span> ads a<br>
                        <span class="sql-keyword">JOIN</span> campaigns c <span class="sql-keyword">ON</span>
                        a.campaign_id = c.campaign_id<br>
                        <span class="sql-keyword">GROUP BY</span> c.brand<br>
                        <span class="sql-keyword">ORDER BY</span> avg_ctr <span class="sql-keyword">DESC</span>;<br>
                        <span class="sql-keyword">"""</span><br>
                        pd.read_sql_query(query, conn)<br><br>

                        <span class="sql-comment"># 7. Поведение пользователей по регионам</span><br>
                        query = <span class="sql-keyword">"""</span><br>
                        <span class="sql-keyword">SELECT</span> u.region,<br>
                        &nbsp;&nbsp;&nbsp;<span class="sql-keyword">ROUND</span>(<span
                            class="sql-keyword">AVG</span>(i.view_time_sec), 2) <span class="sql-keyword">AS</span>
                        avg_view_time,<br>
                        &nbsp;&nbsp;&nbsp;<span class="sql-keyword">ROUND</span>(<span
                            class="sql-keyword">AVG</span>(i.feedback_score), 2) <span class="sql-keyword">AS</span>
                        avg_feedback<br>
                        <span class="sql-keyword">FROM</span> interactions i<br>
                        <span class="sql-keyword">JOIN</span> users u <span class="sql-keyword">ON</span> i.user_id =
                        u.user_id<br>
                        <span class="sql-keyword">GROUP BY</span> u.region<br>
                        <span class="sql-keyword">ORDER BY</span> avg_feedback <span
                            class="sql-keyword">DESC</span>;<br>
                        <span class="sql-keyword">"""</span><br>
                        pd.read_sql_query(query, conn)<br><br>

                        <span class="sql-comment"># 8. Визуализация (matplotlib)</span><br>
                        <span class="sql-keyword">import</span> matplotlib.pyplot <span class="sql-keyword">as</span>
                        plt<br><br>

                        df = pd.read_sql_query(<span class="sql-keyword">"""</span><br>
                        <span class="sql-keyword">SELECT</span> ad_type,<br>
                        &nbsp;&nbsp;&nbsp;<span class="sql-keyword">ROUND</span>(<span
                            class="sql-keyword">AVG</span>(1.0 *
                        clicks / impressions), 4) <span class="sql-keyword">AS</span> avg_ctr<br>
                        <span class="sql-keyword">FROM</span> ads<br>
                        <span class="sql-keyword">GROUP BY</span> ad_type;<br>
                        <span class="sql-keyword">"""</span>, conn)<br><br>

                        plt.bar(df[<span class="sql-keyword">'ad_type'</span>], df[<span
                            class="sql-keyword">'avg_ctr'</span>])<br>
                        plt.title(<span class="sql-keyword">"Средний CTR по типам рекламы"</span>)<br>
                        plt.xlabel(<span class="sql-keyword">"Тип рекламы"</span>)<br>
                        plt.ylabel(<span class="sql-keyword">"CTR"</span>)<br>
                        plt.show()<br><br>

                        <span class="sql-comment"># 9. Мини-практикум - Подсказки (SQL)</span><br>
                        <span class="sql-comment">-- CPC: cost per click (avg cost / clicks)</span><br>
                        <span class="sql-keyword">SELECT</span> platform,<br>
                        &nbsp;&nbsp;&nbsp;<span class="sql-keyword">ROUND</span>(<span
                            class="sql-keyword">SUM</span>(cost)
                        / <span class="sql-keyword">NULLIF</span>(<span class="sql-keyword">SUM</span>(clicks),0), 2)
                        <span class="sql-keyword">AS</span>
                        avg_cpc<br>
                        <span class="sql-keyword">FROM</span> ads<br>
                        <span class="sql-keyword">GROUP BY</span> platform<br>
                        <span class="sql-keyword">ORDER BY</span> avg_cpc <span class="sql-keyword">DESC</span>;<br><br>

                        <span class="sql-comment">-- Бренды по feedback</span><br>
                        <span class="sql-keyword">SELECT</span> c.brand, <span class="sql-keyword">ROUND</span>(<span
                            class="sql-keyword">AVG</span>(i.feedback_score),2) <span class="sql-keyword">AS</span>
                        avg_feedback<br>
                        <span class="sql-keyword">FROM</span> interactions i<br>
                        <span class="sql-keyword">JOIN</span> ads a <span class="sql-keyword">ON</span> i.ad_id =
                        a.ad_id<br>
                        <span class="sql-keyword">JOIN</span> campaigns c <span class="sql-keyword">ON</span>
                        a.campaign_id = c.campaign_id<br>
                        <span class="sql-keyword">GROUP BY</span> c.brand<br>
                        <span class="sql-keyword">ORDER BY</span> avg_feedback <span
                            class="sql-keyword">DESC</span>;<br><br>

                        <span class="sql-comment"># 10. Завершение</span><br>
                        conn.close()




                    </div>
                </div>
            </div>



            <!-- Карточка 14: Упражнения для закрепления -->
            <div class="card mx-auto" style="max-width: 800px; margin: 10px">
                <img src="../h1title14.jpg" class="card-img-top" alt="Упражнения">
                <div class="card-body">
                    <h3>Упражнения для самостоятельной работы</h3>
                    <p class="card-text">Практические задания для закрепления материала.</p>

                    <div class="exercise">
                        <h5>Задание 1: База данных источников информации</h5>
                        <p>Создайте базу данных для хранения источников информации с полями: id, source_name, url,
                            category,
                            reliability_score, last_checked.</p>
                        <button class="btn btn-sm btn-outline-primary" onclick="toggleSolution('solution1')">Показать
                            решение</button>
                        <div id="solution1" style="display: none; margin-top: 10px;">
                            <div class="code-block">
                                <span class="sql-keyword">CREATE TABLE</span> sources (<br>
                                id INTEGER <span class="sql-keyword">PRIMARY KEY
                                    AUTOINCREMENT</span>,<br>
                                source_name TEXT <span class="sql-keyword">NOT NULL</span>,<br>
                                url TEXT,<br>
                                category TEXT,<br>
                                reliability_score INTEGER <span class="sql-keyword">CHECK</span>(reliability_score
                                BETWEEN 1
                                AND 5),<br>
                                last_checked DATE<br>
                                );
                            </div>
                        </div>
                    </div>

                    <div class="exercise">
                        <h5>Задание 2: Анализ эффективности авторов</h5>
                        <p>Напишите запросы для анализа работы авторов:
                        <ul>
                            <li>Найти автора с наибольшим количеством статей</li>
                            <li>Посчитать среднее количество просмотров по категориям</li>
                            <li>Найти статьи, опубликованные за последнюю неделю</li>
                        </ul>
                        </p>
                        <button class="btn btn-sm btn-outline-primary" onclick="toggleSolution('solution2')">Показать
                            решение</button>
                        <div id="solution2" style="display: none; margin-top: 10px;">
                            <div class="code-block">
                                <span class="sql-comment"># Автор с наибольшим количеством статей</span><br>
                                <span class="sql-keyword">SELECT</span> a.name, <span
                                    class="sql-keyword">COUNT</span>(ar.id) as article_count<br>
                                <span class="sql-keyword">FROM</span> authors a<br>
                                <span class="sql-keyword">JOIN</span> articles ar <span class="sql-keyword">ON</span>
                                a.id =
                                ar.author_id<br>
                                <span class="sql-keyword">GROUP BY</span> a.id<br>
                                <span class="sql-keyword">ORDER BY</span> article_count <span
                                    class="sql-keyword">DESC</span><br>
                                <span class="sql-keyword">LIMIT</span> 1;<br><br>

                                <span class="sql-comment"># Средние просмотры по категориям</span><br>
                                <span class="sql-keyword">SELECT</span> category, <span
                                    class="sql-keyword">AVG</span>(views) as avg_views<br>
                                <span class="sql-keyword">FROM</span> articles<br>
                                <span class="sql-keyword">GROUP BY</span> category;<br><br>

                                <span class="sql-comment"># Статьи за последнюю неделю</span><br>
                                <span class="sql-keyword">SELECT</span> title, author_id, publication_date<br>
                                <span class="sql-keyword">FROM</span> articles<br>
                                <span class="sql-keyword">WHERE</span> publication_date >= date('now', '-7 days');
                            </div>
                        </div>
                    </div>

                    <div class="exercise">
                        <h5>Задание 3: Оптимизация базы данных</h5>
                        <p>Создайте индексы для оптимизации частых запросов и напишите транзакцию для обновления
                            нескольких
                            связанных таблиц.</p>
                        <button class="btn btn-sm btn-outline-primary" onclick="toggleSolution('solution3')">Показать
                            решение</button>
                        <div id="solution3" style="display: none; margin-top: 10px;">
                            <div class="code-block">
                                <span class="sql-comment"># Создание индексов</span><br>
                                <span class="sql-keyword">CREATE INDEX</span> idx_articles_date <span
                                    class="sql-keyword">ON</span> articles(publication_date);<br>
                                <span class="sql-keyword">CREATE INDEX</span> idx_articles_author <span
                                    class="sql-keyword">ON</span> articles(author_id);<br>
                                <span class="sql-keyword">CREATE INDEX</span> idx_articles_category <span
                                    class="sql-keyword">ON</span> articles(category);<br><br>

                                <span class="sql-comment"># Транзакция</span><br>
                                <span class="sql-keyword">BEGIN TRANSACTION</span>;<br>
                                <span class="sql-keyword">INSERT INTO</span> authors (name, email) <span
                                    class="sql-keyword">VALUES</span> ('Новый автор', 'new@email.com');<br>
                                <span class="sql-keyword">INSERT INTO</span> articles (title, author_id) <span
                                    class="sql-keyword">VALUES</span> ('Новая статья', last_insert_rowid());<br>
                                <span class="sql-keyword">COMMIT</span>;
                            </div>
                        </div>
                    </div>
                </div>
            </div>




            <div class="card mx-auto" style="max-width: 800px; margin: 10px">
                <img src="https://images.unsplash.com/photo-1707999558198-d5f93aafa75b?q=80&w=600&auto=format&fit=crop"
                    class="card-img-top" style="filter: grayscale(1);" alt="quiz">
                <div class="card-body">
                    <div class="container" id="formcontainer" style="display: none;">
                        <form>
                            <div class="mb-3">
                                <label for="emailInput" class="form-label">Email</label>
                                <input type="email" class="form-control" id="emailInput" aria-describedby="emailHelp">
                                <div id="emailHelp" class="form-text">Email может быть фиктивный. Пароль НЕ требуется
                                </div>
                            </div>
                            <div class="mb-3">
                                <label for="user" class="form-label">ФИО Группа</label>
                                <input type="text" class="form-control" id="userInput">
                            </div>

                            <button type="submit" class="btn btn-outline-secondary btn-sm m-2 align-text-bottom"
                                id="loginbutton">Сохранить</button>
                        </form>
                    </div>
                    <div class="container my-1 d-flex flex-wrap" id="quizbuttonslist"></div>
                    <div class="container" id="quizcontainer" style="display: none;">
                        <div class="card mx-auto" style="min-height: 100px;">
                            <div class="card-header" id="quizHeader"></div>
                            <div class="card-body">
                                <h5 class="card-title fade-in-div" id="quizTitle">Выберите тестовое задание</h5>
                                <div class="card-text fade-in-div" id="quizString"></div>
                                <form id="quizform">
                                    <div id="quizChecks" class="m-1 p-1"></div>
                                    <div id="quizHint" class="m-1 p-1"></div>
                                    <div class="container p-1 m-1" id="accountingblock" style="display: none;">
                                    </div>
                                    <div id="quizformdataarray"></div>
                                    <div id="usercalculations" style="display: none;">
                                        <label for="inputFormula" class="col-form-label"
                                            id="resformula">Калькулятор</label>
                                        <input type="text" class="form-control form-control-sm" id="inputFormula">
                                    </div>
                                    <textarea class="form-control my-3" id="userComment" rows="2"
                                        style="display: none;">Мой комментарий</textarea>
                                    <button type="submit" class="btn btn-outline-primary m-3" id="answerButton"
                                        style="display: none;">Ответить</button>
                                </form>
                            </div>
                        </div>
                    </div>

                </div>
            </div>

        </div>
    </div>
    </div>








    <!-- Футер 
    <footer class="bg-dark text-white mt-5">
        <div class="container py-4">
            <div class="row">
                <div class="col-md-6">
                    <h5>Методическое пособие по SQLite3</h5>

                </div>
                <div class="col-md-6 text-right">

                    <p>Используется в Jupyter Lite</p>
                </div>
            </div>
        </div>
    </footer> -->

    <!-- Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.2/dist/js/bootstrap.bundle.min.js"></script>
    <script type="module" src="../dist/quizcardwithstorage.js"></script>

    <script>
        function toggleSolution(id) {
            var solution = document.getElementById(id);
            if (solution.style.display === "none") {
                solution.style.display = "block";
            } else {
                solution.style.display = "none";
            }
        }
    </script>
</body>

</html>