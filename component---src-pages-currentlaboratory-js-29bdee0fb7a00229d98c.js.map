{"version":3,"sources":["webpack:///./src/pages/currentlaboratory.js","webpack:///./src/mediatemplates/ShowXlTableWithPredefinedIndicators.js"],"names":["currentDay","Intl","DateTimeFormat","weekday","year","month","day","format","Date","replace","CurrentLaboratory","useFirebaseNode","usersProjects","data","loading","error","currentCases","Object","keys","map","item","console","log","sort","a","b","timeA","timestamp","timeB","uniqueTitles","Set","title","key","variant","length","filter","id","Header","avatarUrl","src","alt","className","style","verticalAlign","width","height","borderRadius","objectFit","theme","Body","Text","quizString","answer","type","content","xlArray","createProtoArray","ShowXlTableWithPredefinedIndicators","quiz","projectData","projectDataArray","tableWithData","doFindValuesForArrayOfArraysTable","striped","bordered","hover","size","column","columnIndex","row","rowIndex"],"mappings":"8nCAqCA,IAAIA,EAAa,IAAIC,KAAKC,eAAe,KAAM,CAC3CC,QAAS,QACTC,KAAM,UACNC,MAAO,QACPC,IAAK,YACNC,OAAO,IAAIC,MAAQC,QAAQ,gBAAiB,KAEhC,SAASC,IAAqB,IAAD,EACQC,YAAgB,wBAA0BX,EAAa,WAAzFY,EAD0B,EAChCC,KAAqBC,EADW,EACXA,QAASC,EADE,EACFA,MAEtC,GAAMD,IAAYF,EAAiB,OAAO,kBAAC,IAAD,KAAQ,qCAClD,GAAMG,EAAS,OAAO,kBAAC,IAAD,YAEtB,IAAIC,EAAeC,OAAOC,KAAKN,GAAeO,KAAI,SAAAC,GAAU,OAAOR,EAAcQ,MACjFC,QAAQC,IAAIN,GAEZA,EAAaO,MAAK,SAAUC,EAAGC,GAC3B,IAAIC,GAAUF,aAAD,EAACA,EAAGG,WAAYH,EAAEG,UAAY,EACvCC,GAAUH,aAAD,EAACA,EAAGE,WAAYF,EAAEE,UAAY,EAC3C,OAAID,EAAQE,GACA,EAERF,EAAQE,EACD,EAEJ,KAGX,IAAMC,EAAiBb,EAAF,EAAqB,IAAIc,IAAId,EAAaG,KAAI,SAACC,GAAD,OAAUA,EAAKW,WAAW,GA4B7F,OA1BAV,QAAQC,IAAIO,GA0BL,kBAAC,IAAD,KAEH,uCAAaA,GACTA,EAAaV,KAAI,SAACY,GAAD,OACb,yBAAKC,IAAKD,GACN,kBAAC,IAAD,CAAOE,QAAQ,WAAWF,KAEvBf,GAAgBA,EAAakB,OAAS,GAAKlB,EAAamB,QAAO,SAAAf,GAAI,OAAIA,EAAKW,QAAUA,KAAOZ,KAAI,SAAAC,GAAI,OACpG,kBAAC,IAAD,CAAMY,IAAKZ,EAAKgB,IACZ,kBAAC,IAAKC,OAAN,KACOjB,EAAKkB,UACJ,yBACIC,IAAKnB,EAAKkB,UACVE,IAAI,GACJC,UAAU,MACVC,MAAO,CACHC,cAAe,SACfC,MAAO,OACPC,OAAQ,OACRC,aAAc,MACdX,OAAQ,kBACRY,UAAW,WAGnB,KACJ,+BAAQ3B,EAAK4B,QAGjB,kBAAC,IAAKC,KAAN,KAEI,kBAAC,IAAKC,KAAN,WAAc,+BAAQ9B,EAAK+B,aAC3B,kBAAC,IAAKD,KAAN,KAAW,yCAAe,IAAK9B,EAAKgC,SACrB,gBAAdhC,EAAKiC,SAA4BjC,aAAD,EAACA,EAAMkC,UAAW,kBAAC,IAAD,CAA0BC,QAASC,YAAiBpC,EAAKkC,QAAS,EAAG,kB,yKCpHzI,SAASG,EAAT,GAAiE,IAAlBC,EAAiB,EAAjBA,KAAMH,EAAW,EAAXA,QAAW,EAC/B5C,YAAgB,iBAAmB+C,EAAKN,QAAxEO,EAD+D,EACrE9C,KAAmBC,EADkD,EAClDA,QAASC,EADyC,EACzCA,MAEpC,GAAMD,IAAY6C,EAAe,OAAO,oCACxC,GAAM5C,EAAS,OAAO,oCAEtB,IAAI6C,EAAmB3C,OAAOC,KAAKyC,GAChCxC,KAAI,SAACC,GAAW,OAAOuC,EAAYvC,MAKlCyC,EAAgBC,YAAkCF,EAAkBL,GAIxE,OAAO,kBAAC,IAAD,CAAOQ,SAAO,EAACC,UAAQ,EAACC,OAAK,EAACC,KAAK,MACxC,+BACE,4BACGL,EAAc,GAAG1C,KAAI,SAACgD,EAAQC,GAAT,OACpB,wBAAIpC,IAAKoC,EAAa3B,UAAU,eAC7BoB,EAAc,GAAGO,SAK1B,+BACGP,EAAc1C,KAAI,SAACkD,EAAKC,GACvB,GAAIA,EAAW,EACb,OAAO,wBAAItC,IAAKsC,GACbD,EAAIlD,KAAI,SAACgD,EAAQC,GAAT,OACP,wBAAIpC,IAAKsC,EAAWF,GACtB,2BAAO3B,UAAW,QAAlB,IAA4B4B,EAAID,IAD9B","file":"component---src-pages-currentlaboratory-js-29bdee0fb7a00229d98c.js","sourcesContent":["import React from \"react\";\n\nimport ReactHtmlParser from 'react-html-parser';\nimport ShowXlTableArrayOfArrays from \"../mediatemplates/ShowXlTableArrayOfArrays\";\n\nimport ShowXlTableWithPredefinedIndicators from \"../mediatemplates/ShowXlTableWithPredefinedIndicators\";\nimport { createProtoArray } from \"../features/spreadsheet/spreadsheetSlice\";\nimport { useFirebaseNode } from \"../hooks/useFirebaseNode\";\nimport Avatar from 'avataaars'\n\nimport Alert from 'react-bootstrap/Alert'\nimport Card from 'react-bootstrap/Card'\n\n\n\nimport Layout from \"../components/layout\"\n\nfunction topType() {\n    let variants = [\"NoHair\", \"Eyepatch\", \"Hat\", \"Hijab\", \"Turban\", \"WinterHat1\", \"WinterHat2\", \"WinterHat3\", \"WinterHat4\", \"LongHairBigHair\", \"LongHairBob\", \"LongHairBun\", \"LongHairCurly\", \"LongHairCurvy\", \"LongHairDreads\", \"LongHairFrida\", \"LongHairFro\", \"LongHairFroBand\", \"LongHairNotTooLong\", \"LongHairShavedSides\", \"LongHairMiaWallace\", \"LongHairStraight\", \"LongHairStraight2\", \"LongHairStraightStrand\", \"ShortHairDreads01\", \"ShortHairDreads02\", \"ShortHairFrizzle\", \"ShortHairShaggyMullet\", \"ShortHairShortCurly\", \"ShortHairShortFlat\", \"ShortHairShortRound\", \"ShortHairShortWaved\", \"ShortHairSides\", \"ShortHairTheCaesar\", \"ShortHairTheCaesarSidePart\"];\n    return variants[Math.floor(Math.random() * variants.length)];\n}\n\nfunction clothType() {\n    let variants = [\"BlazerShirt\", \"BlazerSweater\", \"CollarSweater\", \"GraphicShirt\", \"Hoodie\", \"Overall\", \"ShirtCrewNeck\", \"ShirtScoopNeck\", \"ShirtVNeck\"];\n    return variants[Math.floor(Math.random() * variants.length)];\n}\n\nfunction clotheColor() {\n    let variants = [\"Black\", \"Blue01\", \"Blue02\", \"Blue03\", \"Gray01\", \"Gray02\", \"Heather\", \"PastelBlue\", \"PastelGreen\", \"PastelOrange\", \"PastelRed\", \"PastelYellow\", \"Pink\", \"Red\", \"White\"];\n    return variants[Math.floor(Math.random() * variants.length)];\n}\n\nfunction hairColor() {\n    let variants = [\"Auburn\", \"Black\", \"Blonde\", \"BlondeGolden\", \"Brown\", \"BrownDark\", \"Platinum\", \"Red\"];\n    return variants[Math.floor(Math.random() * variants.length)];\n}\n\nlet currentDay = new Intl.DateTimeFormat(\"en\", {\n    weekday: \"short\",\n    year: \"numeric\",\n    month: \"short\",\n    day: \"numeric\"\n}).format(new Date()).replace(/[^a-zA-Z0-9]/g, \"_\");\n\nexport default function CurrentLaboratory() {\n    const { data: usersProjects, loading, error } = useFirebaseNode('currentLaboratoryDay/' + currentDay + '/cases/');\n\n    if (!!loading || !usersProjects) { return <Layout><div>...</div></Layout> }\n    if (!!error) { return <Layout>:-(</Layout> }\n\n    let currentCases = Object.keys(usersProjects).map(item => { return usersProjects[item] });\n    console.log(currentCases);\n\n    currentCases.sort(function (a, b) {\n        var timeA = !!a?.timestamp ? a.timestamp : 0;\n        var timeB = !!b?.timestamp ? b.timestamp : 0;\n        if (timeA > timeB) {\n            return -1;\n        }\n        if (timeA < timeB) {\n            return 1;\n        }\n        return 0;\n    });\n\n    const uniqueTitles = !!currentCases ? [...new Set(currentCases.map((item) => item.title))] : [];\n\n    console.log(uniqueTitles);\n\n    // data.sort(function (a, b) {\n    //     var timeA = !!a?.timestamp ? a.timestamp : 0;\n    //     var timeB = !!b?.timestamp ? b.timestamp : 0;\n    //     if (timeA > timeB) {\n    //         return -1;\n    //     }\n    //     if (timeA < timeB) {\n    //         return 1;\n    //     }\n    //     return 0;\n    // });\n\n    // console.log(data);\n\n    // let uniqueUsers = !!data ? [...new Set(data.map(item => item.user))] : []; // [ 'A', 'B']\n    // console.log(uniqueUsers);\n    // let usersProgress = uniqueUsers.map(user => {\n    //     return { user: user, doneTasks: [...new Set(data.filter(quiz => quiz.user === user).map(userquiz => userquiz.title))].length }\n    // });\n    // console.log(usersProgress);\n\n\n    // const uniqueTitles = !!data ? [...new Set(data.map(item => item.title))] : []; // [ 'A', 'B']\n\n    return <Layout>\n\n        <div>     {!!uniqueTitles &&\n            uniqueTitles.map((title) => (\n                <div key={title}>\n                    <Alert variant=\"primary\">{title}</Alert>\n\n                    {!!currentCases && currentCases.length > 0 && currentCases.filter(item => item.title === title).map(item =>\n                        <Card key={item.id}>\n                            <Card.Header>\n                                {!!item.avatarUrl ? (\n                                    <img\n                                        src={item.avatarUrl}\n                                        alt=\"\"\n                                        className=\"m-2\"\n                                        style={{\n                                            verticalAlign: \"middle\",\n                                            width: \"50px\",\n                                            height: \"50px\",\n                                            borderRadius: \"50%\",\n                                            filter: \"grayscale(100%)\",\n                                            objectFit: \"cover\",\n                                        }}\n                                    />\n                                ) : null}\n                                <small>{item.theme}</small>\n\n                            </Card.Header>\n                            <Card.Body>\n                                {/* <Card.Title>{item.theme}</Card.Title> */}\n                                <Card.Text>   <small>{item.quizString}</small></Card.Text>\n                                <Card.Text><small>Ответ: {\" \"}{item.answer}</small></Card.Text>\n                                {item.type === \"spreadsheet\" && !!item?.content && <ShowXlTableArrayOfArrays xlArray={createProtoArray(item.content, 0, 0)} />}\n\n                            </Card.Body>\n                        </Card>\n                    )}\n\n\n                    {/* {currentCases.filter(case => case.title === title)\n                .map((quiz) => {\n                  return (\n                    <div key={quiz.id}>\n                      <Alert variant=\"secondary\" className=\"mt-3\">\n                        {!!quiz.avatarUrl ? (\n                          <img\n                            src={quiz.avatarUrl}\n                            alt=\"\"\n                            className=\"m-2\"\n                            style={{\n                              verticalAlign: \"middle\",\n                              width: \"50px\",\n                              height: \"50px\",\n                              borderRadius: \"50%\",\n                              filter: \"grayscale(100%)\",\n                              objectFit: \"cover\",\n                            }}\n                          />\n                        ) : null}\n                        {quiz.title}\n                      </Alert>\n                      <div>\n                        {quiz.type === \"accountingwithprofitscash\" && isObject(quiz.quizString) ? <ShowXlTableArrayOfArrays xlArray={createProtoArray(quiz.quizString, 0, 0)} /> : ReactHtmlParser(quiz.quizString)}\n                        {ReactHtmlParser(`<br><span>Ответ: ${quiz.type === \"calculation\" ? quiz.comment : quiz.answer}</span>\n                          <span class=\"ml-5\">Дата/время: ${quiz.date}</span><br>\n                          ${!!quiz.user ? \"Решено: \" + quiz.user : \"\"}\n                          `)}\n                      </div>\n                      {/* <DeleteFireNodeButton nodeRef={\"usersCraft/\" + userEmail + \"/posts/\"} id={quiz.id}/> \n                      <MarkDeleteFireNodeButton nodeRef={\"usersCraft/\" + userEmail + \"/posts/\"} id={quiz.id}/>  \n\n                      {quiz?.htmlfeedback && <div>{ReactHtmlParser(quiz.htmlfeedback)}</div>}\n\n                      {quiz.type === \"spreadsheet\" && !!quiz?.content && <ShowXlTableArrayOfArrays xlArray={createProtoArray(quiz.content, 0, 0)} />}\n\n                      {quiz.type === \"calculation\" && <ShowXlTableWithPredefinedIndicators quiz={quiz} xlArray={createProtoArray(quiz.content, 0, 0)} />}\n\n                      {(quiz.type === \"balancestackedbarswithpredefinedindicators\" ||\n                        quiz.type === \"arraycategoriesbarapexchartwithpredefinedindicators\" ||\n                        quiz.type === \"arraycategorieslineapexchartwithpredefinedindicators\"\n                      ) && quiz?.deleted !== true && <PrepareDataFromDictionaryForChart quiz={quiz} />}\n\n                      {(quiz.type === \"html\" || quiz.type === \"markdown\") && <div>{ReactHtmlParser(quiz.content)}</div>}\n\n                      {(quiz.type === \"datetimebarapexchart\" || quiz.type === \"datetimelineapexchart\" ||\n                        quiz.type === \"arraycategorieslineapexchart\" || quiz.type === \"arraycategoriesbarapexchart\")\n                        && quiz?.deleted !== true && <GetSeriesCategoriesOptionsForApexChart firenode={quiz.content} mediaItem={quiz.type} />\n                      }\n\n                      {(quiz.type === \"scatterquotesapexchart\" || quiz.type === \"scatterquotesapexchartoptions\" ||\n                        quiz.type === \"scatterapexchart\") && quiz?.deleted !== true && <GetReadyScatterApexChart firenode={quiz.content} />\n                      }\n\n                      {(quiz.type === \"datalinequotesapexchart\" || quiz.type === \"datalinequotesapexchartoptions\" ||\n                        quiz.type === \"datetimeareanocategoriesapexchart\") && quiz?.deleted !== true && <GetReadyDatalineQuotesApexChart firenode={quiz.content} />\n                      }\n\n\n                      {quiz.type === \"media\" ? <ShowMedia datafirenode={\"/usersCraft/\" + userEmail + \"/data/\" + quiz.content} /> : null}\n\n                      {quiz.type === \"accountingwithprofitscash\" ? <MediaTemplatesAccountingWithProfitsCash records={quiz.content} mediaItems={quiz.mediaItems} /> : null}\n\n\n                    </div>\n                  );\n                })} */}\n                </div>\n            ))}</div>\n\n        {/* {projectUrls.map((project, projectIndex) => {\n            console.log(project)\n            return <div >\n                <ProjectLayout key={projectIndex} projectUrl={project} projectForms={Object.keys(usersProjects[project]).map(item => { return [item] })} />\n            </div>\n        })}      */}\n    </Layout>\n}\n\n\nfunction ProjectLayout({ projectUrl, projectForms }) {\n    const { data: projectMeta, loading, error } = useFirebaseNode('openmedia/' + projectUrl);\n\n\n    if (!!loading || !projectMeta) { return <div>...</div> }\n    if (!!error) { return <div>:-(</div> }\n\n\n    return <div>\n        <Alert variant=\"primary\">{projectMeta.theme}</Alert>\n\n        <div className=\"media border p-3 mb-5\">\n            {!!projectMeta?.avatarUrl ?\n                <img\n                    src={projectMeta.avatarUrl} alt=\"\" className=\"m-3\" data-toggle=\"tooltip\" data-placement=\"bottom\"\n                    style={{ verticalAlign: 'middle', width: '60px', height: '60px', borderRadius: '50%', filter: 'grayscale(100%)', objectFit: 'cover' }} />\n                :\n                <span data-toggle=\"tooltip\" data-placement=\"bottom\">\n                    <Avatar\n                        style={{ width: '60px', height: '60px' }}\n                        avatarStyle='Circle'\n                        topType={topType()}\n                        accessoriesType='Prescription02'\n                        hairColor={hairColor()}\n                        facialHairType='Blank'\n                        clotheType={clothType()}\n                        clotheColor={clotheColor()}\n                        eyeType='Happy'\n                        eyebrowType='Default'\n                        mouthType='Smile'\n                        skinColor='Light'\n                    />\n                </span>\n            }\n\n            {/* <img\n                src={projectMeta.avatarUrl}\n                alt=\"\"\n                className=\"m-3\"\n                style={{\n                    verticalAlign: \"middle\",\n                    width: \"60px\",\n                    height: \"60px\",\n                    borderRadius: \"50%\",\n                    filter: \"grayscale(100%)\",\n                    objectFit: \"cover\",\n                }}\n            /> */}\n            <div className=\"media-body\">\n                <h4>\n                    {projectMeta.user}{\" \"}\n                    <small>\n                        <i>\n                            {projectMeta.date}\n                        </i>\n                    </small>\n                </h4>\n                <p>{projectMeta.content}{\" \"} {projectMeta.quizString}</p>\n            </div>\n        </div>\n        <div>{projectForms.map(projectCalculation => <ProjectForm formUrl={projectCalculation} />)} </div>\n    </div>\n}\n\nfunction ProjectForm({ formUrl }) {\n    const { data: formMeta, loading, error } = useFirebaseNode('/usersTemplates/calculations/' + formUrl);\n\n    if (!!loading || !formMeta) { return <div>...</div> }\n    if (!!error) { return <div>:-(</div> }\n\n    return <div>\n        <div>{ReactHtmlParser(\n            formMeta.title + '<br><small>' +\n            formMeta.quizString + '</small><br><small>' +\n            formMeta.comment + '</small><br>' +\n            '<small>Дата/время: ' + formMeta.date + '<small><br>')}\n        </div>\n        <div>{formMeta?.htmlfeedback && <div>{ReactHtmlParser(formMeta.htmlfeedback)}</div>}</div>\n        <ShowXlTableWithPredefinedIndicators quiz={formMeta} xlArray={createProtoArray(formMeta.content, 0, 0)} />\n\n    </div>\n\n\n\n}","import React from \"react\";\nimport { useFirebaseNode } from \"../hooks/useFirebaseNode\";\n\nimport { doFindValuesForArrayOfArraysTable } from \"../features/data/dataSlice\";\n\nimport Table from \"react-bootstrap/Table\";\n\n\n\nexport default function ShowXlTableWithPredefinedIndicators({ quiz, xlArray }) {\n  const { data: projectData, loading, error } = useFirebaseNode('openmediadata/' + quiz.answer);\n\n  if (!!loading || !projectData) { return <div>...</div> }\n  if (!!error) { return <div>:-(</div> }\n\n  let projectDataArray = Object.keys(projectData)\n    .map((item) => { return projectData[item] })\n\n  // console.log(quiz);\n  // console.log(projectDataArray);\n\n  let tableWithData = doFindValuesForArrayOfArraysTable(projectDataArray, xlArray);\n  // console.log(tableWithData);\n\n\n  return <Table striped bordered hover size=\"sm\">\n    <thead>\n      <tr>\n        {tableWithData[0].map((column, columnIndex) => (\n          <th key={columnIndex} className=\"text-center\">\n            {tableWithData[0][columnIndex]}\n          </th>\n        ))}\n      </tr>\n    </thead>\n    <tbody>\n      {tableWithData.map((row, rowIndex) => {\n        if (rowIndex > 0) {\n          return <tr key={rowIndex}>\n            {row.map((column, columnIndex) => (\n              <td key={rowIndex + columnIndex} >\n            <small className={\"ml-1\"}> {row[columnIndex]}</small>   {/* <small>{row[columnIndex]}</small>  */}\n              </td>\n            ))}\n          </tr>\n        }\n      })}\n    </tbody>\n  </Table>\n}\n\n\n"],"sourceRoot":""}